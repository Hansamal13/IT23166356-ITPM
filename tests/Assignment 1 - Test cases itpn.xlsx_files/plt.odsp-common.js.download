"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([["plt.odsp-common"],[function(a,b,c){let d;c.d(b,{a:function(){return s},b:function(){return p}});var e=c(130),f=c(70);function g(a){try{let b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)");return b?b.pop():""}catch{return""}}function h(a,b){document.cookie=`${a}=${b};path=/;samesite=none;secure;${!b?"expires=Thu, 01 Jan 1970 00:00:01 GMT;":""}`}let i="enableKillSwitches",j="disableKillSwitches",k="KillSwitchOverrides",l=`${k}_${i}`,m=`${k}_${j}`;function n(a){let b=[],c=[];for(let d in a)(a[d]?b:c).push(d);try{h(l,b.join(",")),h(m,c.join(","))}catch{}}let o={};function p(){if(o){let a=[];for(let b of Object.keys(o))a.push(o[b]?b:`!${b}`);return a.join(",")}}function q(){let a=g(l),b=g(m);var c={},d=void 0;if(a)for(let b of a.split(","))c[e.normalizeUpper(b,!1)]=!0;if(b)for(let a of b.split(","))c[e.normalizeUpper(a,!1)]=!1;if(d)for(let a of d.split(","))"!"===a[0]?c[e.normalizeUpper(a.slice(1),!1)]=!1:c[e.normalizeUpper(a,!1)]=!0;return c}let r=()=>{o=q();let a=function(){let a={};try{let b=location.search?location.search.substring(1):"";if(b)for(let c of b.split("&")){let b=c.split("=");b.length>1&&void 0!==b[0]&&void 0!==b[1]&&(a[b[0]]=decodeURIComponent(b[1].replace(/\+/g," ")))}}catch{}return a}();a[i],a[j],a.debugKillSwitches,n(o),r=()=>{}};class s{static initKillSwitches(a){s._killSwitch=t({killSwitches:a||{}})}static isActivated(a,b,c){if(r(),s._killSwitch)return s.isActivated=s._killSwitch.isActivated,s._killSwitch.isActivated(a,b,c);try{if(window._spPageContextInfo){let d=t(window._spPageContextInfo);return window._spPageContextInfo?.killSwitches&&(s.isActivated=d.isActivated),d.isActivated(a,b,c)}if(window.Flight){let d;if(window.Flight.KillSwitches)for(let a of(d={},Object.keys(window.Flight.KillSwitches)))d[window.Flight.KillSwitches[a]]=!0;let e=t({killSwitches:d});return d&&(s.isActivated=e.isActivated),e.isActivated(a,b,c)}}catch{}return d&&d(a,!1),!1}}function t(a){let b=a&&a.killSwitches;return{isActivated:(a,c,f)=>{var g;let h=!1;if(a){let c=e.normalizeUpper(a,!1);c in o?h=!!o[c]:b&&(h=!!b[c])}return g=h,d&&d(a,g),h}}}try{let a=(a,b=!0)=>{let c=q();c[e.normalizeUpper(a,!1)]=!!b,o[e.normalizeUpper(a,!1)]=!!b,n(c)};window.__debugSetKillSwitch=a,(0,f.b)("killSwitches",{get:()=>({set:a,isActivated:a=>s.isActivated(a)})})}catch{}}
,,,function(a,b,c){c.d(b,{a:function(){return h},b:function(){return f.a}});var d=c(94),e=c(11),f=c(35);let g=(0,d.a)({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:e.a.String},startTimeOverride:{isPrefixingDisabled:!0,type:e.a.Number},resultCode:{isPrefixingDisabled:!0,type:e.a.String},resultType:{typeRef:f.a,isPrefixingDisabled:!0,type:e.a.Enum},error:{isPrefixingDisabled:!0,type:e.a.String},stackTrace:{isPrefixingDisabled:!0,type:e.a.String},extraData:e.a.Object,extraMetrics:{isPrefixingDisabled:!0,type:e.a.Object},privacyClassification:{isPrefixingDisabled:!0,type:e.a.String},objectType:{isPrefixingDisabled:!0,type:e.a.String},persistence:{isPrefixingDisabled:!0,type:e.a.Boolean}}).withData({privacyClassification:e.b.requiredService,privacyDataTypes:["productAndServicePerformance"]});class h extends g{end(a){return a&&a.extraData&&this.data.extraData&&(a={...a,extraData:{...this.data.extraData,...a.extraData}}),super.end(a)}}}
,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(169),e=c(245);let f=0;class g{get key(){return this}toString(){return`Resource #${this.id} "${this.name}"`}constructor(a){this.id=++f,"string"==typeof a?(this.name=a,this.factory=void 0,this.loader=void 0):(this.name=a.name,this.factory=a.factory,this.loader=a.loader)}}Object.defineProperty(g.prototype,"flags",{value:d.a.none}),Object.defineProperties(g.prototype,e.b)}
,function(a,b,c){let d,e;c.d(b,{a:function(){return A},b:function(){return y}});var f=c(56),g=c(0),h=c(28),i=c(255),j=c(70);let k=g.a.isActivated("26b61085-e68c-4a13-a8de-ae84ba2d96d2","1/16/2023","Validate if window object is present or not"),l=g.a.isActivated("BE39BD19-F3B1-4ECB-A1BB-E0F95F6309B2"),m="enableFeatures",n="disableFeatures",o={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},p={ODB:357,Fallback:!1},q={ODB:342,Fallback:!1},r={ODB:60763,ODC:"AllowFeatureOverrides",Fallback:!1},s="FeatureOverrides",t={},u=`${s}_${m}`,v=`${s}_${n}`;function w(a){try{let b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)");return b?b.pop():""}catch{}}function x(a){let b=[],c=[];for(let d in a)(a[d]?b:c).push(d);try{document.cookie=`${u}=${b.join(",")};path=/;samesite=none;secure;${!b.length?"expires=Thu, 01 Jan 1970 00:00:01 GMT;":""}`,document.cookie=`${v}=${c.join(",")};path=/;samesite=none;secure;${!c.length?"expires=Thu, 01 Jan 1970 00:00:01 GMT;":""}`}catch{}}function y(){if(t){let a=[];for(let b of Object.keys(t))a.push(t[b]?b:`!${b}`);return a.join(",")}}function z(a,b,c,d){if(b)for(let c of b.split(","))a[c]=!0;if(c)for(let b of c.split(","))a[b]=!1;if(d)for(let b of d.split(","))"!"===b[0]?a[b.slice(1)]=!1:a[b]=!0;return a}class A{static get Overrides(){return t}static evaluateCanOverride(){if(!k&&"undefined"==typeof window){A.CanOverride=!1;return}A.CanOverride=h.b.isFeatureEnabled(o)||h.b.isFeatureEnabled(p)||h.b.isFeatureEnabled(q)||h.b.isFeatureEnabled(r)||!!(window?.Flight&&("dev"===window.Flight.version||window.Flight.devMode))}static isFeatureEnabled(a,b){let c=A._isFeatureEnabled(a,b);return e&&e(a,c),c}static isEcsFeatureEnabled(a,b){let c=A._isEcsFeatureEnabled(a,b);return e&&e(a,c),c}static _isFeatureEnabled(a,b){if(A.CanOverride){if(a.ODB in t){let b=t[a.ODB];return!l&&b&&(0,h.c)(a.ODB),b}else if(a.ODC in t)return t[a.ODC]}return b?(0,i.b)(a,b):h.b.isFeatureEnabled(a)}static _isEcsFeatureEnabled(a,b){return A.CanOverride&&a.ODBECS in t?t[a.ODBECS]:b?(0,i.a)(a,b):h.b.isFeatureEnabled(a)}}A.AllowFeatureOverrides=o,A.SPODebugOnlyCookieRedirect=p,A.ClientDebugFeatureOverrides=r,(()=>{if(A.evaluateCanOverride(),t=z({},w(u),w(v),void 0),A.CanOverride){let a=location.search?location.search.substring(1):"",b=(0,f.a)(a),c=b[m],d=b[n],e=b.debugFlights;z(t,c,d,e)}x(t);try{d=(a,b=!0)=>{t[a]=!!b,x(t)},window.__debugSetFeature=d,(0,j.b)("features",{get:()=>({set:d,isEnabled:a=>{let b;if("string"==typeof a){let c=Number(a);b=isNaN(c)?{ODC:a}:{ODB:c}}else b="number"==typeof a?{ODB:a}:a;return A.isFeatureEnabled(b)}})})}catch{}})()}
,function(a,b,c){let d,e,f,g,h,i,j,k,l,m,n;c.d(b,{a:function(){return R},b:function(){return Q}});var o=c(250);function p(a){window.setTimeout(()=>{o.c(O,q,{error:a})},0)}let q="error",r="Canceled",s=1;function t(){}function u(a,b){a._value=b,a._setState(O.isPromise(b)?f:j)}function v(a,b,c,d,e,f){return{exception:a,error:b,promise:c,handler:f,id:d,parent:e}}function w(a,b,c,d){let e=c?._isException;return v(e?b:null,e?null:b,a,c?._errorId,c,d)}function x(a,b,c){let d=c?._isException,e=c?._errorId;return a instanceof O&&G(a,e,d),v(d?b:null,d?null:b,a,e,c)}function y(a,b){let c=++s;return a instanceof O&&G(a,c),v(null,b,a,c)}function z(a,b){let c=++s;return a instanceof O&&G(a,c,!0),v(b,null,a,c)}function A(a,b,c){F(a,{c:b,e:c})}function B(a,b,c,d){a._value=b,E(a,b,c,d),a._setState(l)}function C(a,b){let c,d,e=a._value,g=a._listeners;if(g)for(c=0,a._listeners=null,d=g.length;c<d;c++){let d=g[c],h=d.c,i=d.promise;if(i){try{i._setCompleteValue(h?h(e):e)}catch(a){i._setExceptionValue(a)}i._state!==f&&i._listeners&&b.push(i)}else M.prototype.done.call(a,h)}}function D(a,b){let c,d,e=a._value,g=a._listeners;if(g)for(c=0,a._listeners=null,d=g.length;c<d;c++){let d=g[c],h=d.e,i=d.promise;if(i){try{h?(h.handlesOnError||E(i,e,w,a,h),i._setCompleteValue(h(e))):i._setChainedErrorValue(e,a)}catch(a){i._setExceptionValue(a)}i._state!==f&&i._listeners&&b.push(i)}else K.prototype.done.call(a,void 0,h)}}function E(a,b,c,d,e){b instanceof Error&&b.message===r||o.c(O,q,c(a,b,d,e))}function F(a,b){let c=a._listeners;c?c.push(b):c=[b],a._listeners=c}function G(a,b,c){a._isException=c||!1,a._errorId=b}function H(a,b,c,d){a._value=b,E(a,b,c,d),a._setState(m)}function I(a,b){let c;c=O.isPromise(b)?f:k,a._value=b,a._setState(c)}function J(a,b,c){let d=new P(a);return F(a,{promise:d,c:b,e:c}),d}d={name:"created",enter:a=>{a._setState(e)},cancel:t,done:t,then:t,_completed:t,_error:t,_notify:t,_setCompleteValue:t,_setErrorValue:t},e={name:"working",enter:t,cancel:a=>{a._setState(h)},done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},f={name:"waiting",enter:a=>{let b=a._value;if(b instanceof P&&b._state!==m&&b._state!==k)F(b,{promise:a});else{let c=d=>{b._errorId?a._chainedError(d,b):(E(a,d,w,b,c),a._error(d))};c.handlesOnError=!0,b.then(a._completed.bind(a),c)}},cancel:a=>{a._setState(g)},done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},g={name:"waiting_canceled",enter:a=>{a._setState(i);let b=a._value;O.is(b)&&b.cancel()},cancel:t,done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},h={name:"canceled",enter:a=>{a._setState(i),a._cancelAction()},cancel:t,done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},i={name:"canceling",enter:a=>{let b=Error(r);b.name=b.message,b._handled=!0,a._value=b,a._setState(l)},cancel:t,done:t,then:t,_completed:t,_error:t,_notify:t,_setCompleteValue:t,_setErrorValue:t},j={name:"complete_notify",enter:a=>{if(a._listeners){let b,c=[a];for(;c.length;)(b=c.shift())&&b._state._notify(b,c)}a._setState(k)},cancel:t,done:(a,b,c)=>M.prototype.done.call(a,b),then:(a,b,c)=>M.prototype.then.call(a,b,c),_completed:t,_error:t,_notify:C,_setCompleteValue:t,_setErrorValue:t},k={name:"success",enter:a=>{a._cleanupAction()},cancel:t,done:(a,b,c)=>M.prototype.done.call(a,b),then:(a,b,c)=>M.prototype.then.call(a,b),_completed:t,_error:t,_notify:C,_setCompleteValue:t,_setErrorValue:t},l={name:"error_notify",enter:a=>{if(a._listeners){let b,c=[a];for(;c.length;)(b=c.shift())&&b._state._notify(b,c)}a._setState(m)},cancel:t,done:(a,b,c)=>K.prototype.done.call(a,b,c),then:(a,b,c)=>K.prototype.then.call(a,b,c),_completed:t,_error:t,_notify:D,_setCompleteValue:t,_setErrorValue:t},m={name:"error",enter:a=>{a._cleanupAction()},cancel:t,done:(a,b,c)=>K.prototype.done.call(a,b,c),then:(a,b,c)=>K.prototype.then.call(a,b,c),_completed:t,_error:t,_notify:D,_setCompleteValue:t,_setErrorValue:t};class K{get[Symbol.toStringTag](){return"ErrorPromise"}cancel(){}done(a,b){let c=this._value;if(b)try{b.handlesOnError||E(this,c,w,this,b);let a=b(c);O.is(a)&&a.done();return}catch(a){c=a}c instanceof Error&&c.message===r||p(c)}then(a,b){let c;if(!b)return this;let d=this._value;try{b.handlesOnError||E(this,d,w,this,b),c=new M(b(d))}catch(a){c=a===d?this:new L(a)}return c}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>R.resolve(a?.()).then(()=>b),b=>R.resolve(a?.()).then(()=>{throw b}))}constructor(a,b=y){this._value=a,E(this,a,b)}}class L extends K{constructor(a){super(a,z)}}class M{get[Symbol.toStringTag](){return"CompletePromise"}cancel(){}done(a,b){if(a)try{let b=a(this._value);O.is(b)&&b.done()}catch(a){p(a)}}then(a,b){let c;try{let b=a?a(this._value):this._value;c=this._isSameValue(b,this)?this:new M(b)}catch(a){c=new L(a)}return c}catch(a){return this.then(void 0)}finally(a){return this.then(b=>R.resolve(a?.()).then(()=>b),b=>R.resolve(a?.()).then(()=>{throw b}))}_isSameValue(a,b){return a===this._value}constructor(a){if(O.isPromise(a)){const b=new P(null);return b._setCompleteValue(a),b}this._value=a}}function N(a){return()=>{for(let b of Object.keys(a))O.as(a[b]).cancel()}}class O{static get cancel(){return n||(n=new K(Error(r)))}static get[Symbol.species](){return this}static any(a){return new O((b,c)=>{let d=Object.keys(a),e=d.length;for(let f of(0===e&&b(),d)){let d=O.as(a[f]);d.then(()=>{b({key:f,value:d})},a=>{if(a instanceof Error&&a.name===r){0==--e&&b(O.cancel);return}c({key:f,value:d})})}},N(a))}static race(a){return new O((b,c)=>{let d=Object.keys(a),e=d.length;for(let f of(0===e&&b(),d))O.as(a[f]).then(b,a=>{if(a instanceof Error&&a.name===r){0==--e&&b(O.cancel);return}c(a)})},N(a))}static as(a){return O.is(a)?a:new M(a)}static is(a){return O.isPromise(a)&&"function"==typeof a.cancel}static isPromise(a){return!!a&&"object"==typeof a&&"function"==typeof a.then}static isCanceled(a){return a instanceof Error&&a.name===r}static all(a){return new O((b,c)=>{let d=Object.keys(a),e=Array.isArray(a)?[]:{},f=Array.isArray(a)?[]:{},g=d.length,h=()=>{if(0==--g){let a=Object.keys(e);0===a.length?b(f):a.every(a=>O.isCanceled(e[a]))?b(O.cancel):c(e)}};for(let b of d){let c=a[b];void 0===c?g--:O.then(c,a=>{f[b]=a,h()},a=>{e[b]=a,h()})}0===g&&b(f)},N(a))}static allSettled(a){return new O((b,c)=>{let d=Object.keys(a),e=Array.isArray(a)?[]:{},f=d.length,g=()=>{0==--f&&b(e)};for(let b of d){let c=a[b];void 0===c?f--:O.then(c,a=>{e[b]={status:"fulfilled",value:a},g()},a=>{e[b]={status:"rejected",reason:a},g()})}0===f&&b(e)},N(a))}static then(a,b,c){return O.as(a).then(b,c)}static thenEach(a,b,c){let d=Array.isArray(a)?[]:{};for(let e of Object.keys(a))d[e]=O.then(a[e],b,c);return O.all(d)}static serial(a){return a.reduce((a,b)=>a.then(b),O.wrap())}static timeout(a,b){let c,d,e=new O(b=>{c=window.setTimeout(b,a)},()=>{c&&window.clearTimeout(c)});return b?(d=()=>{e.cancel()},e.then(()=>{b.cancel()}),b.then(d,d),b):e}static wrap(a){return new M(a)}static resolve(a){return O.wrap(a)}static wrapError(a){return new K(a)}static reject(a){return O.wrapError(a)}get[Symbol.toStringTag](){return"CancelablePromise"}cancel(){this._state.cancel(this),this._run()}done(a,b){this._state.done(this,a,b)}then(a,b){return this._state.then(this,a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>R.resolve(a?.()).then(()=>b),b=>R.resolve(a?.()).then(()=>{throw b}))}_init(a,b){this._oncancel=b,this._setState(d),this._run();try{a?a(this._completed.bind(this),this._error.bind(this)):this._setExceptionValue(Error("No init value for Promise"))}catch(a){this._setExceptionValue(a)}}_cancelAction(){if(this._oncancel)try{this._oncancel()}catch(a){}}_cleanupAction(){this._oncancel=void 0}_chainedError(a,b){let c=this._state._error(this,a,x,b);return this._run(),c}_completed(a){let b=this._state._completed(this,a);return this._run(),b}_error(a){let b=this._state._error(this,a,y);return this._run(),b}_setState(a){this._nextState=a}_setCompleteValue(a){this._state._setCompleteValue(this,a),this._run()}_setChainedErrorValue(a,b){let c=this._state._setErrorValue(this,a,x,b);return this._run(),c}_setExceptionValue(a){let b=this._state._setErrorValue(this,a,z);return this._run(),b}_run(){for(;this._nextState;)this._state=this._nextState,this._nextState=void 0,this._state.enter(this)}_isSameValue(a,b){return a===this._value}constructor(a,b){this._init(a,b)}}o.a(O,q);class P extends O{_init(){}_cancelAction(){this._creator&&this._creator.cancel()}_cleanupAction(){this._creator=null}_initThen(){this._setState(d),this._run()}constructor(a){super(),this._creator=a,this._initThen()}}let Q=class extends O{_init(){}_cancelAction(){this._oncancel&&this._oncancel()}_cleanupAction(){this._oncancel=void 0}_initSignal(){this._setState(d),this._run()}constructor(a){super(),this._oncancel=a,this._initSignal()}},R=O;b.c=R}
,,,,function(a,b,c){c.d(b,{a:function(){return i},b:function(){return h}});var d={};c.r(d),c.d(d,{optionalDiagnostic:function(){return f},requiredDiagnostic:function(){return e},requiredService:function(){return g}});let e="requiredDiagnostic",f="optionalDiagnostic",g="requiredService",h=d,i={String:1,Number:2,Boolean:3,Object:4,Array:5,Enum:6}}
,,,,function(a,b,c){var d,e;c.d(b,{a:function(){return g}});let f=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;(e=d||(d={}))[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl";class g{constructor(a="",b){const c=b?.allowDataUrl??!1,d=a.indexOf("//"),e=a.indexOf("/"),g=d>-1&&d<=e?d+2:-1,h=function(a,b){if(!(b>-1))return"";{let c=a.indexOf("/",b);return c>-1?a.slice(0,c):a}}(a,g),i=h&&h.slice(g),j=a.slice(h.length),k=h?0:c&&f.test(a)?3:"/"===j[0]?2:1,l=j.split("/");this.authority=h,this.domain=i,this.format=k,this.path=j,this.segments=l,this.value=a}}}
,function(a,b,c){c.d(b,{$:function(){return M},$b:function(){return ay},A:function(){return ad},Ab:function(){return bt},B:function(){return bg},Bb:function(){return bq},C:function(){return S},Cb:function(){return j},Cc:function(){return y},D:function(){return H},Db:function(){return I},Dc:function(){return aI},E:function(){return aV},Eb:function(){return a4},F:function(){return T},Fb:function(){return a7},G:function(){return aF},Gb:function(){return a8},H:function(){return aG},Hb:function(){return o},I:function(){return a_},Ib:function(){return x},Ic:function(){return aM},J:function(){return af},Jb:function(){return bp},K:function(){return w},Kb:function(){return a6},L:function(){return bl},Lb:function(){return n},M:function(){return aW},Mb:function(){return p},N:function(){return ae},Nb:function(){return z},O:function(){return bd},Ob:function(){return bi},Oc:function(){return ah},P:function(){return v},Pb:function(){return X},Q:function(){return m},Qb:function(){return bu},R:function(){return ai},Rb:function(){return aO},S:function(){return Y},Sb:function(){return ap},Sc:function(){return bb},T:function(){return aj},Tb:function(){return Z},U:function(){return bz},Ub:function(){return $},V:function(){return al},Vb:function(){return bv},W:function(){return bA},Wb:function(){return bn},X:function(){return br},Xb:function(){return a5},Y:function(){return bo},Yb:function(){return bw},Z:function(){return B},Zb:function(){return ax},_:function(){return aD},_b:function(){return an},_c:function(){return bs},a:function(){return N},ab:function(){return D},ac:function(){return ab},b:function(){return aw},bb:function(){return av},bc:function(){return aY},c:function(){return Q},cb:function(){return bj},cc:function(){return ag},d:function(){return P},db:function(){return s},dc:function(){return ak},e:function(){return J},eb:function(){return by},ec:function(){return a1},f:function(){return i},fb:function(){return q},fc:function(){return G},g:function(){return a9},gb:function(){return L},gc:function(){return aR},h:function(){return bx},hb:function(){return a$},hc:function(){return u},i:function(){return at},ib:function(){return E},ic:function(){return W},j:function(){return aL},jb:function(){return bh},k:function(){return aT},kb:function(){return t},l:function(){return U},lb:function(){return a0},lc:function(){return ar},m:function(){return aK},mb:function(){return bB},mc:function(){return az},n:function(){return aQ},nb:function(){return A},nc:function(){return V},o:function(){return bm},ob:function(){return aB},oc:function(){return aX},p:function(){return be},pb:function(){return bc},pc:function(){return R},q:function(){return ba},qb:function(){return au},r:function(){return aU},rb:function(){return am},rc:function(){return aa},s:function(){return bk},sb:function(){return aE},sc:function(){return F},t:function(){return aJ},tb:function(){return r},tc:function(){return aP},u:function(){return O},ub:function(){return aN},uc:function(){return l},v:function(){return aZ},vb:function(){return aC},vc:function(){return aH},w:function(){return aS},wb:function(){return K},x:function(){return C},xb:function(){return aA},xc:function(){return ac},y:function(){return a3},yb:function(){return as},yc:function(){return bf},z:function(){return a2},zb:function(){return aq}});var d=c(6),e=c(28),f=c(0),g=c(79);let h=window._spPageContextInfo,i={ODB:1466};function j(){return e.b.isFeatureEnabled(i)}let k=[];function l(){return!0}function m(){return d.a.isFeatureEnabled({ODB:1977})}function n(){return d.a.isFeatureEnabled({ODB:60345})}function o(){return d.a.isFeatureEnabled({ODC:!0,ODB:!1,ECS:1081438,OneDrive:void 0})}function p(){var a;let b;return!d.a.isFeatureEnabled({ODC:(a="ODCHideNonPremiumLinkFeatures",(b=k.filter(function(b){return b.flightStringId===a})[0])?b.flightEnabled:a),ODB:!1,OneDrive:void 0})}function q(){return f.a.isActivated("4429323f-4400-4a98-a83b-4e27f4c42109","04/18/2024","Fix shared with update")||d.a.isFeatureEnabled({ECS:1253990})}function r(){return!f.a.isActivated("c270c3c0-e271-42bd-8e82-c1e2d9a2a7b2","11/10/2025","fixLinkSettingsModeError for v2 when share link api is failed")}function s(){return!f.a.isActivated("a0f6091d-e62c-4e67-b0a6-72bbb134892d","02/10/2023","fixPeoplePickerOdcCustomerPromise")&&!d.a.isFeatureEnabled({ECS:1069468})}function t(){return!d.a.isFeatureEnabled({ODC:f.a.isActivated("12EA7E85-1736-4E83-9E6E-E6F9610A692B","08/15/2023","FamilySharingWacKS"),ODB:!1,OneDrive:void 0})}function u(){return f.a.isActivated("bdd26309-eb3c-4f4f-9d14-ceef3e92cc6f","04/18/2024","update callout to use tooltip")||d.a.isFeatureEnabled({ECS:1254087})}function v(){return!f.a.isActivated("da13eadb-9185-4fff-895e-e7d4e149be07","01/18/2023","external sharing in people picker")&&!d.a.isFeatureEnabled({ECS:1056503})}function w(){return!f.a.isActivated("34614db0-da1b-4a32-8252-3c0fb8f80913","09/19/2023","enable the premium features for M365 basic plan users")&&!d.a.isFeatureEnabled({ECS:1169459})&&d.a.isFeatureEnabled({ODB:60907})}function x(){return!f.a.isActivated("4e2301ca-b8b4-48c0-b35a-006b9c31b18c","12/28/2023","re share the existing link to others")&&!d.a.isFeatureEnabled({ECS:1146219})&&d.a.isFeatureEnabled({ODB:61265})}function y(){return!f.a.isActivated("1a17ad58-dba7-4885-8976-56f6e65c8d85","03/25/2025","use audience check in share link function, mainly used for reshare")}function z(){return!f.a.isActivated("2e9b2ce9-cbf7-4946-a014-d8590a7c0fb5","04/17/2025","re share clear recipient in share link function")}function A(){return!f.a.isActivated("cb7d2c6b-f7da-457b-aca2-d8b94f0ababb","01/18/2023","fixLinkSettingsOpenLog")&&!d.a.isFeatureEnabled({ECS:1064203})}function B(){return!f.a.isActivated("29f3b27d-c021-4576-a5d9-09aabcfc99fb","04/06/2023","fixCopyLinkViewState")&&!d.a.isFeatureEnabled({ECS:1094346})}function C(){return!f.a.isActivated("71a40062-0aba-46d5-9221-997738ee798b","10/14/2024","changeCustomerPromiseTimeOut")&&!d.a.isFeatureEnabled({ECS:1086659})}function D(){return!f.a.isActivated("03fde877-4287-4f2a-9c7f-da996bdcb7a6","04/24/2023","fixLinkSettingsOtherSettings")&&!d.a.isFeatureEnabled({ECS:1083754})}function E(){return!f.a.isActivated("2153f182-6d03-4ca4-909f-8064ad3c3f6f","07/27/2023","fixLinkSettingsPeoplePicker")&&!d.a.isFeatureEnabled({ECS:1113931})}function F(){return!f.a.isActivated("03db8451-92a3-47a5-be55-af82ccce6e39","06/13/2023","simplifiedCopyCommandNotification")&&!d.a.isFeatureEnabled({ECS:1093764})}function G(){return!f.a.isActivated("aad6691b-4c47-4bfc-bc4a-24962f4f9669","07/26/2023","supportExternalSharingForExistingAudience")&&!d.a.isFeatureEnabled({ECS:1113615})}function H(){return!f.a.isActivated("177e3f91-46d3-41ba-8c8f-8dc1fad68910","02/12/2024","copyPermissionMaxWaitEnabled")&&!d.a.isFeatureEnabled({ECS:1230381})}function I(){return!f.a.isActivated("c654fb63-ee65-4e9c-95d4-ac304f3b2025","02/12/2024","initCPWithHostSessionId")&&!d.a.isFeatureEnabled({ECS:1230509})}function J(){return!f.a.isActivated("1dee4d47-8282-45c8-937b-7c1636991a61","02/20/2024","ShareDialogSingleCxP")&&!d.a.isFeatureEnabled({ECS:1233537})&&d.a.isFeatureEnabled({ODB:61483})}function K(){return!f.a.isActivated("c56bb19f-9436-4e7a-bc9a-55347c3f1db4","02/20/2024","ShareDialogSingleCxP")&&!d.a.isFeatureEnabled({ECS:1251387})}function L(){return!f.a.isActivated("70804dcd-05a5-476e-8599-c2a14e37cff7","05/29/2024","graduateCleanUpDefaultLink")&&!d.a.isFeatureEnabled({ECS:1266299})}function M(){return!f.a.isActivated("ec61b33f-ee32-441d-bc6a-4a868f835e93","03/24/2025","fixExpirationDatePicker")}function N(){return!f.a.isActivated("97e22824-dfad-45bd-a68d-43a256afa3b9","02/12/2025","COBPeoplePickerResolveInSPO")&&!d.a.isFeatureEnabled({ECS:1551146})}function O(){return!f.a.isActivated("d4fe1d94-091b-4958-8b0a-60bcf382a59a","11/29/2024","authFailErrorUI")&&!d.a.isFeatureEnabled({ECS:1479727})}function P(){return!f.a.isActivated("eb2dd7bc-d212-4515-a3a9-fe186ec5ebdd","05/21/2025","ExternalWarningOnAtMentionEnabled")}function Q(){return!f.a.isActivated("5ac2f4f9-e1cb-4175-9bb5-899b074d087b","07/25/2025","ExpirationDatePickerInlineEnabled")}function R(){return!f.a.isActivated("13514d47-1e94-4a20-bb40-bf63f5468bf7","05/21/2025","teamsCopyLinkPerfImprovement")}function S(){return!f.a.isActivated("8a114f14-43ad-45a3-842e-1ac7f922cd2e","07/17/2025","copyModeShareReadyEventRefactor")}function T(){return!f.a.isActivated("11e9c495-1e13-4db5-9c2a-ef1fb98ad902","07/29/2025","disableReShareForBundleSharing")}function U(){return!f.a.isActivated("816dcade-9a8f-4a5f-9991-ff9e130c8a12","08/13/2025","addServerSharingContextLogging")}function V(){return!f.a.isActivated("01817736-be12-42ac-b760-193c25bf30b1","09/11/2025","sendManifestToHostApp")}function W(){return!f.a.isActivated("dcfb2c5d-46bc-4a7f-8970-f5066f36bb16","10/12/2021","Share To Teams in web")}function X(){return!f.a.isActivated("e6dbe5d1-55f9-439b-a975-1931c6bf9c90","02/25/2021","People picker improvements")&&!d.a.isFeatureEnabled({ECS:1005398})}function Y(){return d.a.isFeatureEnabled({ODC:!0,ODB:!1,OneDrive:void 0})}function Z(){return!f.a.isActivated("6acc2587-8c04-4366-960a-8754df787145","10/03/2022","People picker 3s search with non mail security group indexing")&&!d.a.isFeatureEnabled({ECS:1044963})&&d.a.isFeatureEnabled({ODB:1596})||_()}function $(){return!f.a.isActivated("640c23cc-ecfe-4ae0-860b-fec999027e92","08/02/2023","People picker 3s search enabled for XP")&&!d.a.isFeatureEnabled({ECS:1115472})||_()}function _(){return d.a.isFeatureEnabled({ODC:!0,ODB:!1,ECS:1076914,OneDrive:void 0})}function aa(){return!f.a.isActivated("429328b1-73c4-4346-b204-29ce8a8d354d","12/21/2022","Enable rendering a message bar in the default, copy link, or manage access sharing dialog.")&&!f.a.isActivated("be539d36-bc68-42bf-ba3a-494ed392aa9e","09/29/2022","Disable new page sharing experience")&&(e.b.isFeatureEnabled({ODB:1556})||ao(h))}function ab(){return!f.a.isActivated("edfd6634-3e54-499a-95e2-a38aa2b4e82e","07/05/2023","Set the default share dialog permission to read")&&!e.b.isFeatureEnabled({ECS:1107924})}function ac(){return!f.a.isActivated("da505fd8-1316-4d4e-ad83-5f0ed0ef406b","09/28/2023","Enable simplified dialog use in SharePoint pages.")&&e.b.isFeatureEnabled({ODB:61243})}function ad(){return!f.a.isActivated("2a092b3f-6729-4a0a-a847-7c2e1dc366e9","1/24/2023","Contextual Sharing Feature")&&!e.b.isFeatureEnabled({ECS:1065461})&&d.a.isFeatureEnabled({ODB:1743})}function ae(){return!f.a.isActivated("d685ea9e-632d-414f-9b9c-6982bc1c6eec","01/24/2023","Disables expiration date picker based on get/delete submitOnlyLink status.")}function af(){return!f.a.isActivated("a8176101-afe0-4540-975d-cd326db8ee52","01/23/2023","Allows file request sharelink to be edited from manage access pane.")}function ag(){return f.a.isActivated("00ece790-28cb-4228-b947-70c6cf959b9e","6/5/2023","Simplified Sharing Dialog v2")||e.b.isFeatureEnabled({ECS:1098348})}function ah(){return f.a.isActivated("c34e5556-e4c2-4fa7-b6fe-e5b41dfaa583","06/20/23","KS to make set Address Bar link capability async")}function ai(){return d.a.isFeatureEnabled({ODB:61409})}function aj(){return f.a.isActivated("b3ba617e-d237-482b-b59c-65d6a4f5b0e2","11/13/2024","Killswitch for fixing add people mode in issue simplified Share Dialog when sharing to family group in COB")||d.a.isFeatureEnabled({ECS:1471667})}function ak(){return f.a.isActivated("64103F30-0A20-4BC5-9C23-767B39B7E1B0","05/20/2024","Killswitch for simplified Share Dialog for Multi share in COB")||d.a.isFeatureEnabled({ECS:1262035})}function al(){return f.a.isActivated("90B5CA46-A849-4E92-A681-90E0F95E962B","06/20/2024","Killswitch for fix copy reshare link in COB simplified Share Dialog")||d.a.isFeatureEnabled({ECS:1277241})}function am(){return f.a.isActivated("6f986fc9-cf86-4f2d-8441-d526e25b5dfa","03/08/2024","KS for fixing ui issue in manage access for COB")||e.b.isFeatureEnabled({ECS:1239525})}function an(){return!f.a.isActivated("c675bcf5-0efe-428c-ae4d-7b3b4819af14","04/10/2023","KS for enabling floodgate survey in sharedialog")&&d.a.isFeatureEnabled({ODB:60170})}let ao=a=>!!(!f.a.isActivated("5d592717-97ec-4339-9b65-4439dc0307b3","05/01/2023","Disable the O365 page sharing experience experiment")&&d.a.isFeatureEnabled({ODB:60600}))&&1===(0,g.c)(90174,a);function ap(){return!f.a.isActivated("f514a55e-51bb-431a-aebb-67b7e65ca19b","05/05/2023","Incorporates document summary into existing message text field")}function aq(){return!f.a.isActivated("ef557ef0-37fd-4f00-9d9f-6167a43ee9e6","05/23/2023","Do not show the SharingInfoBar after share is clicked in the dialog.")}function ar(){return f.a.isActivated("d87ac6da-0b38-4349-b400-70765ba93cf0","07/30/2023","Skip inheritedFrom information for COB ManageAcess when empty inheritedFrom property is returned")||e.b.isFeatureEnabled({ECS:1114780})}function as(){return!f.a.isActivated("b51e45fe-eb94-43ac-9e79-5767035ba4c1","11/26/2023","Add hover border none for ShareHintDetail")}function at(){return!f.a.isActivated("99d6e434-0d22-42a7-831e-0a41ff977f44","02/14/2024","Add copilot helper to sharing store for share dialog")||d.a.isFeatureEnabled({ECS:1231452})}function au(){return f.a.isActivated("eace855f-1ff6-4ee2-8bff-a8ae5b055046","12/13/2023","render limited sharing info bar ks")||d.a.isFeatureEnabled({ECS:1174630})}function av(){return!f.a.isActivated("e3d04e35-2135-45da-ae07-1066f58c1969","01/21/2025","Get feedback variables without state setting")}function aw(){return f.a.isActivated("87830933-6BAB-41F0-B9C2-18FF72C8BD36","02/19/2024","Killswitch to disable SuiteNav for COB")||d.a.isFeatureEnabled({ECS:1252799})}function ax(){return d.a.isFeatureEnabled({ODB:61570})}function ay(){return f.a.isActivated("1675dcd1-2c70-420e-8f22-53f843cb6405","03/11/2024","Save link settings")||d.a.isFeatureEnabled({ECS:1240512})}function az(){return f.a.isActivated("42ba9856-fb92-429a-9759-8060aeb7197d","03/08/2024","update cob strings")||d.a.isFeatureEnabled({ECS:1239782})}function aA(){return f.a.isActivated("85AF52C5-8829-475D-A8BE-0691616A127C","03/15/2024","Set Peoplepicker AllowEmailAddress To GSI value")||d.a.isFeatureEnabled({ECS:1241903})}function aB(){return f.a.isActivated("d62a393a-8ba6-48ce-bd61-ce52e7a4597a","03/18/2024","fix People picker non mail SG not showing up for search directory")||d.a.isFeatureEnabled({ECS:1242780})}function aC(){return f.a.isActivated("200f831c-197e-4c85-a49b-6bd14127e4ed","04/03/2024","Hide stop sharing for non owners")||d.a.isFeatureEnabled({ECS:1248778})}function aD(){return f.a.isActivated("6967cd22-db4f-4858-884c-3cfb8268a56b","04/03/2024","KS for fixing double owners in sites")||e.b.isFeatureEnabled({ECS:1248688})}function aE(){return f.a.isActivated("804718de-5d0f-41b8-b0cc-e61d1099fd9e","05/31/2024","KS for fixing owa post message")||e.b.isFeatureEnabled({ECS:1266954})}function aF(){return d.a.isFeatureEnabled({ODB:61663})}function aG(){return f.a.isActivated("9e8ce715-6bb4-42b4-806c-ac3e4207b56c","04/11/2024","KS for rendering company wide sharing banner")||e.b.isFeatureEnabled({ECS:1251392})}function aH(){return f.a.isActivated("fef14f7d-40e9-4d65-9b09-2359315d55c0","04/10/2024","KS for updating isSPO logic")||e.b.isFeatureEnabled({ECS:1251004})}function aI(){return f.a.isActivated("3e60e583-a500-4418-a926-53e94b684d93","05/07/2024","KS for using sharing role from link")||e.b.isFeatureEnabled({ECS:1259645})}function aJ(){return f.a.isActivated("2853B05B-5D54-4037-94C9-B362D2B510B2","05/11/2024","handle cookie retire")||d.a.isFeatureEnabled({ECS:1261055})}function aK(){return f.a.isActivated("ab5c4674-c0bc-407d-8766-8aca378d0197","05/14/2024","add share completed")||d.a.isFeatureEnabled({ECS:1261908})}function aL(){return f.a.isActivated("ddb63db0-b4ac-450c-9a60-7a9730481a4e","07/17/2024","add copy button clicked")||d.a.isFeatureEnabled({ECS:1292358})}function aM(){return f.a.isActivated("e8e349d7-43ed-4aad-a7a2-4561162da784","06/21/2024","isReadingAllowedForGrantAcccess")||d.a.isFeatureEnabled({ECS:1278641})}function aN(){return f.a.isActivated("483aee4d-5ed8-466a-96c0-27d3a33640c2","06/27/2024","change share type sent to host app")||d.a.isFeatureEnabled({ECS:1280801})}function aO(){return f.a.isActivated("9c11822a-dd93-41ec-918b-f91d42b1a57f","07/17/2024","Provided Function Description Arial Label KS")||d.a.isFeatureEnabled({ECS:1292472})}function aP(){return f.a.isActivated("406763a6-4f97-46fe-80f4-a516930030e9","07/17/2024","send sharedialog.load result to host")||d.a.isFeatureEnabled({ECS:1292822})}function aQ(){return f.a.isActivated("3a1fa58d-bff7-4b1e-8646-3fbd4c15ffd4","07/25/2024","add wv2 to telemetry")||d.a.isFeatureEnabled({ECS:1301786})}function aR(){return f.a.isActivated("69c20f8e-c76d-4f3b-a11b-1fa983dbace9","08/09/2024","update grant access message field char count and aria live")||d.a.isFeatureEnabled({ECS:1414688})}function aS(){return f.a.isActivated("ff4f62c3-61dd-4fcb-9639-ce6378f27176","08/16/2024","bypass copy to clipboard by browser")||d.a.isFeatureEnabled({ECS:1417055})}function aT(){return f.a.isActivated("3fa8ef41-badd-45d3-bc59-39fab6f5e50a")||d.a.isFeatureEnabled({ECS:1425991})}function aU(){return f.a.isActivated("e05b172d-cea3-403c-b776-47e08b3aa964")||d.a.isFeatureEnabled({ECS:1435183})}function aV(){return!(f.a.isActivated("c9c6a0ce-65cc-45e5-8872-df1692ce9d13")||d.a.isFeatureEnabled({ECS:1439421}))&&d.a.isFeatureEnabled({ODB:62129})}function aW(){return f.a.isActivated("D57CDD77-5AB1-4815-B23E-4E6C0183F650")||d.a.isFeatureEnabled({ECS:1457844})}function aX(){return!f.a.isActivated("11d009ea-ba21-40f9-be30-cb858cc06dec")&&d.a.isFeatureEnabled({ODB:62053})}function aY(){return!f.a.isActivated("59a24f5f-f49c-488f-959d-57c5ecc5561f","11/20/2024","Update message field char screen reader alert")}function aZ(){return f.a.isActivated("61d37a0f-fc88-4711-80da-4fbf21368165")||d.a.isFeatureEnabled({ECS:1478290})}function a$(){return f.a.isActivated("89b3be86-d34a-4745-822d-e738f1e8f9d5")||d.a.isFeatureEnabled({ECS:1522221})}function a_(){return f.a.isActivated("cbc58c6e-42e6-406d-a73d-4db9ea22e4b9")||d.a.isFeatureEnabled({ECS:1522191})}function a0(){return f.a.isActivated("eba89d22-14eb-4dd6-96bb-59637e9a05c5")||d.a.isFeatureEnabled({ECS:1524580})}function a1(){return f.a.isActivated("ff91a4c8-29c5-492f-8453-3842b3d5b3ee")||d.a.isFeatureEnabled({ECS:1529580})}function a2(){return f.a.isActivated("74489ca4-0210-4e23-b523-51a711f8354c")||d.a.isFeatureEnabled({ECS:1534602})}function a3(){return f.a.isActivated("61cf8e75-4b15-4815-ab56-7b058e3605e6")||d.a.isFeatureEnabled({ECS:1534693})}function a4(){return f.a.isActivated("dcd88c4a-1908-4412-9218-2bd4c2fc3961")||d.a.isFeatureEnabled({ECS:1535217})}function a5(){return f.a.isActivated("23de8256-17bd-4880-b2c1-dd21aefbe307")||d.a.isFeatureEnabled({ECS:1535759})}function a6(){return f.a.isActivated("ffe1bf1f-a154-4ab5-8d6f-190c4f0c21ab")||d.a.isFeatureEnabled({ECS:1552341})}function a7(){return!f.a.isActivated("5fbe2456-6425-4cce-bec7-309a70fdca05")||!d.a.isFeatureEnabled({ECS:1555790})}function a8(){return f.a.isActivated("baf2b708-3912-48e9-9865-3e008363bc39")||d.a.isFeatureEnabled({ECS:1560197})}function a9(){return f.a.isActivated("318296a3-97d5-4dc6-8138-31dc1347b1fa","04/10/2025","add specificity with can request access for grant acecss")||d.a.isFeatureEnabled({ECS:1418986})}function ba(){return f.a.isActivated("a1dd2e31-21de-4d9f-b4dc-4393d81b2578","03/27/2025","allow copying direct URL KS")||d.a.isFeatureEnabled({ECS:1574396})}function bb(){return f.a.isActivated("c9d1af9b-4dc8-4cb2-bc5e-93c4c69a351f")}function bc(){return f.a.isActivated("d3e1d3d2-b36c-48b6-9d5d-85d3e2799949")||d.a.isFeatureEnabled({ECS:1570893})}function bd(){return f.a.isActivated("21619D38-9902-45F5-A8A3-10636CC5E152")}function be(){return f.a.isActivated("70616c6c-4052-4aee-a619-c18d9b401e7e")}function bf(){return f.a.isActivated("5412f45f-bdbe-4467-9bae-d2e19587ee61")}function bg(){return f.a.isActivated("5B0E22B4-F857-44EC-9ED1-0CBAA277B75C")}function bh(){return f.a.isActivated("16eb1d2b-a7a1-4b21-9eb6-3b23906f822c")}function bi(){return f.a.isActivated("2c8c7695-f305-4203-8d43-ab29b0071d3c")}function bj(){return f.a.isActivated("943e4599-223e-428a-9799-501dfe41fe44","04/11/2025","joannakuo: fix height of dialog in 400% zoom")}function bk(){return f.a.isActivated("67ab907e-40e6-46c5-8fbd-5342a1243b9d","04/16/2025","joannakuo: follow role defaults for restricted view")}function bl(){return!f.a.isActivated("19CFF699-BC25-4595-AF4E-60224802FA48")&&d.a.isFeatureEnabled({ODB:62582})}function bm(){return f.a.isActivated("333a3e8c-e951-4283-bcae-cdf086a3771c","05/06/2025","joannakuo: allow dismiss of contact card")}function bn(){return f.a.isActivated("2101507b-ebf7-46e2-8dd2-98eb413707d5","05/29/2025","joannakuo: remove overlap of icons KS")}function bo(){return f.a.isActivated("d8d783ba-8d16-459a-9e87-1c171ae82446")}function bp(){return f.a.isActivated("dfdb1cca-f1a6-461d-a302-fdf2612fb473","05/27/2025","joannakuo: reset sharing information error")}function bq(){return f.a.isActivated("bc2b6bc6-d5fd-4d6f-956b-4f9d1c09494a","06/10/2025","joannakuo: refactor info message region")}function br(){return f.a.isActivated("27C9452E-14C3-4C1B-AA8A-5756BEAD3286","06/10/2025","liminliu, Fix CopyLink button tooltip width issue")}function bs(){return f.a.isActivated("5f11dc72-4cab-4360-bd6a-88e9300c11f6","06/13/2025","joannakuo: update caching strategy in people picker")}function bt(){return f.a.isActivated("82f6402e-32b2-44e3-a359-25adbc0a7f2f","06/20/2025","joannakuo: log onedrive.live domain qos")}function bu(){return f.a.isActivated("333a3e8c-e951-4283-bcae-cdf086a3771c","06/27/2025","daneuber: ks to disable reparenting lpc for a11y issue")}function bv(){return f.a.isActivated("9760b224-03fc-4751-ad31-c5c910846865")}function bw(){return f.a.isActivated("bdbb3786-face-428c-ad1e-7b2ca32cc906")}function bx(){return f.a.isActivated("96d48fbd-4029-4780-b078-cd029784a83b")}function by(){return f.a.isActivated("5f569599-2d8a-4190-8270-f3b11256c778")}function bz(){return f.a.isActivated("071b34de-7471-47d8-b4ca-d3e380442b75")}function bA(){return f.a.isActivated("43412E02-0488-4403-A43B-C94C892A55F4")}function bB(){return f.a.isActivated("f6e62e5d-2d68-43d6-8365-72e420b7046d")}}
,,,function(a,b,c){c.d(b,{a:function(){return k}});var d,e,f=c(249),g=c(98);(d=e||(e={}))[d.scheme=0]="scheme",d[d.authority=1]="authority",d[d.path=2]="path",d[d.query=3]="query";let h=/[;\/?:@&=$,]/,i=/[\/?]/;function j(a){let b={};for(let c in a)a.hasOwnProperty(c)&&(b[c.toLowerCase()]=a[c].toLowerCase());return b}class k{static concatenate(...a){let b="";for(let c=0;c<a.length;c++){let d=a[c];c>0&&(d=k.ensureNoPrecedingSlash(d)),c<a.length-1&&(d=k.ensureTrailingSlash(d)),b+=d}return b}static ensureNoPrecedingSlash(a){return"/"===a[0]?a.substr(1):a}static ensureTrailingSlash(a){return"/"!==a[a.length-1]?a+"/":a}getScheme(){return this._scheme}setScheme(a){this._scheme=a}getAuthority(){return this._getAuthority(!1)}setAuthority(a){this._parseAuthority(a)}getUser(){return this._user}getHost(){return this._host}getPort(){return this._port}getPath(a){let b=this._path;return a&&null!==b&&b.lastIndexOf("/")===b.length-1&&(b=b.slice(0,-1)),b}getLeftPart(a){let b=this._scheme+"://";return 1===a&&(b+=this.getAuthority()),2===a&&(b+=this.getPath()),3===a&&(b+=this.getQuery()),b}setPath(a){"mailto"!==this.getScheme().toLowerCase()&&a&&"/"!==a[0]&&(a="/"+a),this._parsePath(a)}getPathSegments(){return this._pathSegments}getLastPathSegment(){let a=this._pathSegments;return a[a.length-1]||""}getQuery(a){return this._serializeQuery(a)}setQuery(a){this.setQueryFromObject(this._deserializeQuery(a))}getQueryAsObject(){return this._query}setQueryFromObject(a){for(let b in this._query={},a)a.hasOwnProperty(b)&&this.setQueryParameter(b,a[b])}getQueryParameter(a){let b=null,c=this._query;if(this._queryCaseInsensitive)for(let d in a=a.toLowerCase(),c)c.hasOwnProperty(d)&&d.toLowerCase()===a&&(b=c[d]);else b=c[a];return b||null}setQueryParameter(a,b,c=!0){let d=this._decodeQueryString(b);(d||c)&&(this._query[this._decodeQueryString(a)]=d)}removeQueryParameter(a){delete this._query[this._decodeQueryString(a)]}getFragment(){return this._fragment}setFragment(a){"#"===a[0]&&(a=a.substring(1)),this._fragment=this._decodeQueryString(a)}equals(a){return(0,g.b)(this._scheme,a.getScheme())&&this._user===a.getUser()&&(0,g.b)(this._host,a.getHost())&&this._port===a.getPort()&&this._fragment===a.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),a.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),a.getQuery(),this._queryCaseInsensitive)}equivalent(a){return(0,g.b)(this._scheme,a.getScheme())&&(0,g.b)(this._user,a.getUser())&&(0,g.b)(this._host,a.getHost())&&(0,g.b)(this._port,a.getPort())&&(0,g.b)(this.getPath(!0),a.getPath(!0))&&(0,f.a)(j(this.getQueryAsObject()),j(a.getQueryAsObject()))&&(0,g.b)(this._fragment,a.getFragment())}toString(a){return this._getStringInternal(!0,a)}getDecodedStringForDisplay(){return this._getStringInternal(!1)}getStringWithoutQueryAndFragment(){return this._getStringWithoutQueryAndFragmentInternal(!0)}_equalsCaseAppropriate(a,b,c){return c?(0,g.b)(a,b):a===b}_getStringInternal(a,b){let c=this._getStringWithoutQueryAndFragmentInternal(a,b),d=this.getQuery(a);return d&&(c+="?"+d),this._fragment&&(c+="#"+(a?encodeURIComponent(this._fragment):this._fragment)),c}_getStringWithoutQueryAndFragmentInternal(a,b){let c="";this._scheme&&(c+=(a?encodeURIComponent(this._scheme):this._scheme)+":");let d=this._getAuthority(a,b);return d&&(c+="//"+d),this._pathEncoded&&(c+=a?this._pathEncoded:this._path),c}_deserializeQuery(a){let b={};for(let c of(0===a.indexOf("?")&&(a=a.substring(1)),a.split(/[;&]+/))){let a=c.indexOf("=");a<0&&(a=c.length),a>0&&(b[c.substr(0,a)]=c.substr(a+1))}return b}_serializeQuery(a){let b="";for(let c in this._query)if(this._query.hasOwnProperty(c)){let d=c,e=this._query[c];a&&(d=encodeURIComponent(d),e=encodeURIComponent(e)),null===e||""===e?b+=d+"=&":b+=d+"="+e+"&"}return""!==b&&(b=b.slice(0,-1)),b}_parseURI(a){let b=a,c=b.indexOf("#");if(c>=0){let a=b.substring(c+1);this.setFragment(a),b=b.substring(0,c)}let d=b.search(h);if(!(d>=0))return void this.setPath(b);":"===b[d]&&(this.setScheme(b.substring(0,d)),b=b.substring(d+1));let e="";if(0===b.indexOf("//")){let a=(b=b.substring(2)).search(i);if(a>=0?(e=b.substring(0,a),b=b.substring(a)):(e=b,b=""),this.setAuthority(e),!b)return void this.setPath("")}let f=b.indexOf("?");f>=0&&(this.setQuery(b.substring(f+1)),b=b.substring(0,f)),this.setPath(b)}_parseAuthority(a){this._host=a;let b=a.lastIndexOf("@");b>=0&&(this._host=this._host.substring(b+1));let c=this._host.indexOf(":");b<0&&c<0||(b<0?this._host=a:(this._user=a.substring(0,b),this._host=a.substring(b+1)),c>=0&&(this._port=this._host.substring(c+1),this._host=this._host.substring(0,c)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host))}_parsePath(a){try{this._path=decodeURIComponent(a)}catch(b){this._path=a}let b=this._pathSegments=[];this._pathEncoded=a;let c=a.split("/");for(let a=0;a<c.length;++a)try{b[a]=decodeURIComponent(c[a])}catch(d){b[a]=c[a]}""===b[0]&&b.shift(),""===b[b.length-1]&&b.pop()}_getAuthority(a,b={}){let c,d,e,f=b&&b.doNotPercentEncodeHost,g="";return a?(c=encodeURIComponent(this._user).replace("%3A",":"),d=f?this._host:encodeURIComponent(this._host),e=encodeURIComponent(this._port)):(c=this._user,d=this._host,e=this._port),""!==c&&(g=c+"@"),""!==this._host&&(g+=d),""!==this._port&&(g+=":"+e),g}_decodeQueryString(a){let b=a;try{b=decodeURIComponent(a.replace(/\+/g," "))}catch(a){}return b}constructor(a,b){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",b&&(this._queryCaseInsensitive=!!b.queryCaseInsensitive,this._pathCaseInsensitive=!!b.pathCaseInsensitive),this._parseURI(a)}}}
,,,,,,,function(a,b,c){c.d(b,{a:function(){return ad},b:function(){return h},c:function(){return k},d:function(){return i},e:function(){return aX},f:function(){return j},g:function(){return aY},h:function(){return aM},i:function(){return aN},j:function(){return a6},k:function(){return aD},l:function(){return ay},m:function(){return aQ},n:function(){return _},o:function(){return au},p:function(){return at},q:function(){return aP},r:function(){return aI},s:function(){return aA},t:function(){return aL},u:function(){return aJ},v:function(){return aC},w:function(){return aZ},x:function(){return as},y:function(){return ar},z:function(){return aK},A:function(){return aw},B:function(){return az},C:function(){return a4},D:function(){return aF},E:function(){return aU},F:function(){return aB},G:function(){return a_},H:function(){return aT},I:function(){return am},J:function(){return al},K:function(){return aS},L:function(){return ao},M:function(){return ap},N:function(){return aW},O:function(){return an},P:function(){return aq},Q:function(){return av},R:function(){return ae},S:function(){return aO},T:function(){return aG},U:function(){return aV},V:function(){return ak},W:function(){return a3},X:function(){return af},Y:function(){return aH},Z:function(){return ac},_:function(){return a5},$:function(){return aa},eb:function(){return ab},tb:function(){return aR},nb:function(){return a2},ib:function(){return a0},ab:function(){return a1},rb:function(){return ag},ob:function(){return ai},sb:function(){return ah}});var d,e,f,g,h,i,j,k,l=c(46),m=c(45),n=c(32),o=c(86),p=c(37),q=c(36),r=c(83),s=c(118),t=c(39),u=c(20),v=c(47),w=c(204),x=c(151),y=c(16),z=c(0);let A=/[<>&'"\\]/g,B=/(&lt;|&gt;|&amp;|&quot;|&#39;|&#92;)/g,C={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"},D={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&#92;":"\\"};function E(a){return C[a]}class F{static encodeText(a){return a?a.replace(A,E):""}static decode(a){return a?a.replace(B,a=>D[a]):""}}var G=c(74),H=c(3),I=c(78),J=c(436),K=c(41),L=c(153),M=c(103),N=c(19),O=c(92),P=c(154),Q=c(31),R=c(49),S=c(34),T=c(69),U=T.a("images/sharedialog/companyonly.svg"),V=T.a("images/sharedialog/anyone.svg"),W=T.a("images/sharedialog/specificpeople.svg"),X=T.a("images/sharedialog/directrecipients.svg"),Y=T.a("images/sharedialog/peopleinchat.svg"),Z=T.a("images/sharedialog/existingaccess.svg");let $=z.a.isActivated("d382a148-e079-4323-9a90-182cbe3b243b"),_=[u.Fk,u.We,u.Kk,u.fl,u.Bk,u.Bd,u.Ri],aa=[u.Kj,u.Bj,u.qj,u.Qj,u.Wj,u.Tj,u.zj],ab=[u.Uj,u.Pj,u.Rj,u.Lj,u.Nj,u.Hj,u.Fj,u.kj,u.Gj,u.Vj,u.jj,u.Mj],ac=[u.de,u.Pd,u.Fe,u.$,u.Re,u.ue,u.le,u.lb,u.Yi,u.Wf,u.Gf,u.Tc],ad="|spo-grid-all-users/";function ae(){let a=new N.a(location.href);return af()&&"true"===a.getQueryParameter("crossdomain")}function af(){return new N.a(location.href).getPath(!0).indexOf("/_layouts/15/sharedialog.aspx")>=0}function ag(a,b){return aj(a,b=b||26)}function ah(a,b){return aj(a,b=b||25)}function ai(a,b){return aj(a,b=b||20)}function aj(a,b){if(!a)return"";let c=Math.floor(b/2);if(new Q.a().isIE)return a;if(Array.from){let d=Array.from(a);if(d?d.length<=b:a.length<=b)return a;let e=d.slice(0,c).join(""),f=d.slice(d.length-c).join("");return`${e}...${f}`}return a}function ak(a){return a.userRole===l.a.none&&a.defaultLinkKind===m.a.uninitialized}function al(a,b){switch(a){case"anonymous":return b?m.a.anonymousEdit:m.a.anonymousView;case"organization":return b?m.a.organizationEdit:m.a.organizationView;case"users":return m.a.flexible;default:return m.a.direct}}function am(a){switch(a){case"anonymous":return n.a.anyone;case"organization":return n.a.organization;case"users":return n.a.specificPeople;default:return n.a.existing}}function an(a){switch(a){case m.a.anonymousEdit:case m.a.anonymousView:return"anonymous";case m.a.organizationEdit:case m.a.organizationView:return"organization";case m.a.flexible:return"users";default:return"existingAccess"}}function ao(a){switch(a){case n.a.anyone:return"anyone";case n.a.organization:return"organization";case n.a.specificPeople:case n.a.specificPeopleFlex:case n.a.customLabeledSpecificPeople:return"specificPeople";case n.a.existing:default:return"existingAccess"}}function ap(a){switch(a){case n.a.anyone:return o.a.anyone;case n.a.organization:return o.a.organization;case n.a.specificPeople:case n.a.specificPeopleFlex:case n.a.customLabeledSpecificPeople:return o.a.specificPeople;case n.a.existing:default:return o.a.existing}}function aq(a){switch(a){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function ar(a,b,c){let d=b.sharingLinkKind,e=b.audience,f=v.k(a)?X:Y;switch(d){case m.a.organizationView:case m.a.organizationEdit:return U;case m.a.anonymousView:case m.a.anonymousEdit:return V;case m.a.flexible:if(b.audience===n.a.customLabeledSpecificPeople)return c&&c.iconUrl||f;return W;default:if(e===n.a.customLabeledSpecificPeople)return c&&c.iconUrl||f;return Z}}function as(a){if(a.isCreateOnlyLink)return"FileRequest";if(a.isAddressBarLink)return"Favicon";switch(a.sharingLinkKind){case m.a.requestAccess:return"Mail";case m.a.organizationView:case m.a.organizationEdit:return"Work";case m.a.anonymousView:case m.a.anonymousEdit:return"Globe";case m.a.flexible:if(a.audience===n.a.anyone)return"Globe";if(a.audience===n.a.organization)return"Work";return"AddFriend";default:return"Link"}}function at(){if($)return{palette:{themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#3AA0F3",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#6CB8F6",themeDarker:"#82c7ff",themeDark:"#82C7FF",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#252423",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},semanticColors:{bodyBackground:"#1b1a19",bodyStandoutBackground:"#3B3A39",buttonText:"#ffffff",buttonTextPressed:"#faf9f8",buttonTextHovered:"#f3f2f1",bodySubtext:"#a19f9d",disabledBackground:"#484644",errorText:"#E37D80",inputBackgroundChecked:"#3AA0F3",menuBackground:"#323130",menuItemBackgroundHovered:"#484644",menuItemBackgroundPressed:"#3b3a39",menuDivider:"#484644",menuIcon:"#6CB8F6",menuHeader:"#ffffff",menuItemText:"#f3f2f1",menuItemTextHovered:"#faf9f8",messageText:"#f3f2f1",primaryButtonBackground:"#0078D4",primaryButtonBackgroundHovered:"#004c87",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#ffffff",primaryButtonTextHovered:"#ffffff",primaryButtonTextPressed:"#ffffff",primaryButtonTextDisabled:"#605e5c",variantBorder:"#3b3a39",infoBackground:"#323130",infoIcon:"#c8c6c4",errorIcon:"#F1707B",warningIcon:"#c8c6c4",blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"}};let a={themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#2899F5",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#3aa0f3",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#252423",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},b={bodyBackground:a.primaryBackground,bodyStandoutBackground:a.neutralLight,buttonText:a.black,buttonTextPressed:a.neutralDark,buttonTextHovered:a.primaryText,bodySubtext:a.neutralSecondary,disabledBackground:a.neutralTertiaryAlt,errorText:a.redDark,inputBackgroundChecked:a.themeDarkAlt,menuBackground:a.neutralLighter,menuItemBackgroundHovered:a.neutralTertiaryAlt,menuItemBackgroundPressed:a.neutralLight,menuDivider:a.neutralTertiaryAlt,menuIcon:a.themeDark,menuHeader:a.black,menuItemText:a.primaryText,menuItemTextHovered:a.neutralDark,messageText:a.primaryText,primaryButtonBackground:a.themePrimary,primaryButtonBackgroundHovered:a.themeLight,primaryButtonBackgroundPressed:a.themeLighter,primaryButtonText:a.black,primaryButtonTextHovered:a.black,primaryButtonTextPressed:a.black,primaryButtonTextDisabled:"#605e5c",variantBorder:a.neutralLight,infoBackground:a.neutralLighter,infoIcon:a.neutralPrimaryAlt,errorIcon:a.redDark,warningIcon:a.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:a.shareSuccessIcon,errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"};return{palette:a,semanticColors:b}}function au(a,b,c,d){let e=v.k(a);switch(c&&c.audienceType||e&&"recipient"){case"channel":switch(b){case"edit":return u.kg;case"review":if(w.a[d])return u.Mg;return u.Pg;default:return u.Tg}case"team":switch(b){case"edit":return u.Ng;case"review":if(w.a[d])return u.Bg;return u.jg;default:return u.Vg}case"recipient":switch(b){case"edit":return u.di;case"review":if(w.a[d])return u.li;return u.ui;default:return u.fi}default:switch(b){case"edit":return u.Ug;case"review":if(w.a[d])return u.Fg;return u.Hg;default:return u.Rg}}}function av(){let a=window.require&&window.require.toUrl("plt.resx-plt.js"),b=a&&a.split("/"),c=b&&b.length>2&&b[b.length-2];return c&&1===["ar","arc","dv","he","nqo","fa","ps","sd","syr","ur","yi","ji"].filter(a=>c===a).length||!y.lb()&&(0,R.b)()}function aw(a){let{sharingLink:b,companyName:c,clientId:d,isListSharing:e,customLabeledAudienceConfig:f,fileExtension:g,isAccessSummaryLink:h,isFolder:i,isMultiTenantOrganization:j}=a,k=b.sharingLinkKind,l=b.audience;if(b.isAddressBarLink)return u.D;if(b.isCreateOnlyLink)return!b.allowsAnonymousAccess&&c?t.b(i?u.Td:u.Ui,c):i?u.Ud:u.Ui;if(h)return u.h;switch(k){case m.a.requestAccess:let o=b.invitees[0],p=o.primaryText||o.email||o.id;return t.b(u.xi,p);case m.a.organizationView:return j?t.b(u.Oc,c):t.b(u.Cc,c);case m.a.organizationEdit:return j?t.b(u.vc,c):t.b(u.hc,c);case m.a.anonymousView:return u.V;case m.a.anonymousEdit:return u.L;case m.a.direct:if(l!==n.a.customLabeledSpecificPeople)return u.dd;if(b.isReview)return f&&f.entityName?t.b(u.Mc,f.entityName):au(d,"review",f,g);if(b.isEdit)return f&&f.entityName?t.b(u.Lc,f.entityName):au(d,"edit",f);return f&&f.entityName?t.b(u.Pc,f.entityName):au(d,"view",f);case m.a.flexible:if(l===n.a.existing)return u.dd;if(l===n.a.anyone){if(b.blockDownload)return b.hasPassword?u.X:u.W;if(b.hasPassword)if(!b.isReview)return b.isEdit?u.Q:u.T;else if(w.a[g])return u.R;else return u.S;if(b.isManageList)return u.M;if(b.isReview)if(w.a[g])return u.P;else return u.U;if(b.isEdit)return e?u.N:u.L;return u.V}if(l===n.a.customLabeledSpecificPeople){if(b.isManageList)return f&&f.entityName?t.b(u.kc,f.entityName):au(d,"edit",f);if(b.isReview)return f&&f.entityName?t.b(u.Mc,f.entityName):au(d,"review",f,g);if(b.isEdit)return f&&f.entityName?t.b(e?u.kc:u.Lc,f.entityName):au(d,"edit",f);return f&&f.entityName?t.b(u.Pc,f.entityName):au(d,"view",f)}if(b.audience===n.a.organization){if(b.blockDownload)return j?t.b(u.wc,c):t.b(u.Ec,c);if(b.isManageList)return t.b(u.bc,c);if(b.isReview)if(w.a[g])return j?t.b(u.Sc,c):t.b(u.Dc,c);else return j?t.b(u.Ic,c):t.b(u.xc,c);if(b.isEdit)return t.b(e?u.gc:u.hc,c);return t.b(u.Cc,c)}if(b.blockDownload)return u.fk;if(b.isManageList)return u.ok;if(b.isReview)if(w.a[g])return u.Wh;else return u.qh;if(b.isEdit)return e?u.sk:u.rk;return u.uk;default:return""}}function ax(a){return{principalId:a.id,name:a.primaryText,image:a.imageUrl,isResolved:!0,principalName:a.loginName,userId:a.loginName,email:a.email,job:a.secondaryText,isExternal:a.isExternal,principalType:a.type}}function ay(a){return{id:a.principalId,primaryText:a.name,imageUrl:a.image,loginName:a.userId,email:a.email,secondaryText:a.job,isExternal:a.isExternal,type:a.principalType}}function az(a){let b=[],c=a.principals,d=a.invitees;for(let a of c)b.push(ax(a));for(let a of d)0===(!0===a.isExternal?b.filter(b=>b.email===a.email):b.filter(b=>b.principalName===a.loginName)).length&&b.push(ax(a));return b}function aA(a){if(!a)return 0;let b=0,c=a.length,d=0,e=!1;if(0===a.length)return 0;for(;d<c;){let f=null,g=a[d];" "===g?f=d+1<c&&" "===a[d+1]||e?"&#160;":" ":"\n"===g?(f="<br />",e=!0):('"'===g?f="&quot;&quot;&quot;":"&"===g?f="&amp;":"'"===g?f="&#39;":"<"===g?f="&lt;":">"===g?f="&gt;":"\r"===g&&(f=" "),e=!1),null!==f?b+=f.length:b+=1,d++}return b}function aB(a,b,c,d){let e,f;switch(a){case l.a.manageList:e="EditListPencil",f=u.gb;break;case l.a.edit:e="Edit",f=b?u.vb:u.Db;break;case l.a.view:e="View",f=u.Pb;break;case l.a.review:e="Feedback",f=u.wb;break;case l.a.owner:e="Signin",f=u.Vd;break;case l.a.restrictedview:e="BlockDownloadIcon",f=u.Lb;break;case l.a.submit:e="FileRequest",f=d?u.Eb:u.Cb;break;case l.a.none:e="Delete",f=u.Qc}return{name:e,title:c?f.toLowerCase():f}}function aC(a){let b=l.a.none,c=aE(),d=a.accessMap;return d?.forEach(a=>{let d=aF(a);c.indexOf(d)>c.indexOf(b)&&(b=d)}),b}function aD(a,b,c=1){let d=aE();return 0===c?d.indexOf(a)>d.indexOf(b):d.indexOf(a)>=d.indexOf(b)}function aE(){return[l.a.none,l.a.submit,l.a.restrictedview,l.a.view,l.a.review,l.a.edit,l.a.manageList,l.a.owner]}function aF(a){let b=a.role,c=a.rawPermission;if(a.isSPO);else if(c){if(c.roles)for(let a of(b=l.a.view,c.roles))"write"===a&&(b=l.a.edit);c.link&&c.link.type&&("edit"===c.link.type?b=l.a.edit:"view"===c.link.type&&(b=l.a.view))}return b}function aG(a){return a===l.a.edit||(0,y.Lb)()&&a===l.a.manageList}function aH(a){return a===n.a.specificPeople||a===n.a.specificPeopleFlex}function aI(a,b){let c=(0,y.Lb)()&&v.d(a)&&b?.sharedObjectType===x.a.list,d=b?.sharedObjectType===x.a.list&&(b.userRole===l.a.manageList||b.userRole===l.a.owner);return c||d?l.a.manageList:l.a.edit}function aJ(a,b){let c=0;if(!a||a.getTime()===new Date(0).getTime())return c;let d=new Date;d.setHours(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds());let e=Math.floor((a.getTime()-d.getTime())/864e5);return e<1?c=1:e>730?c=3:e>b&&-1!==b&&(c=2),c}function aK(a,b){return a===n.a.anyone?b?m.a.anonymousEdit:m.a.anonymousView:a===n.a.organization?b?m.a.organizationEdit:m.a.organizationView:a===n.a.specificPeople||a===n.a.existing?m.a.direct:m.a.flexible}function aL(a,b){switch(a){case 1:return u.Eg;case 2:return t.b(u.F,b);case 3:return t.b(u.He,730);case 4:return u.Li;default:return""}}function aM(a){return a.canAddExternalPrincipal||a.canAddInternalPrincipal}function aN(a){return!!a&&!!a.organizationLinkAbilities&&!!a.organizationLinkAbilities.canManageReadLink&&a.organizationLinkAbilities.canManageReadLink.enabled}function aO(a,b,c){return v.k(a)||b===p.a.linkSettings&&v.n(a)&&c&&(!!c.entityName||!!c.audienceType)}function aP(a){if(-1===a)return null;{let b=new Date;return b.setDate(b.getDate()+a),b}}async function aQ(a){if((0,M.a)())return window.sessionStorage.setItem("copiedLink",a.textField?.value||a.linkUrl),!0;let b=!1,c=!y.w()&&a.bypassBrowserCopyToClipboard;if(!v.g(a.clientId)&&!c){let c=null,d=new H.a({name:"shareLinkCopyFromBrowser"}),e=new H.a({name:"shareLinkExecCopyCommandToClipboard"}),f=a.textField;f||((f=document.createElement("textarea")).textContent=a.linkUrl,f.style.top="0",f.style.left="0",f.style.position="absolute",f.style.opacity="0",document.body.appendChild(f));try{(y.p()||void 0===a.shouldFocusUrlOnCopy||a.shouldFocusUrlOnCopy)&&(f.focus(),f.setSelectionRange(0,f.value.length)),b=document.execCommand("copy"),e.end({resultType:H.b.Success})}catch(b){c=b;let a=new K.a({code:"exeCopyCommandError",innerError:b});e.end((0,J.a)((0,I.a)(b),{resultCode:a.code}))}if(window.navigator&&window.navigator.clipboard){let d=new H.a({name:"shareLinkClipboardWrite"});try{if("write"in window.navigator.clipboard&&a.itemName){let b=f?.value||a.linkUrl,c="text/plain",d="text/html",e=new Blob([b],{type:c}),g=new Blob([`<a href=${b}>${F.encodeText(a.itemName)}</a>`],{type:d}),h=[new ClipboardItem({[c]:e,[d]:g})];await window.navigator.clipboard.write(h)}else await window.navigator.clipboard.writeText(f?.value||a.linkUrl);b=!0,d.end({resultType:H.b.Success})}catch(b){c=b;let a=new K.a({code:"clipboardWriteError",innerError:b});d.end((0,J.a)((0,I.a)(b),{resultCode:a.code}))}}a.textField||document.body.removeChild(f);let g={resultType:H.b.Success};b||(g=(0,J.a)((0,I.a)(c),{resultCode:c?.code||"copyFromBrowserError"})),g.extraData={...g.extraData,...a.extraQosData,clientId:q.a[a.clientId],mode:p.a[a.extraQosData?.mode],isCrossDomainSharePointHosted:ae()},d.end(g)}try{b=(0,y.sc)()?(0,G.d)(a.linkUrl,b)||b:(0,G.d)(a.linkUrl)}catch(a){}return b}function aR(a,b){return a&&a.toLowerCase().indexOf("/_layouts/15/userphoto.aspx")>=0&&0>location.href.toLowerCase().indexOf("sharedialog.aspx")&&(v.i(b)||v.q(b))}function aS(a,b,c){return O.c()&&a.isCreateOnlyLink?l.a.submit:a.isManageList?l.a.manageList:a.isEdit?aI(b,c):a.isReview?l.a.review:a.blockDownload?l.a.restrictedview:l.a.view}function aT(a,b){let{sharingLinks:c,sharingPrincipals:d}=a,e=b?c:c.filter(a=>{let b=new Date(a.expiration);return a.isActive&&a.sharingLinkKind!==m.a.direct&&(!a.expiration||b.getTime()>Date.now())&&(!a.isAddressBarLink||a.isAddressBarLink&&a.principals.length>0)&&!0!==a.isUnhealthy}),f=!!e.length;if(!f&&d.length){for(let a of d)if(a.role!==l.a.owner){f=!0;break}}return{shared:f,activeLinks:e,sharingPrincipals:d}}function aU(a){let b;switch(a){case r.a.user:b="user";break;case r.a.none:b="none";break;default:b="group"}return b}function aV(a){let b=new Date(null),c=new Date(0),d=a instanceof Date&&!isNaN(a.getTime()),e=!1;if(d)try{let b=new Date(a),c=b.getFullYear&&b.getFullYear();(0===c||1===c)&&(e=!0)}catch(a){}return!a||a===b||a===c||e||!d}(d=h||(h={}))[d.none=0]="none",d[d.pastDate=1]="pastDate",d[d.adminPolicy=2]="adminPolicy",d[d.overMax=3]="overMax",d[d.adminRequired=4]="adminRequired",(e=i||(i={}))[e.GREATERTHAN=0]="GREATERTHAN",e[e.GREATERTHAN_OREQUAL=1]="GREATERTHAN_OREQUAL";let aW=(a,b,c)=>{if(!c)return;let d=c.expiration,e=c.hasPassword;c.preventDownload;let f=[];return d&&d.getTime()!==new Date(0).getTime()&&f.push({icon:"Calendar",tooltip:`${t.b(u.yd,(0,L.d)(d))}`}),e&&f.push({icon:"Lock",tooltip:u.sj}),c.audience!==n.a.existing&&c.isReview&&w.a[b.fileExtension]&&f.push({icon:"Feedback",tooltip:u.qf}),c.audience===n.a.anyone&&c.trackLinkUsers&&f.push({icon:"ReminderPerson",tooltip:v.d(a)?u.ki:u.Pi}),f},aX=340,aY=480,aZ=({clientId:a,companyName:b,currentSettings:c,customLabeledAudienceConfig:d,sharingInformation:e,sharingStore:f})=>{if(!c||!e)return"";if(b?.length>u.zb.length&&(b=u.zb),("video"===(0,P.a)(e.fileExtension)||a1(a,f))&&c.sharingRole===l.a.restrictedview||c.preventDownload){if(c.audience===n.a.anyone)return u.W;else if(c.audience===n.a.organization)return e.isMultiTenantOrganization?t.b(u.wc,b):t.b(u.Ec,b);else if(c.audience===n.a.specificPeopleFlex)return u.fk;else if(c.preventDownload&&c.sharingRole===l.a.restrictedview&&c.audience===n.a.specificPeople)return u.Si}switch(c.sharingLinkKind){case m.a.direct:if(c.audience===n.a.specificPeople){if(e.requiresAccessApproval)return u.Si;if(!c.sharingRole)return c.isEdit?u.rk:u.uk;if(aG(c.sharingRole))return u.rk;if(c.sharingRole===l.a.review){if(w.a[e.fileExtension])return u.dk;return u.lk}return u.uk}return u.dd;case m.a.organizationView:return e.isMultiTenantOrganization?t.b(u.Oc,b):t.b(u.Cc,b);case m.a.organizationEdit:return e.isMultiTenantOrganization?t.b(u.vc,b):t.b(u.hc,b);case m.a.anonymousView:return u.V;case m.a.anonymousEdit:return u.L;case m.a.flexible:return a$(a,b,c,d,e);default:return""}},a$=(a,b,c,d,e)=>c.audience===n.a.existing?u.dd:c.audience===n.a.specificPeopleFlex?c.sharingRole?c.sharingRole==l.a.manageList?u.ck:aG(c.sharingRole)?u.rk:c.sharingRole===l.a.review?w.a[e.fileExtension]?u.dk:u.lk:u.uk:c.isEdit?u.rk:u.uk:c.audience===n.a.customLabeledSpecificPeople?c.sharingRole===l.a.review?d&&d.entityName?t.b(u.Mc,d.entityName):au(a,"review",d,e.fileExtension):c.isEdit?d&&d.entityName?t.b(u.Lc,d.entityName):au(a,"edit",d):d&&d.entityName?t.b(u.Pc,d.entityName):au(a,"view",d):c.audience===n.a.organization?c.sharingRole===l.a.review?w.a[e.fileExtension]?e.isMultiTenantOrganization?t.b(u.Sc,b):t.b(u.Dc,b):e.isMultiTenantOrganization?t.b(u.Ic,b):t.b(u.xc,b):c.sharingRole==l.a.manageList?t.b(u.yc,b):c.isEdit?t.b(u.hc,b):t.b(u.Cc,b):c.audience===n.a.anyone?c.sharingRole===l.a.review?w.a[e.fileExtension]?u.P:u.U:c.sharingRole==l.a.manageList?u.O:c.isEdit?u.L:u.V:"";function a_(a){switch(a){case l.a.review:return u.Fi;case l.a.edit:case l.a.manageList:return u.td}return u.dl}function a0(a,b){return b&&b.isCOB&&b.isCOB()||!y.W()&&v.d(a)}function a1(a,b){return b&&!y.cc()&&!b.isConsumer()&&!(!(0,y.xc)()&&a===q.a.sharePointPages)&&!v.d(a)&&!b.isCOB()}function a2(a){let{allOrganizationSecurityGroupId:b,discoverableByOrganizationEnabled:c,userRole:d}=a,e=d===l.a.owner||d===l.a.edit;return y.G()&&!y.H()&&e&&c&&b&&b!==S.a.Empty}function a3(a){return a.userRole===l.a.owner}function a4(a,b,c){let d=a.url;if(b!==s.a.copy&&b!==s.a.outlook)return d;let e=function(){let a=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(a);let b=[];for(let c=0;c<a.length;c++)b.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[a[c]%62]);return b.join("")}(),f=new N.a(d);(0,M.a)()||f.setQueryParameter("e",e);let g=c.getNavId();g&&f.setQueryParameter("nav",g);let h=c.getTargetDocId?.();h&&f.setQueryParameter("tdid",h);let i=c.getInvitationId();return i&&f.setQueryParameter("inviteid",i),f.toString()}function a5(a){if(a){if(a.indexOf("The invited user already exists in the directory as object ID")>=0){let b=a.indexOf("ID");return a.substring(0,b+2)}if(a.indexOf("Couldn't resolve user")>=0){let b=a.indexOf("user");return a.substring(0,b+4)}}return a}function a6(a){return"loop"===a||"fluid"===a}(f=j||(j={}))[f.none=0]="none",f[f.send=1]="send",f[f.copy=2]="copy",(g=k||(k={})).unseen="unseen",g.seeing="seeing",g.dismissed="dismissed"}
,,function(a,b,c){let d,e,f,g,h,i;c.d(b,{a:function(){return q},b:function(){return p},c:function(){return r}});var j=c(93),k=c(255),l=c(0);let m=l.a.isActivated("AC23A357-929F-4276-96A6-40FE285B0B7B"),n=!l.a.isActivated("D49CBD65-E3C7-435A-BB52-321153CCC975"),o=!1;class p{static initSPExpFeatures(a){g=a}static initSPEcsClientFeatures(a){h=a,(0,j.b)(a)}static isFeatureEnabled(a){if(!o)try{let a,b,c;d=window.PageContext,e=(a=window.Flight)&&a.Ramps,f=window.FilesConfig,b=window.Flighting,c=window._spPageContextInfo,i=window.Flight?.ecsRolloutsEnabled,!g&&c&&(!c.ExpFeatures&&b&&b.ExpFeatures&&(c.ExpFeatures=b.ExpFeatures),p.initSPExpFeatures(c.ExpFeatures)),!h&&c?.ECSClientFeatures&&p.initSPEcsClientFeatures(c.ECSClientFeatures),o=!0}catch(a){}let b=!!a.Fallback,{ODB:c,ODC:j,ECS:l,OneDrive:n,ODBECS:q}=a;if(void 0!==c&&g){let d=(0,k.b)(a,g);!m&&d&&r(c),b=d}return void 0!==j&&f&&("boolean"==typeof j?b=j:e&&e[j]?b=!0:f&&f[j]&&(b=!0)),void 0!==l&&i&&i.indexOf(l)>=0&&(b=!0),void 0!==n&&d&&(b=n),void 0!==q&&h&&(b=(0,k.a)(a,h)),b}}p.On={Fallback:!0},p.Off={};let q=function(){try{if(!m&&window){if(n&&self!==self.top){let a=self.parent.ODSP_FEATURES;if(a)return window.ODSP_FEATURES={...window.ODSP_FEATURES,...a},window.ODSP_FEATURES}return window.ODSP_FEATURES=window.ODSP_FEATURES||{},window.ODSP_FEATURES}}catch(a){}return{}}();function r(a){"number"==typeof a&&(q[a]=!0)}}
,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(40);function e(a,b){return new this(a,d.b.Single,b)}function f(a){return new this(null,d.b.Single,a)}function g(a,b,c){class g extends d.c{}return g.logData=b?e:f,(0,d.d)(g.prototype,a,b||{},c),g}}
,function(a,b,c){function d(a){let b;function c(c){return b=RegExp(`${c}(\\d+)([\\d.]*)`).exec(a)}a=a.toLowerCase();let d=c("msie ")||c("trident.*rv:"),e=b&&"9"===b[1],f=!b&&c("(?:edge|edgios)/"),g=!b&&c("edg/"),h=!b&&c("fxios|firefox/"),i=!b&&c("(?:chrome|crios)/"),j=!b&&/safari\/(\d+)/.test(a);j&&c("version/");let k=!b&&/compatible; [a-z]+;/.test(a);return k&&c("trident/"),{browserName:d||k?"IE":f?"Edge":g?"EdgeChromium":h?"Firefox":i?"Chrome":j?"Safari":"NA",isChrome:!!i,isEdge:!!f,isEdgeChromium:!!g,isFirefox:!!h,isIE:!!d||!!k,isIE9:!!e,isSafari:!!j,matchedBrowser:b}}function e(a){let{matchedBrowser:b}=a;return{browserMajor:b&&parseInt(b[1],10)||0,browserMinor:b&&b[2]&&b[2].slice(1)||"0"}}function f(a){a=a.toLowerCase();let b=/windows phone|wpdesktop/.test(a),c=b||/ipad|iphone|ipod|android/.exec(a),d=c&&c[0],e="android"===d,f=!!d&&!e,g=!c&&a.indexOf("macintosh")>-1,h=!c&&a.indexOf("windows nt")>-1;return{isAndroid:e,isIOS:f,isIPad:"ipad"===d,isMac:g,isWindows:h,isWinPhone:!!b,isMobile:!!c,osName:h?"Windows":b?"Windows Phone":g?"OSX":f?"IOS":e?"Android":"NA"}}c.d(b,{a:function(){return g},b:function(){return e},c:function(){return d},d:function(){return f}});class g{constructor(a){const b="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;a||(a=b&&b.navigator&&navigator.userAgent||"");const c=a,g=a.toLowerCase(),h=d(g),i=e(h),j=f(g),k=j.isMobile,l=/electron\/\\d+[\\d.]*/.test(g),m="undefined"!=typeof window&&!!window.matchMedia&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),n=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(g);let o=!1,p=!1,q=!1,r=!1;if(b&&b.document){const a=document.createElement("style");a.type="text/css",o=!a.styleSheet,p="addBehavior"in HTMLDivElement.prototype;const c=document.createElement("input");c.type="file";const d=b.File,e=d&&d.prototype;r=!!(e&&(e.slice||e.mozSlice||e.webkitSlice)),q="webkitdirectory"in c&&!l}return{...h,...i,...j,isElectron:l,osVersion:n?n[2]:"NA",isWindows81:!k&&/windows (?:8\.1|nt 6\.3)/.test(g),isWindows10:!k&&g.indexOf("windows nt 10")>-1,isWindows7:!k&&g.indexOf("windows nt 6.1")>-1,isPWA:m,areCSS3TransitionsSupported:!h.isIE||i.browserMajor>9,areTouchEventsSupported:!!b&&"ontouchstart"in b,isFolderUploadSupported:q,isHtml5FileUploadSupported:r,isRetinaSupported:!!b&&b.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:o,isWebDavSupported:p,userAgent:c}}}}
,function(a,b){var c,d;(d=c||(c={}))[d.specificPeople=0]="specificPeople",d[d.organization=1]="organization",d[d.anyone=2]="anyone",d[d.existing=3]="existing",d[d.specificPeopleFlex=4]="specificPeopleFlex",d[d.customLabeledSpecificPeople=5]="customLabeledSpecificPeople",d[d.direct=6]="direct",b.a=c}
,,function(a,b,c){b.a=c(130)}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}
,function(a,b,c){let d;function e(a){if(void 0===d)for(let a in d={},h){let b=parseInt(a);isNaN(b)||(d[h[b].toLowerCase()]=b)}return d[a?a.toLowerCase():""]||h.unknown}function f(a){return h[a]}c.d(b,{a:function(){return i},c:function(){return e},b:function(){return f}}),(g=h||(h={}))[g.unknown=1]="unknown",g[g.odb=2]="odb",g[g.sharePoint=3]="sharePoint",g[g.ngsc=4]="ngsc",g[g.word=5]="word",g[g.powerpoint=6]="powerpoint",g[g.excel=7]="excel",g[g.onenoteWeb=8]="onenoteWeb",g[g.wac=9]="wac",g[g.visio=10]="visio",g[g.officecom=11]="officecom",g[g.listPart=12]="listPart",g[g.outlookWeb=13]="outlookWeb",g[g.odIos=14]="odIos",g[g.odAndroid=15]="odAndroid",g[g.teams=16]="teams",g[g.sample=17]="sample",g[g.odc=18]="odc",g[g.wordAndroid=19]="wordAndroid",g[g.excelAndroid=20]="excelAndroid",g[g.powerpointAndroid=21]="powerpointAndroid",g[g.wordIos=22]="wordIos",g[g.excelIos=23]="excelIos",g[g.powerpointIos=24]="powerpointIos",g[g.onenote=25]="onenote",g[g.teamsIos=26]="teamsIos",g[g.teamsAndroid=27]="teamsAndroid",g[g.onenoteIos=28]="onenoteIos",g[g.visioIos=29]="visioIos",g[g.onenoteAndroid=30]="onenoteAndroid",g[g.visioAndroid=31]="visioAndroid",g[g.outlookWindows=32]="outlookWindows",g[g.outlookMac=33]="outlookMac",g[g.onenoteUWP=34]="onenoteUWP",g[g.officemobileIos=35]="officemobileIos",g[g.officemobileAndroid=36]="officemobileAndroid",g[g.odcWac=37]="odcWac",g[g.outlookGroupsWeb=38]="outlookGroupsWeb",g[g.fluid=39]="fluid",g[g.modernFileExplorer=40]="modernFileExplorer",g[g.listsHome=41]="listsHome",g[g.listsIos=42]="listsIos",g[g.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",g[g.officeFeed=44]="officeFeed",g[g.searchUx=45]="searchUx",g[g.consumerList=46]="consumerList",g[g.shareDemo=47]="shareDemo",g[g.onePlayer=48]="onePlayer",g[g.windowsShare=49]="windowsShare",g[g.streamIos=50]="streamIos",g[g.streamAndroid=51]="streamAndroid",g[g.loopIos=52]="loopIos",g[g.outlookAndroid=53]="outlookAndroid",g[g.outlookiOS=54]="outlookiOS",g[g.whiteboard=55]="whiteboard",g[g.businesscentral=56]="businesscentral",g[g.mslens=57]="mslens",g[g.pbidesktop=58]="pbidesktop",g[g.oneup=59]="oneup",g[g.sharePointPages=60]="sharePointPages",g[g.streamOnline=61]="streamOnline",g[g.npe=62]="npe",g[g.designer=63]="designer",g[g.designerIos=64]="designerIos",g[g.designerAndroid=65]="designerAndroid",g[g.filesintaskbar=66]="filesintaskbar",g[g.bizchat=67]="bizchat",g[g.createModule=68]="createModule";var g,h,i=h}
,function(a,b){var c,d;(d=c||(c={}))[d.share=1]="share",d[d.copy=2]="copy",d[d.atMention=3]="atMention",d[d.linkSettings=4]="linkSettings",d[d.manageAccess=5]="manageAccess",d[d.notify=6]="notify",d[d.addPeople=7]="addPeople",b.a=c}
,,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});let d=/\{(\d+)\}/g;function e(a,...b){return a.replace(d,(a,c)=>{let d=b[Number(c)];return null===d?"":`${d}`})}function f(a,...b){let c,e=[],g=0;for(;c=d.exec(a);){let f=b[parseInt(c[0].replace(/\{|\}+/g,""),10)];c.index>g&&e.push(a.substring(g,c.index)),g=d.lastIndex,e.push(f)}return g!==a.length&&e.push(a.substring(g,a.length)),e}}
,function(a,b,c){c.d(b,{a:function(){return e},b:function(){return l.a},c:function(){return q},d:function(){return o}});var d,e,f=c(174),g=c(42),h=c(55),i=c(11),j=c(130);class k{static _getCorrelationVector(){let a;return"undefined"!=typeof window?a=window.rootVector:"undefined"!=typeof self&&(a=self.rootVector),a||new k}toString(){return`${this.root}#${this.parent}#${this.current}`}constructor(a,b){a?(this.root=a.root,this.parent=a.current):this.root=this.parent=j.Empty,b?this.current=b:this.current=j.generate()}}k.RootVector=k._getCorrelationVector();var l=c(626);let m=c(0).a.isActivated("9D29F193-421F-4A86-AD3F-FF9972DC09A1"),n=0;function o(a,b,c,d){(0,f.a)(a,b);let e={};for(let a in c)if(Object.prototype.hasOwnProperty.call(c,a)){let d=c[a],f=e[a]="number"==typeof d?{type:d}:d;f.definedInName=b.shortEventName,f.type===i.a.Number&&(f.isMetric=!0)}a.metadata=d?{...d.prototype.metadata,...e}:e}(d=e||(e={}))[d.Consumer=0]="Consumer",d[d.ConsumerAnonymous=1]="ConsumerAnonymous",d[d.Business=2]="Business",d[d.BusinessAnonymous=3]="BusinessAnonymous",d[d.Unknown=4]="Unknown",d[d.ConsumerOnSPO=5]="ConsumerOnSPO";let p=new WeakMap;class q{static isTypeOf(a){return a.eventName?a.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!a.prototype&&a.prototype.shortEventName===this.prototype.shortEventName}static withManager(a){if(!a||a===h.a)return this;let b=p.get(a);b||(b=new WeakMap,p.set(a,b));let c=b.get(this);if(c)return c;class d extends this{}return d.prototype.manager=a,c=d,b.set(this,c),c}static withData(a){if(!a)return this;let b="function"!=typeof a?b=>({...a,...b}):a;return class extends this{addData(a){let c={...a,...b(a)};return{...c,...super.addData(c)}}}}static withContext(a){if(!a)return this;let b="function"!=typeof a?b=>({...a,...b}):a;return class extends this{addContext(a){let c={...a,...b(a)};return{...c,...super.addContext(c)}}}}static from(a){return a?this.withManager(a.prototype.manager).withContext(b=>a.prototype.addContext(b)).withData(b=>a.prototype.addData(b)):this}addContext(a){return s(this.manager,a,{})}addData(a){return a}_setData(a){let b={...this.addData(this.data),...a};!function(a,b,c,d){for(let e of Object.keys(c))if(e in b){let f=b[e];r(a,c,d,e,f)}}(this.manager,this.metadata,b,this.data)}_logEvent(a){this.manager.logEvent(this,a)}constructor(a,b,c){this.context={},this.data={},this.context={...this.addContext({})},this.id=n++,c&&(this.parentId=c.id),m?this.startTime=a&&a.startTimeOverride||h.a.getTime():this.startTime=(a&&a.startTimeOverride)??h.a.getTime(),this.vector=new k(c?c.vector:k.RootVector),a&&this._setData(a),(m||0!==this.startTime)&&this._logEvent(b)}}function r(a,b,c,d,e){let f=b[d];switch(typeof f){case"string":let h=a.cleanString(f,d,e);void 0!==h&&(c[d]=h);return;case"undefined":return;case"object":(0,g.b)(f)?c[d]=f:f&&Object.getPrototypeOf(f)===Object.prototype?c[d]=s(a,f,{}):c[d]=f;return;default:c[d]=f;return}}function s(a,b,c){for(let d of Object.keys(b))r(a,b,c,d);return c}let t=q.prototype;t.eventName="EventBase,",t.shortEventName="EventBase",t.critical=!1,t.manager=h.a}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return h},c:function(){return f},d:function(){return i},e:function(){return e}});var d=c(386);function e(a){return b=>`${a}${b?` (${b})`:""}`}function f(a){return b=>b||a}class g extends d.a{constructor(a){super(a),this.name="ApiError";const{innerError:b}=a,c=b||void 0,d=c?{..."string"==typeof c.correlationId?{correlationId:c.correlationId}:{},..."boolean"==typeof c.isExpected?{isExpected:c.isExpected}:{},..."string"==typeof c.name?{code:c.name}:{},..."string"==typeof c.code?{code:c.code}:{},..."object"==typeof c.extraData?{extraData:c.extraData}:{}}:{},{correlationId:e=d.correlationId,isExpected:f=d.isExpected,extraData:g}=a;this.correlationId=e,this.isExpected=!!f,this.code=i(a.code)?a.code(d.code)||"":a.code||d.code||"",this.extraData={...d.extraData||{},...g||{}}}}function h(a,b){return c=>a(b(c))}function i(a){return"function"==typeof a}}
,function(a,b,c){function d(a,b){if(void 0!==a&&""!==a)return{_value:f(a),_type:void 0===b?"safe":"boolean"==typeof b?b?"safe":"unsafe":b,__isPrivacyDataWrapper:!0}}function e(a){return!!a&&!0===a.__isPrivacyDataWrapper}function f(a){return e(a)?a._value:a}c.d(b,{a:function(){return f},b:function(){return e},c:function(){return d}})}
,function(a,b){var c,d;(d=c||(c={}))[d.none=0]="none",d[d.session=1]="session",d[d.local=2]="local",d[d.sharedMemory=3]="sharedMemory",b.a=c}
,function(a,b,c){var d,e,f;c.d(b,{a:function(){return d}}),(f=d||(d={}))[f.invalid=-1]="invalid",f[f.teamSite=1]="teamSite",f[f.meetings=2]="meetings",f[f.centralAdmin=3]="centralAdmin",f[f.wiki=4]="wiki",f[f.documentCenter=7]="documentCenter",f[f.blog=9]="blog",f[f.tenantAdmin=16]="tenantAdmin",f[f.app=17]="app",f[f.appCatalog=18]="appCatalog",f[f.mySite=21]="mySite",f[f.subgroup=39]="subgroup",f[f.publishingPortal=52]="publishingPortal",f[f.mySiteHost=54]="mySiteHost",f[f.enterpriseWiki=56]="enterpriseWiki",f[f.group=64]="group",f[f.pointPublishingPersonal=66]="pointPublishingPersonal",f[f.sitePagePublishing=68]="sitePagePublishing",f[f.teamChannel=69]="teamChannel",f[f.projectWebAppSite=6221]="projectWebAppSite",f[f.contentCenter=6001]="contentCenter",(e||(e={})).CatalogSiteSubType="CatalogSite";let g={};for(let a of Object.keys(d))"string"==typeof a&&(g[a.toUpperCase()]=d[a]);b.b=d}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.limitedView=4]="limitedView",e[e.limitedEdit=5]="limitedEdit",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}
,function(a,b,c){c.d(b,{a:function(){return o},b:function(){return q},c:function(){return l},d:function(){return i},e:function(){return s},f:function(){return k},g:function(){return m},h:function(){return g},i:function(){return f},j:function(){return v},k:function(){return j},l:function(){return t},m:function(){return h},n:function(){return w},o:function(){return u},p:function(){return r},q:function(){return y},r:function(){return n},s:function(){return p},t:function(){return x}});var d=c(36),e=c(16);function f(a){var b;return r(a)||t(a)||s(a)||u(a)||v(a)||(b=a)===d.a.officemobileIos||b===d.a.officemobileAndroid}function g(a){return a===d.a.odb||a===d.a.sharePoint||a===d.a.odc||a===d.a.npe||a===d.a.consumerList||a===d.a.oneup||a===d.a.sharePointPages}function h(a){return a===d.a.ngsc}function i(a){return a===d.a.consumerList}function j(a){return a===d.a.outlookWeb||a===d.a.outlookWindows||a===d.a.outlookMac||a===d.a.outlookAndroid||a===d.a.outlookiOS}function k(a){return a===d.a.odIos||a===d.a.wordIos||a===d.a.excelIos||a===d.a.visioIos||a===d.a.onenoteIos||a===d.a.powerpointIos||a===d.a.teamsIos||a===d.a.officemobileIos||a===d.a.listsIos||a===d.a.streamIos||a===d.a.loopIos||a===d.a.outlookiOS}function l(a){return a===d.a.odAndroid||a===d.a.wordAndroid||a===d.a.excelAndroid||a===d.a.visioAndroid||a===d.a.onenoteAndroid||a===d.a.powerpointAndroid||a===d.a.teamsAndroid||a===d.a.officemobileAndroid||a===d.a.streamAndroid||a===d.a.outlookAndroid}function m(a){return k(a)||l(a)}function n(a){return g(a)||a===d.a.onenoteWeb||a===d.a.outlookWeb||a===d.a.officecom||a===d.a.teams||a===d.a.sample||a===d.a.outlookGroupsWeb||a===d.a.fluid||a===d.a.odcWac||a===d.a.wac||a===d.a.businesscentral||a===d.a.listPart||a===d.a.listsHome||a===d.a.shareDemo||a===d.a.streamOnline||a===d.a.bizchat||m(a)}function o(a){return g(a)||a===d.a.listPart||a===d.a.shareDemo}function p(a){let b=!!e.sb()&&(a===d.a.word||a===d.a.excel||a===d.a.powerpoint);return g(a)||a===d.a.officecom||a===d.a.wac||a===d.a.businesscentral||b}function q(a){return m(a)||w(a)}function r(a){return a===d.a.word||a===d.a.wordAndroid||a===d.a.wordIos}function s(a){return a===d.a.excel||a===d.a.excelAndroid||a===d.a.excelIos}function t(a){return a===d.a.powerpoint||a===d.a.powerpointAndroid||a===d.a.powerpointIos}function u(a){return a===d.a.visio||a===d.a.visioIos||a===d.a.visioAndroid}function v(a){return a===d.a.onenote||a===d.a.onenoteWeb||a===d.a.onenoteUWP||a===d.a.onenoteIos||a===d.a.onenoteAndroid}function w(a){return a===d.a.teams||a===d.a.teamsIos||a===d.a.teamsAndroid}function x(a){return a===d.a.odc||a===d.a.npe||e.kb()&&a===d.a.odcWac}function y(a){return a===d.a.word||a===d.a.excel||a===d.a.powerpoint||a===d.a.ngsc||a===d.a.visio||a===d.a.windowsShare}}
,function(a,b,c){c.d(b,{a:function(){return j},b:function(){return i},c:function(){return g},d:function(){return f},e:function(){return e},f:function(){return h}});var d=c("react-lib");function e(a,b){let c={...a};return Object.keys(c).forEach(a=>{b.has(a)&&delete c[a]}),c}function f(a,b){return e(a,b)}let g=a=>{let b={};return a&&(a.ariaLabel&&(b["aria-label"]=a.ariaLabel),a.ariaLabelledBy&&(b["aria-labelledby"]=a.ariaLabelledBy),a.ariaDescribedBy&&(b["aria-describedby"]=a.ariaDescribedBy),a["aria-live"]&&(b["aria-live"]=a["aria-live"])),b},h=()=>{let[a,b]=d.useState(null);return d.useEffect(()=>{if(!a)return;let b=a.parentElement,c=b?._virtual?.parent;c&&!document.contains(c)&&(b._virtual={parent:document.body})},[a]),b},i=["above-start","above","above-end","above","below-start","below","below-end","below","before-top","before","before-bottom","after-top","after","after-bottom"],j=["below-start","below","below-end","below","above-start","above","above-end","above","after-top","after","after-bottom","before-top","before","before-bottom"]}
,,,,,,,function(a,b,c){let d;c.d(b,{a:function(){return m},b:function(){return l}});var e=c(0),f=c(42);let g=new Set(e.a.isActivated("846423CC-E536-4164-A3AE-0EC1BB5F991D")?[]:["additionalpostdata","alttitle","applicationname","debugginginfo","debugmessage","deferredlistdata","error","errorcodes","errorinfo","errormessage","errorstack","fcilongtasks","fileid","filelisturl","host","message","name","nextlink","pathname","rawerror","rawurl","resourcelocation","result","serverfileref","serverlisturl","siteurls","source","stack","targetfield","trace","ttilongtasks","url","vnexttheme applied","vnexttheme","webabsoluteurl"]);function h(a,b,c){let d;if(!a)return a;for(let i of(d=Array.isArray(a)?[]:Object.create(Object.getPrototypeOf(a)),Object.keys(a))){let j=a[i];if(j=(0,f.a)(j),e.a.isActivated("CF66205D-33E2-4FDD-BD4F-6CE443E89541")?void 0!==j&&(d[i]=j):void 0!==j&&-1===b.indexOf(j)&&(d[i]=j),"object"==typeof j){if(-1!==b.indexOf(j))continue;b.push(j),d[i]=h(j,b,"extraData"===i?g:c),b.pop()}else d[i]=j}return d}var i=c(625),j=c(626);class k{get startDate(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date}get startTime(){return this.startDate.getTime()}getTime(){return new Date().getTime()}cleanString(a){return a}addEventHandler(a){let{handler:b}=a,c=`${this._managerName}-${a.sourceName}`;if(k._handlerNameCounts[c]){let a=++k._handlerNameCounts[c];c+=`-${a}`}else k._handlerNameCounts[c]=1;if(this._eventHandlers.push({handleEvent:b,sourceName:c}),a.handleMissedEvents)for(let a of this._buffer.getAll())this._provideEvent(a,b,c);return()=>this.removeEventHandler(b)}removeEventHandler(a){let b=this._eventHandlers;for(let c=0;c<b.length;c++)if(b[c].handleEvent===a){b.splice(c,1);break}}logEvent(a,b){let c=this._buffer,d=this._startedEvents||new Map;b===j.a.End?d.delete(a):b===j.a.Start&&d.set(a,!0);let e=c.isFull,f=function(a){if(a.event.hasBeenProcessed)return a.event;let{event:b,eventType:c}=a;return{data:h(b.data,[b,b.data]),context:h(b.context,[b,b.context]),eventType:c,id:b.id,vector:b.vector,endTime:b.endTime,parentId:b.parentId,metadata:b.metadata,critical:b.critical,eventName:b.eventName,startTime:b.startTime,shortEventName:b.shortEventName,isEventTypePrefixingDisabled:b.isEventTypePrefixingDisabled,hasBeenProcessed:!0}}({event:a,eventType:b});c.push(f);let g=this._eventHandlers.length;!this._hasBufferOverflown&&e&&(this._hasBufferOverflown=!0,0===g&&n(Error("Logging buffer overflow hit before any logging handler was registered")));for(let a=0;a<g;a++)try{let b=this._eventHandlers[a];this._provideEvent(f,b.handleEvent,b.sourceName)}catch(a){n(a)}}isFeatureEnabled(a){return!0}addFeatureEnabler(a){}removeFeatureEnabler(a){}getStack(){let a;try{let a=window;a.______ExpectedError______&&a.______ExpectedError______()}catch(b){a=b}return a&&a.stack||void 0}addUnloadHandler(a){this._unloadHandlers.push(a)}removeUnloadHandler(a){let b=this._unloadHandlers,c=b.indexOf(a);c>-1&&b.splice(c,1)}addOnBeforeUnloadHandler(a){this._onBeforeUnloadHandlers.push(a)}removeOnBeforeUnloadHandler(a){let b=this._onBeforeUnloadHandlers,c=b.indexOf(a);c>-1&&b.splice(c,1)}clearOnBeforeUnloadHandlers(){this._onBeforeUnloadHandlers.length=0}registerCustomBeforeUnload(a){a.addCallback(this._onBeforeUnload)}dispose(){"undefined"!=typeof window&&window&&window.removeEventListener&&window.removeEventListener("beforeunload",this._onBeforeUnload),this._onBeforeUnload()}_provideEvent(a,b,c){a.context["Debug.EventSource"]=c,b(Object.freeze(a))}constructor(a){this._onBeforeUnload=()=>{try{for(let a of this._onBeforeUnloadHandlers)try{this._startedEvents.forEach((b,c)=>{a(c)})}catch{}}catch{}for(let a of(this._startedEvents.clear(),this._unloadHandlers))try{a()}catch{}},this._eventHandlers=[],this._unloadHandlers=[],this._onBeforeUnloadHandlers=[],this._startedEvents=new Map,this._buffer=new i.a(500),this._hasBufferOverflown=!1,this._managerName=a.sourceName,"undefined"!=typeof window&&window&&window.addEventListener&&window.addEventListener("beforeunload",this._onBeforeUnload)}}function l(a){return new k(a)}k._handlerNameCounts={};let m=(d=()=>l({sourceName:"Global"}),"undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||d():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||d():d());function n(a){console.error("Telemetry Manager:",a)}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){let b={};if(a){let c=a.split("&");for(let a=0;a<c.length;a++){let d=c[a].split("=");void 0!==d[1]&&(d[1]=d[1].replace(/\+/g," "),b[d[0]]=decodeURIComponent(d[1]))}}return b}}
,,,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(250);function e(a){setTimeout(()=>{throw a},0)}class f{static raise(a,b,c,e){return d.c(a,b,c,e)}static isObserved(a,b){let c=a&&a.__events__;return!!c&&!!c[b]}static isDeclared(a,b){let c=a&&a.__declaredEvents;return!!c&&!!c[b]}static stopPropagation(a){a.stopPropagation&&a.stopPropagation()}dispose(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)}onAll(a,b,c){for(let d in b)this.on(a,d,b[d],c)}on(a,b,c,e){if(b.indexOf(",")>-1){let d=b.split(/[ ,]+/);for(let b=0;b<d.length;b++)this.on(a,d[b],c,e)}else{let g=this._parent,h={target:a,eventName:b,parent:g,callback:c,objectCallback:null,elementCallback:null,useCapture:e},i=a.__events__=a.__events__||{};if(i[b]=i[b]||{count:0},i[b][this._id]=i[b][this._id]||[],i[b][this._id].push(h),i[b].count++,d.b(a)){let d=(...a)=>{let b;if(!this._isDisposed){try{if(b=c.apply(g,a),!1===b&&a[0]&&a[0].preventDefault){let b=a[0];b.preventDefault(),f.stopPropagation(b)}}catch(a){this._onError(a)}return b}};h.elementCallback=d,a.addEventListener(b,d,e)}else h.objectCallback=(...a)=>{if(!this._isDisposed)return c.apply(g,a)};this._eventRecords.push(h)}}off(a,b,c,d){for(let e=0;e<this._eventRecords.length;e++){let f=this._eventRecords[e];if((!a||a===f.target)&&(!b||b===f.eventName)&&(!c||c===f.callback)&&("boolean"!=typeof d||d===f.useCapture)){let a=f.target.__events__,b=a[f.eventName],d=b?b[this._id]:null;d&&(1!==d.length&&c?(b.count--,d.splice(d.indexOf(f),1)):(b.count-=d.length,delete a[f.eventName][this._id]),b.count||delete a[f.eventName]),f.elementCallback&&f.target.removeEventListener&&f.target.removeEventListener(f.eventName,f.elementCallback,f.useCapture),this._eventRecords.splice(e--,1)}}}raise(a,b,c){return f.raise(this._parent,a,b,c)}declare(a){let b=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof a)b[a]=!0;else for(let c=0;c<a.length;c++)b[a[c]]=!0}constructor(a,b=e){this._id=f._uniqueId++,this._parent=a,this._onError=b,this._eventRecords=[]}}f._uniqueId=0}
,function(a,b,c){var d=c(43);class e{static hasStorageType(a){switch(e.init(),a){case d.a.none:case d.a.sharedMemory:return!0;case d.a.session:return!!e._sessionStorage;case d.a.local:return!!e._localStorage;default:return!1}}static init(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(a){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(a){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}}static testStorage(a){let b="BrowserStorageTest",c=!1;try{a.setItem(b,"1"),"1"===a.getItem(b)&&(c=!0),a.removeItem(b)}catch(a){}return c}setValue(a,b,c,d=!0){a=d?this.normalizeKey(a):a,this.dataStore[a]=b;let e=this.getStorage(c);if(e)try{let c=[],d=JSON.stringify(b,function(a,b){if("object"==typeof b&&null!==b){if(-1!==c.indexOf(b))return;c.push(b)}return b});c=null,e.setItem(this.dataStoreKey+a,d)}catch(a){}}getValue(a,b,c=!0,d=!1){a=c?this.normalizeKey(a):a;let e=this.dataStore[a],f=this.getStorage(b);if((void 0===e||d)&&f){let b=f.getItem(this.dataStoreKey+a);if(b)try{e=JSON.parse(b),this.dataStore[a]=e}catch(a){e=void 0}}return e}remove(a,b,c=!0){a=c?this.normalizeKey(a):a;let d=this.getStorage(b);d&&d.removeItem(this.dataStoreKey+a),delete this.dataStore[a]}getStorage(a){switch(a||this.defaultCachingType){case d.a.none:case d.a.sharedMemory:return null;case d.a.session:return e._sessionStorage;case d.a.local:return e._localStorage;default:return null}}normalizeKey(a){return a&&a.toLowerCase()||""}constructor(a,b=d.a.none){e.init(),this.dataStoreKey=a,this.defaultCachingType=b,b===d.a.none?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}}e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,b.a=e}
,function(a,b,c){c.d(b,{A:function(){return n},B:function(){return j},C:function(){return C},D:function(){return F},E:function(){return r},F:function(){return o},G:function(){return q},H:function(){return x},I:function(){return u},a:function(){return s},b:function(){return y},c:function(){return k},d:function(){return p},e:function(){return M},f:function(){return B},g:function(){return h},h:function(){return i},i:function(){return f},j:function(){return g},k:function(){return A},l:function(){return z},m:function(){return J},n:function(){return I},o:function(){return L},p:function(){return t},q:function(){return l},r:function(){return K},s:function(){return E},t:function(){return w},u:function(){return G},v:function(){return D},w:function(){return H},x:function(){return e},y:function(){return v},z:function(){return m}});var d=c(0);function e(){return d.a.isActivated("f6c0b3d3-2a6b-4b1f-8d6b-0d0c8c9e4a3b")}function f(){return d.a.isActivated("a7d3d5c3-5e7d-4f3d-8f6c-1f2d8b3b2b7d")}function g(){return d.a.isActivated("5e49e708-9893-49f1-a434-07833cc41dcc")}function h(){return d.a.isActivated("4a5c25b1-6a46-4a3a-ba9f-4e1a1f618b91")}function i(){return d.a.isActivated("329f9302-d41b-4db4-9c9b-a00c994671be")}function j(){return d.a.isActivated("a4c46f85-d94f-41d7-b9f9-86437989792a")}function k(){return d.a.isActivated("02ecb473-e449-462b-9157-c441571582af")}function l(){return d.a.isActivated("710bab74-f80c-4f50-b853-8d0d7ae93186")}function m(){return d.a.isActivated("23ebb8ce-5b87-449e-ad54-c552383d734c")}function n(){return d.a.isActivated("f7aa1c95-2862-4f95-9713-865134a0b1b6")}function o(){return d.a.isActivated("d5e73238-2054-4c48-a2db-45f7462595cd")}function p(){return d.a.isActivated("5ec705de-f67b-46db-a457-ad6ba7ef60b7")}function q(){return d.a.isActivated("92e88bd1-dedb-4988-9e37-783d41a71dfd")}function r(){return d.a.isActivated("392c1359-2b0e-48b3-b0d5-1e793002a418")}function s(){return d.a.isActivated("b3ddc769-eab6-4053-a52a-c6124e05be2b")}function t(){return d.a.isActivated("9f145ae1-f3c7-4fb0-83f1-d90c8ad50139")}function u(){return d.a.isActivated("b9cc8531-15a5-439b-bfc7-b543be0504cf")}function v(){return d.a.isActivated("a515b31b-4c80-464e-a28d-3bcab7ecd7c5")}function w(){return d.a.isActivated("85173d7b-5726-49d6-a312-43726f103e64")}function x(){return d.a.isActivated("6d1c6dbf-40d1-4c01-9e8b-47284b5c1936")}function y(){return d.a.isActivated("a4d743ce-4d8e-4df6-8882-547d878ce7b2")}function z(){return d.a.isActivated("3a0c64a2-59f1-4318-bea2-a00abd1c197e")}function A(){return d.a.isActivated("9e042d7b-92c2-49ca-bde9-5e26945a60fa")}function B(){return d.a.isActivated("aa157aab-3f3e-463f-9fa0-251a0c84b728")}function C(){return d.a.isActivated("8abebb04-6c54-4f2b-a8ab-3ce170450588")}function D(){return d.a.isActivated("90f566ae-9719-4d2f-b776-6a3a04ebb33b")}function E(){return d.a.isActivated("cf39f912-61ac-4187-9de4-f8c35fd36584")}function F(){return d.a.isActivated("f8d64a40-039f-4319-b037-5a8ec43c3bc7")}function G(){return d.a.isActivated("c62ee607-4f4e-4c28-9536-6df31763edcd")}function H(){return d.a.isActivated("3447119c-99a9-47f2-a893-bc36e7ac1f13")}function I(){return d.a.isActivated("4cfbba00-000d-49e8-8e7c-ece06bb136bb")}function J(){return d.a.isActivated("7634ce7f-1fa8-40bb-9c89-6b71f6c77113")}function K(){return d.a.isActivated("f974e508-791a-4799-be8d-eb8946370c87")}function L(){return d.a.isActivated("9b77d191-10f1-4418-a3b1-3a91bb9b134c")}function M(){return d.a.isActivated("9FE50496-B56B-4B34-847B-8A4CAD75AD87")}}
,,function(a,b,c){c.d(b,{a:function(){return u}});var d=c("react-lib"),e=c(51),f=c(4),g=c(471),h=c(9),i=c(287),j=c(470),k=c(48);let l=d.createElement(d.Fragment,null),m=[0,300,500],n=new Set([...Array.from(new Set(["componentRef","calloutProps","content","onRenderContent","delay","maxWidth","targetElement","directionalHint","directionalHintForRTL","theme","styles"])),"closeDelay","setAriaDescribedBy","onTooltipToggle","hostClassName","hostStyles"]),o=(0,h.a)({useStaticStyles:!0}),p=(0,h.a)({useStaticStyles:!0}),q=(0,h.a)({useStaticStyles:!0}),r=new Set(["calloutProps","className","closeDelay","componentRef","content","delay","directionalHint","directionalHintForRTL","hostClassName","id","onTooltipToggle","overflowMode","setAriaDescribedBy","styles","theme","tooltipProps"]);var s=c(61);let t=(0,e.a)({root:{display:"inline"}}),u=a=>{let b,[c,e]=d.useState(),{hostClassName:h,children:u,...v}=function(a,b){let{id:c,content:e,tooltipProps:g,calloutProps:h,setAriaDescribedBy:s=!0,hostClassName:t="",directionalHint:u,closeDelay:v,children:w,styles:x,onTooltipToggle:y}=a;return function(a){let{content:b=l,className:c,hostClassName:e="",id:g,styles:h,hostStyles:i,calloutProps:r,delay:s,children:t,closeDelay:u,setAriaDescribedBy:v=!0,directionalHint:w,onTooltipToggle:x}=a,y=o(h),z=p(r?.styles),A=q(i),B=d.createElement("div",{className:(0,f.a)(c,y.root,y.content,z.calloutMain)},a?.onRenderContent?a.onRenderContent(a,a=>a?.content?d.createElement(d.Fragment,null,a.content):null)||l:b);return{content:(0,j.a)(B,{defaultProps:{role:"tooltip",id:g,className:z.beakCurtain},required:!0}),children:t,appearance:r?.styles?"normal":void 0,withArrow:!0,hostClassName:(0,f.a)(e,A.root),relationship:v?"description":"inaccessible",positioning:w?k.b[w]:"above",showDelay:s?m[s]:250,hideDelay:u||250,onVisibleChange:(a,b)=>x?.(b.visible),...(0,k.d)(a,n)}}({id:c,content:e,children:w,calloutProps:h,hostClassName:t,closeDelay:v,setAriaDescribedBy:s,directionalHint:u,hostStyles:x,targetElement:function(a,b){if(!b)return;let{overflowMode:c}=a;if(void 0!==c)switch(c){case i.a.Parent:return b.parentElement;case i.a.Self:}return b}(a,b),onTooltipToggle:y,...g,...(0,k.d)(a,r)})}(a,c),w=t(),x=(b=v.content.children.props.children)===l||null==b||""===b;return d.useEffect(()=>{if(!(0,s.x)()){let a=c?.getAttribute("aria-describedby"),b=c?.getAttribute("aria-labelledby"),d=c?.firstElementChild;d&&(a&&(c?.removeAttribute("aria-describedby"),d.setAttribute("aria-describedby",a)),b&&(c?.removeAttribute("aria-labelledby"),d.setAttribute("aria-labelledby",b)))}},[c,u]),x?d.createElement("div",{className:(0,f.a)("ms-TooltipHost ms-TooltipHostShim",h,w.root)},u):d.createElement(g.a,v,d.createElement("div",{className:(0,f.a)("ms-TooltipHost ms-TooltipHostShim",h,w.root),ref:e},u))};u.displayName="TooltipHostShim"}
,,,,,,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){let b=window,c=b.__odsp_cdnConfig,d=b.__backupBaseUrl??"";return(d=c?(d=c.baseUrls[0]).replace(`/${c.key}/`,`/${c.libraryKey}/`):(d=b.require.toUrl("odsp-media")).slice(0,d.indexOf("/odsp-media"))).endsWith("/")||(d+="/"),`${d}odsp-media-4917eb62/${a}`}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});let d=function(){try{if(window)return window.$devtools=window.$devtools||{},window.$devtools}catch(a){}return{}}();function e(a,b){Object.getOwnPropertyDescriptor(d,a)||Object.defineProperty(d,a,b)}function f(a,b){e(a,{get:()=>b})}}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return h}});var d=c(5),e=c(257),f=c(429);function g(a,b,c){return new d.a({name:a,factory:new e.a(b,c)})}function h(a,b,c){return new d.a({name:a,factory:new f.a(b,c)})}}
,function(a,b,c){b.a=c(95)}
,,function(a,b,c){c.d(b,{A:function(){return t},B:function(){return T},C:function(){return A},D:function(){return H},a:function(){return C},b:function(){return r},c:function(){return p},d:function(){return v},e:function(){return R},f:function(){return q},g:function(){return N},h:function(){return B},i:function(){return O},j:function(){return M},k:function(){return P},l:function(){return w},m:function(){return y},n:function(){return Q},o:function(){return L},p:function(){return E},q:function(){return D},r:function(){return G},s:function(){return K},t:function(){return I},u:function(){return x},v:function(){return J},w:function(){return z},x:function(){return S},y:function(){return u},z:function(){return s}});var d=c(36),e=c(37),f=c(32),g=c(152),h=c(3),i=c(26),j=c(16),k=c(78),l=c(436),m=c(41),n=c(47);let o=!1;function p(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function q(){try{window.external.Dismiss()}catch(a){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function r(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkNotificationShown"}),"*")}function s(a,b,c){try{window.external.ShareCompleted(a)}catch(d){window.parent.postMessage(JSON.stringify({name:"share_completed",shareType:a,scope:b,withAISummary:c}),"*")}}function t(a,b,c,d){try{window.external.ShareFailed(a,b,c,d)}catch(e){window.parent.postMessage(JSON.stringify({name:"share_failed",shareType:a,rawError:b,errorCategory:c,errorMessage:d}),"*")}}function u(a){try{window.external.ShareClicked(a)}catch(b){window.parent.postMessage(JSON.stringify({name:"share_clicked",shareType:a}),"*")}}function v(a,b){let c=!1,d=!1,e=new h.a({name:"sharingCopyToClipboardInterop"});try{let b=window.external;(0,j.sc)()||(d=!b.CopyToClipboard),c=b.CopyToClipboard(a),d=(0,j.sc)()?c??!0:c||void 0===c,e.end({resultType:h.b.Success})}catch(d){window.external.CopyToClipboard||window.parent.postMessage(JSON.stringify({name:"share_copyToClipboard",url:a,browserCopySucceed:b}),"*");let c=new m.a({code:"windowExternalCopyToClipboardError",innerError:d});e.end((0,l.a)((0,k.a)(d),{resultCode:c.code}))}return d}function w(){let a=!1;try{a=window.external.IsSendCopyEnabled()}catch(a){}return a}function x(){try{window.external.SendCopy()}catch(a){window.parent.postMessage(JSON.stringify({name:"share_sendCopy"}),"*")}}function y(){let a=!1;try{a=window.external.IsSendPdfEnabled()}catch(a){}return a}function z(){try{window.external.SendPdf()}catch(a){window.parent.postMessage(JSON.stringify({name:"share_sendPdf"}),"*")}}function A(a,b,c){let d=b?b.length:0;try{window.external.SendLinkViaTeams(a.url)}catch(c){let b={name:"share_teamsClicked",sharingLink:a.url};window.parent.postMessage(JSON.stringify(b),"*")}try{window.external.SendLinkViaTeamsWithContext(a.url,b,d,c)}catch(f){let e={name:"share_teamsClickedWithContext",sharingLink:a.url,recipients:b,numRecipients:d,body:c};window.parent.postMessage(JSON.stringify(e),"*")}}function B(a){try{window.external.GrantAccessCompleted(a)}catch(b){window.parent.postMessage(JSON.stringify({name:"share_grantAccessCompleted",successful:a}),"*")}}function C(a,b=""){try{window.external.AddPeopleCompleted(a,b)}catch(c){window.parent.postMessage(JSON.stringify({name:"share_addPeopleCompleted",successful:a,completionMessage:b}),"*")}}function D(a,b,c,f,g,i){if(!n.i(b)){if(o){var j;let k;j=g.isStubFile?"file uploading":g.errorMessage||"unknown error",k=d.a[b]||"unknown",new h.a({name:`ShareV3.${e.a[c]}.AfterPageLoad`,startTimeOverride:a||void 0}).end({resultType:j?h.b.Failure:h.b.Success,extraData:{clientId:k,scenario:f,isError:!!j,correlationId:i,error:j}})}else F(a,b,c,f,g.errorMessage||"unknown error",i),o=!0;try{window.external.PageError(g.error,g.errorCategory,g.errorMessage,g.debugErrorMessage)}catch(b){let a={name:"share_error",error:g.error,errorCategory:g.errorCategory,errorMessage:g.errorMessage,debugErrorMessage:g.debugErrorMessage};window.parent.postMessage(JSON.stringify(a),"*")}}}function E(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function F(a,b,c,f,g,i){if(a){let j=d.a[b]||"unknown";new h.a({name:`ShareV3.${e.a[c]}.PageLoaded`,startTimeOverride:a}).end({resultType:g?h.b.Failure:h.b.Success,extraData:{clientId:j,scenario:f,isError:!!g,correlationId:i,error:g}})}}function G(a,b,c,d,e){if(o){F(a,b,c,d,void 0,e);let f=new h.a({name:"Sharing.post_share_ready_instant_load"});try{window.parent.postMessage(JSON.stringify({name:"share_instantLoadReady"}),"*"),f.end({resultType:h.b.Success})}catch(a){f.end({resultType:h.b.Failure,resultCode:"post_share_ready_instant_load_failure"})}}else{F(a,b,c,d,void 0,e);try{window.external.PageFinishedLoading(),new h.a({name:"Sharing.post_webview_share_ready"}).end({resultType:h.b.Success})}catch(b){let a=new h.a({name:"Sharing.post_iframe_share_ready"});try{window.parent.postMessage(JSON.stringify({name:"share_ready"}),"*"),a.end({resultType:h.b.Success})}catch(b){a.end({resultType:h.b.Failure,resultCode:"post_share_ready_failure"})}}o=!0}}function H(){try{window.external.UIReady()}catch(a){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function I(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function J(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function K(){try{window.external.PeoplePickerFocused()}catch(a){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function L(a,b,c,d,e){let g=(0,i.y)(e,a,c),h=(0,i.A)({sharingLink:a,companyName:b,clientId:e,isListSharing:d,customLabeledAudienceConfig:c}),j=(0,i.L)(a.audience),k=(0,i.P)(a.status),l=a.audience===f.a.existing?"00000000-0000-0000-0000-000000000000":a.shareId,m=!1;try{window.external.LinkSettingsCompleted(l,a.url,g,h,j),m=!0}catch(a){}let n={id:l,expirationDateTime:a.expiration?.toISOString(),hasPassword:!!a.hasPassword,link:{type:a.isReview?"review":a.isEdit?"edit":"view",blocksDownload:!!a.blockDownload,preventsDownload:!!a.blockDownload,createOnly:!!a.isCreateOnlyLink,iconUrl:g,localizedDescription:h,webUrl:a.url,scope:j,customLabeledAudience:a.audience===f.a.customLabeledSpecificPeople,status:k,createdDateTime:a.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(n)),m=!0}catch(a){}if(!m){let b={name:"share_linkSettingsCompleted",type:a.isReview?"review":a.isEdit?"edit":"view",shareId:l,linkUrl:a.url,iconUrl:g,linkDescription:h,scope:j,blocksDownload:!!a.blockDownload,customLabeledAudience:a.audience===f.a.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(b),"*"),window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:n}),"*")}}function M(){let a=!1;try{a=window.external.IsDarkMode()}catch(a){}return a}function N(){let a;try{a=window.parent.GetShareDialogTheme()}catch(a){}return a}function O(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}function P(){try{return window.external.IsMoreAppsEnabled()}catch(a){return!1}}function Q(){try{return window.external.IsTeamsEnabled()}catch(a){return!1}}function R(){try{return window.external.CheckSendViaOutlookAvailability()}catch(a){return g.a.none}}function S(a,b,c,d){try{window.external.SendViaOutlookWithContext(a,b,c,d)}catch(e){window.parent.postMessage(JSON.stringify({name:"share_outlookWithContext",recipients:a,numRecipients:b,body:c,sharingLink:d}),"*")}}function T(a){try{window.external.PageStartedLoading()}catch(b){window.parent.postMessage(JSON.stringify({name:"share_started",manifest:a}),"*")}}}
,,,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(30),e=c(11);let f=(0,d.a)({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:e.a.String},isIntentional:{isPrefixingDisabled:!0,type:e.a.Boolean},scenario:{isPrefixingDisabled:!0,type:e.a.String},location:{isPrefixingDisabled:!0,type:e.a.String},usageType:{isPrefixingDisabled:!0,type:e.a.String},currentPage:{isPrefixingDisabled:!0,type:e.a.String},previousPage:{isPrefixingDisabled:!0,type:e.a.String},experiment:{isPrefixingDisabled:!0,type:e.a.Object},siteId:{isPrefixingDisabled:!0,type:e.a.String},webId:{isPrefixingDisabled:!0,type:e.a.String},listId:{isPrefixingDisabled:!0,type:e.a.String},groupId:{isPrefixingDisabled:!0,type:e.a.String},docId:{isPrefixingDisabled:!0,type:e.a.String},webTemplateId:{isPrefixingDisabled:!0,type:e.a.String},listTemplateId:{isPrefixingDisabled:!0,type:e.a.String},siteType:{isPrefixingDisabled:!0,type:e.a.String},feature:{isPrefixingDisabled:!0,type:e.a.String},component:{isPrefixingDisabled:!0,type:e.a.String},extraData:e.a.Object,objectType:{isPrefixingDisabled:!0,type:e.a.String},datasource:{isPrefixingDisabled:!0,type:e.a.String},action:{isPrefixingDisabled:!0,type:e.a.String},privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}}).withData({privacyClassification:e.b.optionalDiagnostic,privacyDataTypes:["browsingHistory"]})}
,function(a,b,c){c.d(b,{a:function(){return function a(b,c){let g,h=b||void 0,i=(0,d.b)(b?.stack);return{error:(0,e.a)(b),resultCode:h&&(g=[],"object"==typeof h.extraData&&h.extraData&&void 0!==h.extraData.status&&g.push(`[${h.extraData.status}]`),"string"==typeof h.code&&g.push(`${h.code}`),g.join(" "))||b&&b.name||(b?"Unknown":void 0),...h?{..."boolean"==typeof h.isExpected?{resultType:h.isExpected?f.b.ExpectedFailure:f.b.Failure}:{resultType:f.b.Failure}}:{resultType:f.b.Success},...i?{stackTrace:i}:{},extraData:{...h?{..."object"==typeof h.innerError?{innerError:a(h.innerError)}:{},..."string"==typeof h.correlationId?{CorrelationId:h.correlationId}:{},..."object"==typeof h.extraData?{...h.extraData}:{}}:{},...c?.extraData||{}}}}}});var d=c(427),e=c(388),f=c(3)}
,function(a,b,c){c.d(b,{a:function(){return C},b:function(){return B},c:function(){return A},d:function(){return D}});var d=c(56),e=c(0),f=c(30),g=c(11);let h=(0,f.a)({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:g.a.Number},variant:{isPrefixingDisabled:!0,type:g.a.Number},isAATest:{isPrefixingDisabled:!0,type:g.a.Boolean},isOverride:{isPrefixingDisabled:!0,type:g.a.Boolean},isLoggedAtExposure:{isPrefixingDisabled:!0,type:g.a.Boolean},serverTime:{isPrefixingDisabled:!0,type:g.a.String}});function i(a){let b=a.charCodeAt(0);return b>=65&&b<=90?b-65:b>=97&&b<=122?b-71:b>=48&&b<=57?b+4:43===b?62:63}function j(a,b){let c=b.toString(36);c=Array(4-c.length).join("0")+c;for(let b=0;b<a.length;b++)for(let d=0;d<a[b].length-2;d+=3)if(a[b].substring(d,d+3)===c)return b+4;return 0}function k(a,b){if(b>Math.floor(3*a.length/2)-1)return 0;let c=Math.floor(b/3*2);switch(b%3){case 0:return i(a[c])>>2;case 1:return(3&i(a[c]))<<2|i(a[c+1])>>4;case 2:return 15&i(a[c])}return 0}var l=c(70),m=c(444);let n="expOverrides",o="FeatureOverrides_experiments";function p(a){return"number"==typeof a}function q(a){return Array.isArray(a)&&2===a.length&&p(a[0])&&p(a[1])}function r(a){try{let b=a&&JSON.parse(a);if(Array.isArray(b))return b.filter(q)}catch(a){}return[]}function s(){let a=new Map;for(let b of r((0,m.b)(o)))a.set(b[0],b[1]);for(let b of window&&window.location&&window.location.search?r((0,d.a)(window.location.search.substr(1))[n]):[])a.set(b[0],b[1]);return a}function t(a){let b=Array.from(a);return(0,m.c)(o,JSON.stringify(b)),b}function u(a,b){try{let c=s();return void 0!==a&&void 0!==b&&c.set(a,b),t(c)}catch(a){return[]}}class v{static get experimentOverrides(){return v._experimentOverridesData||(v._experimentOverridesData=u()),v._experimentOverridesData}static setExperimentOverrideByKey(a,b){return v._experimentOverridesData=u(a,b),v._experimentOverridesData}static removeExperimentOverrideByKey(a){return v._experimentOverridesData=function(a){try{let b=s();return b.delete(a),t(b)}catch(a){return[]}}(a),v._experimentOverridesData}static clear(){v._experimentOverridesData=void 0,(0,m.a)(o)}}v._experimentOverridesData=void 0,e.a.isActivated("A2048F93-C4E7-4ED1-B8DF-46FF48B7EA99")||(0,l.b)("experiments",{get:()=>({set:v.setExperimentOverrideByKey})});let w="experimentLogCacheTime",x="experimentLogCache",y=!e.a.isActivated("4F6F5B50-178E-40E9-B992-A49FC5B41195");class z{get variantToDisplay(){return this._shouldLogVariantPropertyAccess&&this._logInternal(!1),this._variantToDisplay}static getExperimentTags(a){if(void 0===a.experimentData||void 0===a.experimentDataLookup||void 0===a.serverTime)return[];let b=[];for(let c=9e4;c<=90499;c++){let d,e=c-9e4,f=k(a.experimentData,e);if(0!==f){if(f>=1&&f<=4)d=(f-1).toString();else{if(5!==f)continue;d=j(a.experimentDataLookup,e).toString()}if(void 0!==d){let a=`${c.toString()}-${d}`;-1===b.indexOf(a)&&b.push(a)}}}return b}static _getItemFromSessionStorageNoThrow(a){try{return sessionStorage.getItem(a)}catch(a){return null}}static _setItemInSessionStorageNoThrow(a,b){try{sessionStorage.setItem(a,b)}catch(a){}}logExposure(){this._logInternal(!0)}_saveExperiments(){window.ODSP_EXPERIMENTS=window.ODSP_EXPERIMENTS||{},window.ODSP_EXPERIMENTS[this._experimentId]=this}_logInternal(a){let b=void 0!==this._variantToLog&&(a&&!this._loggedExposure||!a&&!this._loggedPropertyAccess),c=null,d=null;if(b&&(c=z._getItemFromSessionStorageNoThrow(w),d=z._getItemFromSessionStorageNoThrow(x),b=c!==this._serverTime||!d||-1===d.indexOf(this._experimentId.toString()+a)),b&&void 0!==this._variantToLog){let b={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride,isLoggedAtExposure:a,serverTime:this._serverTime};h.logData(b),a?this._loggedExposure=!0:this._loggedPropertyAccess=!0,c===this._serverTime?z._setItemInSessionStorageNoThrow(x,(d??"")+this._experimentId.toString()+a):(z._setItemInSessionStorageNoThrow(w,this._serverTime),z._setItemInSessionStorageNoThrow(x,this._experimentId.toString()+a))}}_setProperties(a,b,c,d){this._variantToDisplay=a,this._variantToLog=b,this._isAATest=c,this._isOverride=d}constructor(a,b,c){if(this._isAATest=!1,this._isOverride=!1,this._serverTime="",this._shouldLogVariantPropertyAccess=!1,this._loggedPropertyAccess=!1,this._loggedExposure=!1,this._variantToDisplay=0,this._experimentId=a,this._shouldLogVariantPropertyAccess=c,this._serverTime=b?.serverTime??"",y){for(const b of v.experimentOverrides)if(b[0]===a)return void this._setProperties(b[1],b[1],!1,!0)}else if(window&&window.location&&window.location.search){const b=(0,d.a)(window.location.search.substr(1))[n];if(b){let c;try{c=JSON.parse(b)}catch{c=[]}for(const b of c)if(b&&2===b.length&&b[0]===a)return void this._setProperties(b[1],b[1],!1,!0)}}if(!b||void 0===b.experimentData||void 0===b.experimentDataLookup||void 0===b.serverTime||this._experimentId<9e4){this._variantToDisplay=0,this._variantToLog=void 0;return}const e=a-9e4,f=k(b.experimentData,e);if(0===f)this._setProperties(0,void 0,!1,!1);else if(f>=1&&f<=4)this._setProperties(f-1,f-1,!1,!1);else if(5===f){const a=j(b.experimentDataLookup,e);this._setProperties(a,a,!1,!1)}else if(f>=6&&f<=9)this._setProperties(0,f-6,!0,!1);else if(10===f)this._setProperties(0,j(b.experimentDataLookup,e),!0,!1);else if(f>=11&&f<=14)this._setProperties(f-11,f-11,!1,!0);else{const a=j(b.experimentDataLookup,e);this._setProperties(a,a,!1,!0)}this._saveExperiments()}}function A(a,b){let c=new z(a,b,!1);return c.logExposure(),c.variantToDisplay}function B(a,b){return new z(a,b,!0)}function C(a,b){return new z(a,b,!1).variantToDisplay}function D(a){if(!a)return!1;if(!window.ODSP_EXPERIMENT_TAGS||0===window.ODSP_EXPERIMENT_TAGS.length){let b=z.getExperimentTags(a);if(0===b.length)return!1;window.ODSP_EXPERIMENT_TAGS=b}return!0}}
,,,function(a,b,c){var d,e,f,g,h,i;c.d(b,{a:function(){return d},b:function(){return e},c:function(){return f}}),(g=d||(d={}))[g.regularUser=0]="regularUser",g[g.externalUser=1]="externalUser",g[g.group=2]="group",g[g.application=3]="application",g[g.linkedinUser=4]="linkedinUser",(h=e||(e={})).graph="graph",h.sharepointSearch="sharepointSearch",h.substrate="substrate",(i=f||(f={})).unified="unifiedGroup",i.securityGroup="securityGroup",i.SPGroup="SPGroup",i.PublicDistributionList="PublicDistributionList",i.family="family"}
,function(a,b){var c,d;(d=c||(c={}))[d.none=0]="none",d[d.user=1]="user",d[d.distributionList=2]="distributionList",d[d.securityGroup=4]="securityGroup",d[d.sharePointGroup=8]="sharePointGroup",d[d.ConsumerGroup=16]="ConsumerGroup",d[d.all=15]="all",d[d.modernGroup=-1]="modernGroup",b.a=c}
,function(a,b,c){var d,e;(e=d||(d={}))[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare",b.a=d}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};b.b={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}}
,,,,,,function(a,b,c){let d,e,f,g,h;c.d(b,{a:function(){return k},b:function(){return l},c:function(){return p},d:function(){return o},e:function(){return n},f:function(){return m}});var i=c(79),j=c(16);function k(a){d=(0,i.b)(90076,a),e=(0,i.b)(90022,a),f=(0,i.b)(90128,a),g=(0,i.b)(90058,a),h=(0,i.b)(90222,a)}function l(){try{if(sessionStorage.getItem("externalSharingConfirmationDialog"))return parseInt(sessionStorage.getItem("externalSharingConfirmationDialog"))}catch{}return g&&j.P()?(g.logExposure(),g.variantToDisplay):0}function m(){return d&&j.uc()?(d.logExposure(),d.variantToDisplay):0}function n(){return e&&j.ic()?(e.logExposure(),e.variantToDisplay):0}function o(){return j.Pb()&&f?(f.logExposure(),f.variantToDisplay):0}function p(){try{if(sessionStorage.getItem("linkReShareExperiment"))return parseInt(sessionStorage.getItem("linkReShareExperiment"))}catch{}return j.Ib()?1:h?(h.logExposure(),h.variantToDisplay):0}}
,function(a,b,c){let d;c.d(b,{a:function(){return e},b:function(){return g},c:function(){return h}});let e={EcsClientFlightInfo:JSON.parse('{"SPOClientCanaryFlight":0,"EnableClipchampSpinnerInODSP":1,"FileBrowserWorkspaceEnabled":2,"ShouldUseLokiForSPOSearch":3,"SyntexClassificationColumnV0":4,"PagesTextFragmentHighlighting":5,"AgentSmallCorpusSummariesWarmUp":6,"APEXBumpMsalJsTo422":7,"ClassicPagesRestrictMode":8,"EnableSPACFluxWorkflow":9,"VibeSiteBuilderApplication":10,"VibeSiteBuilderCreateSiteEntry":11,"CDNFailoverStateScriptV2Client":12,"EnableSPACCopilotInputV3":13,"EnableGraphicArtInSpDA":14,"LoadClipchampBundleEarly":15,"EnableSPACCopilotGovernanceAgentStarterPrompts":16,"EnableSPACInPageCopilotSuggestionPills":17,"ForceNoOCRExperiment":18,"TenantAdminDeprecateAcquireEndpoint":19,"SyntexClassificationAddColumnEntryPoint":20,"React18Upgrade":21,"EnableSPACCopilotSuggestionPills":22,"HideSyntexClassificationAddColumnEntryPoint":23,"SPACCopilotSkipMacEligibilityCheck":24,"EnableDocGenTool":25,"EnableBizchatInAgentBuilder":26,"NextGenSharePointPublicPreviewUX":27,"TenantAdminMigrateTokenHelperAppId":28,"TenantAdminMigrateTokenHelperForCps":29,"TenantAdminMigrateTokenHelperForLokiService":30,"RteNpsPerfImprove":31,"TenantAdminMigrateTokenHelperForMigrationService":32,"TenantAdminMigrateTokenHelperForCopilot":33,"VivaPulseGeneralAceJitAuth":34,"RemoveClassificationUX":35,"NextGenerationChannelSiteClient":36}')},f=!1;function g(a){f||!d&&a&&(d=a,f=!0)}function h(a,b){try{if(!f&&!b)return!1;let c=b||d,g=e.EcsClientFlightInfo[a];if(null==g||!c)return!1;return(c[g>>5]&1<<g)!=0}catch(a){return console.error("Error in isEcsFlightEnabled:",a),!1}}}
,function(a,b,c){c.d(b,{a:function(){return j}});var d=c(42),e=c(40),f=c(55),g=c(11);let h=c(0).a.isActivated("9D29F193-421F-4A86-AD3F-FF9972DC09A1");class i extends e.c{setTimeout(a,b){this._clearTimeout(),this.timeoutId=window.setTimeout(()=>{this.end(b)},a)}end(a){if(!this.endTime){h?this.endTime=a&&a.endTimeOverride||f.a.getTime():this.endTime=(a&&a.endTimeOverride)??f.a.getTime();let b={duration:h||0!==this.startTime&&0!==this.endTime?this.endTime-this.startTime:0,...a};this._setData(b),this.data.error&&!(0,d.b)(this.data.error)&&(this.data.error=(0,d.c)(this.data.error,!1)),(h||0!==this.endTime)&&this._logEvent(e.b.End),this._clearTimeout()}}_clearTimeout(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)}constructor(a,b){super(a,e.b.Start,b)}}function j(a,b,c){class d extends i{}let f={...b,duration:{isPrefixingDisabled:!0,type:g.a.Number}};return(0,e.d)(d.prototype,a,f,c),d}}
,function(a,b,c){c.r(b),c.d(b,{getErrorMessage:function(){return x},isExpectedError:function(){return y},log:function(){return w},logError:function(){return v},verbose:function(){return u}});var d=c(30),e=c(11),f=c(230);let g=(0,d.a)({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0},{stack:e.a.String,extraData:e.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}},f.a).withData({privacyClassification:e.b.requiredService});var h=c(35);let i=(0,d.a)({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:e.a.String},resultCode:e.a.String,resultType:{typeRef:h.a,type:e.a.Enum}},g).withData({privacyClassification:e.b.requiredDiagnostic});var j=c(397),k=c(625),l=c(258),m=c(0),n=c(78),o=c(3),p=c(436);let q=m.a.isActivated("6C46088C-BA1D-4AA5-8FDC-4CF0FCF6A743"),r=m.a.isActivated("8124A385-5729-43AC-B1C9-D54AD0872A5D"),s="Canceled",t=new k.a(50);function u(a,b){t.push({name:b,message:a})}function v(a,b,c){try{var d;let e;if(!a||(d=a)===s||d?.name===s||d?.message===s||"object"==typeof a&&a.isExpected)return;if(!q){let{eventName:d,...e}=c||{};new o.a({name:`CaughtError${!r&&d?`.${d}`:""}`,startTimeOverride:0}).end((0,p.a)((0,n.a)(a),{extraData:b},...e?[e]:[]));return}let f=x(a),h=a?.stack??"";for(;e=t.popOldest();)j.a.logData(e);c&&c.eventName?i.logData({name:c.eventName,resultCode:c.resultCode,resultType:c.resultType,extraData:b||{},message:f,stack:h}):g.logData({extraData:b||{},message:f,stack:h})}catch{}}function w(a,b,c,d){v(a,void 0,{eventName:b,resultCode:c,resultType:d})}function x(a){return a?"object"==typeof a?a.message??a.description??(0,l.a)(a):a.toString():""}function y(a,b){if(!0===a.isExpected)return!0;void 0===a.message&&void 0===a.code&&console.error('Error message and code are both undefined. "error" must specify at least message or code');let c=(a,b)=>!!(a&&b)&&(0===a.localeCompare(b,void 0,{sensitivity:"base"})||a===b),d=!1;for(let e of b){let b=c(e.code,a.code),f=c(e.message,a.message);if(e.code&&a.code&&e.message&&a.message?d=b&&f:e.code&&a.code?d=b:e.message&&a.message&&(d=f),d)break}return d}}
,,function(a,b,c){c.d(b,{a:function(){return d}});class d{create(){return{instance:this._value}}constructor(a){this._value=a,this.dependencies={}}}}
,function(a,b,c){function d(a,b){let c=a.toString();for(;c.length<b;)c=`0${c}`;return c}function e(a,b){return a&&b?a.toUpperCase()===b.toUpperCase():a===b}function f(a){return a?a[0].toUpperCase()+a.substr(1):a}function g(a,b,c){if(c=Number(c),void 0===a||void 0===b||void 0===c)return"";let d="",e=-1,f=b.split("||");for(let a=0,b=f.length;a<b;a++){let b=f[a];if(b){for(let d of b.split(","))if(d){if(isNaN(Number(d))){if(-1!==d.indexOf("-")){let b,f,g=d.split("-");if(2!==g.length)continue;if("*"===d[0]){let d=g[0].substring(1),h=g[1];if(isNaN(Number(d))||isNaN(Number(h)))continue;{let g;b=parseInt(d,10),f=parseInt(h,10);for(let a=b;a<=f;a++){let b="[0-9]*"+a;if(RegExp(`^${b}$`).test(c.toString())){g=!0;break}}if(g){e=a;break}}}else{if(""===g[0])b=0;else{if(isNaN(Number(g[0])))continue;b=parseInt(g[0],10)}if(c>=b){if(""===g[1]){e=a;break}if(isNaN(Number(g[1])))continue;if(c<=(f=parseInt(g[1],10))){e=a;break}}}}else if(-1!==d.indexOf("*")){let b=d.trim().replace(/\*/g,"[0-9]*");if(RegExp(`^${b}$`).test(c.toString())){e=a;break}}}else if(c===parseInt(d,10)){e=a;break}}if(-1!==e)break}}if(-1!==e){let b=a.split("||");b[e]&&(d=b[e])}return d}c.d(b,{a:function(){return f},b:function(){return e},c:function(){return g},d:function(){return d}})}
,function(a,b,c){function d(){}function e(a){setTimeout(()=>{throw a},0)}c.d(b,{a:function(){return f}});class f{dispose(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(let a of Object.keys(this._timeoutIds))this.clearTimeout(Number(a));this._timeoutIds=null}if(this._immediateIds){for(let a of Object.keys(this._immediateIds))this.clearImmediate(Number(a));this._immediateIds=null}if(this._intervalIds){for(let a of Object.keys(this._intervalIds))this.clearInterval(Number(a));this._intervalIds=null}if(this._animationFrameIds){for(let a of Object.keys(this._animationFrameIds))this.cancelAnimationFrame(Number(a));this._animationFrameIds=null}}}setTimeout(a,b){let c=0;if(!this._isDisposed){let d=this._timeoutIds||(this._timeoutIds={}),e=this._parent;d[c=setTimeout(()=>{try{delete d[c],a.apply(e)}catch(a){this._logError(a)}},b)]=!0}return c}clearTimeout(a){let b=this._timeoutIds;b&&b[a]&&(clearTimeout(a),delete b[a])}setImmediate(a){let b=0;if(!this._isDisposed){let c=this._immediateIds||(this._immediateIds={}),d=this._parent,e=()=>{try{delete c[b],a.apply(d)}catch(a){this._logError(a)}};c[b=window.setImmediate?window.setImmediate(e):window.setTimeout(e,0)]=!0}return b}clearImmediate(a){let b=this._immediateIds;b&&b[a]&&(window.clearImmediate?window.clearImmediate(a):window.clearTimeout(a),delete b[a])}setInterval(a,b){let c=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});let d=this._parent;c=setInterval(()=>{try{a.apply(d)}catch(a){this._logError(a)}},b),this._intervalIds[c]=!0}return c}clearInterval(a){this._intervalIds&&this._intervalIds[a]&&(clearInterval(a),delete this._intervalIds[a])}throttle(a,b,c={}){let e,f;if(this._isDisposed)return d;let g=b||0,{leading:h=!0,trailing:i=!0}=c,j=0,k=null,l=this._parent,m=b=>{let c=new Date().getTime(),d=c-j;return d>=g&&(!b||h)?(j=c,k&&(this.clearTimeout(k),k=null),e=a.apply(l,f)):null===k&&i&&(k=this.setTimeout(m,h?g-d:g)),e};return(...a)=>(f=a,m(!0))}debounce(a,b,c={}){let e,f;if(this._isDisposed)return d;let g=b||0,{leading:h=!1,trailing:i=!0,maxWait:j=NaN}=c,k=0,l=new Date().getTime(),m=null,n=this._parent,o=b=>{let c=new Date().getTime(),d=!1;b&&(h&&c-k>=g&&(d=!0),k=c);let p=c-k,q=g-p,r=c-l,s=!1;return isNaN(j)||(r>=j&&m?s=!0:q=Math.min(q,j-r)),p>=g||s||d?(m&&(this.clearTimeout(m),m=null),l=c,e=a.apply(n,f)):(null===m||!b)&&i&&(m=this.setTimeout(o,q)),e};return(...a)=>(f=a,o(!0))}requestAnimationFrame(a){let b=0;if(!this._isDisposed){let c=this._animationFrameIds||(this._animationFrameIds={}),d=this._parent,e=()=>{try{delete c[b],a.apply(d)}catch(a){this._logError(a)}};c[b=window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout(e,0)]=!0}return b}cancelAnimationFrame(a){let b=this._animationFrameIds;b&&b[a]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(a):window.clearTimeout(a),delete b[a])}_logError(a){this._onErrorHandler&&this._onErrorHandler(a)}constructor(a,b=e){this._isDisposed=!1,this._parent=a||null,this._onErrorHandler=b,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null}}}
,,function(a,b,c){function d(a){if(!a)return{};var b=decodeURIComponent(a).split(".")[1];if(!b)return{};try{let a=atob(b.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(a)}catch(a){return{}}}function e(a){if(!a)return;let b=a.azp||a.appid;if(b)return b;let c=a.nameid;if(c&&"true"!==a.isuser)return c.split("@")[0]||void 0}function f(a,b=Date.now()){let c=b/1e3;if(!a)return!1;let d=a.exp,e=a.nbf;return("number"!=typeof e||c>=e)&&("number"!=typeof d||c<d)}c.d(b,{a:function(){return e},b:function(){return f},c:function(){return d}})}
,function(a,b,c){c.d(b,{a:function(){return u},b:function(){return t}});var d,e,f,g,h,i,j,k,l,m,n,o,p=c(6),q=c(0);(d=j||(j={}))[d.none=0]="none",d[d.standard=1]="standard",d[d.compact=2]="compact",d[d.minimal=3]="minimal",d[d.extended=4]="extended",(e=k||(k={}))[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right",(f=l||(l={}))[f.right=0]="right",f[f.middle=1]="middle",f[f.left=2]="left",(g=m||(m={}))[g.unknown=-1]="unknown",g[g.white=0]="white",g[g.black=1]="black",g[g.lightGradient=2]="lightGradient",g[g.darkGradient=3]="darkGradient",(h=n||(n={}))[h.topToBottom=0]="topToBottom",h[h.bottomToTop=1]="bottomToTop",h[h.leftToRight=2]="leftToRight",h[h.rightToLeft=3]="rightToLeft";let r=q.a.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),s="undefined"!=typeof window&&p.a.isFeatureEnabled({ODB:1737});function t(a){let{webAbsoluteUrl:b,webServerRelativeUrl:c,isSiteListsHost:d}=a;return"/"===c||""===c||!r&&d||s&&a?.isUnifiedAdminUrl?b:b.substring(0,b.lastIndexOf(c))}function u(a){return"/"===a.webServerRelativeUrl?"":a.webServerRelativeUrl}(i=o||(o={}))[i.FooterEnabled=2]="FooterEnabled",i[i.MegaMenuEnabled=128]="MegaMenuEnabled",i[i.FooterEmphasis0=256]="FooterEmphasis0",i[i.FooterEmphasis1=512]="FooterEmphasis1",i[i.FooterLayout0=1024]="FooterLayout0",i[i.FooterLayout1=2048]="FooterLayout1",i[i.HideTitleInHeader=0x2000000]="HideTitleInHeader",i[i.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}
,function(a,b,c){c.d(b,{a:function(){return d}});let d=()=>{try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(a){return console.log("No session storage accessible: "+a),!1}}}
,function(a,b,c){c.d(b,{a:function(){return d}});class d{static encodeURIComponent(a,b,c,d){let e="",f=0;if(!a)return"";let g=a.length;for(f=0;f<g;f++){let g=a.charCodeAt(f),h=a.charAt(f);if(b&&("#"===h||"?"===h)){e+=a.substr(f);break}if(c&&"&"===h){e+=h;continue}g<=127?d||g>=97&&g<=122||g>=65&&g<=90||g>=48&&g<=57||b&&g>=32&&g<=95&&0>" \"%<>'&".indexOf(h)?e+=h:g<=15?e+="%0"+g.toString(16).toUpperCase():g<=127&&(e+="%"+g.toString(16).toUpperCase()):g<=2047?(e+="%"+(192|g>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):(64512&g)!=55296?(e+="%"+(224|g>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):f<a.length-1&&(g=(1023&g)<<10,f++,g|=1023&a.charCodeAt(f),g+=65536,e+="%"+(240|g>>18).toString(16).toUpperCase(),e+="%"+(128|(258048&g)>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase())}return e}static escapeUrlForCallback(a){let b=a.indexOf("#"),c=a.indexOf("?");if(b>0&&(-1===c||b<c)){let d=a.substr(0,b);c>0&&(d+=a.substr(c)),a=d}return d.encodeURIComponent(a,!0,!1,!0)}static encodeRestUriStringToken(a,b){return a&&(a=(a=a.replace(/'/g,"''")).replace(/%27/g,"%27%27"),b||(a=d.encodeURIComponent(a))),a}}}
,function(a,b,c){c.d(b,{a:function(){return s}});var d=c("react-lib"),e=c(51),f=c(111),g=c(4),h=c(466),i=c(9),j=c(106),k=c(48);let l=new Set(["ariaLabel","ariaLive","className","componentRef","label","labelPosition","styles","size","theme","type"]),m={top:"above",right:"after",bottom:"below",left:"before"},n={[j.a.xSmall]:"extra-tiny",[j.a.small]:"extra-tiny",[j.a.medium]:"tiny",[j.a.large]:"small"},o={[j.b.normal]:"tiny",[j.b.large]:"small"};var p=c(61);let q=(0,i.a)({useStaticStyles:!0}),r=(0,e.a)({spinner:{...f.a.overflow("hidden")}}),s=a=>{let b,c,e=(c=a.labelPosition?m[a.labelPosition]:"below",a.type&&(b=o[a.type]),b=void 0!==a.size?n[a.size]:b??"tiny",{...{ref:a.componentRef,labelPosition:c,size:b,label:a.label,className:a.className},...(0,k.d)(a,l)}),f=q(a.styles,{theme:a.theme}),i=r();return e.label&&(e.label={className:(0,g.a)("ms-Label",f.label),children:e.label}),e.className=(0,g.a)("ms-Spinner",f.root,a.className),(0,p.B)()&&(e.spinner={className:i.spinner}),d.createElement(h.a,e)};s.displayName="SpinnerShim"}
,,,,,,,function(a,b,c){c.d(b,{a:function(){return k},b:function(){return j}});var d=c(63),e=c(18),f=c("react-lib");let g={gapSpace:0},h={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},i=0;function j(a,b,c){let j=(c=c||{}).tooltipId?c.tooltipId:`od-Share-tooltip-${i}`;i++;let k=c.targetElementId?{...g,target:`#${c.targetElementId}`}:g;return f.createElement(d.a,{id:j,content:b,directionalHint:void 0===c.position?e.a.topCenter:c.position,calloutProps:k,tooltipProps:h,styles:c.styles},a)}function k(a,b,c,d){return f.createElement("span",{tabIndex:-1,"aria-hidden":!!d,className:"od-Share-screenReaderOnly","aria-live":b,role:c},a||"")}}
,,,,,,function(a,b){var c,d;(d=c||(c={}))[d.share=0]="share",d[d.copy=1]="copy",d[d.outlook=2]="outlook",d[d.nonOutlook=3]="nonOutlook",d[d.moreApps=4]="moreApps",d[d.mobileShareToTeams=5]="mobileShareToTeams",d[d.webShareToTeams=6]="webShareToTeams",d[d.grantAccess=7]="grantAccess",b.a=c}
,,,function(a,b,c){c.d(b,{a:function(){return d}});let d={FluentUIV9ShimOverallControl:60077,FluentUIV9ShimDefaultButton:60337,FluentUIV9ShimPrimaryButton:60344,FluentUIV9ShimIconButton:60355,FluentUIV9ShimActionButton:60356,FluentUIV9ShimImage:60357,FluentUIV9ShimToggle:60461,FluentUIV9ShimCommandBarButton:60466,FluentUIV9ShimCommandBar:60480,FluentUIV9ShimCommandButton:60501,FluentUIV9ShimTooltipHost:60634,FluentUIV9ShimTooltip:60633,FluentUIV9ShimLink:60405,FluentUIV9ShimStack:60413,FluentUIV9ShimCheckbox:60414,FluentUIV9ShimDialog:60426,FluentUIV9ShimChoiceGroup:60415,FluentUIV9ShimPersona:60419,FluentUIV9ShimFacepile:60569,FluentUIV9ShimPivot:60105,FluentUIV9ShimContextualMenu:60556,FluentUIV9ShimOverlay:60547,FluentUIV9ShimOverflowSet:60555,FluentUIV9ShimIcon:60446,FluentUIV9ShimSpinner:60450,FluentUIV9ShimSlider:60454,FluentUIV9ShimLayer:60460,FluentUIV9ShimText:60566,FluentUIV9ShimCustomizer:60650,FluentUIV9ShimThemeProvider:60567,FluentUIV9ShimSpinButton:60557,FluentUIV9ShimLabel:60382,FluentUIV9ShimSeparator:60384,FluentUIV9ShimCompoundButton:60540,FluentUIV9ShimTextField:61154,FluentUIV9ShimShimmer:61344,FluentUIV9ShimFocusTrapZone:60457,FluentUIV9ShimFocusZone:61362,FluentUIV9ShimPanel:61363,FluentUIV9ShimProgressIndicator:61364,FluentUIV9ShimDatePicker:61369,FluentUIV9ShimMessageBar:61378,FluentUIV9ShimDropdown:61379,FluentUIV9ShimCallout:61380,FluentUIV9ShimModal:61381,FluentUIV9ShimLayoutGroup:61383,FluentUIV9ShimComboBox:61384,FluentUIV9ShimCard:61385}}
,,,,,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(55);function e(){let a=()=>(0,d.b)({sourceName:"CustomerPromise"});return"undefined"!=typeof window?window.CUSTOMERPROMISE_MANAGER=window.CUSTOMERPROMISE_MANAGER||a():"undefined"!=typeof self?self.CUSTOMERPROMISE_MANAGER=self.CUSTOMERPROMISE_MANAGER||a():a()}}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return q},c:function(){return l},d:function(){return f}});var d,e,f,g,h=c(15),i=c(0),j=c(98),k=c(256);(d=f||(f={}))[d.sameSite=0]="sameSite",d[d.crossSite=1]="crossSite",d[d.unknown=2]="unknown",(e=g||(g={}))[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown";class l{get serverRelativeItemUrl(){return m(this._getServerRelativeItemUrl())}get serverRelativeListUrl(){return m(this._getServerRelativeListUrl())}get fullListUrl(){return this._getFullListUrl()}get normalizedListUrl(){return m(this._getNormalizedListUrl())}get fullItemUrl(){return this._getFullItemUrl()}get normalizedItemUrl(){return m(this._getNormalizedItemUrl())}get listRelativeItemUrl(){return this._getListRelativeItemUrl()}get webRelativeItemUrl(){return this._getWebRelativeItemUrl()}get fullWebUrl(){return this._getFullWebUrl()}get normalizedWebUrl(){return m(this._getNormalizedWebUrl())}get serverRelativeWebUrl(){return m(this._getServerRelativeWebUrl())}get inferredFullListUrl(){return m(this._getInferredFullListUrl())}get isCrossDomain(){return this._getIsCrossDomain()}get isCrossList(){return this._getIsCrossList()}get siteRelation(){return this._getSiteRelation()}get geoRelation(){return this._getGeoRelation()}get path(){return this._getPath()}get listUrl(){return this._getListUrl()}get webUrl(){return this._getWebUrl()}_getPath(){let a,b=this._rawPath;if(b)if("/"===b[0]||b.indexOf("://")>-1)a=n(b);else{let c=this._getListUrl()||this.defaultListUrl;c&&(a=`${c}/${b}`)}return this._getPath=()=>a,a}_getListUrl(){let a,b=this._rawListUrl;if(b)if("/"===b[0]||b.indexOf("://")>-1)a=n(b);else{let c=this._getWebUrl()||this.defaultFullWebUrl;c&&(a=`${c}/${b}`)}return this._getListUrl=()=>a,a}_getWebUrl(){let a,b=this._rawWebUrl;return b&&(a="/"===b[0]||b.indexOf("://")>-1?n(b):`${this.defaultFullWebUrl}/${b}`),this._getWebUrl=()=>a,a}_getCurrentAuthority(){let a=new h.a(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=()=>a,a}_getNormalizedWebUrl(){let a,b=this._getFullWebUrl(),c=this.defaultFullWebUrl;if(void 0!==b&&!(0,j.b)(b,c)){let c=new h.a(b);a=(0,j.b)(c.authority,this._getCurrentAuthority())?c.path:b}return this._getNormalizedItemUrl=()=>a,a}_getNormalizedItemUrl(){let a,b=this._getFullItemUrl();if(void 0!==b){let c=new h.a(b);a=(0,j.b)(c.authority,this._getCurrentAuthority())?c.path:b}return this._getNormalizedItemUrl=()=>a,a}_getNormalizedListUrl(){let a,b=this._getFullListUrl(),c=this._getDefaultListUrl();return void 0===b||(0,j.b)(b,c)||(a=(0,j.b)(new h.a(b).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():b),this._getNormalizedListUrl=()=>a,a}_getInferredFullListUrl(){let a,b=this._getFullListUrl();if(b)a=b;else{let b=this._getFullItemUrl(),c=this._getFullWebUrl();if(b&&c&&(0,k.a)(b,c)){let d=new h.a(b),e=new h.a(c);d.segments.length>e.segments.length&&(a=`${d.authority}${d.segments.slice(0,e.segments.length+1).join("/")}`)}}return this._getInferredFullListUrl=()=>a,a}_getServerUrl(){let a=this.path&&new h.a(this.path).authority||this.listUrl&&new h.a(this.listUrl).authority||this.webUrl&&new h.a(this.webUrl).authority||this.defaultListUrl&&new h.a(this.defaultListUrl).authority||new h.a(this.defaultFullWebUrl).authority;return this._getServerUrl=()=>a,a}_getServerRelativeListUrl(){let a;if(void 0!==this.listUrl)a=new h.a(this.listUrl).path;else{let b=this._getDefaultListUrl(),c=this.mayInferListUrl;if(void 0!==b||c){let d=this._getServerRelativePath(),e=new h.a(b).path;if(void 0===d&&(void 0===this.webUrl||e&&(0,k.a)(p(e),p(this._getServerRelativeWebUrl())))||e&&(0,k.a)(p(d),p(e)))a=e;else if(void 0!==d&&(""===this.defaultListUrl||c)){let b=this._getServerRelativeWebUrl();if((0,k.a)(p(d),p(b))){let c=new h.a(d).segments[new h.a(b).segments.length];a=`${p(b)}${c}`}}}}return this._getServerRelativeListUrl=()=>a,a}_getFullListUrl(){let a,b=this._getServerUrl(),c=this._getServerRelativeListUrl();return void 0!==c&&(a=`${b}${c}`),a}_getFullItemUrl(){let a,b=this._getServerUrl(),c=this._getServerRelativeItemUrl();return void 0!==c&&(a=`${b}${c}`),this._getFullItemUrl=()=>a,a}_getServerRelativeWebUrl(){let a,b;if(void 0!==this.webUrl)a=new h.a(this.webUrl).path;else if((this.defaultListUrl||this.listUrl)&&!this.mayInferListUrl&&void 0!==(b=this._getServerRelativeListUrl())){let c=new h.a(b);a=`${c.segments.slice(0,-1).join("/")}`}else this.defaultFullWebUrl&&(a=new h.a(this.defaultFullWebUrl).path);return this._getServerRelativeWebUrl=()=>a,a}_getServerRelativePath(){let a;return void 0!==this.path&&(a=new h.a(this.path).path),this._getServerRelativePath=()=>a,a}_getServerRelativeItemUrl(){let a;return this.path||this._rawPath?a=this._getServerRelativePath():this.listUrl?a=this._getServerRelativeListUrl():this.webUrl?a=this._getServerRelativeWebUrl():this.defaultListUrl?a=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(a=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=()=>a,a}_getListRelativeItemUrl(){let a,b,c=this._getServerRelativePath(),d=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==d&&(0,k.a)(p(c),b=p(d))&&(a=c&&c.substring(b.length)),this._getListRelativeItemUrl=()=>a,a}_getWebRelativeItemUrl(){let a,b,c=this._getServerRelativePath(),d=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==d&&(0,k.a)(p(c),b=p(d))&&(a=c&&c.substring(b.length)),this._getWebRelativeItemUrl=()=>a,a}_getDefaultListUrl(){let a;return void 0!==this.defaultListUrl&&(a=new h.a(this.defaultListUrl).authority?this.defaultListUrl:`${this._getCurrentAuthority()}${this.defaultListUrl}`),this._getDefaultListUrl=()=>a,a}_getIsCrossDomain(){let a=this._getCurrentAuthority(),b=!(0,j.b)(new h.a(this._getServerUrl()).authority,a);return this._getIsCrossDomain=()=>b,b}_getIsCrossList(){let a=this._getFullListUrl(),b=this._getDefaultListUrl(),c=!(0,j.b)(a,b);return this._getIsCrossList=()=>c,c}_getSiteRelation(){let a=2;if(this._getIsCrossDomain())a=1;else if(void 0!==this.webUrl)a=+!(0,j.b)(o(this.defaultFullWebUrl),o(this._getFullWebUrl()));else{let b=new h.a(this.defaultFullWebUrl).path,c=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==c)if((0,k.a)(p(c),p(b))){let d=new h.a(o(c)),e=new h.a(o(b));a=2*(d.segments.length-1!==e.segments.length&&(d.segments.length-2!==e.segments.length||"Lists"!==d.segments[d.segments.length-2]))}else a=1}return this._getSiteRelation=()=>a,a}_getFullWebUrl(){let a,b=this._getServerUrl(),c=this._getServerRelativeWebUrl();return void 0!==c&&(a=`${b}${c}`),this._getFullWebUrl=()=>a,a}_getGeoRelation(){if(!this._getIsCrossDomain())return 0;let a=new h.a(this._getServerUrl()).authority;if(!a)return 2;let b=this._getCurrentGeo();if(!b)return 2;let c=this._getGeoByAuthority()[a.toUpperCase()];return c?+!(0,j.b)(c,b):2}_getGeoByAuthority(){let a={},b={};function c(c,d,e){let f=new h.a(c).authority.toUpperCase();(e||!b[f])&&(a[f]=d),e&&(b[f]=!0)}if(this.multiGeoInfo)for(let a of this.multiGeoInfo){let b=a.InstanceId,d=a.IsDefaultDataLocation;if(c(a.MySiteHostUrl,b,d),c(a.PortalUrl,b,d),c(a.RootSiteUrl,b,d),c(a.TenantAdminUrl,b,d),a.AdditionalUrls)for(let e of a.AdditionalUrls)c(e,b,d);if(this.defaultFullWebUrl&&this.webAbsoluteUrlLegacy){let e=`${new h.a(this.webAbsoluteUrlLegacy).authority}/`;a.MySiteHostUrl===e&&c(`${new h.a(this.defaultFullWebUrl).authority}/`,b,d)}}return this._getGeoByAuthority=()=>a,a}_getCurrentGeo(){let a=this._getCurrentAuthority();if(!a)return;let b=this._getGeoByAuthority()[a.toUpperCase()];return this._getCurrentGeo=()=>b,b}constructor(a){const{defaultFullWebUrl:b,webAbsoluteUrlLegacy:c,defaultListUrl:d,multiGeoInfo:e,options:{path:f,listUrl:g,webUrl:h,mayInferListUrl:j=!1}={}}=a;this._rawPath=f||void 0,this._rawListUrl=g||void 0,this._rawWebUrl=h||void 0,this.defaultFullWebUrl=n(b||void 0);const k=!i.a.isActivated("EBF720CC-3C94-4AD7-9B65-1893741C8188");this.webAbsoluteUrlLegacy=k?n(c||void 0):void 0,this.defaultListUrl=n(d||void 0),this.multiGeoInfo=e,this.mayInferListUrl=j}}function m(a){return""===a?"/":a}function n(a){return"/"===a?"/":a}function o(a=""){return"/"===a[a.length-1]?a.substring(0,a.length-1):a}function p(a=""){return"/"===a[a.length-1]?a:`${a}/`}class q{getUrlParts(a){let{webAbsoluteUrl:b,webAbsoluteUrlLegacy:c,listUrl:d,multiGeoInfo:e}=this.itemUrlContext;return new this.itemUrlPartsType({defaultFullWebUrl:b,webAbsoluteUrlLegacy:c,defaultListUrl:d,multiGeoInfo:e,options:a})}constructor(a){const{context:b,itemUrlPartsType:c=l}=a;this.itemUrlPartsType=c,this.itemUrlContext=b}}}
,function(a,b,c){let d;c.d(b,{a:function(){return aj},b:function(){return ak}});var e=c(7),f=c(133),g=c(3),h=c(0),i=c(42),j=c(252),k=c(217),l=c(77),m=c(41),n=c(15),o=c(253);let p="x-ms-diagnostics",q=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?(?:;error_category="([^"]+?)")?/,r=/^User resolution failure: (\S+)(?:\s+(.*))?/;var s=c(254);let t="SPServiceResponse";class u extends m.a{constructor(a){const b=a.errorData,c=a.innerError instanceof u&&a.innerError.errorData,d=a.errorData||c||{status:0},{message:e,correlationId:f,code:g,...h}=d,i="object"==typeof e?e?JSON.stringify(e):`${e}`:e,j=b&&b.codes||{order:[],map:{}};if(c&&c.codes)for(const a of c.codes.order)j.map[a]||(j.order.push(a),j.map[a]=c.codes.map[a]);for(const b of(super({..."string"==typeof f?{correlationId:f}:{},..."string"==typeof g?{code:g}:{},..."string"==typeof i?{message:i}:{},...a,extraData:{...a.extraData||{},hasAuthChallenge:!!d.authenticate,status:d.status,infected:d.infected,groupThrottle:d.groupThrottle,statusText:d.statusText}}),this.name="GetDataError",this.codes=j,this.errorData=d,Object.keys(h)))this[b]=h[b]}}let v="Unknown",w="NoConnection";var x=c(19),y=c(175);let z="WWW-Authenticate",A="X-SubStatusCode",B="X-SPO-ErrorCode",C="X-MSDAVEXT_Error",D="SPSQLQueryCount",E="x-virus-infected",F="Reauthid",G=h.a.isActivated("1af54829-4704-49e5-b31b-a8039201cf99");class H{getSourceUrl(){return this._url}getAllResponseHeaders(){return this._request.getAllResponseHeaders()}getCorrelationId(){return this.getResponseHeader("SPRequestGuid")}getServiceWorkerDataSourceHeader(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")}getStatus(){let a=-1;try{a=this._request.status}catch(a){}return"number"==typeof a?a:-1}getAuthenticationRedirect(){return this.getResponseHeader("X-Forms_Based_Auth_Required")}getResponseType(){return this._request.responseType}getResponseText(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText}getErrorResponseText(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(E),authenticate:this.getResponseHeader(z)}:this.getResponseText()}parseError(){let a=new j.a;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(a){let b,c=new j.a,d=()=>{if(b.result){let a;try{a=JSON.parse(b.result),c.complete(a)}catch(a){c.complete({message:"Unable to parse blob result."})}}},e=()=>{c.complete({message:"Unable to read blob error response."})};try{(b=new FileReader).addEventListener("load",d),b.addEventListener("error",e),b.readAsText(a)}catch(a){e()}return c.getPromise().then(a=>(b&&(b.removeEventListener("load",d),b.removeEventListener("error",e)),a))})(this._request.response).then(b=>{let c={data:b,status:this.getStatus(),statusText:this._request.statusText,infected:!!this.getResponseHeader(E),authenticate:this.getResponseHeader(z)};a.complete(c)}):a.complete(this._request.response):a.complete(this._request.responseText),a.getPromise()}getValue(a){let b;switch(a){case H.DataValueKeys.SourceURL:b=this.getSourceUrl();break;case H.DataValueKeys.CorrelationId:b=this.getCorrelationId();break;case H.DataValueKeys.Status:b=this.getStatus();break;case H.DataValueKeys.AuthenticationRedirect:b=this.getAuthenticationRedirect();break;case H.DataValueKeys.ResponseText:b=this.getResponseText();break;case H.DataValueKeys.ErrorResponseText:b=this.getErrorResponseText()}return b}getRedirectUrl(){if(this._isCanaryRequest)if(403!==this.getStatus())return this.getAccessDeniedRedirectUrl();else if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();else return this.getRedirectLoginPageUrl();if(403===this.getStatus()||401===this.getStatus())if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();else return this.getRedirectLoginPageUrl()}getRedirectLoginPageUrl(){let a,b=this.getAuthenticationRedirect();if(b){let c=new x.a(b);c.setQueryParameter("ReturnUrl",y.b(window.location.href)),a=c.toString()}else if(!h.a.isActivated("E01ED707-3C9F-4CD5-8ADF-8A5484D4A861","04/18/2023","Construct redirectUrl targetting Default.aspx")){let b=h.a.isActivated("46AD8143-4179-406B-83E3-582A1DD3F543","07/21/2023","Use location to determine redirectUrl, in case of cross site calls")?new n.a(this._url).authority:new n.a(window.location.href).authority;if(b)if(G)a=`${b}/_forms/Default.aspx?ReturnUrl=${encodeURIComponent(location.href)}`;else{var c;a=`${b}/_forms/Default.aspx`+((c=location.href)?`?ReturnUrl=${encodeURIComponent(c)}`:"")}let d=this.getResponseHeader(F);if(d){let b=new URL(location.href);b.searchParams.append("reauthid",d),a=b.toString()}}return a}getAccessDeniedRedirectUrl(){let a;if(this._webAbsoluteUrl){let b=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(b){let c=new x.a(b);c.setQueryParameter("Source",y.b(window.location.href)),c.setQueryParameter("Type","list"),c.setQueryParameter("correlation",y.b(this.getCorrelationId())),a=c.toString()}}return a}getRedirectToErrorCustomPromptLocation(){let a=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),b=new x.a(a);return b.setQueryParameter("ReturnUrl",window.location.href),b.toString()}shouldRedirectToErrorCustomPromptLocation(){let a=this.getResponseHeader(B),b=this.getResponseHeader("sharepointerror");return"9.3"===a||"-2130575129"===b}getResponseHeadersDictionary(){let a={},b=this.getAllResponseHeaders();if(b){let c=b.trim().split(/[\r\n]+/);c&&c.length>0&&c.forEach(function(b){let c=b.split(": "),d=c.shift(),e=c.join(": ");a[d]=e})}return this.getResponseHeadersDictionary=()=>a,a}getResponseHeader(a){let b=this.getResponseHeadersDictionary();return b[a.toLowerCase()]||b[a]||this._request.getResponseHeader(a)}getHeaderNumberValue(a){let b=Number(this.getResponseHeader(a));return isNaN(b)?void 0:b}constructor(a,b,c){this._request=a,this._url=b,this._webAbsoluteUrl=c&&c.webAbsoluteUrl,this._isCanaryRequest=c&&c.isCanaryRequest}}H.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};var I=c(172),J=c(59),K=c(131),L=c(6);let M=h.a.isActivated("94486333-390c-4bb2-9cbf-371c7042f19a"),N=L.a.isFeatureEnabled({ODB:60886}),O=h.a.isActivated("6bd90ef4-625b-47e1-8b58-0b2cc41ec5d0");class P{static _isValidFormDigest(a){return!!(a&&a.serverTime&&Date.now()-new Date(a.serverTime).getTime()<(a.formDigestTimeoutSeconds-60)*1e3)}dispose(){this._scope.dispose()}abort(){if(this._currentRequest){let a=this._currentRequest;a.isCancelled=!0,a.abort(),this._currentRequest=void 0}}isRequestActive(){return!!this._currentRequest}getServerDataFromUrl(a){let{url:b,successCallback:c,failureCallback:d,uploadProgressCallback:e,additionalPostData:f,isRest:g=!0,method:h="POST",withCredentials:i,additionalHeaders:j,contentType:k,noRedirect:l,responseType:m,needsRequestDigest:n=this._needsRequestDigest}=a,o=new Date().toISOString(),p=new XMLHttpRequest;p.open(h,b,!0),"boolean"==typeof i&&(p.withCredentials=i),m&&(p.responseType=m);let q=f instanceof FormData;k?p.setRequestHeader("Content-Type",k):q||(g?p.setRequestHeader("Content-Type","application/json;odata=verbose"):p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));let r=!1;if(j)for(let a in j)a&&(p.setRequestHeader(a,j[a]),"accept"===a.toLowerCase()&&(r=!0));r||p.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=p;let s=a=>{n&&a&&p.setRequestHeader("x-requestdigest",a),this._events.on(p,"readystatechange",()=>{this._onReadyStateChange(p,b,c,d,!!l,o)}),e&&p.upload&&this._events.on(p.upload,"progress",a=>{e(a)}),p.send(f)};n?this._ensureRequestDigest(s,d):s()}ensureRequestDigest(a,b){this._ensureRequestDigest(a,b)}_ensureRequestDigest(a,b){let c=P._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&P._isValidFormDigest(c)?a(c.formDigestValue):this._ensureRequestDigestWorker(a,b)}_ensureRequestDigestWorker(a,b){let c=new Date,d=new P({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});a||(d._requestCanaryForAuth=!0);let e=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof e?(P._requestDigestPromise||(P._requestDigestPromise=new Promise((a,f)=>{let g=b=>{let d=JSON.parse(b.getResponseText()).d.GetContextWebInformation;P._formDigests[this._webServerRelativeUrl]={serverTime:c.toISOString(),formDigestValue:d.FormDigestValue,formDigestTimeoutSeconds:d.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},a(P._formDigests[this._webServerRelativeUrl].formDigestValue),P._requestDigestPromise=void 0};d.getServerDataFromUrl({url:x.a.concatenate(e,"/_api/contextinfo"),successCallback:g,failureCallback:(a,b)=>{f({serverData:a,error:b}),P._requestDigestPromise=void 0},method:"POST",noRedirect:!!b})})),P._requestDigestPromise.then(b=>(a&&a(b),b)).catch(({serverData:c,error:d})=>{a?a(void 0):b&&b(c,d)})):b&&b(void 0,new m.a({code:"MissingWebForDigestAuth",isExpected:!1}))}_onReadyStateChange(a,b,c,d,e,f){if(4===a.readyState)if(this._currentRequest=void 0,this._events.off(a),a.upload&&this._events.off(a.upload),a&&a.isCancelled)d(void 0,new I.a);else if(!function(a){try{if(4===a.readyState&&(void 0===a.status||0===a.status))return!1}catch(a){return!1}return!0}(a))d(void 0,new m.a({code:w,isExpected:!0}));else{let f=new H(a,b,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),g=f.getStatus(),h=!e&&f.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===g){let a=f.getRedirectLoginPageUrl();try{h?window.location.href=f.getRedirectToErrorCustomPromptLocation():d(f)}catch(a){}a&&!e&&(window.location.href=a)}else{let a=f.getAccessDeniedRedirectUrl();try{d(f)}catch(a){}a&&!e&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=a)}return}if(200===g||201===g||204===g||N&&!M&&202===g)return void c(f);if(403===g){P._requestDigestPromise=void 0,e?this._ensureRequestDigestWorker(void 0,(a,b)=>d(f,b)):h?window.location.href=f.getRedirectToErrorCustomPromptLocation():O?this._ensureRequestDigestWorker():this._ensureRequestDigestWorker(void 0,(a,b)=>d(f,b));return}401===g&&h&&(window.location.href=f.getRedirectToErrorCustomPromptLocation()),d(f)}}_tryLoadDigest(a){if(P._isValidFormDigest(a)){P._formDigests[this._webServerRelativeUrl]=a;return}let b=P._formDigests[this._webServerRelativeUrl];P._isValidFormDigest(a)&&(!P._isValidFormDigest(b)||b&&new Date(b.serverTime).getTime()<new Date(a.serverTime).getTime())&&(P._formDigests[this._webServerRelativeUrl]=a)}constructor(a={}){this._scope=new K.a,this._events=this._scope.attach(new J.a(this));const b=a.webAbsoluteUrl||a.webUrl;this._webServerRelativeUrl=a.webServerRelativeUrl||b&&new x.a(b).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),this._alwaysGetDigest=a.alwaysGetDigest??!1,this._needsRequestDigest=!1!==a.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(a.formDigest),this._requestCanaryForAuth=!1,this._engagement=a.engagement,this._operationName=a.operationName}}function Q(a){let{options:{url:b,authToken:c,telemetryHandler:d,useExactAuthToken:f,method:i,additionalHeaders:j},dataSyncClient:k,aadUserId:l,getData:m}=a,n=()=>m({url:b,telemetryHandler:d,authToken:c,useExactAuthToken:f});return h.a.isActivated("26fb0edf-b3af-42db-b8ea-2858c7eacfe0")&&!l?n():e.c.resolve(k).then(a=>{let c;return a?(c=(b,c,e)=>{let{eventData:f}=b,{extraData:i={}}=f,j={performanceEntry:i&&i.performanceEntry,httpStatus:i&&i.HttpStatus,responseHeaders:b.serverData?.getResponseHeadersDictionary(),correlationId:i&&i.CorrelationId,succeeded:f&&f.resultType===g.b.Success||!1,resultCode:f&&f.resultCode,extraData:i},k=d&&d(b),l=h.a.isActivated("97E1912E-09BC-4111-9A67-EEA52ACC4BF3")?a.onRequestComplete(c,j):e(j);return i.dataSyncQos=a.getQosInfo(),{...k||{},eventData:{...k?k.eventData:f,extraData:{...k?k.eventData.extraData:f.extraData,...a.getQosInfo()}},canRetry:l&&(!k||k.canRetry)}},a.getData({url:b,method:i,additionalHeaders:j},({endpoint:a,headers:b,onComplete:d})=>m({url:a.url,authToken:a.authToken,telemetryHandler:b=>c(b,a,d),useExactAuthToken:!0,additionalHeaders:b}),n)):n()})}P._formDigests={},P._requestDigestPromise=void 0;var R=c(28),S=c(78),T=c(256);let U=h.a.isActivated("8871DEAD-6482-4778-A3AB-0A964E21F31E");function V(a){let b,{options:c,webAbsoluteUrl:d,apiEvent:f,tokenProvider:g,getData:i,noRedirect:j,qosName:l}=a,{url:n,disallowSelfIssuedToken:o,disallowCookies:p}=c,q=(0,s.a)(n),r=(a,b)=>{if(!g.getAuthToken)return e.c.resolve({authToken:void 0});let c=new f({name:`${l}.getAuthToken${b?".retry":""}`,url:q});return e.c.resolve(g.getAuthToken(a)).then(a=>(c.end({resultType:k.b.Success,resultCode:a?.authToken?"tokenAuth":"cookieAuth",...a?{extraData:{AuthCorrelationId:a?.correlationId,AuthExpiration:a?.expiresOn}}:{}}),a)).catch(a=>(c.end((0,S.a)(a)),e.c.reject(a)))},t=(a,b)=>{if(!g.getFormDigest)return e.c.resolve(void 0);let c=new f({name:`${l}.getFormDigest${b?".retry":""}`,url:q});return e.c.resolve(g.getFormDigest(a)).then(a=>(c.end({resultType:k.b.Success,resultCode:a?"newDigest":"sameDigest"}),a)).catch(a=>(c.end((0,S.a)(a)),e.c.reject(a)))};if(!r&&!t)return i({url:n});let u={url:n,webAbsoluteUrl:d,claimsChallenge:c.claimsChallenge,disallowCookies:p,disallowSelfIssuedToken:o,apiQosName:l,noRedirect:j},v={url:n,webAbsoluteUrl:d,claimsChallenge:c.claimsChallenge,apiQosName:l,noRedirect:j},w=0,x=()=>w>3?b?e.c.reject(b):e.c.reject(new m.a({code:"TooManyReauthAttempts"})):(w++,r(u,!1).then(a=>a?.authToken?a.authToken===u.expiration?.authToken||a.authToken===u.claimsChallenge?.authToken?b?e.c.reject(b):e.c.reject(new m.a({code:"ReauthProducedRepeatToken"})):a:t(v,!1).then(b=>a)).then(a=>{if(a?.authToken&&d&&(h.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==n[0])&&!(0,T.a)(n,encodeURI(d)))throw new m.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});return i({url:n,authToken:U?a?.authToken:a,qosExtraData:{...a?{AuthCorrelationId:a.correlationId,AuthExpiration:a.expiresOn}:{}}}).catch(c=>{let d,f,g;if(b=c,(g=c?.authenticate)&&g.slice(0,W.length)===W&&g.indexOf('error="insufficient_claims"')>-1)d={claimsChallenge:{authToken:a?.authToken,claims:X(c),error:c}},f={claimsChallenge:{claims:X(c),reauthid:c.reauthid,error:c}};else{let b,g,h,i;if(b=c?.code,g=c?.status,h=c?.codes,i=h?.map?.[A]?.code,!("3000002,invalid_client"===b||"10013"===b||(401===g||"16"===i)&&"917656"===b||c?.authenticate))return e.c.reject(c);d={expiration:{authToken:a?.authToken,error:c}},f={expiration:{error:c}}}return u={...u,...d},v={...v,...f},x()})}));return x()}let W="Bearer";function X(a){let b=a.authenticate,c='claims="';if(b){let a=b.indexOf(c);if(a>-1){let d=b.indexOf('"',a+c.length);if(d>-1){let e=b.slice(a+c.length,d);return h.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?e:atob(e)}}}}var Y=c(159);let Z=h.a.isActivated("DE6C2A7A-FDAB-4578-B4F8-76AC5AABCF2D"),$=L.a.isFeatureEnabled({ODB:62073});try{d=window?.UASContext?.workloadExtension?.toLowerCase().startsWith("/sharepoint")??!1}catch(a){d=!1}let _=d,aa=!h.a.isActivated("FFE6FDD3-51F4-4F44-A2C6-C4B920D392C3"),ab=h.a.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","07/12/2024","Disable collect sp perf metrics for Image tagging"),ac=h.a.isActivated("C8FBDDAA-10A4-401C-AF53-DB24C9FE508B","10/27/2024","always use form digest for COB"),ad=h.a.isActivated("88166B0F-C6E0-47AB-9069-32290AF11BFF");h.a.isActivated("8B20A8CC-6CA5-45DC-B7DC-9F3EB433F422");let ae=h.a.isActivated("D6829F03-A1EE-46C4-A474-EA8F5F22A8A2"),af="undefined"!=typeof window?window:void 0,ag=af&&af.performance,ah=h.a.isActivated("B0493589-74F3-4204-AFC6-2B77AA14095B");class ai{static parseJSON(a){return a&&JSON.parse(a)||void 0}getData(a){let{cancelToken:b}=a,c=this._getData(a);if(b){let a=b.subscribe(()=>{c.cancel()});return Promise.resolve(c).then(b=>(a(),b)).catch(b=>{throw a(),b})}return Promise.resolve(c)}_getData(a){let{parseResponse:b=ai.parseJSON,qosExtraData:c,additionalPostData:d="",contentType:f,method:k="POST",maxRetries:l=0,responseType:x,onUploadProgress:y,timeout:E,noTimeoutInLastRetry:G=!1,webAbsoluteUrl:H,allowOAuth:I=!0,customerPromise:J,url:K,maxUrlLength:L=2e3,onBeforeRequest:M,qosObjectType:N,noRedirect:O}=a;if(K.length>L)throw new u({errorData:{code:"-6,UrlTooLong",status:-1}});let Q=this._dataRequestorContext,S=this._tokenProvider,T=this._getDataWithTokenProvider,U=this._getDataWithSyncClient,V=[];this._qosName&&V.push(this._qosName),a.qosName&&V.push(a.qosName);let W=V.join("."),X=K=>{let{url:L,telemetryHandler:U,authToken:V,useExactAuthToken:X=!1,additionalHeaders:ai}=K,aj=!0,ak=(0,s.a)(L),al=s=>{let K,O,{authToken:T,qosExtraData:V}=s,{crossSiteCollectionCall:ae=!1,noRedirect:ah=this._noRedirect,needsRequestDigest:al=!0}=a,am={...a.additionalHeaders,...ai,...!ab&&"ODSDataSource.ODSP.ImageTag.Feedback.UploadImage"===W?{}:{CollectSPPerfMetrics:D}};if(I){let a,b;if(T&&"object"==typeof T?(a=T.authToken,b=T.scheme):a=T,a){let c=!1;!R.b.isFeatureEnabled({ECS:86137})&&a.split(" ").length>1&&(c=!0);let d=X||c?a:`${b||"Bearer"} ${a}`,e=!1;for(let a in am)a&&"authorization"===a.toLowerCase()&&(e=!0);e||(am.Authorization=d),ae=!0,(ac||(aa?Q?.siteSubscriptionId!=="9188040d-6c67-4c5b-b112-36a304b66dad":(!Q||0!==Q.webAbsoluteUrl.indexOf("https://my.microsoftpersonalcontent.com")&&0!==Q.webAbsoluteUrl.indexOf("https://onedrive.live.com"))&&1))&&(al=!1),ah=!0}else!($&&_)&&S&&S&&(am.Authorization="Bearer")}let an=new P({...Q?{webServerRelativeUrl:Q.webServerRelativeUrl,webAbsoluteUrl:H||Q.webAbsoluteUrl,alwaysGetDigest:ae,formDigest:{serverTime:Q.serverTime,updateFormDigestPageLoaded:Q.updateFormDigestPageLoaded,formDigestValue:Q.formDigestValue,formDigestTimeoutSeconds:Q.formDigestTimeoutSeconds}}:{},needsRequestDigest:al,engagement:this._engagement,operationName:this._qosName}),ao=af&&af.location&&new n.a(af.location.href).authority,ap=new n.a(L).authority,aq=(a,e)=>{let j,l,n=(d,f)=>h=>{let j,k,l,m,n=h.getResponseText();O=h.getServiceWorkerDataSourceHeader();let p=(0,o.a)(L,f),q={...c||{},needsRequestDigest:al,hasAuthToken:!!T,isCrossOrigin:!!ao&&ao!==ap,CorrelationId:h.getCorrelationId(),...V||{},HttpStatus:h.getStatus(),serviceWorkerDataSource:O||void 0,rawRequestDuration:p.duration,performanceEntry:JSON.stringify(p),serviceWorkerFetchInfo:h.getResponseHeader("X-ServiceWorkerFetchInfo")||void 0,SQLRT:h.getHeaderNumberValue(D),ServerDuration:h.getHeaderNumberValue("SPClientServiceRequestDuration")},r=!1;try{"blob"===x&&n&&"object"==typeof n?l=n:k=b(n,h),r=!0}catch(a){j=a,m={resultType:g.b.Failure,resultCode:"InvalidJSON",error:(0,i.c)("object"==typeof a?JSON.stringify(a):a,!1),extraData:q,objectType:N}}if(m||(m={resultType:g.b.Success,extraData:q,objectType:N}),U){let{eventData:a}=U({response:k,eventData:m,serverData:h});m=a}if(d?.end(m),r)try{a(l||k)}catch(a){}else e(this._normalizeErrors?new u({code:"-1,parse_response",innerError:j,errorData:{correlationId:h.getCorrelationId(),status:h.getStatus()}}):void 0);an=void 0},s=(a,b)=>(f,j)=>{let k=(0,o.a)(L,b),l={...c||{},needsRequestDigest:al,hasAuthToken:!!T,isCrossOrigin:!!ao&&ao!==ap,rawRequestDuration:k.duration,performanceEntry:JSON.stringify(k)},n="undefined"!=typeof navigator&&!1===navigator.onLine;if(this._offlineDetection&&(n=this._offlineDetection.offline),!f){let b=v,c=!0,d=0;j&&j instanceof m.a&&(b=j.code,c=j.isExpected,d=-1),n&&(b===w||b===v)&&(b="Offline");let f={status:d,code:b},h={resultType:c?g.b.ExpectedFailure:g.b.Failure,resultCode:b,extraData:l};if(U){let{eventData:a}=U({eventData:h,errorData:f});h=a}a?.end(h),e(this._normalizeErrors?new u({errorData:f,innerError:j}):f);return}let s=b=>{let c,j=function(a){let b=!1,c={order:[],map:{}},d=function(a){if(!a.value)return;let b=r.exec(a.value);if(b){let[,a,c]=b,d="UserResolutionFailure",e=a.lastIndexOf("."),f=e>=0?a.substring(e+1):a,g=`${d},${f}${c?","+c:""}`;return{id:d,message:"",category:a,code:g}}if(b=q.exec(a.value)){let[,a="-1",c="",d,e]=b,f=d||e||"unknown";return{id:a,message:c,category:f,code:`${a},${f}`}}}({value:a.getResponseHeader(p)});if(d){switch(d.id){case"3000000":case"3000003":case"3000006":case"3001003":case"3001004":case"3001005":case"3002000":case"3004009":case"3004010":case"3003000":b=!0;break;default:b=!1}let a={source:p,code:d.code,message:d.message,isDisplayable:!0};c.order.push(a.source),c.map[a.source]=a}let e=a.getResponseHeader(C);if(e)try{let[,a="-1",b=""]=/(\d+);\s+(.+)/.exec(e),d={source:C,code:a,message:b,isDisplayable:!1};c.order.push(d.source),c.map[d.source]=d}catch(a){}let f=a.getResponseHeader(B);if(f){let b={source:B,code:f,message:a.getResponseHeader("X-SPO-ErrorMessage"),isDisplayable:!0};c.order.push(b.source),c.map[b.source]=b}let g=a.getResponseHeader(A);if(g){let a={source:A,code:g};c.order.push(a.source),c.map[a.source]=a}return{codes:c,isExpected:b}}(f),k=j?.isExpected,m=j?.codes;if("object"==typeof b&&"number"==typeof b.status)c=b;else if("string"==typeof b){let a;try{a=JSON.parse(b)}catch(a){}if(a)if(a.error_description)c={code:`-1,${a.error||"Unknown"}`,message:a.error_description},"policy_enforced"===a.error&&(k=!0);else if("string"==typeof a.error)c={message:a.error};else if(a.error&&a.error.message&&a.error.message.value){let b={source:t,code:a.error.code,message:`${a.error.message.value}`,isDisplayable:!0};m&&(m.order.push(b.source),m.map[b.source]=b),c=a.error}else c=a.error||a["odata.error"]||{responseData:a};else if(b&&400===f.getStatus()){let a;c={code:"-1,HTMLResult",message:/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(b)?((a=b.match(/<body[^>]*>[\s\S]*<\/body>/i))?a[0]:"").slice(0,1e3):b.slice(0,1e3)},l={...l,rawPayload:d}}}let o=f.getStatus(),s=f.getCorrelationId(),w=f.getResponseHeader("SPGroupThrottle"),x=f.getResponseHeader(C);if(l={...l,CorrelationId:s,HttpStatus:o,GroupThrottle:w,MSCorrelationVector:f.getResponseHeader("MS-CV")},(401===o&&x||403===o||404===o||429===o||503===o||-1===o||0===o&&n)&&(aj=!1,k=!0),400===o){let a,b,c,e=(b={order:[],map:{}},(c=f.getResponseHeader("X-Msedge-Ref"))&&(a={source:A,code:"Non-Empty X-Msedge-Ref details",message:c}),a&&(b.order.push(a.source),b.map[a.source]=a),{codes:b,isExpected:!1});m&&e&&(Array.prototype.push.apply(m.order,e.codes.order),e.codes.order.forEach(a=>{m.map[a]=e.codes.map[a]})),l.rawPayload||(l={...l,rawPayload:d})}if((c=c||{}).codes=m,c.status=o,c.retryAfter=f.getHeaderNumberValue("Retry-After"),c.authenticate=f.getResponseHeader(z),c.authenticate&&(k=!0),!ad){let a=f.getResponseHeader(F);a&&(c.reauthid=a)}s&&(c.correlationId=s),w&&(c.groupThrottle=w);let y=JSON.stringify(c);h.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(c.targetUrl=f.getSourceUrl());let D=c["@error.redirectUrl"],E=f.getRedirectUrl()||D;E&&(k=!0,c.redirectUrl=E);let G=m?.map[t];G&&this._normalizeErrors&&(c.message=G.message);let H=m?.order[0];if(H){let a=m.map[H];a&&(H===B&&a.message?(c.code="XSPOErrorMessage",c.message=a.message):a.code&&(c.code=a.code))}c.code||(c.code=v);let I=`[${o}] ${c.code}`,J={resultType:k?g.b.ExpectedFailure:g.b.Failure,error:(0,i.c)(y,!1),resultCode:I,extraData:l};if(U){let{eventData:a,canRetry:b}=U({eventData:J,errorData:c,serverData:f});a&&(J=a),(!0===b||!1===b)&&(aj=b),J.resultType===g.b.ExpectedFailure&&(k=!0)}let K=this._normalizeErrors?new u({errorData:c,isExpected:k}):c;K.codes&&K.codes&&(J.extraData||(J.extraData={}),J.extraData.errorCodes=JSON.stringify(K.codes.map)),a?.end(J),e(K)},x=f.getResponseType();x&&"text"!==x?f.parseError().then(s):s(f.getResponseText())};j=K=J?new(function(a,b=Y.a){return class extends a{end(a){this._customerPromise&&(a?.resultType===g.b.Success?this._customerPromise.end({resultType:a?.resultType,errorCode:a?.resultCode,extraData:{...a?.extraData,isFromQosEvent:!0}}):Z||a?.resultType!==g.b.ExpectedFailure?this._customerPromise.end({resultType:a?.resultType,errorCode:a?.resultCode,veto:this._computeVeto?this._computeVeto(a):"None",extraData:{...a?.extraData,isFromQosEvent:!0}}):this._customerPromise.end({resultType:g.b.Success,errorCode:a?.resultCode,extraData:{...a?.extraData,isFromQosEvent:!0}})),super.end(a)}constructor(a){super(a),a.pillar&&(this._customerPromise=new b({scenario:a.name,pillar:a.pillar,extraData:{...a?.extraData,isFromQosEvent:!0}}),a.veto&&(this._computeVeto=a.veto))}}}(this._apiEvent))({url:ak,name:W,objectType:N,extraData:c,pillar:J?.pillar?J.pillar:void 0,veto:J?.veto?J.veto:void 0}):new this._apiEvent({url:ak,name:W,objectType:N,extraData:c}),l=ag&&ag.now(),an.getServerDataFromUrl({url:L,successCallback:n(j,l),failureCallback:s(j,l),uploadProgressCallback:y,additionalPostData:d,method:k,additionalHeaders:am,contentType:f,withCredentials:!T&&void 0,noRedirect:ah,responseType:x,needsRequestDigest:al})};return M?.(),(function(a){let{onExecute:b,onCancel:c,timeout:d,canRetry:f,noTimeoutInLastRetry:g}=a,h=0,i=Math.max(a.maxRetries,0),k=()=>{let a=new e.a(b,()=>{c(h>=i||!f())});return d&&(!g||h<i)?e.a.timeout(d,a):a};return h<i?function(a){let b,{adjustRetries:c,async:d,beforeRetry:e,callback:f,canRetry:g=()=>!0,delay:h,resetAttemptsOnRestart:i,shouldRestart:k}=a,{retries:l}=a,m=0,n=new j.a(()=>{b.cancel()});function o(a){k&&k()?(i&&(m=0),q()):n.complete(a)}function p(a){c&&(l=c(a)),m<l&&g(a)?(m++,e&&e(),"number"==typeof h&&d?d.setTimeout(q,h):q()):n.error(a)}function q(){(b=f()).then(o,p)}return q(),n.getPromise()}({canRetry:f,retries:i,callback:k,beforeRetry:()=>{h++}}):k()})({timeout:E,onExecute:aq,maxRetries:l,noTimeoutInLastRetry:G,canRetry:()=>aj,onCancel:a=>{an&&(an.abort(),a&&an.dispose())}}).then(a=>(an&&an.dispose(),a),a=>(an&&an.dispose(),!K.endTime&&e.a.isCanceled(a)&&K.end({resultCode:"Canceled",resultType:g.b.ExpectedFailure}),e.a.reject(a)))};return V?e.a.resolve(V).then(a=>al({url:L,authToken:a})):Q?.authToken?e.a.resolve(Q.authToken).then(a=>al({url:L,authToken:a})):S?T?.({apiEvent:this._apiEvent,getData:al,options:{url:L,authToken:a.authToken,qosExtraData:a.qosExtraData,claimsChallenge:a.claimsChallenge,disallowCookies:a.disallowCookies,disallowSelfIssuedToken:a.disallowSelfIssuedToken},webAbsoluteUrl:(()=>{if(!ae){if(H)return H;if(L&&Q&&Q.webAbsoluteUrl)if(L.toLowerCase().startsWith(encodeURI(Q.webAbsoluteUrl).toLowerCase()))return Q.webAbsoluteUrl;else return new n.a(L).authority||window.location.origin;return}return H||Q&&Q.webAbsoluteUrl})(),qosName:W,tokenProvider:S,noRedirect:O}):ah&&Q?.getAuthToken?e.a.resolve(Q.getAuthToken({disallowSelfIssuedToken:a.disallowSelfIssuedToken})).then(b=>al({url:L,authToken:b,disallowSelfIssuedToken:a.disallowSelfIssuedToken})):al({url:L})},aj={authToken:a.authToken,telemetryHandler:a.telemetryHandler,url:a.url,useExactAuthToken:a.useExactAuthToken,method:a.method,additionalHeaders:a.additionalHeaders};return this._dataSyncClient&&!a.skipSyncClient?U?.({options:aj,aadUserId:Q?.aadUserId,dataSyncClient:this._dataSyncClient,getData:X}):X(aj)}constructor(a,b){this._dataRequestorContext=b.dataRequestorContext,this._tokenProvider=b?.tokenProvider??this._dataRequestorContext?.tokenProvider,this._dataSyncClient=b?.dataSyncClient??this._dataRequestorContext?.dataSyncClient,this._qosName=a.qosName,this._apiEvent=b?.apiEvent??k.a,this._engagement=b?.engagement??l.a,this._normalizeErrors=a.normalizeErrors??!0,this._getDataWithTokenProvider=b?.getDataWithTokenProvider??V,this._getDataWithSyncClient=b?.getDataWithSyncClient??Q,this._offlineDetection=b?.offlineDetection,this._noRedirect=b?.noRedirect??!0}}class aj{static parseJSON(a){return a&&JSON.parse(a)||void 0}getData(a){let b,c,d=()=>{a.onBeforeRequest&&a.onBeforeRequest();let b=f.a.getRUMOneLogger(),c=Date.now();b&&!b.readTempData("appDataFetchStart")&&b.saveTempData("appDataFetchStart",c)};if(a.cancelToken)return e.c.resolve(this._dataRequestorNew.getData({...a,onBeforeRequest:d}));let g=new I.b;return this._dataRequestorNew.getData({...a,onBeforeRequest:d,cancelToken:g.token}).then(a=>{b?.(a),g?.dispose()}).catch(a=>{c?.(a),g?.dispose()}),new e.c((a,d)=>{b=a,c=d},()=>{g.cancel()})}constructor(a,b){const c=b?b.pageContext:a.pageContext;this._dataRequestorNew=new ai({...a,normalizeErrors:!!a.normalizeErrors},{...b||{},dataRequestorContext:c,noRedirect:b?.noRedirect??!!b?.tokenProvider})}}var ak=aj}
,,function(a,b,c){function d(a,b){let c="";for(;c.length<a;){let a=16*(b??Math.random)();a|=0,c+=a.toString(16)}return c}function e(){return crypto.getRandomValues(new Uint32Array(1))[0]/0x100000000}c.r(b),c.d(b,{Empty:function(){return f},_guidRegEx:function(){return g},cryptoRandom:function(){return e},generate:function(){return h},isValidGuid:function(){return l},normalizeDashes:function(){return k},normalizeLower:function(){return i},normalizeUpper:function(){return j}});let f="00000000-0000-0000-0000-000000000000",g=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function h(a){let b=[];b.push(d(8,a)),b.push(d(4,a)),b.push("4"+d(3,a));let c=d(4,a),e=parseInt(c[0],16);return e&=3,e|=8,b.push(c=e.toString(16)+c.substr(1)),b.push(d(12,a)),b.join("-")}function i(a,b=!1){return a?m(a.toLowerCase(),b):""}function j(a,b=!1){return a?m(a.toUpperCase(),b):""}function k(a,b=!1){if(a){let c=a.replace(/[^A-Fa-f0-9]/g,"");if(32===c.length)return m(`${c.slice(0,8)}-${c.slice(8,12)}-${c.slice(12,16)}-${c.slice(16,20)}-${c.slice(20)}`,b)}return""}function l(a){return!!(a&&g.test(i(a)))}function m(a,b){let c=a.match(/^\{(.*)\}$/);return c?b?c[0]:c[1]:b?"{"+a+"}":a}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(246);class e{attach(a){let b=`${++this._lastDisposableId}`,c=(0,d.a)(a,()=>{delete this._disposables[b]});return this._disposables[b]=c,c}dispose(){this.isDisposed||(this.isDisposed=!0);let a=this._disposables;for(let b of Object.keys(a)){let c=a[b];c&&(0,d.b)(c)&&c.dispose(),delete a[b]}}constructor(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}}}
,function(a,b,c){c.d(b,{a:function(){return d},b:function(){return e}});class d{create(a){return{instance:a.value()}}constructor(a){this.dependencies={value:a.lazy}}}class e{load(){let a=this._load().then(a=>new d(a));return this.load=()=>a,a}constructor(a){this._load=a}}}
,function(a,b,c){let d;c.d(b,{a:function(){return ac},b:function(){return ac}});var e,f,g,h,i=c(99),j=c(426),k=c(30),l=c(11);let m=(0,k.a)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:l.a.String,dictionary:l.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:l.a.String},persistence:{isPrefixingDisabled:!0,type:l.a.String}}).withData({privacyClassification:l.b.requiredService});var n=c(31),o=c(135),p=c(0);async function q(a){let b={...a,requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return(await c.e("deferred.odsp-common").then(c.bind(c,595))).getFirstCPUIdle(b)}var r=c(19);(e=g||(g={}))[e.own=0]="own",e[e.cors=1]="cors";class s{constructor(a,b,c,d,e,f,g){this.url=a,this.duration=b,this.correlationId=c,this.status=d,this.startTime=e,this.endTime=f,this.name=g,this.clientDurationInMilliseconds=new Date(f).getTime()-new Date(e).getTime(),this.origin=a&&new r.a(a).getHost()}}let t="undefined"==typeof window?self:window;class u{reset(){this.apis=[],this._apiBuffer={}}startTracking(a){let{ignore:b=a=>!1,getAPIName:c=a=>void 0}=a,d=a=>{let{id:b,request:c,type:d}=a,e=new s;e.startTime=new Date().toISOString(),e.startTimeRelative=this._now(),"fetch"===d&&(e.url="string"==typeof c?c:c.url),this._apiBuffer[b]=e},e=a=>{try{let{response:d,id:e}=a,f=this._apiBuffer[e];if(f&&!b(f.url)){let a,b,e;try{a=d.headers.get("SPClientServiceRequestDuration"),b=d.headers.get("SPSQLQueryCount")}catch(a){}try{e=d.headers.get("SPRequestGuid")}catch(a){}f.name=c(f.url),f={...f,...{endTime:new Date().toISOString(),endTimeRelative:this._now(),clientDurationInMilliseconds:this._now()-f.startTimeRelative,status:d.status,...a?{duration:Number(a)}:{},...b?{sqlRT:Number(b)}:{},...e?{correlationId:e}:{}}},this.apis.push(f)}}catch(a){}},f=a=>{try{let{request:d,id:e}=a,f=this._apiBuffer[e],g=d.responseURL||d.requestUrl;if(f&&!b(g)){let a=d.getAllResponseHeaders()?.toLowerCase()??"",b=a.indexOf("spclientservicerequestduration:")>=0&&d.getResponseHeader("SPClientServiceRequestDuration"),e=a.indexOf("spsqlquerycount:")>=0&&d.getResponseHeader("SPSQLQueryCount"),h=a.indexOf("sprequestguid:")>=0&&d.getResponseHeader("SPRequestGuid");f.name=c(g),f={...f,...{endTime:new Date().toISOString(),endTimeRelative:this._now(),clientDurationInMilliseconds:this._now()-f.startTimeRelative,status:d.status,...b?{duration:Number(b)}:{},...e?{sqlRT:Number(e)}:{},...h?{correlationId:h}:{},url:g}},this.apis.push(f)}}catch(a){}};return this._instrument({fetch:{onRequest:d,onResponse:e},xhr:{onRequest:d,onResponse:f}}),()=>{this.stopTracking()}}stopTracking(){t.__RUMOneAPITrackerInstrumented=!1,this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen),this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend),this._originalFetch&&(t.fetch=this._originalFetch)}getData(){let a=0,b=0,c=[];for(let d of this.apis)if(d){a++,b+=d.duration,d.origin||(d.origin=new r.a(d.url).getHost()),d.hostType=new r.a(window.location.href).getHost()===d.origin?g.own:g.cors;let e={...d};delete e.url,c.push(e)}return{count:a,duration:b,calls:JSON.stringify(c)}}_instrument(a){if(t.__RUMOneAPITrackerInstrumented)return;t.__RUMOneAPITrackerInstrumented=!0;let{fetch:b,xhr:c}=a;if("XMLHttpRequest"in t&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send,this._originalXhrOpen=XMLHttpRequest.prototype.open;let a=this;XMLHttpRequest.prototype.open=function(...b){return this.requestUrl=b[1],a._originalXhrOpen.apply(this,b)},XMLHttpRequest.prototype.send=function(...b){let d=a._requestIdGenerator();return c.onRequest({request:this,id:d,type:"xhr"}),this.addEventListener("readystatechange",()=>{4===this.readyState&&c.onResponse({request:this,id:d,type:"xhr"})}),a._originalXhrSend.apply(this,b)}}"fetch"in t&&void 0!==t.fetch&&(this._originalFetch=t.fetch.bind(t),t.fetch=(a,c)=>new Promise((d,e)=>{let f=this._requestIdGenerator();b.onRequest({request:a,id:f,type:"fetch"}),this._originalFetch(a,c).then(a=>{b.onResponse({response:a,id:f,type:"fetch"}),d(a)},a=>{e(a)})}))}_now(){return performance&&performance.now?Math.round(performance.now()):NaN}constructor(){this._requestIdGenerator=function(){let a=0;return()=>(a++).toString()}(),this.apis=[],this._apiBuffer={}}}var v=c(134);c(410);var w=c(59);let x=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"];function y(){let[a]=performance.getEntriesByType("navigation");if(a)return a}function z(a){try{let b=window._spPageContextInfo,c=a.name;if(b?.cdnPrefix){let a=b.cdnPrefix.replace(/bld$/,"");if(0===c.search(window.location.protocol+"//"+a))return!0}if(b?.cdnBaseUrl&&0===c.search(b.cdnBaseUrl))return!0;return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(c)}catch(a){return!1}}function A(a,b){let c=[];for(let d=0;d<a.length;d++){let e=a[d];(!b.from||b.from(e))&&(!b.requestType||b.requestType(e))&&c.push(e)}return c}let B={CDN:z,SharePoint:a=>0===a.name.search(window.location.protocol+"//"+window.location.host),ThirdParty:a=>!B.SharePoint(a)&&B.CDN(a)},C={HTML:a=>/html/i.test(a.initiatorType),ASPX:a=>/\.aspx/i.test(a.name),JS:a=>/script/i.test(a.initiatorType),CSS:a=>/link|css/i.test(a.initiatorType),IMG:a=>/img/i.test(a.initiatorType)};function D(a,b){return b in a?{[b]:Math.round(a[b])}:{}}var E=c(173),F=c(172);class G{once(a,b){let c,d=a=>{b(a),this._removeRemovalCallback(c)};c=()=>{this._eventTarget.removeEventListener(a,d)},this._eventTarget.addEventListener(a,d,{once:!0}),this._removals.push(c)}subscribe(a,b){let c=this._eventTarget;c.addEventListener(a,b);let d=()=>{c.removeEventListener(a,b)};return this._removals.push(d),()=>{d(),this._removeRemovalCallback(d)}}publish(a,b){this._eventTarget.dispatchEvent(new CustomEvent(a,{detail:b}))}dispose(){for(let a of this._removals)a();this._removals=[]}_removeRemovalCallback(a){let b=this._removals.indexOf(a);b>=0&&this._removals.splice(b,1)}constructor(){this._eventTarget=new EventTarget,this._removals=[]}}var H=c(251);let I=p.a.isActivated("baffdece-5d6e-4a68-a576-dcf23dd0b94d"),J=["EUPL","TTI"],K="ComponentPerformanceTracker";function L(a){let{id:b,instanceId:c}=a;return c?`${b}.${c}`:b}function M(a){let{components:b,instanceId:c}=a,d=[];for(let a of b)"string"==typeof a?d.push(L({id:a,instanceId:c})):d.push(L({id:a.id,instanceId:a.instanceId||c}));return d}class N{reset(){this._data={},this._metadata={},this._error=void 0,this._stageReadyMap={EUPL:!1,TTI:!1};let a=this._signals;this._signals={EUPL:new E.a,TTI:new E.a},a.EUPL.promise.catch(()=>{}),a.TTI.promise.catch(()=>{}),a.EUPL.reject(new F.a({code:"Interrupted"})),a.TTI.reject(new F.a({code:"Interrupted"})),this._eventMC&&(this._eventMC.publish("reset",{publisher:K}),this._eventMC.publish("all",{publisher:K}))}subscribe(a,b){return this._eventMC?this._eventMC.subscribe(a,b):()=>{}}getPerformanceData(){let a=[];for(let b of Object.keys(this._data))a.push(this._data[b]);return a}expectComponent(a){this._expectComponent(a)&&this._checkStages()}expectComponents(a){let{stage:b}=a,c=M(a),d=!1;for(let a of c)d=this._expectComponent({id:a,stage:b})||d;d&&this._checkStages()}updateExpectedStage(a){let{stage:b}=a,c=L(a);this._metadata[c]&&(this._metadata[c].stage=b),this._data[c]&&(this._data[c].ignoreForEUPL="EUPL"!==b,this._checkStages())}isExpectingComponent(a){return!!this._metadata[a]}getMissingComponents(a){let{stage:b}=a,c=[];for(let a of Object.keys(this._metadata))"All"!==b&&this._metadata[a].stage!==b||this._data[a]?.renderTime||c.push(a);return c}isStageReady({stage:a}){return"All"===a?this._isStageReady({stage:a}):this._stageReadyMap[a]}reportComponentData(a){let{data:b}=a;if(this._data[b.controlId])return;if(!b.renderTime){try{b.renderTimeRequiredDataChecker(b)&&(b.renderTime=b.renderTimeCalculator(b))}catch(a){this._setError("Error calculating render time for component",b),b.renderTime=-1}(!b.renderTime||b.renderTime<0)&&(this._setError("Invalid render time for component",b),b.renderTime=-1)}let c=this._metadata[b.controlId];c&&(b.ignoreForEUPL="EUPL"!==c.stage),this._data[b.controlId]=b,b.renderTime&&this._checkStages()}reportComponent(a){let{id:b,instanceId:c,startTime:d,endTime:e}=a,f=L({id:b,instanceId:c}),g=new H.a({controlId:f,startTime:d,endTime:e});this.reportComponentData({data:g})}async waitForStageReady({stage:a}){if(!I)return new Promise(()=>{});{let b=!1;for(;!b;)try{await this._signals[a].promise,b=!0}catch(a){if((0,F.c)(a)&&"Interrupted"===a.code)continue;throw a}}}getError(){return this._error}removeComponents(a){for(let b of M(a))delete this._data[b],delete this._metadata[b];this._checkStages()}areComponentsReady(a){return M(a).every(a=>this._data[a]?.renderTime!==void 0)}dispose(){this._eventMC&&this._eventMC.dispose()}_expectComponent(a){let{stage:b}=a,c=L(a);this._metadata[c]?this._metadata[c].stage=b:this._metadata[c]={id:c,stage:b};let d=!1;if(this._data[c]){let a="EUPL"!==b;this._data[c].ignoreForEUPL!==a&&(this._data[c].ignoreForEUPL=a,d=!0)}return this._stageReadyMap[b]&&(this._stageReadyMap[b]=!1,"EUPL"===b&&this._stageReadyMap.TTI&&(this._stageReadyMap.TTI=!1),d=!0),d}_setError(a,b){!this._error&&(this._error=a,b&&(this._error+=` (${JSON.stringify({controlId:b.controlId,startTime:b.startTime,endTime:b.endTime,renderTime:b.renderTime})})`))}_checkStages(){let a=[];for(let b of J)!this._stageReadyMap[b]&&this._isStageReady({stage:b})&&(this._stageReadyMap[b]=!0,I?this._signals[b].resolve():a.push(b));if(this._eventMC){for(let b of a)this._eventMC.publish(b,{publisher:K});this._eventMC.publish("update",{publisher:K}),this._eventMC.publish("all",{publisher:K})}}_isStageReady(a){let{stage:b}=a;if("TTI"===b&&!this._stageReadyMap.EUPL)return!1;let c=0;for(let a of Object.keys(this._metadata))if("All"===b||this._metadata[a].stage===b)if(!this._data[a]?.renderTime)return!1;else c++;return"EUPL"!==b||c>=1}constructor(a={}){this._data={},this._metadata={},this._stageReadyMap={EUPL:!1,TTI:!1},this._signals={EUPL:new E.a,TTI:new E.a},I||(this._eventMC=new G)}}var O=c(70),P=c(93);let Q=!p.a.isActivated("141F57D6-0313-495D-9340-47DBE127B468"),R=!p.a.isActivated("F74D763D-85D9-4290-A358-67EB10506661"),S=!p.a.isActivated("3BA48823-0380-4A47-9075-1C887CC226C5"),T=!p.a.isActivated("AF517CC4-FA3B-4673-BB0E-BC3F2E55157F"),U=p.a.isActivated("0d09f7d6-976a-4c50-b9b9-415c0c9f45b1"),V=p.a.isActivated("8022108e-d4e4-457f-bdaf-13bdd1ebb564"),W="__default_rumone__",X={checkInterval:100,error_timeout:3e4,max_markers:200};function Y(a,b){m.logData({streamName:a,dictionary:b,persistence:"Critical"})}(f=h||(h={}))[f.Incomplete=1]="Incomplete",f[f.ReadyToUpload=2]="ReadyToUpload",f[f.Uploaded=3]="Uploaded",f[f.TimeOut=4]="TimeOut",f[f.Skipped=5]="Skipped";let Z=["EUPL","ScenarioId"],$=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,_=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/;function aa(a){return null==a}let ab="perftest";class ac{static getRUMOneLogger(a,b){let{name:c=W,config:d=X,onLog:e=Y}=a||{};if(!ac._loggers[c]){let{componentPerformanceTracker:a=new N}=b||{};try{let b=new ac({name:c,onLog:e,config:d},{componentPerformanceTracker:a});ac._loggers[c]=b}catch(a){}}return ac._loggers[c]}registerLoggingFunc(a){let b=this._loggingFunctions.indexOf(a);return b<0&&this._loggingFunctions.push(a),()=>{b>=0&&this._loggingFunctions.splice(b,1)}}get KeyMetrics(){return this._isTtiEnabled()&&this.addExpectedKeyMetric("TTI"),this._keyMetrics}getPerformanceData(){return this._rumoneData}skipLoggingSessionsInBackground(){Q&&(this._skipLoggingSessionsInBackground=!0)}startAPIMeasurement(a){return this._apiTracker.startTracking(a)}undoAPIInstrument(){this._apiTracker.stopTracking()}dispose(){this.components.reset(),this._dataStartTime=0,this._dataState=1,this._apiTracker.reset(),this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._rumoneData={},this._settings={},this._keyMetrics=Z.slice(0),this.clearPerfDataTimer(),this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this.clearResourceTimings(),(0,o.c)(this._getOwnMakers().map(a=>a.name)),ac._markers[this._name]=[],this._unhookUnloadEvent(),this._fciPromise=void 0,d=void 0,this._resetBackgroundVisibilityStatus()}resetLogger(){V?(this.components.reset(),this._emergencyUpload(),this._dataStartTime=new Date().getTime(),this._dataState=1,this._apiTracker.reset(),this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._rumoneData={},this._settings={},this._keyMetrics=Z.slice(0),this.clearPerfDataTimer(),this.setPerfDataTimer(),this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this.clearResourceTimings(),(0,o.c)(this._getOwnMakers().map(a=>a.name)),ac._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this._fciPromise=void 0,d=void 0,this._resetBackgroundVisibilityStatus()):(this._emergencyUpload(),this.dispose(),this._dataStartTime=new Date().getTime(),this._hookUnloadEvent(),this.setPerfDataTimer()),this.logMessageInConsole("Reset performance Logger Done"),w.a.raise(this,"reset",{})}setSettings(a){this._settings={...this._settings,...a}}setTimeout(a){this._config.error_timeout=a}excludePageForPerfData(){this.setSettings({excludePageData:!0})}writeToBackgroundScenarioIdForPerfData(){this.setSettings({writeToBackgroundScenarioId:!0})}getPerformanceDataPropertyValue(a){return a&&this._rumoneData[a]}setPerformanceDataPropertyValue(a,b){return a&&$.test(a)?(this._rumoneData[a]=b,!0):(console.error(`key ${a} does not confrim to the Regex ${$}`),!1)}addExpectedControl(a){let b=this._normalizeControl(a);return this.components.expectComponent({id:b.controlId,stage:b.ignoreForEUPL?"TTI":"EUPL"})}ignoreExpectedControl(a){let b=this._normalizeControl(a);return this.components.updateExpectedStage({id:b.controlId,stage:"TTI"})}expectingControl(a){let b=this._normalizeControl(a);return this.components.isExpectingComponent(b.controlId)}writeServerCorrelationId(a){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||a}writeServerUrl(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)}writeServerSideLatency(a,b){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=a,this._rumoneData.IISLatency=b)}writeControlPerformanceData(a){if(a)return this.components.reportComponentData({data:a})}writeAPICallPerformanceData(a){a&&this._apiTracker.apis.push(a)}readAPICallPerformanceData(){return this._apiTracker.apis}writeAppCache(a){this.isCollected("AppCache")||(this._rumoneData.AppCache=a)}writePageTransitionType(a,b){(!this.isCollected("PageTransitionType")||b)&&(a===j.a.fullPageLoad||a===j.a.none||a===j.a.pageToPageNavigation||a===j.a.onePageAppNavigation)&&(this._rumoneData.PageTransitionType=a)}writeScenarioId(a,b){(!this.isCollected("ScenarioId")||b)&&(this._rumoneData.ScenarioId=a)}collectW3CPerfTimings(){if(!this._isW3cTimingCollected){let a=function(){let a=performance&&performance.timing;if(a){let c=[];for(let d=0;d<x.length;d++){var b;let e=a[x[d]];e&&c.push(["secureConnectionStart"!==(b=x[d])?"W3c"+b.charAt(0).toUpperCase()+b.slice(1):"W3cSecureConnectStart",Number(e)])}return c}}();if(a)for(let b of a)this._logRUMOneData(...b);this._isW3cTimingCollected=!0,this._logRUMOneData("navigation",function(){let a=y();if(a&&a.toJSON){let b=a.toJSON();return delete b.name,b}}())}}collectW3cResourceTimings(a={}){let{logSummery:b=!0,start:c=0,end:d=Math.round(this.now()),columnNameOverride:e=a=>a}=a,f=`logSummery=${b}|start=${c}|end=${d}|columnNameOverride=${e}`;if(!this._isW3cResourceTimingCollected[f]){let a=function(a){let{logSummery:b,start:c,end:d,columnNameOverride:e}=a;if(!window.document||!performance?.getEntriesByType)return;let f=function(a,b){let c=performance.getEntriesByType("resource"),d=document.getElementsByTagName("iframe");for(let a=0;a<d.length;a++){let b=null;try{b=d[a].contentWindow.performance}catch(a){}b&&b.getEntriesByType&&(c=c.concat(b.getEntriesByType("resource")))}return c.filter(c=>c.startTime>=a&&c.startTime<=b)}(c,d),g=[],h=Object.keys(B);for(let a=0;a<h.length;a++){let c=h[a],d=A(f,{from:B[c],requestType:null});b&&g.push({key:e(c+"RequestCountTotal"),value:d.length});let i=Object.keys(C);for(let a=0;a<i.length;a++){let f=i[a];b&&g.push({key:e(c+"RequestCount"+f),value:A(d,{from:null,requestType:C[f]}).length})}if(d.length>0&&(b&&g.push({key:e(c+"RequestDownloadTime"),value:Math.round(d.reduce((a,b)=>a+b.duration,0)/d.length)}),"CDN"===c)){let a=JSON.stringify(d.map(a=>({name:a.name.split("/").map(a=>a.split("?")[0]).filter(a=>a&&a.length>0).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(a.startTime),duration:Math.round(a.duration),transferSize:a.transferSize||0,fetchStart:Math.round(a.fetchStart),requestStart:Math.round(a.requestStart),connect:Math.round(a.connectEnd-a.connectStart),domainLookup:Math.round(a.domainLookupEnd-a.domainLookupStart),redirect:Math.round(a.redirectEnd-a.redirectStart),...D(a,"workerStart"),...D(a,"responseStart"),...D(a,"responseEnd"),...D(a,"secureConnectionStart")})));g.push({key:e(c+"RequestNames"),value:a})}}return g}({columnNameOverride:e,logSummery:b,start:c,end:d});if(a){for(let b of a)this._logRUMOneData(b.key,b.value);this._isW3cResourceTimingCollected[f]=!0}}}saveTempData(a,b){this._tempData[a]=b}readTempData(a){return this._tempData[a]}writeRenderTime(a,b){(!this.isCollected("RenderTime")||b)&&(this._rumoneData.RenderTime=a)}writePreRenderTime(a){this.isCollected("PreRender")||(this._rumoneData.PreRender=a)}writePostRenderTime(a){this.isCollected("PostRender")||(this._rumoneData.PostRender=a)}writeDataFetchTime(a,b){(!this.isCollected("DataFetch")||b)&&(this._rumoneData.DataFetch=a)}writeAppInfo(a,b){(!this.isCollected("AppInfo")||b)&&(this._rumoneData.AppInfo=a)}isRunning(){return 3!==this._dataState&&4!==this._dataState&&5!==this._dataState}writeEUPLBreakdown(a,b){return this._writeBreakdown(this._euplBreakDown,a,b)}addEUPLBreakdown(a,b,c){return this._addBreakdown(this._euplBreakDown,a,b,c)}readEUPLBreakdown(a){return this._readBreakdown(this._euplBreakDown,a)}writeTTIBreakdown(a,b){return this._writeBreakdown(this._ttiBreakDown,a,b)}addTTIBreakdown(a,b,c){return this._addBreakdown(this._ttiBreakDown,a,b,c)}readTTIBreakdown(a){return this._readBreakdown(this._ttiBreakDown,a)}getStartTime(){let{getStartTime:a}=this._settings;return a?a():0}addFlights(a){if(a&&a.length>0){let b=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]");for(let c=0;c<a.length;c++){let d=a[c];d&&-1===b.indexOf(d)&&b.push(d)}this._rumoneData.Flights=JSON.stringify(b)}}addPerfFlights(a){this._rumoneData.PerfFlights=a}collectSPClientFlights(a){let{ExpFeatures:b}=a,c="";if(b&&b.length)for(let a of b)c+=this._numberToBinString(a).split("").reverse().join("");if(!p.a.isActivated("f00a10d6-c80d-49a2-9636-1b349f88c198")){let b=this._collectEcsClientFlights(a);b&&(c+=`|${b}`)}this._rumoneData.Flights=c}collectODCClientRamps(a,b){let{Ramps:c={}}=a,d=[];for(let a of b)a.ODC&&"boolean"!=typeof a.ODC&&c[a.ODC]&&d.push(a.ODC);this._rumoneData.Flights=JSON.stringify(d)}addServerMetrics(a,b){if(a)for(let c in a)c&&!aa(a[c])&&(aa(this._serverMetrics[c])||b)&&(this._serverMetrics[c]=a[c])}writeServerVersion(a){this._rumoneData.SharePointServerVersion=a}getComponentPerformanceData(){return this.components.getPerformanceData()}mark(a){(ac._markers[this._name]=ac._markers[this._name]||[]).push(a),(0,o.f)(a)}now(){return performance&&performance.now?Math.round(performance.now()):NaN}registerPreUploadDataHandler(a){this._preUploadDataHandler=a}getMarkerTime(a){return(0,o.e)(a)}addExpectedKeyMetric(a){this._keyMetrics&&-1===this._keyMetrics.indexOf(a)&&this._keyMetrics.push(a)}set waitOnAddingExpectedControl(a){this.setSettings({waitOnAddingExpectedControl:a})}get waitOnAddingExpectedControl(){return this._settings.waitOnAddingExpectedControl}_measureTTI(){let{getStartTime:a}=this._settings,{getAbsoluteEUPL:b}=this._settings.TTISettings,c=b?b(this._rumoneData.EUPL):this.now(),e=a?a():0,f=NaN,g=y();if(g&&(f=Math.round(function(a){let b=0;for(let c of a)c>0&&(0===b||c<b)&&(b=c);return b}([g.redirectStart,g.workerStart,g.fetchStart])),e>0&&f<e&&(f=e)),this._isTtiEnabled()&&!this._fciPromise){let a,b,g;this.logMessageInConsole("Starting TTI measurement");let h=(a=window.__tti&&window.__tti.e||[],window.__fci?.o&&window.__fci.o.disconnect(),window.__fci?.e&&(window.__fci.e=[]),b=window.__tti&&window.__tti.e,g=window.__tti&&window.__tti.o,b&&(window.__tti.e=[]),g&&g.disconnect(),a);this._fciPromise=q({measurementStartTime:c,initialEntries:h,measureName:"TTI"}),this._fciPromise.then(a=>{let{fci:b,longTasks:g}=a||{},h=aa(b)?NaN:Math.round(b)-e,i=d;i&&(this._rumoneData.CLS=i.cls,this._rumoneData.CLSFullResult=JSON.stringify(i)),this.collectW3cResourceTimings({logSummery:!1,start:e,end:b,columnNameOverride:a=>`${a}OfTTI`}),this._rumoneData.TTI=h,this.logMessageInConsole(`Calculated TTI ${h}`);let j=Math.round(b);this._logRUMOneData("actionableTti",j-f),this._logRUMOneData("TtiData",{longTaskMinimum:c,ttiStartTime:e,ttiEndTime:j,actionableStartTime:f,isTtiSupported:"PerformanceLongTaskTiming"in window,hasHighResolutionTiming:o.a,isPerformanceNavigationSupported:"PerformanceNavigationTiming"in window}),g&&(this._rumoneData.TTILongTasks=JSON.stringify(g),this._rumoneData.TTILongTasksPostFMPCount=g.filter(a=>a.end>this._rumoneData.EUPL).length),this._skipLoggingSessionsInBackground&&document?.visibilityState==="hidden"&&(S?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),this._skipLoggingSessionsInBackground&&R&&this._hasPageGoneIntoBackground&&(S?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),this._logLastRequestBeforeTTI(h,g),this.logMessageInConsole("Sending 'measureTTI' event"),w.a.raise(this,"measureTTI",this._rumoneData),this.logMessageInConsole("Completed TTI measurement")})}}_logLastRequestBeforeTTI(a,b){let c=performance.getEntriesByType("resource");if(a&&b&&b.length>0&&c&&c.length>0){let a,d,e=b[b.length-1].start,f=c[0];for(let a of c)a.responseEnd<e&&a.responseEnd>f.responseEnd&&(f=a);a=z(f)?f.name:this._processLastNetworkUrl(f.name),d=/\.aspx/i.test(f.name)?"ASPX":/\.js/i.test(f.name)?"JS":/\.css/i.test(f.name)?"CSS":/img/i.test(f.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(f.name)?"IMG":/aria\.microsoft\.com/i.test(f.name)?"Aria":/_api/i.test(f.name)?"API":"Other",this._rumoneData.TTILastRequestName=a,this._rumoneData.TTILastRequestType=d,this._rumoneData.TTILastRequestStartTime=f.startTime,this._rumoneData.TTILastRequestEndTime=f.responseEnd}}_numberToBinString(a){let b=(a>>>0).toString(2);return`${Array(32-b.length+1).join("0")}${b}`}_logRUMOneData(a,b){a&&(this._rumoneData[a]=b)}_resetBackgroundVisibilityStatus(){this._visibilityChangeAbortController&&this._visibilityChangeAbortController.abort(),this._hasPageGoneIntoBackground=!1}clearResourceTimings(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()}_isBreakdownValue(a){return void 0!==a.needFlatten}collectMarks(){let a={},b=0;this._getOwnMakers().forEach(c=>{b<this._config.max_markers&&(a[c.name.substr(o.b.length)+`.mark${b++}`]=Math.round(c.startTime))}),this.writeEUPLBreakdown(JSON.stringify(a))}_getOwnMakers(){let a=ac._markers,b=[].concat(...Object.keys(a).filter(b=>a.hasOwnProperty(b)&&b!==this._name).map(b=>a[b]));return(0,o.d)().filter(a=>-1===b.indexOf(a.name))}logMessageInConsole(a){this.isRUMOneDebuggingEnabled&&console.log(a)}get isRUMOneDebuggingEnabled(){try{if("sessionStorage"in window&&window.sessionStorage){let a=window.sessionStorage.enableRUMOneDebugging;return a&&"true"===a.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(a){}return!1}logObjectForDebugging(a,b){this.isRUMOneDebuggingEnabled&&console.log(`${this._name} ${a} : `+JSON.stringify(b))}isCollected(a){return!aa(this.getPerformanceDataPropertyValue(a))}_normalizeControl(a){return"string"==typeof a?{controlId:a,ignoreForEUPL:!1}:a}setPerfDataTimer(){this._perfDataTimer=this._async.setTimeout(()=>{this.loopForDataCompleteness()},this._config.checkInterval)}clearPerfDataTimer(){aa(this._perfDataTimer)||(this._async.clearTimeout(this._perfDataTimer),this._perfDataTimer=null)}_hookUnloadEvent(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)}_unhookUnloadEvent(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)}_setFCP(){let a=NaN,b=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(b&&b.length>0){let c=b.filter(a=>"first-contentful-paint"===a.name);if(c&&1===c.length)a=c[0].startTime;else{let c=b.filter(a=>"first-paint"===a.name);c&&1===c.length&&(a=c[0].startTime)}}isNaN(a)||(this._rumoneData.FCP=Math.round(a))}collectSupplementaryData(){this._setFCP(),this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(),this.setBrowserInfo(),this.setReferrer(),this._collectMemoryData(),this._collectPageServerData(),this._setAppInfo(),this._setTestName(),this._collectExperiments(),this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length,this._rumoneData.ServerMetrics=JSON.stringify(this._serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this._euplBreakDown),this._rumoneData.TTIBreakdown=JSON.stringify(this._ttiBreakDown)}_collectExperiments(){let a=window.ODSP_EXPERIMENTS||{},b={};for(let c in a)if(a.hasOwnProperty(c)){let d=a[c];d&&d._serverTime&&Date.now()-new Date(d._serverTime).getTime()<1296e6&&(b[c]=a[c])}this._rumoneData.SPExperiments=JSON.stringify(b)}_setTestName(){let a=new r.a(location.href).getQueryParameter(ab);if(!p.a.isActivated("F7E4291F-F19B-472F-8CBB-CD0D4FFA7939")&&"sessionStorage"in window&&window.sessionStorage){let a=window.sessionStorage.getItem(ab);a?.length>0&&(this._rumoneData.TestName=a)}a&&!this._rumoneData.TestName&&(this._rumoneData.TestName=a)}loopForDataCompleteness(){if(this.clearPerfDataTimer(),!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this._dataState))),this.logObjectForDebugging("Controls: ",this.getComponentPerformanceData()),this.logObjectForDebugging("API Performance Data: ",this._apiTracker.apis),this.logObjectForDebugging("Temp Data: ",this._tempData),this.logObjectForDebugging("EUPLBreakdown: ",this._euplBreakDown),this.logObjectForDebugging("TTIBreakdown: ",this._ttiBreakDown),this.logObjectForDebugging("ServerMetrics: ",this._serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;this._updateState()}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()}_updateState(){switch(this._dataState){case 1:this.components.isStageReady({stage:"EUPL"})&&!this.waitOnAddingExpectedControl&&this.setEUPL();let a=this.components.isStageReady({stage:"TTI"});this._isTtiEnabled()&&this.isCollected("EUPL")&&a&&this._measureTTI(),0===this._getMissedKeyMetrics().length&&(!U||a)&&(this._dataState=2);break;case 2:this._uploadPerfData({emergency:!1})}}_checkTimeout(){if(!this.isRunning()||2===this._dataState)return;let a=Date.now();1===this._dataState&&a-this._dataStartTime<=this._config.error_timeout||(this._setError({reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this.components.getMissingComponents({stage:"All"})}}),this._dataState=4,this._uploadPerfData({emergency:!1}))}_setError(a){this._rumoneData.RUMOneError||(this._rumoneData.RUMOneError=JSON.stringify(a))}_getMissedKeyMetrics(){let a=[];for(let b=0;b<this.KeyMetrics.length;b++)aa(this.getPerformanceDataPropertyValue(this.KeyMetrics[b]))&&a.push(this.KeyMetrics[b]);return a}_emergencyUpload(){this.isRunning()&&this._uploadPerfData({emergency:!0})}_uploadPerfData(a){this.writeControlDataToRUMOne(),this.collectSupplementaryData();let{emergency:b}=a;this._rumoneData.EmergencyUploaded=!!b;try{if(this._settings.excludePageData)this._dataState=5,this._resetBackgroundVisibilityStatus(),this.logMessageInConsole("Uploading perf data skipped as requested by the consumer");else if(b||2===this._dataState||4===this._dataState)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){let a=this.getPerformanceData();S&&this._settings.writeToBackgroundScenarioId&&a.ScenarioId&&(a.ScenarioId+="_background"),this._loggingFunctions.forEach(b=>{b("RUMOne",a)}),this._dataState=3,this._preUploadDataHandler?.(),w.a.raise(this,"dataUploaded"),this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",a),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this._dataState)))}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error(`Error: Uploading perf data called with wrong data state ${this._dataState}`)}catch(a){var c;c=`PerformanceLogger error writing RUMOne data: ${a}`,"undefined"!=typeof console&&console&&console.error(c)}finally{this.isRunning()||(this._unhookUnloadEvent(),this.undoAPIInstrument())}}_isTtiEnabled(){return!!this._settings.TTISettings?.enabled}getReadableDataState(a){for(let b in h)if(a===Number(h[b]))return b;return"NaN"}writeControlDataToRUMOne(){let a=this.components.getPerformanceData();if(a.length){let b=a.filter(a=>!!a.renderTime&&!a.ignoreForEUPL);b.sort((a,b)=>b.renderTime-a.renderTime);for(let a=0;a<10&&a<b.length;a++)this._logRUMOneData(`Control${a+1}Id`,b[a].controlId),this._logRUMOneData(`Control${a+1}RenderTime`,b[a].renderTime);let c={};a.filter(a=>!!a.renderTime&&!!a.ignoreForEUPL).forEach(a=>{c[a.controlId]={data:a.renderTime,needFlatten:a.needFlatten}}),Object.keys(c).length>0&&this.writeEUPLBreakdown(JSON.stringify(c),!0)}let b=this.components.getError();b&&this._setError({reason:"ControlPerformanceFailure",details:b})}setEUPL(){if(!this.isCollected("EUPL")){let a=Date.now()-this.now(),b=this._settings.getStartTime?this._settings.getStartTime():0,c=b,d=0,e=this.components.getPerformanceData(),f=p.a.isActivated("d9016302-003d-432b-83ef-c585c62612fe")||this._settings.ignoreStartTimeForEupl;for(let b of e)!b.ignoreForEUPL&&(f?(b.renderTime&&d<b.renderTime&&(d=b.renderTime),b.endTime>c&&(c=b.endTime)):b.endTime>c&&(c=b.endTime>31536e6?b.endTime-a:b.endTime));f?this._rumoneData.EUPL=d:this._rumoneData.EUPL=Math.round(c-b),this._logRUMOneData("euplData",{euplStartTime:b,euplEndTime:c}),this._skipLoggingSessionsInBackground&&document?.visibilityState==="hidden"&&(S?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),this._skipLoggingSessionsInBackground&&R&&this._hasPageGoneIntoBackground&&(S?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),w.a.raise(this,"eupl",d)}}setBrowserInfo(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile}_collectMemoryData(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)}_collectPageServerData(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})}setAPIDataToRUMOne(){let a=this._apiTracker.getData();this._rumoneData.APICallCount=a.count,this._rumoneData.APICallDurationSum=a.duration,this._rumoneData.APICalls=a.calls}setReferrer(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)}_setAppInfo(){if(!this._rumoneData.AppInfo){let a=window._spModuleLink;if(a){let{buildNumber:b,manifestName:c,scenarioName:d}=a,e=JSON.stringify({buildNumber:b,manifestName:c,scenarioName:d});this._rumoneData.AppInfo=e}}}_writeBreakdown(a,b,c){if(b)try{let d=JSON.parse(b);for(let b in d)d.hasOwnProperty(b)&&this._addBreakdown(a,b,d[b],c)}catch(a){this.logMessageInConsole("Failed to write EUPL breakdown data:"+a.toString())}}_addBreakdown(a,b,c,d){if(b&&!aa(c)){if(aa(a[b])||d){let d=this._isBreakdownValue(c)?c.data:c;a[b]=d??void 0}this._isBreakdownValue(c)&&c.needFlatten&&(!this.isCollected(b)||d)&&this._logRUMOneData(b,c.data)}}_readBreakdown(a,b){return b?a[b]:a}_processEUIIUrl(a){let b=new v.a(a||"");return`${b.authority}/{ length: ${b.path.length}, segments: ${b.segments.length} }`}_processLastNetworkUrl(a){let b=new v.a(a||"");if(b.authority.indexOf("lpcres")>0||b.authority.indexOf("shell.cdn.office")>0)return a;let c=_.exec(a),d="";return c&&c.length>0&&(d=`${c[0]}`),`${b.authority}${d}`}_collectEcsClientFlights(a){let{ECSClientFeatures:b}=a;return Object.keys(P.a.EcsClientFlightInfo).map(a=>`ECS_${String(a)}_${(0,P.c)(a,b)}`).join(",")}constructor(a,b){const{name:c,config:d,onLog:e}=a;this._dataStartTime=Date.now(),this._name=c,this._config=d,this._keyMetrics=Z.slice(0),this._rumoneData={},this._dataState=1,this._loggingFunctions=[],this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._settings={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._async=new i.a,this._apiTracker=new u,this._platformDetection=new n.a,this._skipLoggingSessionsInBackground=!1,R&&document&&(this._visibilityChangeAbortController=new AbortController,this._hasPageGoneIntoBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(this._hasPageGoneIntoBackground=!0,this._visibilityChangeAbortController.abort())},{signal:this._visibilityChangeAbortController.signal})),this.components=b.componentPerformanceTracker,this.registerLoggingFunc(e),this.setPerfDataTimer(),this._hookUnloadEvent()}}T&&((0,O.b)("rumOneLoggers",{get:()=>ac._loggers}),(0,O.b)("rumOne",{get:()=>ac._loggers[W]})),ac._loggers={},ac._markers={}}
,function(a,b,c){b.a=c(15).a}
,function(a,b,c){c.d(b,{a:function(){return e},b:function(){return f},c:function(){return k},d:function(){return l},e:function(){return j},f:function(){return i}});let d=window.performance,e=!!d&&"function"==typeof d.mark&&"function"==typeof d.clearMarks&&"function"==typeof d.now,f="EUPL.",g=0,h=window._perfMarks=window._perfMarks||[];function i(a,b){let c=m(a);(null==b||g<b)&&(e?d.mark(c):h.push({name:c,startTime:Date.now()}),g++)}function j(a,b=!0){let c=b?m(a):a;if(e){let a=d.getEntriesByName(c,"mark");return a&&a.length>0?Math.round(a[0].startTime):NaN}{let a=h.filter(a=>a.name===c)[0];return a&&a.startTime}}function k(a){let b=[];a&&(b=a.map(m)),e?d.getEntriesByType("mark").filter(a=>b.length>0?b.indexOf(a.name)>=0:0===a.name.lastIndexOf(f,0)).forEach(a=>{d.clearMarks(a.name)}):h=[]}function l(){return e?d.getEntriesByType("mark").filter(a=>0===a.name.lastIndexOf(f,0)):h}function m(a){return 0===a.lastIndexOf(f,0)?a:f+a}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});var d=c(175);class e{toString(){let a,b=[];this._parameters.length&&b.push(this._parameters.map(({name:a,serializedValue:b})=>`${a}=${b}`).join("&")),b.push(...this._rawParameters),a=b.length?`?${b.join("&")}`:"";let c=this._webUrl||this._webAbsoluteUrl||"",d=c.indexOf("?"),e=d>-1?c.slice(0,d):c,f=[this._encodeWebAbsoluteUrl?encodeURI(e):e,"_api",...this._segments];return`${f.join("/")}${a}`}segment(a){return this._extend({segments:[a]})}segments(...a){return this._extend({segments:a})}methodWithAliases(a,b){let c=this,d=[];for(let a of Object.keys(b)){let e=b[a],f=c._autoParameter(e);c=f.apiUrl,d.push(`${a}=${f.name}`)}return c.segment(`${a}(${d.join(",")})`)}method(a,...b){let c=this,d=[];for(let a of b){let b=c._autoParameter(a);c=b.apiUrl,d.push(b.name)}return c.segment(`${a}(${d.join(",")})`)}parameter(a,b){return this._parameter(a,b)}parameters(a){let b=this;for(let c of Object.keys(a)){let d=a[c];b=b.parameter(c,d)}return b}oDataParameter(a,b){return this.parameter(a,{raw:b})}rawParameter(a){return this._extend({rawParameters:[a]})}clone(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})}_extend(a={}){let b=this.clone();return b._webUrl=this._webUrl,b._lastParameterId=this._lastParameterId,b._parameters.push(...this._parameters),b._segments.push(...this._segments),b._rawParameters.push(...this._rawParameters),"webUrl"in a&&(b._webUrl=a.webUrl),"lastParameterId"in a&&void 0!==a.lastParameterId&&(b._lastParameterId=a.lastParameterId),"parameters"in a&&void 0!==a.parameters&&b._parameters.push(...a.parameters),"rawParameters"in a&&void 0!==a.rawParameters&&b._rawParameters.push(...a.rawParameters),"segments"in a&&void 0!==a.segments&&b._segments.push(...a.segments),b}_autoParameter(a){let b=this._lastParameterId+1,c=`@a${b}`,d=this._extend({lastParameterId:b})._parameter(c,a);return{name:c,apiUrl:d}}_parameter(a,b){let c;return c=b&&"object"==typeof b&&"json"in b?d.a(JSON.stringify(b.json)):b&&"object"==typeof b&&"guid"in b?`guid'${b.guid}'`:b&&"object"==typeof b&&"raw"in b?b.raw:"number"==typeof b||"boolean"==typeof b?`${b}`:`'${d.a(b)}'`,this._extend({parameters:[{name:a,serializedValue:c}]})}constructor(a){const{webAbsoluteUrl:b,encodeWebAbsoluteUrl:c=!0}=a;this._webAbsoluteUrl=b,this._encodeWebAbsoluteUrl=c,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}}class f{get webAbsoluteUrl(){return this._webAbsoluteUrl}build(){return new this._apiUrlType}contextInfoUrl(a){let b,c=a.indexOf("/_layouts/");if(c>-1)b=a.substring(0,c);else{let c=a.lastIndexOf("/"),d=a.lastIndexOf(".");b=d>c?`${a.substring(0,d)}_${a.substring(d+1)}`:a}return`${b}/_api/contextinfo`}constructor(a){this._apiUrlType=class extends e{constructor(){super({webAbsoluteUrl:a.webAbsoluteUrl,encodeWebAbsoluteUrl:a.encodeWebAbsoluteUrl})}},this._webAbsoluteUrl=a.webAbsoluteUrl}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(128);class e{getDataSourceName(){return this.dataSourceName}needsRequestDigest(a){return!0}getData(a,b,c,d,e="POST",f,g,h,i,j,k,l,m,n,o,p,q){let r=a(),s=d&&d(),t=this.needsRequestDigest(r);return this.dataRequestor.getData({url:r,parseResponse:b,qosName:c,additionalPostData:s,method:e,additionalHeaders:f,contentType:g,maxRetries:h,noRedirect:i,crossSiteCollectionCall:j,telemetryHandler:k,qosExtraData:l,needsRequestDigest:t,authToken:m,webAbsoluteUrl:n,useExactAuthToken:o,skipSyncClient:p,customerPromise:q})}constructor(a,b){const c=this._pageContext=b.pageContext,e=b.tokenProvider,f=b.noRedirect,g=b.normalizeErrors,{dataRequestorType:h=class extends d.b{constructor(a){super(a,{pageContext:c,tokenProvider:e,noRedirect:f})}}}=b,{dataSourceName:i="DataSource"}=a;this.dataRequestor=new h({qosName:i,normalizeErrors:g})}}b.b=e}
,function(a,b,c){class d{static invalidate(a){"undefined"!=typeof window&&(d.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir"),d.safeLeft=d.isRightToLeft?"right":"left",d.safeRight=d.isRightToLeft?"left":"right",d.language=(a=a||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName)||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us",d.cultureLCID=window._spPageContextInfo&&window._spPageContextInfo.currentCultureName||d.language)}}d.invalidate(),b.a=d}
,function(a,b,c){c.d(b,{a:function(){return s},b:function(){return v},c:function(){return r},d:function(){return t},e:function(){return w}});var d,e,f=c(45),g=c(32),h=c(46);(d=e||(e={}))[d.Default=0]="Default",d[d.OnlyPeopleAdded=1]="OnlyPeopleAdded",d[d.Organization=8]="Organization",d[d.Anyone=16]="Anyone";var i=c(56),j=c(0),k=c(28),l=c(15);let m=j.a.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","KS for COB simplified ShareDialog")||k.b.isFeatureEnabled({ECS:1131341}),n=j.a.isActivated("a32b4fa8-d9ef-448b-935e-e20c7e10723f","04/30/2025","KS for checking mian link for is not shared"),o=k.b.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"}),p="https://my.microsoftpersonalcontent.com",q=!j.a.isActivated("9675890E-EBF0-485C-97F8-E058C05D2690");function r(a,b,c){if(a===f.a.anonymousEdit||a===f.a.anonymousView)return g.a.anyone;if(a===f.a.organizationEdit||a===f.a.organizationView)return g.a.organization;if(a===f.a.direct)return g.a.specificPeople;if(a===f.a.flexible)if(b)return g.a.anyone;else if(!1===c)return g.a.organization;else return g.a.specificPeopleFlex}function s(a,b,c){let d=!!a.filter(a=>{let b=new Date(a.expiration);return a.isActive&&a.sharingLinkKind!==f.a.direct&&(!a.expiration||b.getTime()>Date.now())&&!0!==a.isUnhealthy}).length;if(!d&&b.length){for(let a of b)if(a.role!==h.a.owner){d=!0;break}}return!n&&c&&(d||(d=c!==e.OnlyPeopleAdded)),d}function t(){let a=window.location.search.substring(1),b=(0,i.a)(a),c=b.itemMigrated&&"true"===b.itemMigrated.toLowerCase(),d=v(window._spPageContextInfo);return!c&&d&&(c=!0),!m&&(!!window.FilesConfig&&o||!!c)}function u(a,b){let c=a?new l.a(a.webAbsoluteUrl):void 0;if(c&&c.authority===b&&3===c.segments.length)return c.segments[2]}function v(a){if(q)return u(a,p)||u(a,"https://onedrive.live.com");if(a&&"ConsumerTenant"===a.tenantDisplayName&&0===a.webAbsoluteUrl.indexOf(p)){let b=a.webAbsoluteUrl.match(RegExp(`${p}/personal/(\\w+)`));if(b&&2===b.length)return b[1]}}function w(a){return"{"===a[0]&&(a=a.substring(1,a.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(a)&&"00000000-0000-0000-0000-000000000000"!==a}}
,function(a,b,c){c.d(b,{a:function(){return i},b:function(){return j},c:function(){return k},d:function(){return l}});var d=c(272),e=c(28),f=c(0),g=c(44);let h={ODB:f.a.isActivated("904afe8e-3cce-4ab4-ac2f-97b60197cf59","11/9/2021","Disable check for webTemplate mySite as qualification for isOdb"),ECS:108854},i=window._spPageContextInfo&&(window._spPageContextInfo.listBaseTemplate===d.a.mySiteDocumentLibrary||!e.b.isFeatureEnabled(h)&&Number(window._spPageContextInfo.webTemplate)===g.b.mySite),j=!!window.FilesConfig,k=i||j,l=!i&&!j}
,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return B},b:function(){return A},c:function(){return z},d:function(){return t},e:function(){return u},f:function(){return v},g:function(){return w},h:function(){return s},i:function(){return q},j:function(){return r},k:function(){return x},l:function(){return y}});var d=c(319),e=c(86),f=c(32),g=c(206),h=c(82),i=c(39),j=c("react-lib"),k=c(316),l=c(20),m=c(83),n=c(26),o=c(16);let p=["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"];function q(a){return p.indexOf(a)>-1}function r(a){return a?.rawPersonData?.EntityData?.PrincipalType==="UNVALIDATED_EMAIL_ADDRESS"}function s(a){return!!(a?.isExternal&&a?.rawPersonData?.EntityData?.PrincipalType==="GUEST_USER")}function t(a){return a&&0!==a.length?a.filter(a=>a.entityType===h.a.externalUser).length:0}function u(a){return a&&0!==a.length?a.filter(a=>a.entityType===h.a.linkedinUser).length:0}function v(a){let b=a.filter(a=>a.entityType===h.a.externalUser),c=b.length,d=b.map(a=>a.name);if(c>3)return i.b(l.Kf,c);if(c>1){let a=d.join(", "),b=a.lastIndexOf(",");return`${a.substring(0,b+1)} ${l.K} ${a.substring(b+1)} ${l.tg}`}return 1===c?`${d[0]} ${l.ng}`:""}function w(a,b,c){let d=a.filter(a=>a.entityType===h.a.group),e=d.length,f="";if(c){let a=d.filter(a=>!a.email),b=a.length;if(b>3)f=i.b(l.af,a.length);else if(b>1){let b=[];a.map(a=>b.push(a.name));let c=b.join(", "),d=c.lastIndexOf(","),e=`${c.substring(0,d+1)} ${l.K} ${c.substring(d+1)}`;f=i.b(l.c,e)}else b>0&&!a[0].email&&(f=i.b(l.Jf,d[0].name))}else 1===e?f=l.Yf:e>1&&(f=i.b(l.nf,e));return b>=1e3?f+=` ${l.Yd}`:b>=25&&(f+=` ${i.b(l.Qd,b)}`),f}function x(a){let{selectedItems:b,canAddExternalPrincipal:c,sharingInformation:d,viewPolicyTipCallback:e}=a;return y({selectedItems:b,canAddExternalPrincipal:c,sharingInformation:d,viewPolicyTipCallback:e,audience:a.audience})}function y(a){let{selectedItems:b,sharingInformation:c,viewPolicyTipCallback:e}=a,f=j.createElement("div",null,j.createElement("span",{role:"alert","aria-live":"assertive"},l.Qh," "),j.createElement(k.a,{onClick:e},l.ci)),g=c.item.hasDlpPolicy||c.sharingAbilities&&c.sharingAbilities.directSharingAbilities&&c.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===d.a.documentIsProtectedByDlp,p=c?.sharingAbilities?.directSharingAbilities?.canAddNewExternalPrincipal?.enabled||c?.sharingAbilities?.anyoneLinkAbilities?.canAddNewExternalPrincipals?.enabled||c?.sharingAbilities?.peopleSharingLinkAbilities?.canAddNewExternalPrincipals?.enabled,q=c?.sharingAbilities?.directSharingAbilities?.canAddExternalPrincipal?.enabled||c?.sharingAbilities?.anyoneLinkAbilities?.canHaveExternalUsers?.enabled||c?.sharingAbilities?.peopleSharingLinkAbilities?.canHaveExternalUsers?.enabled,r=!o.g()&&c?.sharingAbilities?.directSharingAbilities?.canRequestGrantAccessForExistingExternalPrincipal?.enabled,t=!o.g()&&c?.sharingAbilities?.directSharingAbilities?.canRequestGrantAccessForNewExternalPrincipal?.enabled;for(let a of b){let b=(q||r)&&s(a),d=(0,n.j)(c.fileExtension),e=p||t||b;if(a.isResolving||a.isResolved){if(a.isExternal)if(e){if(a.principalType===m.a.distributionList&&a.entityType===h.a.group)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.qg)}else if(g)return f;else if(d)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Pe);else return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Qg)}else if(e)if(a.rawData)return function(a,b){let c=a.EntityData&&a.EntityData.BlockingSharingPolicy||0;if(0===c||607===c)return j.createElement("span",{role:"alert","aria-live":"assertive"},a.Description);if(c>=401&&c<=404)if(b)return j.createElement("div",{role:"alert","aria-live":"assertive"},i.a(l.Dd,j.createElement("a",{href:b,target:"_blank",rel:"noreferrer"},l._f)));else return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Id);if(c>=200&&c<=209||c>=301&&c<=305)if(b)return j.createElement("div",{role:"alert","aria-live":"assertive"},i.a(l.Cd,j.createElement("a",{href:b,target:"_blank",rel:"noreferrer"},l._f)));else return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Jj);if(c>=600&&c<=603)if(b)return j.createElement("div",{role:"alert","aria-live":"assertive"},i.a(l.xj,j.createElement("a",{href:b,target:"_blank",rel:"noreferrer"},l._f)));else return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Cj);if(802===c)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Xk)}(a.rawData,c.customizedExternalSharingServiceUrl);else return j.createElement("span",{role:"alert","aria-live":"assertive"},l.mf);else if(g)return f;else if(a.isExternal)if(d)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Pe);else return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Qg)}return c.peoplePickerError?j.createElement("span",{role:"alert","aria-live":"assertive"},c.peoplePickerError):null}function z(a){let{sharingInformation:b,selectedItems:c}=a,d=(0,n.j)(b.fileExtension),e=b?.sharingAbilities?.directSharingAbilities?.canAddNewExternalPrincipal?.enabled,f=b?.sharingAbilities?.directSharingAbilities?.canAddExternalPrincipal?.enabled,g=b?.sharingAbilities?.directSharingAbilities?.canAddInternalPrincipal?.enabled,h=b?.sharingAbilities?.directSharingAbilities?.canRequestGrantAccessForInternalPrincipal?.enabled,i=b?.sharingAbilities?.directSharingAbilities?.canRequestGrantAccessForExistingExternalPrincipal?.enabled,k=b?.sharingAbilities?.directSharingAbilities?.canRequestGrantAccessForNewExternalPrincipal?.enabled;for(let a of c){let b=f&&s(a);if(o.g()){if(a.isExternal&&!e&&!b){if(d)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Pe);return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Qg)}}else if(a.isExternal){if(s(a)&&!b&&!i)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.zg);else if(!s(a)&&!k&&!e)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Kg)}else if(!g&&!h)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Gg)}return null}function A(a){let b,c,{scope:d,selectedItems:f,sharingInformation:g,simplifiedV2:h}=a,i=(0,n.j)(g.fileExtension),k=d===e.a.organization,m=d===e.a.uninitialized;if(g.sharingAbilities&&void 0!==d&&f&&f.length)switch(d){case e.a.anyone:b=g.sharingAbilities?.anyoneLinkAbilities?.canAddNewExternalPrincipals?.enabled,c=g.sharingAbilities?.anyoneLinkAbilities?.canHaveExternalUsers?.enabled;break;case e.a.specificPeople:b=g.sharingAbilities?.peopleSharingLinkAbilities?.canAddNewExternalPrincipals?.enabled,c=g.sharingAbilities?.peopleSharingLinkAbilities?.canHaveExternalUsers?.enabled}for(let a of f){let d=c&&s(a);if(a.isExternal)if(b||d){if(k||m)if(!h)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Wg);else return j.createElement("span",{role:"alert","aria-live":"assertive"},j.createElement("div",{style:{fontWeight:600}},l.Od),j.createElement("div",null,l.wd))}else{if(i)return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Pe);return j.createElement("span",{role:"alert","aria-live":"assertive"},l.Qg)}}return null}function B(a,b){if(a.audience!==f.a.existing)return null;let c=0;for(let a in b)b[a]===g.a.none&&c++;let d="";if(1===c?d=l.ae:c>1&&(d=l.ne),d)return j.createElement("div",null,j.createElement("span",{role:"alert","aria-live":"assertive"},d))}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.unknown=0]="unknown",e[e.file=1]="file",e[e.folder=2]="folder",e[e.item=3]="item",e[e.list=4]="list",e[e.web=5]="web",e[e.max=6]="max"}
,function(a,b){var c,d;(d=c||(c={}))[d.none=1]="none",d[d.available=2]="available",d[d.other=3]="other",b.a=c}
,function(a,b,c){let d,e,f,g,h,i,j,k,l,m;c.d(b,{a:function(){return C},b:function(){return E},c:function(){return z},d:function(){return B},e:function(){return D}});var n,o,p=c(138),q=c(98),r=c(315),s=c(493);function t(a,b,c,d){return s["RelativeDateTime_"+a+(c?"Future":"")+(d?"Intervals":"")+(b?"_StartWithLowerCase":"")]}function u(a,b,c,d){let e=t(b,!!d&&c,d),f=t(b,!1,d,!0);return((0,q.c)(e,f,a)||"").replace("{0}",a+"")}let v={};function w(a){var b;return(b=a,void 0===d&&function(){d={};let a=new Date(1900,0,1);try{let b={month:"long"};for(let c of x)a.toLocaleDateString(c,b).match("M[0-9][0-9]")&&(d[c]=!0)}catch{}}(),b&&d[b=b.toLowerCase()])?"en":a}let x=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"];(n=o||(o={}))[n.Sunday=0]="Sunday",n[n.Monday=1]="Monday",n[n.Tuesday=2]="Tuesday",n[n.Wednesday=3]="Wednesday",n[n.Thursday=4]="Thursday",n[n.Friday=5]="Friday",n[n.Saturday=6]="Saturday";let y=(()=>{let a;for(let b of[window.$Config&&window.$Config.mkt,p.a.cultureLCID,p.a.language,navigator.language,"en"].filter(a=>!!a))try{new Date().toLocaleDateString(b),a=b;break}catch(a){}return a=w(a),a})();function z(a,b=!1,c=!1){return function(a,b,c=!1){let d=Date.now()-a.getTime();if(d<-5*r.c);else if(d<r.c)return t("LessThanAMinute",c);else if(d<r.h)return t("AboutAMinute",c);else if(d<r.b)return u(Math.floor(d/r.c),"XMinutes");else if(d<r.g)return t("AboutAnHour",c);else if(d<r.a)return u(Math.floor(d/r.b),"XHours");else if(d<r.f){let d=a.toLocaleTimeString(b);return t("YesterdayAndTime",c).replace("{0}",d)}else if(d<r.d)return u(Math.floor(d/r.a),"XDays");return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(v[b]||(v[b]=new Intl.DateTimeFormat(b)),v[b].format(a)):a.toLocaleDateString(b)}(a,c?y:w(p.a.language),b)}function A(){let a=function(){if(void 0===e)try{new Date().toLocaleDateString(y,{timeZone:"UTC"}),e=!0}catch(a){e=!1}return e}();if(window.Intl&&window.Intl.DateTimeFormat){let b={},c={hour:"2-digit",minute:"2-digit"};f=new Intl.DateTimeFormat(y,b),g=new Intl.DateTimeFormat(y,c),a&&(b.timeZone="UTC",c.timeZone="UTC"),h=new Intl.DateTimeFormat(y,b),i=new Intl.DateTimeFormat(y,c),j=f.format,k=g.format,l=h.format,m=i.format}else j=l=a=>a.toLocaleDateString(y),k=m=a=>a.toLocaleTimeString(y)}function B(a,b){if(!a)return"";j||A();let c=r.i(new Date,a);return(b?c?m:l:c?k:j)(a)}function C(a,b){return a?(j||A(),(b?l:j)(a).replace(/[:\/\\]/g,"-")):""}function D(a,b,c=!1){return r.j(a,c?y:w(p.a.language),b)}function E(a=!1){let b=new Date(2e3,11,22);return b.toLocaleDateString(a?y:w(p.a.language),{day:"numeric",month:"numeric",year:"numeric"}).replace(b.getDate().toString(),"DD").replace((b.getMonth()+1).toString(),"MM").replace(b.getFullYear().toString(),"YYYY")}}
,function(a,b,c){let d;c.d(b,{a:function(){return h},b:function(){return g},c:function(){return j},d:function(){return k},e:function(){return i}});var e=c(84);let f={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],whiteboard:["whiteboard"],fluid:["fluid","loop","note"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]};function g(a){return a?null!==a.itemType&&void 0!==a.itemType&&a.itemType!==e.a.File?e.a[a.itemType].toLowerCase():h(a.extension):"none"}function h(a){return a?(d||(d={},Object.keys(f).map(a=>{f[a].forEach(b=>{d[b]=a})})),d[a.toLowerCase()]||"other"):"none"}function i(a){return"word"===h(a)}function j(a){return"excel"===h(a)}function k(a){return"powerpoint"===h(a)}}
,,function(a,b,c){c.d(b,{a:function(){return k}});var d=c("react-lib"),e=c(0),f=c(6),g=c(121);let h={forceEnabledFlights:[],forceDisabledFlights:[],flights:void 0,isInitialized:!1,queryParams:void 0};function i(a,b){if(-1!==h.forceEnabledFlights.indexOf(a))return!0;if(-1!==h.forceDisabledFlights.indexOf(a)||!b||0===b.length)return!1;let c=Object.values(g.a).indexOf(a);return -1===c?(console.error("The flight which needs to be checked is not in the fluent UI V9 component flights list"),!1):b.length<(c>>5)+1?(console.error("The fluent UI V9 component flights list is not initialized correctly"),!1):(b[c>>5]&1<<(31&c))!=0}var j=c(332);function k(a,b,c,k,l){let m,n=d.useContext(j.a),o=(window.__FUIV9Flights?(h.isInitialized||(h.flights||(h.flights=window.__FUIV9Flights),function(a){if(a&&a.length>0){let b=a.split(",");for(let a of(h.forceEnabledFlights=[],h.forceDisabledFlights=[],b))if("!"===a[0]){let b=parseInt(a.slice(1),10);isNaN(b)||h.forceDisabledFlights.push(b)}else{let b=parseInt(a,10);isNaN(b)||h.forceEnabledFlights.push(b)}}}(function(a){if(h.queryParams||(h.queryParams=new URLSearchParams(window.location.search)),h.queryParams.has(a))return h.queryParams.get(a)}("debugFlights")),function(){if(new Set(h.forceEnabledFlights.concat(h.forceDisabledFlights)).size<h.forceEnabledFlights.length+h.forceDisabledFlights.length)throw Error("There are flights that are forced to be both enabled and disabled")}(),h.isInitialized=!0),!!k&&!(k<0)&&i(g.a.FluentUIV9ShimOverallControl,h.flights)&&i(k,h.flights)):(m={ODB:g.a.FluentUIV9ShimOverallControl},f.a.isFeatureEnabled(m)&&f.a.isFeatureEnabled({ODB:k})))&&n;l&&(o=o&&!e.a.isActivated(l));let p=o?b:a;return d.createElement(p,c)}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});var d=c(261);function e(a,b){return c=>{let e=(0,d.b)(c,b||d.a.Small);return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:e&&a?a+e:void 0}}function f(a){!a||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo={...window._spPageContextInfo,userPhotoCdnBaseUrl:a})}}
,function(a,b,c){c.d(b,{a:function(){return d.a},b:function(){return e.a},c:function(){return f.a},d:function(){return f.b},e:function(){return g.a}}),c(95);var d=c(40),e=c(77),f=c(3);c(35),c(11),c(55),c(233),c(94),c(30);var g=c(78);c(0).a.isActivated("265f44fc-1615-4d58-8ed1-ef6a21350404")}
,function(a,b,c){c.d(b,{a:function(){return t},b:function(){return r}});var d=c(94),e=c(11),f=c(35),g=c(55),h=c(126),i=c(0),j=c(6),k=c(93);let l=!i.a.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),m=!i.a.isActivated("2EFBCD63-564E-413D-AE65-39EFA104910B","06/12/2024","use end time override"),n=!i.a.isActivated("49bcbbce-f172-4626-8eef-1fd842a3af00","06/18/2024","Include isNucleusEnabled for customer promises"),o=i.a.isActivated("A3DFFC53-5DEF-4C11-B12C-84558BD15CBF"),p=i.a.isActivated("4279556e-e9cd-490e-a9b1-6046f6053f07"),q=!i.a.isActivated("f00a10d6-c80d-49a2-9636-1b349f88c198"),r="Missing Perf Goal",s=(0,d.a)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise"},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:e.a.String},errorCode:{isPrefixingDisabled:!0,type:e.a.String},resultType:{typeRef:f.a,isPrefixingDisabled:!0,type:e.a.Enum},resultCategory:{isPrefixingDisabled:!0,type:e.a.String},extraData:e.a.Object,httpStatus:{isPrefixingDisabled:!0,type:e.a.Number},perfGoalInMs:{isPrefixingDisabled:!0,type:e.a.Number},duration:{isPrefixingDisabled:!0,type:e.a.Number},pillar:{isPrefixingDisabled:!0,type:e.a.String},veto:{isPrefixingDisabled:!0,type:e.a.String},isStaging:{isPrefixingDisabled:!0,type:e.a.Boolean},product:{isPrefixingDisabled:!0,type:e.a.String},conversationId:{isPrefixingDisabled:!0,type:e.a.String},ashaFeature:{isPrefixingDisabled:!0,type:e.a.String},isNucleusEnabled:{isPrefixingDisabled:!0,type:e.a.Boolean},copilotFeatureActionType:{isPrefixingDisabled:!0,type:e.a.String}}),t=(class extends s{end(a){var b,d;if(a&&a.extraData&&this.data.extraData&&(a={...a,extraData:{...this.data.extraData,...a.extraData}}),a&&a.errorCode!==r&&(a=this._assessPerf(a)),a&&a.veto&&"None"!==a.veto&&(b=this.data,d=a,j.a.isFeatureEnabled({ODB:62109})&&(console.info("ASHA failure trace"),console.trace(),console.info("ASHA failure start and end data"),console.info(b,d),c.e(37).then(c.bind(c,596)).then(({ashaAlert:a})=>{a(b,d)}).catch(()=>{}))),!l)try{let b=this._collectExperiments();b&&a&&(a.extraData={...a.extraData,experiments:b});let c=window._spPageContextInfo;if(a&&!c&&(c=a.spPageContext),this.data&&!c&&(c=this.data.spPageContext),c){let b=this._collectSPClientFlights(c);b&&a&&(a.extraData={...a.extraData,flights:b})}}catch{}return super.end(a)}_assessPerf(a){if(!this.endTime){let b=a.perfGoalInMs||this.data.perfGoalInMs;b&&a.resultType!==f.a.Failure&&b<(m&&a.endTimeOverride?a.endTimeOverride:g.a.getTime())-this.startTime&&(a={...a,resultType:!p&&a.isPerfGoalExpectedFailure?.()?f.a.ExpectedFailure:f.a.Failure,errorCode:r,veto:o?void 0:this.data.pillar?this._getMissingPerfGoalVeto(this.data.pillar):"None",extraData:a.errorCode?{...a.extraData,innerErrorCode:a.errorCode}:void 0})}return a}_collectExperiments(){let a,b=window.ODSP_EXPERIMENTS||{};for(let c in b)if(b.hasOwnProperty(c)){a=a||{};let d=b[c];d&&d._serverTime&&Date.now()-new Date(d._serverTime).getTime()<1296e6&&(a[c]=b[c])}return a}_collectSPClientFlights(a){let b,{ExpFeatures:c}=a;if(c)for(let a of(b="",c))b+=this._numberToBinString(a).split("").reverse().join("");if(q){let c=this._collectEcsClientFlights(a);c&&(b+=`|${c}`)}return b}_numberToBinString(a){let b=(a>>>0).toString(2);return`${Array(32-b.length+1).join("0")}${b}`}_collectEcsClientFlights(a){let{ECSClientFeatures:b}=a;return Object.keys(k.a.EcsClientFlightInfo).map(a=>`ECS_${String(a)}_${(0,k.c)(a,b)}`).join(",")}_getMissingPerfGoalVeto(a){switch(a){case"Create":return"perf goal miss (create)";case"Boot":return"perf goal miss (boot)";case"View":return"perf goal miss (view)";case"Edit":return"perf goal miss (edit)";case"Share":return"perf goal miss (share)";case"Freshness":return"perf goal miss (freshness)";case"Delete":return"perf goal miss (delete)";case"Social":return"perf goal miss (social)";case"Upload":return"perf goal miss (upload)";case"Search":return"perf goal miss (search)"}return"None"}constructor(a){super(function(a){return n&&a&&(a.isNucleusEnabled=!!window.__isListDataSyncEnabled),a}(a)),a&&a.perfGoalInMs&&this.setTimeout(a?.perfGoalInMs,{resultType:!p&&a.isPerfGoalExpectedFailure?.()?f.a.ExpectedFailure:f.a.Failure,errorCode:r,veto:o?void 0:this.data.pillar?this._getMissingPerfGoalVeto(this.data.pillar):"None",extraData:{...a}})}}).withManager((0,h.a)())}
,,,,function(a,b,c){c.d(b,{a:function(){return B}});var d=c(7),e=c(437),f=c(217),g=c(41),h=c(19),i=c(253),j=c(438),k=c(34),l=c(95),m=c(134),n=c(627),o=c(6),p=c(0),q=c(138);let r="Authorization";var s=c(254);function t(a){let b=a.getAllResponseHeaders()?.toLowerCase()??"";return b.indexOf("sprequestguid")>=0&&a.getResponseHeader("sprequestguid")||b.indexOf("request-id")>=0&&a.getResponseHeader("request-id")||void 0}function u(a){return(a.getAllResponseHeaders()?.toLowerCase()??"").indexOf("ms-cv:")>=0&&a.getResponseHeader("MS-CV")||void 0}let v=!p.a.isActivated("884C4D49-FAA1-41DA-AB27-76D985D391FF"),w=p.a.isActivated("E70D6CFA-D257-4F72-9045-2BF6BB243817"),x=p.a.isActivated("32629518-3CBD-4B34-8DAC-52AC471DCC11"),y=window&&window.performance,z={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},A="Bearer";class B{send(a){let b=b=>{let{headers:c={},driveUrl:o,driveId:B,apiName:C,disableLogging:D=!1,timeout:E,onProgress:F,onUploadProgress:G,qosExtraData:H,apiVersion:I="v2.0",needsAuthorization:J=!0,useStrongAuthToken:K=!1,postProcessQos:L,breakCache:M,allowCookies:N,hasContentType:O=!0,useMultiPart:P=!1,getErrorAsMessage:Q=!1,expectedErrors:R,disallowSelfIssuedToken:S}=a,{endpoint:T}=a,{path:U,accessToken:V,forceContentType:W=!1,useExactAuthToken:X=!1,headers:Y}=b;if(!T){let a="v2.1"===I?I:void 0;T=this._urlDataSource?"function"==typeof this._urlDataSource.getApiBaseUrl?this._urlDataSource.getApiBaseUrl({apiVersion:a,driveId:B}):this._urlDataSource.getVroomApiBaseUrl?.():void 0}let Z=this._urlDataSource?.getRoutingKey?.();if(this._driveIdUrlCheckEnabled&&o&&B&&("me"!==B?`${T}/drives/${B}`:o)!==o)throw new g.a({code:"DriveIdAndDriveUrlMismatch"});let $={...z,...a.expectedErrorCodes||{}},{requestType:_="GET"}=a,aa=this._cookieOrigin,ab=new m.a(U).authority?U:`${T}${U}`,ac=b=>{let g,m,o,v="",w={};P?(v=k.a.generate(),w={"Content-Type":`multipart/form-data;boundary=${v}`}):w={Accept:"application/json",...(a.postData||this._alwaysSendContentType)&&O||W?{"Content-Type":"application/json"}:{},...b.useCookies&&b.digestValue?{"x-requestdigest":b.digestValue}:{},...Z?{"X-FDROUTEKEYHEADER":Z}:{},...Q?{prefer:"rich-error-as-message"}:{},...!p.a.isActivated("99EE4BC8-A7CF-47FA-9104-3CBB7479E126","01/10/2024","Killswitch to enable locale for accept language")?{"Accept-Language":q.a.language}:{},...c,...!this._sendSyncClientHeadersKs?Y:{}},b.sessionToken&&b.sessionToken.tokenUrl&&0===U.indexOf("/drive/")?g=new h.a(`${b.sessionToken.tokenUrl}/${U.substring(7)}`):(g=new h.a(U),T&&!g.getScheme()&&(g=new h.a(T+U))),P&&(g.setQueryParameter("ump","1"),"POST"!==_&&(c["X-HTTP-Method-Override"]=_),_="POST");let z=function(a){let{sessionToken:b,useExactAuthToken:c}=a;if(b){let{accessToken:a,proofToken:d,wlidToken:e,isBadger:f}=b;if(e)return{name:r,value:`wlid1.1 ${e}`};if(a)return{name:r,value:c?a:`${f?"badger":"bearer"} ${a}`};if(d)return{name:"X-PROOF_TOKEN",value:d}}}({sessionToken:b.sessionToken,useExactAuthToken:X});if(!P&&z&&(w={...w,[z.name]:z.value}),P){if(m=`--${v}\r
Content-Disposition: form-data;name=data\r
`,c)for(let a of Object.keys(c))m+=`${a}: ${c[a]}\r
`;m+="Content-Type: application/json\r\n",z&&(m+=`${z.name}: ${z.value}\r
`),Q&&(m+="prefer: rich-error-as-message\r\n"),m+=`\r
${void 0!==a.postData?a.postData:""}\r
--${v}--`}M&&g.setQueryParameter("r",Math.random().toFixed(8)),b.sessionToken?.authKey&&g.setQueryParameter("authKey",b.sessionToken.authKey);let A=`${this._apiName}DataRequest.${C}`;if(!D){let a={url:(0,s.a)(g.toString()),name:A,extraData:H};o=new this._apiEvent(a)}let B=g.toString(),I=y&&y.now();return e.a.start({url:B,headers:w,method:_,json:m||a.postData||"",requestTimeoutInMS:E,withCredentials:b.useCookies,onProgress:F,onUploadProgress:G,responseType:a.responseType||void 0}).then(b=>{let c=(0,i.a)(B,I);if(o){let a=t(b),d={resultType:f.b.Success,extraData:{...H||{},rawRequestDuration:c.duration,performanceEntry:JSON.stringify(c),requestId:a,CorrelationId:a,MSCorrelationVector:u(b)}};o.end(d)}return a.parseResponse?a.parseResponse(b):0===b.responseText.length?null:JSON.parse(b.responseText)},async a=>{let c=(a,b)=>(L&&(a=L(a,b)),o&&o.end(a),d.c.reject(b)),e=(0,i.a)(B,I);if(a instanceof Error){let b=d.c.isCanceled(a),g=b?f.b.ExpectedFailure:f.b.Failure;return c({error:a.message,resultCode:b?"Canceled":"",resultType:g,extraData:{rawRequestDuration:e.duration,performanceEntry:JSON.stringify(e)}},a)}{let h;if(("text"===a.responseType||""===a.responseType)&&a.responseText)try{h=JSON.parse(a.responseText)}catch(a){}if(!x&&"blob"===a.responseType&&a.response&&a.response.size>0)try{h=JSON.parse(await a.response.text())}catch(a){}if(Q)try{let a=h?.error?.message;"string"==typeof a&&(h={error:this._encodingFixEnabled?JSON.parse((0,n.a)(a)):JSON.parse(atob(a))})}catch(a){}let{status:i,statusText:k}=a,{error:{message:m="",innerError:{stackTrace:o="",debugMessage:p=""}={}}={}}=h||{};return(i||!this._isOffline?d.c.resolve(!1):this._isOffline()).then(d=>{let n=t(a),q=d||!!(0,j.b)(h,i,a=>$[a]||!!(R&&(0,l.isExpectedError)({code:`${a}`,message:m},R))||void 0),r=function(a){let{error:b,isOffline:c}=a,d=b?.message||"";return("string"!=typeof d&&d.value?d.value:d)||(c?"Offline":"")}({error:h?.error,isOffline:d}),s=new j.a(Error(r),{response:h,status:i,request:a,correlationId:n,isExpected:q,extraData:{apiEventName:A}});return c({resultType:q?f.b.ExpectedFailure:f.b.Failure,error:m,resultCode:s.code,extraData:{...H||{},...(0,j.c)(s),stack:o,httpStatus:i,httpStatusText:k,requestId:n,CorrelationId:n,MSCorrelationVector:u(a),debugMessage:p,accessTokenLength:b.sessionToken&&b.sessionToken.accessToken?b.sessionToken.accessToken.length:-1,urlLength:g.toString().length,useCookies:!!b.useCookies,isOffline:d,rawRequestDuration:e.duration,performanceEntry:JSON.stringify(e)}},s)})}})},ad=this._sessionManagementProvider;if(J){if(V)return ac({sessionToken:V});if(v&&K&&ad&&ad.getToken)return ad.getToken({apiVersion:I,path:ab,apiQosName:C,useStrongAuthToken:!0}).then(a=>ac({sessionToken:a}));let a=new m.a(ab).authority;if(N&&a&&aa&&a===aa){if("GET"===_)return ac({useCookies:!0});else if(ad&&ad.getFormDigest)return ad.getFormDigest({url:ab}).then(a=>ac({digestValue:a,useCookies:!0}))}if(ad&&ad.getSessionToken){let a={apiVersion:I,endpoint:T,driveUrl:o,path:ab,apiQosName:C,disallowSelfIssuedToken:w?void 0:S};return d.c.resolve(ad.getSessionToken(a)).then(b=>ac({sessionToken:b}).catch(c=>ad.getSessionToken&&b&&function(a){if(a instanceof j.a){let{request:b}=a,c=b&&b.getResponseHeader("WWW-Authenticate");if(c&&c.slice(0,A.length)===A&&c.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(c)?ad.getSessionToken({...a,claimsChallenge:{sessionToken:b,claims:function(a){let b=a.request&&a.request.getResponseHeader("WWW-Authenticate"),c='claims="';if(b){let a=b.indexOf(c);if(a>-1){let d=b.indexOf('"',a+c.length);if(d>-1){let e=b.slice(a+c.length,d);return p.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?e:atob(e)}}}}(c),error:c}}).then(a=>a.accessToken!==b.accessToken?ac({sessionToken:a}):d.c.reject(c)):d.c.reject(c)))}if(ad&&ad.getToken)return ad.getToken({apiVersion:I,path:ab,apiQosName:C,disallowSelfIssuedToken:S}).then(a=>ac({sessionToken:a}))}return ac({})},c={...a};return!p.a.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(a){let{dataSyncClient:b,options:c,getData:e}=a,f=()=>e(c);return d.c.resolve(b).then(b=>b?b.getData({url:c.path,method:c.requestType},({endpoint:b,headers:c,onComplete:d})=>e({...a.options,path:b.url,accessToken:{accessToken:b.authToken},forceContentType:!0,useExactAuthToken:!0,headers:c,onComplete:d}),f):f())}({dataSyncClient:this._dataSyncClient,options:c,getData:b}):b(c)}constructor(a,b){this._sendSyncClientHeadersKs=p.a.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");const{alwaysSendContentType:c=!1}=a,{sessionManagementProvider:d,urlDataSource:e,apiEvent:g=f.a,cookieOrigin:h,isOffline:i,dataSyncClient:j}=b;this._sessionManagementProvider=d,this._alwaysSendContentType=c,this._apiEvent=g,this._apiName=e&&"function"==typeof e.getApiName?e.getApiName():"Vroom",this._urlDataSource=e,this._cookieOrigin=h,this._isOffline=i,this._dataSyncClient=j,this._encodingFixEnabled=!p.a.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!o.a.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._driveIdUrlCheckEnabled=!p.a.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}}}
,function(a,b,c){c.d(b,{a:function(){return v}});var d=c(40),e=c(368),f=c(31);function g(a){try{return window?.sessionStorage?.getItem(a)}catch(a){return null}}var h=c(6),i=c(0);let j={ODB:61528},k=a=>g(a)?.toLowerCase()==="true"&&"undefined"!=typeof console&&!!console;function l(a){let b=!!window?._spModuleLink?.usingRedirectCookie,c=a?.env2==="onebox",d=k("_isRunningTABTest"),e=!function(){if(i.a.isActivated("eb8ae4df-cb8a-40a5-81c2-6661ce536968"))return!1;let a=h.a.isFeatureEnabled(j),b=window.location.pathname.indexOf("/search.aspx")>-1;return a&&b}()&&/[?&]debug=true/.test(window?.location?.href||""),f=!!g("spfx-debug"),l=/[?&]alTest=/.test(window?.location?.href||"");return b||d||e||f||c||l}function m(a,b=new f.a){let c=(0,e.a)(b),g={AccountType:void 0!==a.accountType?d.a[a.accountType]:void 0,CloudType:a.cloudType,Environment:a.environment,FarmLabel:a.farmLabel,FarmName:a.farmName,IsAuthenticated:void 0===a.isAuthenticated?void 0:+!!a.isAuthenticated,IsNucleus:void 0===a.isNucleus?void 0:+!!a.isNucleus,isFoundation:a.isFoundation,Market:a.market,Manifest:a.manifest,OneDriveDeviceId:a.oneDriveDeviceId,Session:a.session,SiteSubscriptionId:a.siteSubscriptionId,UserId:a.userId,Version:a.version,Workload:a.workload,SiteId:a.siteId,WebId:a.webId,WebTemplateId:a.webTemplateId,pageCorrelationId:a.pageCorrelationId,originalSession:a.originalSession,listId:a.listId,Product:a.product,HomeTenantId:a.homeTenantId,ResourceTenantId:a.resourceTenantId,SessionId:a.session,TenantId:a.siteSubscriptionId,UserAgent:c.BrowserUserAgent,ServerGU:a.sideBySideToken,isNucleusEnabled:void 0===a.isNucleusEnabled?void 0:a.isNucleusEnabled?"true":"false",offlineModeStatus:a.offlineModeStatus,...c||{},...a.context||{}};if(!i.a.isActivated("388B4981-7643-45D6-9E3B-08596F5F529F")&&l(a)&&(g.Version="dev"),void 0===window.__debugLoggerContext&&(window.__debugLoggerContext=[]),window.__debugLoggerContext.push({session:g.SessionId||"",workload:g.Workload||"",product:g.Product||"None"}),!window.__wroteSessionId)try{console.log("Session ID:",g.SessionId),console.log("Time in UTC: ",new Date().toUTCString()),window.__wroteSessionId=!0}catch{}return g}function n(){return c.e("odsp.1ds.lib").then(c.bind(c,"1ds-lib"))}var o=c(70);let p="enableTelemetryUpload",q={ODB:-990,ODC:"ForceEnableAria"},r="enableTelemetryDebug";function s(a=!0){sessionStorage.setItem(p,`${a}`)}(0,o.a)("enableTelemetryDebug",function(a=!0){sessionStorage.setItem(r,`${a}`),s(a)}),(0,o.a)("enableTelemetryUpload",s);let t={ODB:62107};var u=c(366);class v{updateContext(a){let b=m(a);this._updateContextPromises.push(this._logger.then(a=>{a.updateContext(b)}))}flush(){return this._logger.then(a=>{a.flush()})}attach(a){let b=a.addEventHandler({sourceName:`OneDS-${this._params.sourceName}`,handleMissedEvents:!0,handler:this.logEvent});return this._handlerDisposers.push(b),b}dispose(){this._handlerDisposers.forEach(a=>a()),this._handlerDisposers=[]}_initOfflineDetection(){let{offlineDetection:a}=this._params;a&&this._logger.then(b=>{b.setOffline(a.offline),a.onChange(a=>{b.setOffline(a)})})}constructor(a){this._getOneDS=n,this._handlerDisposers=[],this.logEvent=a=>{Promise.all([this._logger,...this._updateContextPromises]).then(([b])=>{let{onLogEvent:c,shouldLogEvent:d}=this._params;c&&(a=c(a)),(!d||d(a))&&(b.logEvent(a),this._updateContextPromises=[])})},this._params=a;const b=m(a.context);this._loggerConfig={endpointUrl:a.context.oneDsCollectorUrl,isDebug:"true"===g(r)||"true"===g("EnableConsoleTelemetryDebug"),disableTelemetry:!(!l(a.context)||k(p)||k("enableAriaUpload")||h.a.isFeatureEnabled(q)),enableStorageChannel:!!a.offlineDetection,propertyConfiguration:{scrubIpOnly:!0},...{isDisableEventTimingsKSActive:i.a.isActivated("80DFF50F-3524-4803-AEC5-3EC5582EEBBE")},enablePrivacyGuard:(a=>{let b=i.a.isActivated("FAE1CF3A-D031-498D-9CDE-EA1151B19F0F");return("3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977"===a||"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189"===a||"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718"===a)&&!b})(a.tenantToken),disableStrictContextPlugin:!(()=>{let a=i.a.isActivated("c43b2cff-263b-4f2b-b0a5-559428677402");return h.a.isFeatureEnabled(t)&&!a})(),scrubberConfig:(0,u.a)(),...a.loggerConfig},this._logger=this._getOneDS().then(c=>new c._OneDSLogger(a.tenantToken,b,this._loggerConfig)),this._initOfflineDetection(),this._updateContextPromises=[]}}}
,,,,,function(a,b,c){c.d(b,{a:function(){return d}});let d={none:0,lazy:1,local:2,optional:4,bypass:8,async:16,suspensible:32,notAsync:-18,handleViral:16,loaderViral:8}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(246);class e{create(){let a=new this._type;return{instance:a,disposable:(0,d.b)(a)?a:void 0}}constructor(a){this._type=a,this.dependencies={}}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(131);d.a.prototype.attached=function(a){let b=this;return class extends a{constructor(...a){super(...a),b.attach(this)}}};var e=d.a}
,function(a,b,c){c.d(b,{a:function(){return h},b:function(){return k},c:function(){return i},d:function(){return l}});var d=c(41),e=c(173),f=c(42);let g="Canceled";class h extends d.a{constructor(a={message:(0,f.c)(g)}){const b=(0,d.c)(g);super({code:(0,d.d)(a.code)?(0,d.b)(a.code,b):b,isExpected:!0,...a}),this.name=g}}function i(a){return a instanceof h||!!a&&"object"==typeof a&&(a.code===g||a.name===g)}class j{constructor(a){let b;const c=a.catch(a=>(b=a,Promise.reject(a)));this.subscribe=a=>{let b=a;return c.then(()=>{b=void 0},a=>{if(b){let c=b;b=void 0,c(a)}}),()=>{b=void 0}},this.isCanceled=()=>!!b,this.throwIfCanceled=()=>{if(b)throw new h(b)}}}class k{constructor(){const{reject:a,resolve:b,promise:c}=new e.a;this.cancel=b=>a(b||new h),this.dispose=()=>b(),this.token=new j(c)}}async function l(a,b){if(!b)return await a;let c=new e.a,d=b.subscribe(a=>{c.reject(a)});return(async()=>{try{c.resolve(await a)}catch(a){c.reject(a)}finally{d()}})(),await c.promise}}
,function(a,b,c){c.d(b,{a:function(){return d}});class d{constructor(){let a,b;this.promise=new Promise((c,d)=>{a=c,b=d}),this.promise.catch(()=>{}),this.resolve=a,this.reject=b}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(1);function e(a,b){return(0,d.a)(a,b)}}
,function(a,b,c){function d(a,b,c,d){let e="",f=0;if(!a)return"";let g=a.length;for(f=0;f<g;f++){let g=a.charCodeAt(f),h=a.charAt(f);if(b&&("#"===h||"?"===h)){e+=a.substr(f);break}if(c&&"&"===h){e+=h;continue}g<=127?d||g>=97&&g<=122||g>=65&&g<=90||g>=48&&g<=57||b&&g>=32&&g<=95&&0>" \"%<>'&".indexOf(h)?e+=h:g<=15?e+="%0"+g.toString(16).toUpperCase():g<=127&&(e+="%"+g.toString(16).toUpperCase()):g<=2047?(e+="%"+(192|g>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):(64512&g)!=55296?(e+="%"+(224|g>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):f<a.length-1&&(g=(1023&g)<<10,f++,g|=1023&a.charCodeAt(f),g+=65536,e+="%"+(240|g>>18).toString(16).toUpperCase(),e+="%"+(128|(258048&g)>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase())}return e}function e(a){return a&&(a=d(a=(a=a.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),a}c.d(b,{a:function(){return e},b:function(){return d}})}
,function(a,b,c){function d(a){return a?"gallatin"===a:location.origin.indexOf(".cn")===location.origin.length-3}function e(a){return"pathfinder"===a||"trailblazer"===a}function f(a){return"ag08"===a||"ag09"===a}function g(a){return"pathfinder"===a}function h(a){return"trailblazer"===a}c.d(b,{a:function(){return f},b:function(){return d},c:function(){return e},d:function(){return g},e:function(){return h}})}
,function(a,b,c){c.d(b,{a:function(){return k},b:function(){return m}});var d=c(7),e=c(3),f=c(163),g=c(60),h=c(43),i=c(6);let j="DisableSubstrateSearch",k="https://outlook.office.com/search",l={ODB:1286};class m{canUseSubstrate(){if(this._substrateToken)return!0;let a=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&i.a.isFeatureEnabled(l,this._pageContext.ExpFeatures)&&(a=!0),this._dataStore&&(a=a&&!this._dataStore.getValue(j,h.a.session))),a}disableSubstrateCallsForPicker(){this.initializeDataStore(),this._dataStore.setValue(j,!0,h.a.session)}getSubstrateToken(){if(this._substrateToken)return d.c.resolve(this._substrateToken);if(this._oAuthTokenProvider){let a=new e.a({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken({resource:k,apiQosName:"PeoplePicker.GetSubstrateToken"}).then(b=>(a.end({resultType:e.b.Success}),b),b=>d.c.isCanceled(b)?(a.end({resultType:e.b.ExpectedFailure,resultCode:"Canceled"}),d.c.reject(b)):(a.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:e.b.Failure,extraData:{serverErrorCode:b._serverErrorCode,message:b.message}}),this.disableSubstrateCallsForPicker(),null))}return null}warmUpInit(a){this.canUseSubstrate()&&this.getSubstrateToken().then(b=>{this.init(b,a)})}init(a,b="documentshare"){let c=`${k}/api/v1/init?scenario=${b}`;this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:c,headers:{Authorization:"Bearer "+a,"X-AnchorMailbox":`OID:${this._pageContext?.aadUserId}@${this._pageContext?.aadTenantId}`},needsAuthorization:!1})}initializeDataStore(){this._dataStore||(this._dataStore=new g.a("PeoplePicker",h.a.session))}constructor(a,b){this._dataRequestor=new f.a({},{}),this._pageContext=b.pageContext,this._oAuthTokenProvider=b.oAuthTokenProvider,this._sharingContextInformation=b.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}}}
,function(a,b,c){c.d(b,{a:function(){return s},b:function(){return w},c:function(){return x},d:function(){return y},e:function(){return r}});var d,e,f=c(6),g=c(28),h=c(2),i=c(80),j=c(140);let k={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"};var l=c(0);let m="#3d3e66",n="#e9eaf6",o="#616161",p="#ebebeb",q={black:"#242424",neutralDark:"#424242",neutralPrimary:o,neutralPrimaryAlt:o,neutralSecondary:"#8a8a8a",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#d1d1d1",neutralQuaternary:p,neutralQuaternaryAlt:p,neutralLight:"#f0f0f0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",white:"#fff",themeDarker:"#323348",themeDark:m,themeDarkAlt:m,themePrimary:"#5b5fc7",themeSecondary:"#9092c1",themeTertiary:"#a5a7cf",themeLight:"#385dc2",themeLighter:n,themeLighterAlt:n,accent:"#137ad1"};function r(a,b,c,d){let e,j={...a};if(x(b)){let b,c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";(b=(void 0)??window._spPageContextInfo)&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),f.a.isFeatureEnabled({ODB:62512})&&y(a.themeSchemaVersion)&&c!==a.displayMode&&a.otherMode&&(j.palette={...j.palette,...a.otherMode?.palette},j.otherMode={...j.otherMode,palette:{...a.palette},isInverted:a.isInverted,displayMode:a.displayMode},j.isInverted=a.otherMode?.isInverted,j.displayMode=a.otherMode?.displayMode)}return i.a.applyBatchedUpdates(()=>{e=(0,h.F)(s(j,b,d))}),e}function s(a,b,c){var d;let e;return l.a.isActivated("0d6cef16-2b13-4ef6-94c6-60e57e73d2a3")?(d=a,b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),f.a.evaluateCanOverride(),j.c||(d=v({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},d)),(e=d.palette)&&(e.black||e.neutralPrimary||e.white||e.neutralQuaternary)&&(!e.black||!e.white||!e.neutralPrimary||!e.neutralQuaternary||0!==e.black.indexOf("#000")||0!==e.white.toLowerCase().indexOf("#fff")||0!==e.neutralPrimary.indexOf("#333")||0!==e.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(d.palette={...d.palette,...k}),d):(b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),f.a.evaluateCanOverride(),function(a,b){switch(a){case 0:return t(b);case 1:return t(v({palette:q},b));default:return t(v(u,b))}}(j.c?0:(!c||!b?.themedCssFolderUrl)&&function(a){if(l.a.isActivated("a7baa93c-d9fa-4e23-aa22-5f51ad9fab63")||!a)return!1;{let b=a.featureInfo?.VivaBackendFeature;return b?b.Enabled:a.isCurrentSiteAVivaBackendSite}}(b)?1:2,a))}function t(a){let b,c;return c=!(b=a.palette).black&&!b.neutralPrimary&&!b.white&&!b.neutralQuaternary||b.black&&b.white&&b.neutralPrimary&&b.neutralQuaternary&&0===b.black.indexOf("#000")&&0===b.white.toLowerCase().indexOf("#fff")&&0===b.neutralPrimary.indexOf("#333")&&0===b.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"),(!b||c)&&(a.palette={...a.palette,...k}),a}let u={palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}};function v(a,b){return{...a,...b,effects:{...a.effects,...b.effects},fonts:{...a.fonts,...b.fonts},palette:{...a.palette,...b.palette}}}function w(a){let b=l.a.isActivated("17d606aa-a12a-4d3e-b988-db14e6dc370f")?window._spPageContextInfo:a??window._spPageContextInfo;return b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),g.b.isFeatureEnabled({ODB:61259})}function x(a){let b=a??window._spPageContextInfo;return b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),g.b.isFeatureEnabled({ODB:61852})}function y(a){if(a){let b=/^([0-9]+)\.([0-9]+)(?:\.([0-9]+)(?:\.([0-9]+))?)?$/g.exec(a);if(b)return 2===parseInt(b[1],10)}return!1}(d=e||(e={}))[d.noDefault=0]="noDefault",d[d.vivaHomeDefault=1]="vivaHomeDefault",d[d.spDefault=2]="spDefault"}
,function(a,b,c){c.d(b,{a:function(){return e},b:function(){return n},c:function(){return m},d:function(){return s},e:function(){return p},f:function(){return q}});var d,e,f=c(158),g=c(3),h=c(20),i=c(85),j=c(16),k=c(460),l=c(279);function m(a){let b;if(!j.e()){switch(a){case 2:case 9:b="files";break;case 3:b="doclib";break;case 4:b="sync";break;case 12:case 41:case 42:b="list";break;case 18:case 37:b="odc-files";break;case 4:b="odc-sync";break;default:b=void 0}return b}}function n(a,b,c,d){let e=a;switch(b){case 2:case 0:(e=e||{error:void 0}).error=c.message,e.errorCategory=i.a.generic,e.errorMessage=h.Qk,e.rawError=c,e.debugErrorMessage=d?d.toString():(c.stack?c.stack:c.toString()).substring(0,1024);break;case 1:if(!a){let a,b,d,f,g,{sharingError:k,errorMessage:l,debugErrorMessage:m}=(a=i.b.generic,b=c?.code,d=c?.status,f=h.zd,g=JSON.stringify(c||{}),b?(b.indexOf("-2147024809")>-1&&g?.indexOf("Item does not exist")>-1&&(a=i.b.invalidItem),j.u()&&b.includes("MissingWebForDigestAuth")&&(a=i.b.authFailure,f=h.ej)):d&&parseInt(d,10)>=500&&(a=i.b.serverFailure),{sharingError:a,errorMessage:f,debugErrorMessage:g});e={error:k,errorCategory:i.a.getSharingInformation,errorMessage:l,debugErrorMessage:m,rawError:c,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0}}}return e}function o(){let{clientId:a,scenarioId:b,resourceId:c,listId:d,listItemId:e,uniqueId:f,correlationId:g,hostSessionId:h,userId:i,syncClientDeviceId:j}=window._sharingContextInfo;return{sharingContext:{clientId:a,scenarioId:b,resourceId:c,listId:d,listItemId:e,uniqueId:f,correlationId:g,hostSessionId:h,userId:i,syncClientDeviceId:j}}}function p(a){let{customerPromise:b,rawErrorMessage:c,engagementExtraData:d,errorType:e,sharingStore:h}=a;if(b){var i;let a=(0,f.e)(c),k=(i=a.resultCode)&&"string"==typeof i?i.split(",").join("_"):JSON.stringify(i),m=o(),n=a.resultType;(function(a){if(a?.code?.indexOf("LIST_UNIQUE_SCOPES_EXCEEDED")>=0||a?.code?.indexOf("ListUniqueScopesExceeded")>=0||a?.code?.indexOf("Microsoft.SharePoint.SPSharingResourceOverBudgetException")>=0||!j.mb()&&(a?.code?.indexOf("ERROR_SHARING_BUFFER_EXCEEDED")>=0||a?.code?.indexOf("SharingBufferExceeded")>=0)||a?.status===503&&a?.retryAfter||a?.status===-1&&a?.code?.indexOf("NoConnection")>=0)return!0;let b=a?.message;return!!(b&&("string"!=typeof b&&(b=JSON.stringify(b)),b.indexOf("The invited user already exists in the directory")>=0||b.indexOf("This invitation is blocked by cross-tenant access settings.")>=0||b.indexOf("Creating multi-file sharing bundle is not supported.")>=0))})(c)&&(n=g.b.ExpectedFailure);let p=h?.getSharingInformation(),q=p?.errorCategory,s={...h?.getEngagementHelper().getEngagementExtraData(),...d,...a.extraData,error:a.error,rawErrorMessage:c,errorType:e||2,errorCategory:q,debuggingInfo:m};if(j.M()||(s=r(s)),b.end({resultType:n,errorCode:k,extraData:{...s,diagnosticInfo:s}}),!j.tc()){let a=(0,l.a)();a?.sendShareLoadResult({resultType:n,errorType:e,errorCode:k,errorMessage:c.toString()})}}}function q(a){let{customerPromise:b,engagementExtraData:c,sharingStore:d}=a;if(b){let a={debuggingInfo:r(o())};if(b.end({resultType:g.b.Success,extraData:{...d?.getEngagementHelper().getEngagementExtraData(),...c,diagnosticInfo:a}}),!j.tc()){let a=(0,l.a)();a?.sendShareLoadResult({resultType:g.b.Success})}}}function r(a){if("object"==typeof a&&a){for(let b of Object.keys(a))a[b]=r(a[b]);return a}return"string"==typeof a&&a.match(/https?:\/\//)?"DATA_Sanitized":a}function s(a){return({[k.a.SharingToBlockedUserOnODB]:h.tj,[k.a.SharingToBlockedBySiteRAC]:h.nj,[k.a.ObjectNotSupported]:h.wj,[k.a.SharingToBlockedBySiteRACMSGraphThrottled]:h.b})[a]||""}(d=e||(e={}))[d.render=0]="render",d[d.api=1]="api",d[d.generic=2]="generic"}
,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c("react-lib");(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.IconButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.IconButton:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var e=c(63),f=c(64);function g({iconProps:a,onClick:b,ariaLabel:c,tooltipContent:g,menuProps:h,menuIconProps:i,className:j,directionalHint:k,disabled:l,automationId:m,styles:n,tooltipStyles:o}){let[p,q]=d.useState(!1);return d.createElement(e.a,{content:g,id:g,styles:o,calloutProps:{gapSpace:0,calloutMaxWidth:180,hidden:p,styles:{root:{borderRadius:"4px"},beakCurtain:{borderRadius:"4px"}}},directionalHint:k},d.createElement(f.a,{className:j||"IconButton",iconProps:a,onClick:b,onMenuClick:()=>{q(!0)},onAfterMenuDismiss:()=>{q(!1)},ariaLabel:c,menuProps:h,menuIconProps:i,disabled:l,"data-automationid":m,id:m,styles:n}))}}
,,,,,,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return j},b:function(){return i}});let d="ms-word",e="onenote|UsePlain",f="ms-powerpoint",g="ms-excel",h="ms-visio",i=d,j={accdb:"ms-access",csv:g,doc:d,docm:d,docx:d,dot:d,dotm:d,dotx:d,odp:f,ods:g,odt:d,one:e,onepkg:e,onetoc2:e,mpp:"ms-project",notebook:e,pot:f,potm:f,potx:f,ppa:f,ppam:f,pps:f,ppsm:f,ppsx:f,ppt:f,pptm:f,pptx:f,pub:"ms-publisher",vdw:h,vsd:h,vsdm:h,vsdx:h,vsl:h,vss:h,vssm:h,vssx:h,vst:h,vstm:h,vstx:h,xla:g,xlam:g,xll:g,xls:g,xlsb:g,xlsm:g,xlsx:g,xlt:g,xltm:g,xltx:g}}
,,function(a,b,c){c.d(b,{a:function(){return d}});let d={none:1,pending:2,hasAccess:3}}
,function(a,b,c){c.d(b,{a:function(){return d}});class d{checkSizeChangeForRef(a){a&&a.current&&this.checkSizeChange(a.current)}checkSizeChange(a){if(a&&this._resizeCallback){let b=a.getBoundingClientRect();(this._cachedRect.width!==b.width||this._cachedRect.height!==b.height||this._cachedRect.top!==b.top||this._cachedRect.right!==b.right||this._cachedRect.left!==b.left||this._cachedRect.bottom!==b.bottom)&&(this._callbackDelayMilliseconds?setTimeout(()=>{this._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback()),this._cachedRect=b}}constructor(a){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0},this._resizeCallback=a,this._callbackDelayMilliseconds=20}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c("react-lib");function e(a){let b=d.useRef(a);b.current=a;let c=d.useRef();return c.current||(c.current=(...a)=>b.current.apply(null,a))}}
,,,,,function(a,b,c){c.d(b,{a:function(){return l},b:function(){return v},c:function(){return t},d:function(){return j},e:function(){return s},f:function(){return u},g:function(){return k},h:function(){return f},i:function(){return g},j:function(){return e},k:function(){return o},l:function(){return m},m:function(){return h},n:function(){return i},o:function(){return n},p:function(){return q},q:function(){return p},r:function(){return r}});var d=c("react-lib");let e=d.lazy(()=>c.e(25).then(c.bind(c,598))),f=d.lazy(()=>c.e(14).then(c.bind(c,599))),g=d.lazy(()=>c.e(23).then(c.bind(c,600))),h=d.lazy(()=>c.e(30).then(c.bind(c,591))),i=d.lazy(()=>c.e(32).then(c.bind(c,601))),j=d.lazy(()=>c.e(26).then(c.bind(c,582))),k=d.lazy(()=>c.e(20).then(c.bind(c,406))),l=d.lazy(()=>c.e(15).then(c.bind(c,602))),m=d.lazy(()=>c.e(24).then(c.bind(c,603))),n=d.lazy(()=>c.e(28).then(c.bind(c,604))),o=d.lazy(()=>c.e(27).then(c.bind(c,605))),p=d.lazy(()=>c.e(31).then(c.bind(c,606))),q=d.lazy(()=>c.e(33).then(c.bind(c,607))),r=d.lazy(()=>c.e(22).then(c.bind(c,608))),s=d.lazy(()=>c.e(29).then(c.bind(c,609))),t=d.lazy(()=>Promise.all([c.e("ondemand.resx"),c.e(18)]).then(c.bind(c,610))),u=d.lazy(()=>Promise.all([c.e("ondemand.resx"),c.e(19)]).then(c.bind(c,611))),v=d.lazy(()=>c.e(17).then(c.bind(c,612)))}
,function(a,b,c){c.d(b,{a:function(){return u},b:function(){return h},c:function(){return i},d:function(){return g}});var d,e,f,g,h,i,j=c(150),k=c(46),l=c(36),m=c(37),n=c(118),o=c(32),p=c(45),q=c(56),r=c(77),s=c(357);let t="ShareV3";(d=g||(g={})).Opening="Opening",d.Opened="Opened",d.Completed="Completed",(e=h||(h={})).MainLinkSettingsHint="MainLinkSettingsHint",e.PeoplePickerErrorLinkSettingsHint="PeoplePickerErrorLinkSettingsHint",e.CopyLinkSettingsHint="CopyLinkSettingsHint",e.RoleSelector="RoleSelector",e.Other="Unknown",(f=i||(i={})).People="People",f.Groups="Groups",f.Links="Links",f.Other="Unknown";class u{setEngagementExtraData(a){this._extraData={...this._extraData,...a}}getEngagementExtraData(){return this._extraData}linkSettingsOpened(a,b){this.log("LinkSettings.Opened",{...a,linkSettingsOpenSource:b||"Unknown"})}linkSettingsApplyClicked(a){this.log("LinkSettings.ApplyClicked",a)}linkSettingsCancelClicked(a){this.log("LinkSettings.CancelClicked",a)}linkSettingsLearnMoreClicked(a){this.log("LinkSettings.LearnMoreClicked",a)}linkSettingsOnAllowEditingClicked(a){this.log("LinkSettings.AllowEditingClicked",a)}linkTrackLinkClicked(a){this.log("LinkSettings.TrackLinkClicked",a)}linkSettingsLinkTypeChanged(a){this.log("LinkSettings.LinkTypeChanged",a)}manageAccessNumberOfSharingPrincipals(a){this.log("ManageAccess.NumberOfSharingPrincipals",a)}manageAccessOpened(a){this.log("ManageAccess.Opened",a)}manageAccessAddressBarLinkTypeClicked(a){this.log("ManageAccess.AddressBarLinkTypeClicked",a)}manageAccessFacePileClicked(a){this.log("ManageAccess.FacePileClicked",a)}manageAccessRemoveDirectAccess(a){this.log("ManageAccess.RemoveDirectAccess",a)}manageAccessLinkCopyButtonClicked(a){this.log("ManageAccess.LinkCopyClicked",a)}manageAccessLinkDetailsClicked(a){this.log("ManageAccess.LinkDetailsClicked",a)}manageAccessLinkInviteesToggled(a,b){this.log("ManageAccess.LinkInviteesToggled",{...b,isExpanded:a})}manageAccessAdvancedLinkClicked(a){this.log("ManageAccess.AdvancedLinkClicked",a)}manageAccessLinkSectionShareClicked(a){this.log("ManageAccess.LinkSectionShareClicked",a)}manageAccessGrantAccessClicked(a){this.log("ManageAccess.DiretAccessSectionGrantAccessClicked",a)}manageAccessV3Opened(a){this.log("ManageAccessV3.Opened",a)}manageAccessV3NumberOfSharingPrincipals(a){this.log("ManageAccessV3.NumberOfSharingPrincipals",a)}manageAccessV3NumberOfLinks(a){this.log("ManageAccessV3.NumberOfLinks",a)}manageAccessV3AdvancedSettingsClicked(a){this.log("ManageAccessV3.AdvancedSettingsClicked",a)}manageAccessV3UserDidSearch(a){this.log("ManageAccessV3.UserDidSearch",a)}manageAccessV3GrantAccessClicked(a){this.log("ManageAccessV3.GrantAccessClicked",a)}manageAccessV3StopSharingClicked(a){this.log("ManageAccessV3.StopSharingClicked",a)}manageAccessV3QuickfindHotkeyUsed(a){this.log("ManageAccessV3.QuickfindHotkeyUsed",a)}compactRoleSelectorClicked(a){this.log("RoleSelectorCompact.Clicked",a)}linkSettingsInCompactRoleSelectorClicked(a){this.log("RoleSelectorCompact.LinkSettingsClicked",a)}SharingRoleChangedFromCompactRoleSelector(a){this.log("SharingRoleChangedFromCompactRoleSelector",a)}SharingRoleChangedFromLargeRoleSelector(a){this.log("SharingRoleChangedFromLargeRoleSelector",a)}manageAccessV3NavClicked(a,b,c){this.log("ManageAccessV3.NavigationClicked",{...c,sectionName:a||"Unknown",sectionItemCount:b})}manageAccessV3ShareClicked(a,b){this.log("ManageAccessV3.ShareClicked",{...b,shareLocation:a})}manageAccessV3PrincipalDetailsClicked(a,b){this.log("ManageAccessV3.PrincipalDetailsClicked",{...b,principalType:a})}manageAccessV3PrincipalRemoveDirectAccess(a,b){this.log("ManageAccessV3.PrincipalRemoveDirectAccess",{...b,principalType:a})}manageAccessV3CancelPermissionUpdate(a){this.log("ManageAccessV3.CancelPermissionUpdate",a)}renderSharingInfoBar(a){this.log("SharingInfoBar.Rendered",a)}simplifiedV2TeachingBubbleShown(a){this.log("SimplifiedV2TeachingBubble.Shown",a)}simplifiedV2TeachingBubbleDismissed(a){this.log("SimplifiedV2TeachingBubble.Dismissed",a)}simplifiedV2TeachingBubbleCompleted(a){this.log("SimplifiedV2TeachingBubble.Completed",a)}simplifiedV2TeachingBubbleAbandoned(a){this.log("SimplifiedV2TeachingBubble.Abandoned",a)}shareToTeamsTeachingBubbleShown(a){this.log("ShareToTeamsTeachingBubble.Shown",a)}linkSettingsInfoMessageClick(a){this.log("LinkSettingsInfoMessage.Click",a)}shareCompleted(a){a={...a,compactRoleSelectorClicked:this._engagmentCounts["RoleSelectorCompact.Clicked"]>0,linkSettingsOpened:this._engagmentCounts["LinkSettings.Opened"]>0,sharingRoleChangedFromCompactRoleSelector:this._engagmentCounts.SharingRoleChangedFromCompactRoleSelector>0},this.log("Completed",a)}sendACopyClicked(a){this.log("SendACopy.Clicked",a)}sendACopyOfficeClicked(a){this.log("SendACopy.OfficeClicked",a)}sendACopyPdfClicked(a){this.log("SendACopy.PdfClicked",a)}whoElseHasAccessClicked(a){this.log("WhoElseHasAccess.Clicked",a)}externalSharingCslError(a){this.log("externalSharingCslError",a)}copyLinkInterruptOpened(a){this.log("copyLinkInterruptOpened",a)}copyLinkInterruptEditLinkChosen(a){this.log("copyLinkInterruptEditLinkChosen",a)}copyLinkInterruptExistingLinkChosen(a){this.log("copyLinkInterruptExistingLinkChosen",a)}copyLinkInterruptCancelled(a){this.log("copyLinkInterruptCancelled",a)}copyLinkNotificationAutoCopyFailed(a){this.log("copyLinkNotificationAutoCopyFailed",a)}copyButtonClickedAfterAutoCopyFailed(a){this.log("copyButtonClickedAfterAutoCopyFailed",a)}shareErrorFileIsUploading(a){this.log("shareError.FileUploading",a)}webShareToTeamsTargetClicked(a){this.log("ShareToTeams.TeamsTargetClicked",a)}onLinkParticipantOpenDelete(a){this.log("ShareLinkParticipants.OpenParticipantDeletionDialog",a)}onLinkParticipantDelete(a){this.log("ShareLinkParticipants.ParticipantDeleted",a)}peoplePickerLinkedinSuggestions(a,b){this.log("PeoplePicker.Suggestions",{...a,linkedinSuggestionsCount:j.e(b)})}onShareLinkDelete(a){this.log("ShareLink.Delete",a)}logShareLinkGeneration(a,b){this.log("ShareV3.odspShareLink",{...b,allowsAnonymousAccess:a.allowsAnonymousAccess,audience:a.audience,blockDownload:a.blockDownload,createdViaCopyLinkCommand:a.createdViaCopyLinkCommand,hasDescription:!!a.description,hasExpiration:!!a.expiration,hasPassword:a.hasPassword,numOfInvitees:a.invitees?a.invitees.length:0,isActive:a.isActive,isAddressBarLink:a.isAddressBarLink,isCreateOnlyLink:a.isCreateOnlyLink,isEdit:a.isEdit,isManageList:a.isManageList,isReview:a.isReview,isUnhealthy:a.isUnhealthy,shareId:a.shareId,sharingLinkStatus:a.status,trackLinkUsers:a.trackLinkUsers})}logNumberOfUnhealthyLinks(a){this.log("numberOfUnhealthyLinks",{numUnhealthyLinks:a})}logShareObject(a,b){this.log("ShareObjectV2",{sharingRole:k.a[b],numOfInvitees:a.length})}showSensitivityLabel(a){this.log("showSensitivityLabel",a)}hoverOverSensitivityLabel(a){this.log("hoverOverSensitivityLabel",a)}getSensitivityLabel(a){this.log("getSensitivityLabel",a)}modifiedSummary(a){this.log("modifiedSummary",a)}deletedSummary(a){this.log("deletedSummary",a)}summarizationCopilotEnabled(a,b){this.log("summarizationCopilotEnabled",{...a,copilotFeatureEnabled:b})}summarizationEnabled(a,b){this.log("summarizationEnabled",{...a,summaryEnabled:b})}summarizationClick(a,b){this.log("summarizationClick",{...a,summaryClick:b})}summarizationStatus(a,b){this.log("summarizationStatus",{...a,summaryStatus:b})}summarizationSent(a,b){this.log("summarizationSent",{...a,summarySent:b})}summarizationFeedback(a,b){this.log("summarizationFeedback",{...a,feedbackIsPositive:b})}summarizationDisabledReasonsMask(a,b){this.log("summarizationDisabledReasonsMask",{...a,summaryDisabledReasonMask:b})}summarizationV2Candidate(a,b,c){this.log("summarizationV2Candidate",{...a,summaryV2Candidate:b}),this.log("summarizationV2Encrypted",{...a,isFileEncrypted:c})}discoverableByOrganizationToggle(a){this.log("DiscoverableByOrganization",{enabled:a})}discoverableMessageBarClicked(){this.log("DiscoverableByOrganization.MessageBarClicked")}discoverableByOrganizationDoNotShowAgainChecked(a){this.log("DiscoverableByOragnization.DoNotShowAgain",{checked:a})}logEvent(a,b){this.log(g[a],b)}log(a,b){void 0===this._engagmentCounts[a]?this._engagmentCounts[a]=1:this._engagmentCounts[a]++;let c={...this._extraData,...b},d=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,e=location.href.toLowerCase().indexOf("www.odwebp.svc.ms")>=0,f=(0,q.a)(location.search.substring(1)),g="12"===f.p,h=!!f.migratedhosting&&"true"===f.migratedhosting.toLowerCase(),i={...c,clientId:l.a[c.clientId],scenarioId:c.scenarioId,mode:m.a[c.mode],shareType:n.a[c.shareType],audience:o.a[c.audience],shareTargets:this._getFriendlyShareTargets(c.shareTargets),sharingLinkKind:p.a[c.sharingLinkKind],isShareDialogASPXHosted:d,isP12:g,isMigratedhosting:h,isMicroServiceHosted:e,...void 0===c.shareViewState?{}:{shareViewState:s.a[c.shareViewState]}},j={name:0===a.indexOf(t)?a:`${t}.${a}`,webTemplateId:c.webTemplateId?c.webTemplateId.toString():void 0,docId:c.itemUniqueId,extraData:i};(this._manager?r.a.withManager(this._manager):r.a).logData(j)}_getFriendlyShareTargets(a){let b=[];if(a)for(let c of a)b.push(n.a[c]);return b}constructor(a,b){this._manager=a,this._extraData=b,this._engagmentCounts={}}}}
,function(a,b,c){c.d(b,{a:function(){return m},b:function(){return i}});var d=c(19),e=c(0),f=c(396);let g=!e.a.isActivated("F834A9BA-87BE-487C-BB7D-141AB22CAEA1"),h=!e.a.isActivated("35A76B1F-89F5-403B-A002-47D487412EE4"),i=!e.a.isActivated("E765194C-0589-4A4C-BF5D-E14F426B254E"),j="/_layouts/15/SignOut.aspx";window.FilesConfig&&window.FilesConfig.SuiteNavConfig&&window.FilesConfig.SuiteNavConfig.Urls&&!window.FilesConfig.SuiteNavConfig.Urls.SignOut&&(window.FilesConfig.SuiteNavConfig.Urls.SignOut=j);let k=window?._spPageContextInfo,l=window&&window.FilesConfig||{...k?.userHexCid?{hcid:window._spPageContextInfo.userHexCid}:{},...f.b&&k?{env:k.cloudType,df:k.cloudType&&("prodbubble"===k.cloudType||"spdf"===k.cloudType||"edog"===k.cloudType),SuiteNavConfig:{Locale:k.currentUICultureName,...!i||!k.isAnonymousGuestUser?{UserId:k.userPuid}:{},Urls:{SignOut:j},UserDisplayName:k.userDisplayName}}:{},...k?.mpcUrl?{mpcDomain:k.mpcUrl}:{},...g?{appId:"1141147648"}:{}};l.skyDrivePickerOAuth||(l.skyDrivePickerOAuth="oauth"),!l.oauthToken&&window&&(l.oauthToken=new d.a(window.location.href).getQueryParameter("access_token")),h&&(l.skyApiDomain||(l.skyApiDomain="https://skyapi.onedrive.live.com"),l.storageDomain||(l.storageDomain="https://storage.live.com"));let m=l}
,,function(a,b,c){c.d(b,{a:function(){return h},b:function(){return g.a}});var d=c(94),e=c(11),f=c(3),g=c(35);let h=(0,d.a)({eventName:"Api,Qos,",shortEventName:"Api"},{url:e.a.String,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}},f.a).withData({privacyClassification:e.b.requiredService})}
,,,function(a,b,c){c.d(b,{a:function(){return d}});let d={none:0,link:1,linkV2:2,linkInheritance:3,linkBundle:4,direct:5,participant:6,linkSettings:7,back:8,shareDialogPasswordOnly:9,shareDialogExpirationOnly:10,shareDialogPasswordAndExpiration:11,copyInterruptUpdate:12,copyInterruptRemove:13,addressBarLinkOff:14,shareDialogExternalSharing:15}}
,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(30),e=c(11);let f=(0,d.a)({eventName:"Trace,",shortEventName:"Trace"},{message:e.a.String,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}}).withData({privacyClassification:e.b.requiredService,privacyDataTypes:["browsingHistory"]})}
,function(a,b,c){c.d(b,{a:function(){return i}});var d=c(258),e=c(42),f=c(35);let g="GetSchemaException";function h(a,b,c){let d={resultType:a};return b&&(d.resultCode=b),c&&(d.error=c),d}function i(a,b,c,i,j){let k,l=new a(b);try{k=c()}catch(a){throw l.end(h(f.a.Failure,"PromiseCreationFailed",(0,e.c)(a.toString()))),a}return k.then(a=>{let b;if(i)try{b=i(a)}catch(a){b=h(f.a.Failure,g,(0,e.c)(a.toString()))}else b=h(f.a.Success);l.end(b)},a=>{let b;if(j)try{b=j(a)}catch(a){b=h(f.a.Failure,g,(0,e.c)(a.toString()))}else b=a?h(a instanceof Error&&"Canceled"===a.name?f.a.ExpectedFailure:f.a.Failure,void 0,(0,e.c)((0,d.a)(a),"unsafe")):h(f.a.Failure);l.end(b)}),k}}
,,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={})).outOfBox="outOfBox",e.custom="custom",e.Unknown="Unknown"}
,,function(a,b,c){var d=c(3),e=c(30),f=c(11);let g=(0,e.a)({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0},{message:f.a.String,stack:f.a.String,builtStack:f.a.String,line:f.a.Number,col:f.a.Number,url:f.a.String,privacyClassification:{isPrefixingDisabled:!0,type:f.a.String}}).withData({privacyClassification:f.b.requiredService,privacyDataTypes:["productAndServicePerformance"]});var h=c(427),i=c(0),j=c(78),k=c(95),l=c(436);let m=0,n=i.a.isActivated("77D2C451-10BD-4FF5-B5F0-A71B162640D5"),o=i.a.isActivated("BD012595-DBE3-469D-ACAA-33494B9805E1"),p=i.a.isActivated("6C46088C-BA1D-4AA5-8FDC-4CF0FCF6A743"),q=i.a.isActivated("8124A385-5729-43AC-B1C9-D54AD0872A5D"),r=i.a.isActivated("36B91871-323F-47AE-856A-593D771BB6C5"),s=[a=>"string"==typeof a&&0===a.indexOf("ResizeObserver loop limit exceeded"),a=>"string"==typeof a&&0===a.indexOf("ResizeObserver loop completed with undelivered notifications")];function t(a,b,c){if(!p){let e;!q&&a&&"object"==typeof a&&a.extraData&&"object"==typeof a.extraData&&"string"==typeof a.extraData.qosName&&(e=a.extraData.qosName);let f=new d.a({name:`UnhandledError${e?`.${e}`:""}`,startTimeOverride:0}),g=(0,k.getErrorMessage)(b);m<100?f.end((0,l.a)((0,j.a)(a),{...g?{error:g}:{},...c?{extraData:c}:{}})):100===m&&f.end((0,l.a)((0,j.a)(a),{resultCode:"MaxErrorCountLimit",...g?{error:g}:{},...c?{extraData:c}:{}})),m++}}window.onerror=function a(b,c,d,e,f){let i=s.some(a=>a(b,f));if(!o&&i)return;try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&!i&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[b,c,d,e,f])}catch(a){}if(!p)return void t(f,(0,k.getErrorMessage)(b),{url:c,line:d,col:e});let j=f&&f.stack,l=(function b(){let c,d=[];try{for(c=arguments.callee;c===a||c===b;)c=c?c.caller:c}catch(a){c=null}let e=0;try{for(;c&&e<10;)d.push(function(a){let b;if(a){let d=a&&a.toString?a.toString():"InvalidMethod()",e=9*(8===d.indexOf(" ")),f=d.indexOf(")")+1;if(0===(b=d.substring(e,f)).indexOf("function")||3>b.indexOf("(")){var c;let a=f+50;(c=d=d.replace(/\s\s*/g," "))&&c.length>a&&(c=c.substr(0,a-3)+"..."),b=c+(a<d.length?"}":"")}}return b}(c)),c=c.caller,e++}catch(a){}return d})().join("\n");j=j?j.replace(/[ \t]{2,}/g," "):"",l=l.replace(/[ \t]{2,}/g," ");let q=!1;if(n)q=!0;else for(let a of(0,h.a)())if(-1!==c.indexOf(a)){q=!0;break}let r={message:b,url:q?c:"<dropped-url-string>",line:d,col:e,stack:j,builtStack:l};m<100?g.logData(r):100===m&&g.logData({message:"Hit max error limit of 100",url:"NA",line:0,col:0,stack:"",builtStack:""}),m++},r||window.addEventListener("unhandledrejection",a=>{t(a.reason,void 0,void 0)})}
,function(a,b,c){var d=c(60),e=c(43),f=c(30),g=c(11);let h=(0,f.a)({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0},{message:g.a.String,requireModules:g.a.Array,requireType:g.a.String,stack:g.a.String});var i=c(72);let j=new d.a("RequireJS",e.a.session),k="error";class l{static log(a){h.logData(a);let b=j.getValue(k)||[];b.push(a.message),j.setValue(k,b),a&&("define"===a.requireType||"require"===a.requireType)&&a.stack&&a.requireModules&&i.a.log(a)}static registerRequireOnError(){if(window.requirejs&&"function"==typeof window.requirejs){let a=window.requirejs.onError;window.requirejs.onError=b=>{l.log(b),a&&!b.isTest&&a(b)}}}}l.registerRequireOnError()}
,function(a,b,c){var d=c(72),e=c(99),f=c(7),g=c(59),h=c(258),i=c(30),j=c(11);let k=(0,i.a)({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise"},{message:j.a.String,extraData:j.a.String}).withData({privacyClassification:j.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}),l=new class{log(a){let b=a.id;if(a.parent){a.handler&&delete this._outstandingPromiseErrors[b];return}this._outstandingPromiseErrors[b]=a,1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(()=>{let a=this._outstandingPromiseErrors;this._outstandingPromiseErrors={},Object.keys(a).forEach(b=>{let c=a[b],e=c.exception?c.exception:c.error;if(e instanceof Error||e&&e.stack?f.c.isCanceled(c)||d.a.log(e):k.logData({message:"Promise with no error callback",extraData:(0,h.a)(e)}),window.console&&console.log){let a="Promise with no error callback:"+c.id;console.warn?console.warn(a):console.log(a),console.log(c),e&&e.stack&&console.log(e.stack)}})},0)}constructor(){this._outstandingPromiseErrors={},this._async=new e.a}};new g.a(l).on(f.c,"error",l.log)}
,function(a,b,c){c.r(b),c.d(b,{default:function(){return B}});var d,e,f=c(102),g=c(44),h=c(128),i=c(7),j=c(277);let k=[.537,.349,.216,.184,.145,.082,.043,.027],l=[.537,.45,.349,.216,.184,.145,.082,.043],m=[.88,.77,.66,.55,.44,.33,.22,.11],n=[.11,.22,.33,.44,.55,.66,.77,.88],o=[.96,.84,.7,.4,.12],p=[.1,.24,.44];function q(a,b){return{h:a.h,s:a.s,v:a.v-a.v*b}}function r(a,b){return{h:a.h,s:a.s-a.s*b,v:a.v+(100-a.v)*b}}(d=e||(e={}))[d.Unshaded=0]="Unshaded",d[d.Shade1=1]="Shade1",d[d.Shade2=2]="Shade2",d[d.Shade3=3]="Shade3",d[d.Shade4=4]="Shade4",d[d.Shade5=5]="Shade5",d[d.Shade6=6]="Shade6",d[d.Shade7=7]="Shade7",d[d.Shade8=8]="Shade8";class s{static generateFabricColors(a,b=!1){let c={themeDarker:e.Shade8,themeDark:e.Shade7,themeDarkAlt:e.Shade6,themeLight:e.Shade3,themeLighter:e.Shade2,themeLighterAlt:e.Shade1,themePrimary:e.Unshaded,themeAccent:e.Unshaded,themeSecondary:e.Shade5,themeTertiary:e.Shade4},d=s._getDefaultThemeTokenMap(),f=j.a.fromRgba(a.R,a.G,a.B);for(let a in c){let e=c[a];d[a]=function(a,b,c){if(!a||0===b||!("number"==typeof b&&b>=0&&b<=8))return a;let d=r,e=q;c&&(d=q,e=r);let f=function(a){let b=NaN,{R:c,G:d,B:e}=a,f=Math.max(c,d,e),g=f-Math.min(c,d,e);return 0===g?b=0:c===f?b=(d-e)/g%6:d===f?b=(e-c)/g+2:e===f&&(b=(c-d)/g+4),(b=Math.round(60*b))<0&&(b+=360),{h:b,s:Math.round((0===f?0:g/f)*100),v:Math.round(f/255*100)}}(a),g=function(a){let{s:b,v:c}=a,{h:d}=a,e=(2-(b/=100))*(c/=100),f=b*c;return f/=e<=1?e:2-e,{h:d,s:100*(f=f||0),l:100*(e/=2)}}(f),h=b-1;return function(a){let{s:b,v:c}=a,{h:d}=a,e=[],f=(c/=100)*(b/=100),g=d/60,h=f*(1-Math.abs(g%2-1)),i=c-f;switch(Math.floor(g)){case 0:e=[f,h,0];break;case 1:e=[h,f,0];break;case 2:e=[0,f,h];break;case 3:e=[0,h,f];break;case 4:e=[h,0,f];break;case 5:e=[f,0,h]}return j.a.fromRgba(Math.round(255*(e[0]+i)),Math.round(255*(e[1]+i)),Math.round(255*(e[2]+i)))}(f=255===a.R&&255===a.G&&255===a.B?q(f,k[h]):0===a.R&&0===a.G&&0===a.B?r(f,l[h]):g.l/100>.8?e(f,n[h]):g.l/100<.2?d(f,m[h]):h<o.length?d(f,o[h]):e(f,p[h-o.length]))}(f,e,b)}let g=d.themeAccent;if(d.themeAccentTranslucent10=g?j.a.fromRgba(g.R,g.G,g.B,.1*j.a.maxComponent):null,b){let a="#4f4f4f",b="#484848",c={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:a,neutralQuaternaryAlt:b,cmdbarSelected:a,cmdbarSelectedHover:b,neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(let a in c)c.hasOwnProperty(a)&&(d[a]=j.a.fromHtmlColor(c[a]))}return d}static _getDefaultThemeTokenMap(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}}}var t=c(104),u=c(6);let v={ODB:60044},w={ODB:62505};class x{static makeWebThemeRestUrl(a,b,c){let d=a;d&&"/"===d[d.length-1]&&(d=d.substring(0,d.length-1)),d=t.a.escapeUrlForCallback(d);let e=t.a.escapeUrlForCallback(d)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+t.a.encodeURIComponent(b);return c&&(e+="&ThemeOverride="+t.a.encodeURIComponent(c)),e}static processWebThemeRestResponse(a,b){let c,d=JSON.parse(a);return d&&d.d&&d.d.GetContextWebThemeData&&(c=JSON.parse(d.d.GetContextWebThemeData)),x.processRawThemeData(c,b)}static processRawThemeData(a,b){if(a){let c,d,e,f,g,h=x.coerceToColor,i=x.SetColorIfMissing,k={},l=a.Palette?a.Palette.Colors:{};k=x.convertColorsToRgba(l);let m=s.generateFabricColors(k.ContentAccent1,a.IsInverted),n=h(k.PageBackground)||h(a.IsInverted?"#1b1a19":"#ffffff"),o=h(k.BackgroundOverlay)||null,p=Math.round(.4*j.a.maxComponent);for(let a in m)i(k,a,m[a]);if(i(k,"white",n),i(k,"primaryBackground",j.a.clone(n)),i(k,"primaryText",m.primaryText||h("#333")),i(k,"whiteTranslucent40",n&&j.a.fromRgba(n.R,n.G,n.B,p)),i(k,"backgroundOverlay",o),i(k,"suiteBarBackground",h(k.SuiteBarBackground)||null),i(k,"suiteBarText",h(k.SuiteBarText)||null),i(k,"suiteBarDisabledText",h(k.SuiteBarDisabledText)||null),i(k,"topBarBackground",h(k.TopBarBackground)||null),i(k,"topBarText",h(k.TopBarText)||null),i(k,"topBarHoverText",h(k.TopBarHoverText)||null),i(k,"dialogBorder",h(k.DialogBorder)||null),b&&x.isThemeV2Schema(a.ThemeSchemaVersion)&&(i(k,"backgroundColor",h("#ffffff")),a.OtherMode&&(c=x.processRawOtherModeColors(a.OtherMode)),a.SecondaryColors&&(d=x.processRawSecondaryColors(a.SecondaryColors)),e=a.ThemeSchemaVersion,f=a.DisplayMode),a.FontPackage){let b=a.FontPackage.FontFaces&&a.FontPackage.FontFaces.map(a=>({fontFamily:a.FontFamily,path:a.Path,remappedPaths:a.RemappedPaths})),c={};if(a.FontPackage.FontSlots)for(let b of Object.keys(a.FontPackage.FontSlots)){let d=a.FontPackage.FontSlots[b];d&&(c[b]={fontFamily:d.FontFamily,fontVariationSettings:d.FontVariationSettings,...u.a.isFeatureEnabled(v)&&u.a.isFeatureEnabled(w)?{fontFace:d.FontFace}:{}})}g={fontFaces:b,fontSlots:c,fontPackageSource:a.FontPackage.Source}}return{backgroundImageUri:a.BackgroundImageUri,cacheToken:a.ThemeCacheToken,cacheMaxAge:a.ThemeCacheMaxAge,isDefault:a.IsDefault,isInverted:a.IsInverted,palette:k,version:a.Version,fontPackage:g,...e&&{themeSchemaVersion:e},...f&&{displayMode:f},...c&&{otherMode:c},...d&&{secondaryColors:d}}}return{backgroundImageUri:"",cacheToken:"",cacheMaxAge:void 0,isDefault:!0,isInverted:!1,palette:{},version:""}}static convertColorsToRgba(a){let b={};for(let c in a)if(a.hasOwnProperty(c)){let d=x.coerceToColor(a[c]);d&&(b[c]=d)}return b}static processRawOtherModeColors(a){let b=a.palette??{};return Object.keys(b).length>0&&x.SetColorIfMissing(a,"backgroundColor",x.coerceToColor("#ffffff")),{palette:x.convertColorsToRgba(b),isInverted:a.isInverted,displayMode:a.displayMode}}static processRawSecondaryColors(a){return{light:x.processColorPair(a.light),dark:x.processColorPair(a.dark)}}static processColorPair(a){return a?a.map(a=>(x.SetColorIfMissing(a,"backgroundColor",x.coerceToColor("#ffffff")),{themePrimary:x.coerceToColor(a.themePrimary),backgroundColor:x.coerceToColor(a.backgroundColor),variantType:3*("3"===a.variantType)})):[]}static isThemeV2Schema(a){if(a){let b=/^([0-9]+)\.([0-9]+)(?:\.([0-9]+)(?:\.([0-9]+))?)?$/g.exec(a);if(b)return 2===parseInt(b[1],10)}return!1}static coerceToColor(a){let b;return a?"string"==typeof a||a instanceof String?b=j.a.fromHtmlColor(String(a)):"DefaultColor"in a?b=x.coerceToColor(a.DefaultColor):"R"in a&&"G"in a&&"B"in a&&(b=j.a.fromRgba(a.R,a.G,a.B,a.A)):b=null,b}static SetColorIfMissing(a,b,c){a[b]||(a[b]=c)}}var y=c(140),z=c(178);let A=y.c?"#0078d4":"#03787c";class B{getCacheToken(){let a="",b=this._pageContext;if(b){let c=Number(b.webTemplate),d=c!==g.b.mySite&&c!==g.b.mySiteHost?b.groupColor:A;a=b.themedCssFolderUrl||d}return a}loadTheme(a){return!a&&this._dataPromise?this._dataPromise:this.getCacheToken()?(this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme(),this._dataPromise):this._dataPromise=i.c.resolve()}loadGeneratedTheme(){let a=this._pageContext.groupColor||A,b=j.a.fromHtmlColor(a);if(!b)return i.c.resolve();{let c={backgroundImageUri:void 0,cacheToken:a,cacheMaxAge:void 0,isDefault:!1,isInverted:!1,palette:s.generateFabricColors(b),version:"1"};return i.c.resolve(c)}}loadServerTheme(){let a=(0,z.c)(this._pageContext),b=(0,f.a)(this._pageContext),c=this._pageContext.currentUICultureName,d=this._pageContext.themedCssFolderUrl,e=this.getCacheToken()===d,g=x.makeWebThemeRestUrl(b,c,e&&d||void 0),h=b=>(this._data=x.processWebThemeRestResponse(b,a),this._data),j=this._dataRequestor.getData({url:g,parseResponse:h,qosName:"WebThemeDataSource.LoadData",method:"GET"});return j.done(void 0,()=>{this._dataPromise=i.c.resolve()}),j}needsRequestDigest(a){return!1}constructor(a){this._pageContext=a,this._dataRequestor=new h.a({qosName:"WebThemeDataSource"},{pageContext:a})}}}
,function(a,b,c){c.d(b,{enableAnalyzeImageAugloopFlight:function(){return j},a:function(){return k},b:function(){return l}});var d,e,f=c(6),g=c(0),h=c(79);let i=!g.a.isActivated("EEAA73AF-8769-4895-9A57-3A03F7E1AC29");(d=e||(e={})).enableAnalyzeImage="enableAnalyzeImage",d.enableODSPCortexImage="enableODSPCortexImage";let j={name:"enableAnalyzeImage",experiment:90269,feature:i?{ODB:61293,ODC:!1}:{ODB:61293}},k={name:"enableODSPCortexImage",feature:i?{ODB:62081,ODC:!1}:{ODB:62081}};function l(a,b){var c;if(b){if(a.appSpecific&&-1===a.appSpecific.indexOf(b)||a.appsExcluded&&-1!==a.appsExcluded.indexOf(b))return!1}else if(a.appSpecific||a.appsExcluded)return!1;return!(!(a.feature&&f.a.isFeatureEnabled(a.feature))&&(!a.killSwitch||g.a.isActivated(a.killSwitch)))||!!(a.experiment&&(c=a.experiment,1===(0,h.c)(c,window._spPageContextInfo))||a.isEnabled&&a.isEnabled())}}
,,,,,,function(a,b,c){c.d(b,{a:function(){return e},b:function(){return g}});var d=c(169);class e{toString(){let a=this.flags;return`${this.key}${a&d.a.async?".async":a&d.a.suspensible?".suspensible":a&d.a.lazy?".lazy":""}${a&d.a.local?".local":""}${a&d.a.optional?".optional":""}${a&d.a.bypass?".bypass":""}`}constructor(a,b){this.key=a,this.flags=b}}function f(a){return{get:function(){return new e(this.key,this.flags|a)}}}let g={async:f(d.a.async|d.a.lazy),suspensible:f(d.a.suspensible),lazy:f(d.a.lazy),local:f(d.a.local),optional:f(d.a.optional),bypass:f(d.a.bypass)};Object.defineProperties(e.prototype,g)}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});class d{addCallback(a){this._callbacks.push(a)}dispose(){let a;for(;a=this._callbacks.pop();)a.call(this._owner)}constructor(a){this._callbacks=[],this._owner=a}}function e(a){return"function"==typeof a.dispose}function f(a,b){let c,e,f,g=a.dispose;return("function"==typeof g&&g.disposalChain||(c=new d(a),e=a.dispose,f=()=>{c.dispose(),e&&(a.dispose=e,a.dispose())},a.dispose=f,f.disposalChain=c,c)).addCallback(b),a}}
,function(a,b,c){var d=c(171),e=c(5),f=c(248);class g{get scope(){return this._Component_scope}get isDisposed(){return this.scope.isDisposed}dispose(){this._Component_scope.dispose()}managed(a){return this.resources&&(a=this.resources.injected(a)),this.scope.attached(a)}child(a){let b;return b=a instanceof e.a?this.resources.consume(a):this.resources?this.resources.injected(a,{injectChildResourceScope:!0}):a,this.scope.attached(b)}constructor(a={},b={}){const{id:c="Component"}=a,{resources:e=b.resources?new f.a(b.resources,{owner:c,internalSource:"Component"}):a.resources}=this;this.id=c,this.resources=e,this._Component_scope=new d.a}}g.dependencies={resources:f.b},b.a=g}
,function(a,b,c){c.d(b,{a:function(){return K},b:function(){return M}});var d=c(246),e=c(131),f=c(0),g=c(70),h=c(5),i=c(169);function j(a,b){return c=>{if(Array.isArray(c)&&"function"==typeof c[0])if("number"==typeof a&&a&i.a.optional)return;else if(b);else throw c[0](c[1],c[2]);return Promise.reject(c)}}class k{get(a,b){if(this._resource){let a=this._resource;return{error:void 0,consume:()=>a.instance}}let c=this.manager,d=this.entry.factory,{error:e,consume:f}=c.getAll(d.dependencies,b);return{error:e,consume:()=>{if(this._resource)return this._resource.instance;let a=d.create(f());return this._resource=a,a.disposable&&c.scope.attach(a.disposable),a.instance}}}promote(a){let{entry:b}=this;return new k({key:this.key,entry:{manager:a,loader:b.loader,factory:b.factory}})}debug(){let a,{loader:b}=this.entry;return this.entry.factory&&(a={type:this.entry.factory.constructor?.name||"Factory"},Object.keys(this.entry.factory.dependencies).length>0&&(a.dependencies=this.entry.factory.dependencies)),{...b?{loader:b}:{},...a?{factory:a}:{},...this._resource?{value:this._resource}:{}}}constructor(a){this.key=a.key,this.entry=a.entry,this.manager=a.manager,this._resource=void 0}}var l=c(173),m=c(424),n=c(245);function o(a){return a.length<1?" Consumed directly.":[...a,""].reverse().join("\n  Required by ")}function p(a){let b=a.flags;return b&i.a.async?new n.a(a.key,b&i.a.notAsync):a}function q(a){let b=new l.a;return a.then(a=>b.resolve(a),a=>b.reject(a)),b.promise}let r=new h.a({name:"asyncLoadBarrier"});class s{loadAsync(a,b,c,d){let e=a.key;if(this._isResourceScopeKey(e))return{bypass:t,promise:Promise.resolve(void 0)};let f=this._loadAsync(a,b,[a,...c],d);return{promise:f.promise.catch(j(a.flags,!0)),bypass:f.bypass}}loadAllAsync(a,b,c,d){if(a){let e=Object.keys(a),f=e.length;if(f>0){let g=[];for(;f--;){let h=a[e[f]];h&&g.push(this.loadAsync(h,b,c,d))}return{bypass:u(()=>{for(let a of g)a.bypass()}),promise:(0,m.a)(g.map(a=>a.promise))}}}return{bypass:t,promise:Promise.resolve(void 0)}}_loadAsync(a,b,c,d){let e,f=a.key,g=f.id,h=this._loadState,j=a.flags|b,k=h[g];if(k){if(d&&d.indexOf(f)>=0)throw Error(`${f} has a circular dependency.${o(d)} `);return j&i.a.bypass&&k.bypass(),k}if(j&i.a.async)return{bypass:t,promise:Promise.resolve(void 0)};let m=this._handleManager.getHandle(f);if(!m)return h[g]={bypass:t,promise:Promise.reject([v,a,c])};h[g]={bypass:t,promise:Promise.resolve(void 0)};let n=m.entry,p=n.factory;if(p)return h[g]=this.loadAllAsync(p.dependencies,j&i.a.loaderViral,c,d?[...d,f]:[f]);let q=n.loader;if(!q)return h[g]={bypass:t,promise:Promise.reject([v,a,c])};let r=this._root,{resolve:s,reject:w,promise:x}=new l.a;return!(j&i.a.bypass)&&r?r.wait().then(s).catch(w):s(),h[g]={bypass:u(()=>{j|=i.a.bypass,s(),e&&e()}),promise:x.then(()=>q.load()).then(a=>{n.factory=a;let b=a.dependencies;if(b){let a=this.loadAllAsync(b,j&i.a.loaderViral,c,d?[...d,f]:[f]);return e=a.bypass,a.promise}})}}constructor(a){this._handleManager=a.manager,this._isResourceScopeKey=a.isResourceScopeKey,this._loadState={},this._root=a.manager.consume(r.optional)}}function t(){}function u(a){return()=>{if(a){let b=a;a=void 0,b()}}}function v(a,b){return Error(`${a} is being loaded, but has no factory / loader.Check to ensure that either: 
  1) ${a} is defined with a 'factory' or 'loader' specified.
  2) A higher - level component calls 'expose', 'exposeFactory', or 'exposeAsync' for ${a}.${b.length<2?" Loaded directly.":["",...b.slice(1)].join("\n  Required by ")}`)}class w{load(){return this._cached?this._cached:(this._cached=q(this._loader.load())).then(a=>(this._loader=void 0,a),a=>(this._cached=void 0,Promise.reject(a)))}constructor(a){this._loader=a,this._cached=void 0}}let x=f.a.isActivated("7725284E-57AF-40CB-80D0-7BC054CEE8EB");class y{get isDisposed(){return this.scope.isDisposed}block(a){return this._expose(a)}isDescendantOf(a){return this._level>a._level}getHandle(a){let b=this,c=a.id;if(x){for(;!(c in b._handles)&&b._parent;)b=b._parent;let d=b._handles;return d[c]||this.options.useFactoriesOnKeys&&(a.factory&&(d[c]=new k({key:a,entry:{factory:a.factory,manager:b}}))||a.loader&&(d[c]=new k({key:a,entry:{loader:new w(a.loader),manager:b}})))||void 0}{let c,d;for(;!b._handlesMap.has(a)&&b._parent;)b=b._parent;let e=b._handlesMap;return e.get(a)||this.options.useFactoriesOnKeys&&(a.factory&&(c=new k({key:a,entry:{factory:a.factory,manager:b}}),e.set(a,c),c)||a.loader&&(d=new k({key:a,entry:{loader:new w(a.loader),manager:b}}),e.set(a,d),d))||void 0}}expose(a,b,c){return this._expose(a,d=>new k({key:a,entry:{factory:b.factory,loader:b.loader,manager:d},manager:c&&d}))}dispose(){this.scope.dispose(),x?this._handles={}:this._handlesMap=new Map,this._loader=void 0,this.get=D,this._getLoader=E}bind(a){let b=this.getHandle(a);return b?this._expose(a,a=>b.promote(a)):this}lock(){(this.options.exposeAfterConsumeMode??"allow")!=="allow"&&(this._isLocked=!0)}get(a,b){this.lock();let c=a.flags,d=a.key;if(c&i.a.async){let e,f=p(a),g=()=>this.get(f,b).consume();if(this._isResourceScopeKey(d))return{error:void 0,consume:()=>()=>e||(e=Promise.resolve(g()))};let h=this._getValidHandle(a,i.a.none,[]);if(h.handle)return{error:void 0,consume:()=>()=>e||(e=q(this._getLoader().loadAsync(f,i.a.none,[],[]).promise).then(g,j(c)))};if(c&i.a.optional)return{error:void 0,consume:()=>()=>Promise.resolve(void 0)};let k=h.error;return{error:k,consume:()=>{throw k[0](k[1],k[2])}}}if(c&i.a.suspensible){let c,e,f,g=(c=a.flags)&i.a.suspensible?new n.a(a.key,c&~i.a.suspensible):a,h=()=>this.get(g,b).consume();return{error:void 0,consume:()=>({read:()=>{if(this._isResourceScopeKey(d))return()=>h();let{error:c,consume:j}=this.get(g,b);if(c&&c[0]===A){if(f)throw f.error;throw e||(e=q(this._getLoader().loadAsync(a,i.a.none,[],[]).promise)).catch(a=>{let b=a instanceof Error?a:a[0](a[1],a[2]);throw f={error:b},b})}return j()}})}}let e=c&i.a.lazy;if(this._isResourceScopeKey(d)){let a,c=()=>(a||(a=this.scope.attach(this._createResourceScope(this,b||{owner:`${d}`}))),a);return{error:void 0,consume:e?()=>c:c}}{let f=this._getValidHandle(a,i.a.none,[]),g=f.handle;if(g){let{error:a,consume:c}=g.get(d,b||{owner:`${d}`});return{error:a,consume:e?()=>c:c}}{if(c&i.a.optional)return{error:void 0,consume:e?()=>()=>void 0:()=>void 0};let a=f.error;return{error:a,consume:()=>{throw a[0](a[1],a[2])}}}}}consume(a,b){return this.get(a,b).consume()}isExposed(a){return!!this._isResourceScopeKey(a.key)||!this.get(a).error}getAll(a,b){let c,d={},e=[];for(let f of Object.keys(a)){if(!a[f])continue;let{error:g,consume:h}=this.get(a[f],b);g&&!c&&(c=g),e.push(()=>{d[f]=h()})}return{error:c,consume:()=>{if(c)throw c[0](c[1],c[2]);for(let a of e)a();return d}}}resolve(a,b){return this.getAll(a,b).consume()}loadAsync(a,b,c,d){return this._getLoader().loadAsync(a,b,c,d)}loadAllAsync(a,b,c,d){return this._getLoader().loadAllAsync(a,b,c,d)}debug(){let a={};if(x)for(let[b,c]of Object.entries(this._handles))a[c?`${c.key.name} [${c.key.id}]`:b]=c?.debug();else for(let[b,c]of this._handlesMap)a[c?`${c.key.name} [${c.key.id}`:b.id]=c?.debug();return{parent:this._parent?.debug(),level:this._level,isLocked:this._isLocked,isDisposed:this.isDisposed,options:this.options,handles:a}}_getExposureError(a,b){this.lock();let c=a.flags,d=a.key;if(c&i.a.async){let b=this._getValidHandle(a,i.a.none,[]);if(b.handle||c&i.a.optional)return;return b.error}if(!(c&i.a.suspensible))if(this._isResourceScopeKey(d))return;else{let d=this._getValidHandle(a,i.a.none,[]),e=d.handle;if(e){let a=e.entry.factory;return this._getResolutionError(a.dependencies,b)}if(c&i.a.optional)return;return d.error}}_getResolutionError(a,b){for(let c of Object.keys(a)){if(!a[c])continue;let d=this._getExposureError(a[c],b);if(d)return d}}_getLoader(){return this._loader?this._loader:(this.lock(),this._loader=new s({manager:this,isResourceScopeKey:this._isResourceScopeKey}))}_getValidHandle(a,b,c){let d=a.key,e=d.id;if(c.indexOf(d)>=0)throw Error(`${d} has a circular dependency.${o(c)} `);let f=x?this._handles[e]:this._handlesMap.get(d);if(f&&f.manager)return B(f);let g=this.getHandle(d);if(!g)return C([z,a,c]);let h=a.flags|b,j=g.entry,l=j.factory;if(h&i.a.async&&j.loader)return B(g);if(!l)return C([A,a,c]);let m=c.push(d)-1,n=g.manager,p=h&i.a.local?this:n||j.manager,q=l.dependencies||{};for(let a of Object.keys(q)){let b=q[a];if(!b||this._isResourceScopeKey(b.key))continue;let d=this._getValidHandle(b,h&i.a.handleViral,c),e=d.handle;if(e){let a=e.manager||e.entry.manager;a.isDescendantOf(p)&&(p=a)}else if(!(b.flags&i.a.optional)||d.error[0]===A&&this.options.errorOnOptionalAsyncOnly)return d}return c.splice(m),n&&n===p||(g=new k({key:d,entry:j,manager:p}),x?p._handles[e]=g:p._handlesMap.set(d,g)),x?this._handles[e]=g:this._handlesMap.set(d,g),B(g)}_expose(a,b){if(this.isDisposed)throw Error("Cannot expose a resource on a ResourceScope that has been disposed.");if(this._isResourceScopeKey(a))throw Error("It is invalid to expose `resourceScopeKey`");let c=a.id,d=this._isLocked?this.scope.attach(new y(this,{owner:`${c}`})):this;if(x){let e=d._handles;if(e[c]&&this.options.noDoubleExpose)throw Error(`${a} has already been exposed / consumed at this scope.`);e[c]=b?b(d):void 0}else{let c=d._handlesMap;if(c.get(a)&&this.options.noDoubleExpose)throw Error(`${a} has already been exposed / consumed at this scope.`);c.set(a,b?b(d):void 0)}return d}constructor(a,b){let c;if(x?this._handles={}:this._handlesMap=new Map,this._isLocked=!1,this._loader=void 0,a instanceof y){if(a.isDisposed)throw Error("Parent ResourceScope has already been disposed!");c={...a.options,...b||{}},this._parent=a,this._level=a._level+1,this._isResourceScopeKey=a._isResourceScopeKey,this._createResourceScope=a._createResourceScope}else c=a||{},this._parent=void 0,this._level=0,this._isResourceScopeKey=a.isResourceScopeKey,this._createResourceScope=a.createResourceScope;this.scope=new e.a,this.options=c}}function z(a,b){return Error(`${a} is being consumed, but is not available in the current scope.
  1) Check to ensure that the dependency on this resource (and each step up the chain) is properly declared.
  2) If availability is expected, check to see if the target resource has a dependency that is only available in a child scope.${o(b)}`)}function A(a,b){return Error(`${a} is being consumed synchronously, but was exposed asynchronously and has not been loaded. Either:
  1) Ensure that the root call that is requesting this resource is a consumeAsync(). Or
  2) Ensure that the dependency on this resource is properly declared, so that it can be picked up by an earlier consumeAsync() or load() call.${o(b)}`)}function B(a){return{handle:a,error:void 0}}function C(a){return{handle:void 0,error:a}}function D(a){if(a instanceof n.a||a instanceof h.a)throw Error(`Cannot consume ${a} from a disposed ResourceScope.`);throw Error("Cannot resolve resources from a disposed ResourceScope.")}function E(){throw Error("Cannot load a resource from a ResourceScope that has been disposed.")}var F=c(425),G=c(97),H=c(132);let I=Symbol("unknown"),J=!f.a.isActivated("FC88BC67-4EB9-497C-891A-F9BC51F2BF7A");class K{static _getResourceScopes(a=!1){return(a?K._allDebugResourceScopes:K._allDebugResourceScopes.filter(a=>!a.internalSource)).map(b=>({owner:b.owner,...a?{internalSource:b.internalSource}:{},scope:b.scope.deref()}))}consume(a){if(this._lock(),a)return this._handleManager.consume(a)}consumeAsync(a){if(this._lock(),!a)return Promise.resolve(void 0);let b=this._handleManager,c=p(a);return q(b.loadAsync(c,i.a.none,[],[]).promise).then(()=>b.consume(c)).catch(j(c.flags))}load(a){return this._lock(),q(this._handleManager.loadAllAsync(a,i.a.none,[],[]).promise).catch(j(i.a.none))}exposeAsync(a,b){this._expose(a,{loader:new w(b)})}exposeFactory(a,b){this._expose(a,{factory:b})}expose(a,b){return this._expose(a,{factory:new G.a(b)},b),b}exposeFromPack(a){a.specifications.forEach((a,b)=>{a.factory?this.exposeFactory(b,a.factory):a.loader&&this.exposeAsync(b,a.loader)})}block(a){this._handleManager=this._prepareWrite(a).block(a)}bind(a){this._handleManager=this._prepareWrite(a).bind(a)}isDefined(a){if(this._lock(),!a)return!1;let b=this._handleManager;return!b.isDisposed&&!!b.getHandle(a)}isExposed(a){if(this._lock(),!a)return!1;let b=this._handleManager;return!b.isDisposed&&b.isExposed(a)}injected(a,b){let c=b?.injectChildResourceScope,e=b?.owner??a.name??"Injected",f=c?this._scope.attach(new K(this,{owner:e})):this;class g extends a{}return Object.defineProperty(g.prototype,"resources",{get:function(){return c&&(0,d.a)(this,L),Object.defineProperty(this,"resources",{value:f,configurable:!0,enumerable:!0,writable:!0}),f}}),g}resolve(a){return this._lock(),this._handleManager.resolve(a)}resolveAsync(a){return this.load(a).then(()=>this.resolve(a))}resolved(a,b){return(0,F.a)(a,this.resolve({...a.dependencies||{},...b||{}}))}resolvedAsync(a,b){return this.load({...a.dependencies||{},...b||{}}).then(()=>this.resolved(a,b))}exposeAlias(a,b){this.exposeFactory(a,new H.a(b))}dispose(){this._scope.dispose()}_debug(){return{owner:this._owner,manager:this._handleManager.debug()}}_expose(a,b,c){if(this._isLocked)throw Error("This resource scope is locked and cannot have new keys exposed. This means a resource has already been consumed or checked for exposure from this scope");this._handleManager=this._prepareWrite(a).expose(a,b,c)}_prepareWrite(a){return this._forkOnWrite?(this._forkOnWrite=!1,this._scope.attach(new y(this._handleManager,{owner:`${a.id}`}))):this._handleManager}_lock(){this._isLocked||(this._handleManager.options.exposeAfterConsumeMode??"allow")!=="reject"||(this._isLocked=!0)}constructor(a,b){let c,d;a instanceof K?(d=a._handleManager,a._lock(),c=b):a instanceof y?(d=a,c=b):c=a,c||(c={owner:I});const f=new e.a;if(d){if(d.scope.isDisposed)throw Error("Parent ResourceScope has already been disposed.");d.lock(),void 0!==c.exposeAfterConsumeMode||void 0!==c.noDoubleExpose?d=f.attach(new y(d,c)):(d.options.exposeAfterConsumeMode??"allow")==="allow"&&(this._forkOnWrite=!0)}else{const a={...c,isResourceScopeKey:N,createResourceScope:(a,b)=>new K(a,{...b,internalSource:"handleManager"})};d=f.attach(new y(a))}this._handleManager=d,this._scope=f,this._owner=c.owner,J&&K._allDebugResourceScopes.push({owner:this._owner,internalSource:c.internalSource,scope:new WeakRef(this)})}}function L(){this.resources?.dispose()}J&&((0,g.b)("resourceScopes",{get:K._getResourceScopes}),(0,g.b)("resourceScopesWithInternal",{get:()=>K._getResourceScopes(!0)})),K._allDebugResourceScopes=[];let M=new h.a({name:"resources"});function N(a){return a===M}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,b,c){let d=[],e=[],f=c||((a,b)=>a===b);return function a(b,c){if(b===c)return!0;if(null===b||null===c||"object"!=typeof b||"object"!=typeof c)return!1;{let g=Object.keys(b).sort(),h=Object.keys(c).sort();if(g.length!==h.length||!g.every((g,i)=>{if(g!==h[i])return!1;if("function"==typeof b[g]||"function"==typeof c[g]||f(b[g],c[g]))return!0;if("object"!=typeof b[g])return!1;if(-1!==d.indexOf(b[g]))throw Error(`Cannot perform DeepCompare() because a circular reference was encountered, object: ${b}, property: ${g}`);if(d.push(b[g]),-1!==e.indexOf(c[g]))throw Error(`Cannot perform DeepCompare() because a circular reference was encountered, object: ${c}, property: ${g}`);return e.push(c[g]),!!a(b[g],c[g])&&(d.pop(),e.pop(),!0)}))return!1}return!0}(a,b)}}
,function(a,b,c){function d(a){return!!a&&"function"==typeof a.addEventListener}function e(a,b){let c=a.__declaredEvents=a.__declaredEvents||{};if("string"==typeof b)c[b]=!0;else for(let a=0;a<b.length;a++)c[b[a]]=!0}function f(a,b,c,e){let f,g=a;if(d(g)){if(document.createEvent){let a=document.createEvent("HTMLEvents");a.initEvent(b,e,!0),a.args=c,f=g.dispatchEvent(a)}}else for(;g&&!1!==f;){var h;if((h=g)&&h.__events__){let a=g.__events__[b];for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b)){let d=a[b];for(let a=0;!1!==f&&a<d.length;a++){let b=d[a];b.objectCallback&&(f=b.objectCallback.call(b.parent,c))}}g=e?g.parent:null}else g=null}return f}c.d(b,{a:function(){return e},b:function(){return d},c:function(){return f}})}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return d}});let d=c(0).a.isActivated("117dc17d-2ad5-4b71-b395-89cf0580f8c5");function e(a){return a?a.endTime-a.startTime:0}function f(a){return!!a&&(!!a.startTime||0===a.startTime)&&(!!a.endTime||0===a.endTime)&&a.endTime>a.startTime}class g{constructor(a){const{controlId:b,startTime:c,endTime:g,ignoreForEUPL:h,needFlatten:i,renderTimeCalculator:j=e,renderTimeRequiredDataChecker:k=f}=a;this.controlId=b,this.startTime=c,this.endTime=g,this.renderTimeCalculator=d?j:e,this.renderTimeRequiredDataChecker=d?k:f,this.ignoreForEUPL=void 0===h||h,this.needFlatten=void 0!==i&&i}}}
,function(a,b,c){var d=c(7);b.a=class{get promise(){return this._promise}getPromise(){return this._promise}cancel(){this._promise.cancel()}complete(a){this._promise._completed(a)}error(a){this._promise._error(a)}constructor(a){this.resolve=a=>{this._promise._completed(a)},this.reject=a=>{this._promise._error(a)},this._promise=new d.b(a)}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(15);function e(a,b,c){try{let e,f=c||window;if(!f||!f.performance||!a||!b)return{duration:-1};let g=performance.getEntriesByType("resource");new d.a(a).authority||(a=(f.location&&new d.a(f.location.href).authority)+a);for(let c=g.length-1;c>=0;c--){let d=g[c];if(d.startTime<b)break;decodeURIComponent(d.name)===decodeURIComponent(a)&&(e=d)}if(e)return(({connectEnd:a,connectStart:b,decodedBodySize:c,domainLookupend:d,domainLookupStart:e,duration:f=-1,encodedBodySize:g,fetchStart:h,nextHopProtocol:i,redirectEnd:j,redirectStart:k,requestStart:l,responseEnd:m,responseStart:n,secureConnectionStart:o,startTime:p,transferSize:q,workerStart:r})=>({connectEnd:a,connectStart:b,decodedBodySize:c,domainLookupend:d,domainLookupStart:e,duration:f,encodedBodySize:g,fetchStart:h,nextHopProtocol:i,redirectEnd:j,redirectStart:k,requestStart:l,responseEnd:m,responseStart:n,secureConnectionStart:o,startTime:p,transferSize:q,workerStart:r}))(e);return{duration:-1}}catch(a){return{duration:-1}}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(15);function e(a,b){try{let c={...globalThis.window&&window.location.origin?{[window.location.origin]:"<location.origin>"}:{},...globalThis.window&&window._spPageContextInfo?.webAbsoluteUrl?{[window._spPageContextInfo.webAbsoluteUrl]:"<pageContext.webAbsoluteUrl>"}:{},...b||{}},{authority:e,path:f}=new d.a(a),g=f,h=e;for(let b of Object.keys(c))if(a.slice(0,b.length)===b){g=a.slice(b.length),h=c[b];break}let i=g.split("/");return`${h}/{ length: ${g.length}, segments: ${i.length} }`}catch{return"ErrorWhileScrubbingUrl"}}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});var d=c(93);function e(a,b){let c,d,e=!!a.Fallback,f=a.ODB;if("boolean"==typeof f)e=f;else if(f>0){if(f>=6e4){let a=f-6e4+2e3+1;c=Math.floor(a/32),d=1<<a%32}else{if(!(f<=2e3))return!1;c=Math.floor(f/32),d=1<<f%32}e=c<b.length&&(b[c]&d)!=0}return e}function f(a,b){let c=!!a.Fallback,e=a.ODBECS;return e&&void 0!==d.a.EcsClientFlightInfo[e]&&(c=(0,d.c)(e,b)),c}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,b){let c=a.toUpperCase(),d=b&&b.toUpperCase();return c.substring(0,d&&d.length||0)===d}}
,function(a,b,c){c.d(b,{a:function(){return d}});class d{create(a){let b=new this._type({},a);return{instance:b,disposable:b}}constructor(a,b){this._type=a,this.dependencies={...a.dependencies||{},...b||{}}}}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){let b;try{let c=[];b=JSON.stringify(a,(a,b)=>b===window?"[window]":b instanceof HTMLElement?"[HTMLElement]":"function"==typeof b?"[function]":"object"!=typeof b||null===b?b:-1===c.indexOf(b)?(c.push(b),b):"[circular]")}catch(a){b=JSON.stringify("[object]")}return b}}
,function(a,b,c){c.d(b,{a:function(){return B}});var d=c(82),e=c(102),f=c(6),g=c(34),h=c(137),i=c(83),j=c(7),k=c(177),l=c(136),m=c(628),n=c(439),o=c(438),p=c(0),q=c(629),r=c(19),s=c(3),t=c(176),u=c(101);let v=!p.a.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!f.a.isFeatureEnabled({ECS:1026572}),w=!p.a.isActivated("29b79ab1-ae17-42fd-b4e1-39e58a904f55","04/02/2023","enable IB discovery"),x=!p.a.isActivated("9a20d40f-32c7-4d46-b7e5-ab292ac5809f"),y=!p.a.isActivated("5e644b83-32fa-4e2f-9e2f-4369ae93cf72","05/13/2024","add endpoints for substrate in airgap")&&!f.a.isFeatureEnabled({ECS:1261410}),z=p.a.isActivated("FF5149C6-9ABC-4EF8-8855-98F452A7B210"),A=p.a.isActivated("95313053-b367-450a-9237-240d34ff07ae");class B extends h.b{getCapabilities(){return this._capabilities}getPersonaDetails(a){let b=b=>this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",a).toString(),qosName:"GetPersonaDetails",authToken:b,...!A?{disallowSelfIssuedToken:!0}:{},parseResponse:a=>{let b=a=>({name:a.DisplayName,email:a.Email,userId:a.AccountName,office:a.Office,image:a.PictureUrl,job:a.Title,department:a.DepartmentName,phone:a.Phone,sip:a.Lync}),c=JSON.parse(a).d.GetPersonMagazineUserProfileDataForUser,d={personDetails:b(c.Primary),managerChain:c.ManagerChain.results.map(b),directReports:c.DirectReports.results.map(b)};return d.personDetails.profilePage=(0,e.b)(this._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(d.personDetails.sip)+"&origin=ProfileODBCard",d}});return j.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(b)}getPickerEntityInformation(a){let b=0;a.principalType===i.a.sharePointGroup&&(b=Number(a.rawPersonData.EntityData.SPGroupID));let c=JSON.stringify({entityInformationRequest:{PrincipalType:a.principalType,EmailAddress:a.email,GroupId:b}});p.a.isActivated("3fa8ef41-badd-45d3-bc59-39fab6f5e50a")||(c=JSON.stringify({entityInformationRequest:{PrincipalType:a.principalType,EmailAddress:a.email,GroupId:b,Key:a.userId}}));let d=b=>this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:c,qosName:"getPickerEntityInformation",authToken:b,noRedirect:!0,...!A?{disallowSelfIssuedToken:!0}:{},parseResponse:b=>({totalMemberCount:JSON.parse(b).d.TotalMemberCount,person:a})});return j.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(d)}resolve(a,b){let c=c=>{let e=b.listId&&{querycontext:b.listId};return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:this._constructPostBody(a,b),qosName:"Resolve",authToken:c,additionalHeaders:e,...!A?{disallowSelfIssuedToken:!0}:{},parseResponse:a=>{let c=JSON.parse(JSON.parse(a).d.ClientPeoplePickerResolveUser),e=[];e[0]=c,!c.IsResolved&&(c.EntityData.IsBlockedOnODB&&"true"===c.EntityData.IsBlockedOnODB.toLowerCase()||e&&!e[0].DisplayText&&(e[0].DisplayText=c.Key)),!p.a.isActivated("aaf72a01-8e6e-43c4-b16b-795f351afb03")&&c.IsResolved&&e&&!e[0].DisplayText&&(e[0].DisplayText=c.Key);let f=(e=this._transformData(e,b.filterExternalUsers))[0];return b.filterExternalUsers&&f&&f.entityType===d.a.externalUser?(f.isResolved=!1,f.entityType=d.a.regularUser):b.blockViaPolicy&&!b.filterExternalUsers&&f&&!f.isResolved&&0===f.multipleMatches.length&&(f.isResolved=!0,f.isExternal=!0,f.entityType=d.a.externalUser),b.isGraphDistributionList&&b.useGraph&&f.isExternal&&(f.entityType=d.a.group,f.principalType=i.a.distributionList),f}})};return j.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(c)}canUseGraph(a){let b=a&&a.useGraph&&this._graphPeoplePickerHelper?.canUseGraph();return b&&!this._dataRequestor&&(this._dataRequestor=new n.a({},{})),!!b}canUseSubstrate(a){let b=(a.useSubstrate||!G()&&a.useNew3Ssearch)&&this._substratePeoplePickerHelper?.canUseSubstrate();return b&&!this._dataRequestor&&(this._dataRequestor=new n.a({},{})),!!b}getLivePersonaPickerHelper(){return this._livePeoplePickerHelper}init(a){this.canUseSubstrate(a)&&!this._isSubstrateAPIWarm&&(this._substratePeoplePickerHelper?.warmUpInit(a.scenarioName),this._isSubstrateAPIWarm=!0)}search(a,b){return w&&b.enforceIBSegmentFiltering?this.sharePointSearch(a,b):this.canUseSubstrate(b)||G()&&b.useNew3Ssearch?this._substrateSearch(a,b):this.canUseGraph(b)?this._graphSearch(a,b):(0===b.groupID&&(b.useSubstrateSearch=!0),this.sharePointSearch(a,b))}sharePointSearch(a,b){b.onToggleGetMoreResults&&b.onToggleGetMoreResults(!1);let c=c=>{F()||this._logTokenQOS("spoToken","c58637bb-e2e1-4312-8a00-04b5ffcd3403",c||this._pageContext.authToken);let e=b.listId&&{querycontext:b.listId};return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:this._constructPostBody(a,b),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:e,authToken:c,...!A?{disallowSelfIssuedToken:!0}:{},parseResponse:c=>{let{allowSharePointGroups:e=!0,filterExternalUsers:f}=b,g=JSON.parse(JSON.parse(c).d.ClientPeoplePickerSearchUser),h=this._transformData(g,f);return f&&(h=h.filter(a=>a.entityType!==d.a.externalUser)),h=h.filter(a=>a.principalType===i.a.sharePointGroup?e:a.principalType===i.a.securityGroup?e||this._isValidEmail(a.email,!0):this._isValidEmail(a.email,!1)),this._handleZeroSearchResult(h,a,b,d.b.sharepointSearch)}})};return j.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(c)}subscribePresence(a,b){try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;let c=a=>{try{switch(a){case 0:default:b(0);break;case 1:b(1);break;case 2:b(2);break;case 3:b(3);break;case 4:b(4);break;case 5:b(5);break;case 6:b(6);break;case 8:b(7)}}catch(a){}};return this._skypeIntegration.TrackPresence(a,c),{dispose:()=>{try{this._skypeIntegration.UntrackPresence(a,c)}catch(a){}}}}catch(a){}return null}_constructPostBody(a,b){return JSON.stringify({queryParams:{QueryString:a,MaximumEntitySuggestions:b.maximumEntitySuggestions,AllowEmailAddresses:b.allowEmailAddresses,AllowOnlyEmailAddresses:b.allowOnlyEmailAddresses,PrincipalType:b.principalType,PrincipalSource:b.principalSource,UseSubstrateSearch:b.useSubstrateSearch,SharePointGroupID:b.groupID,QuerySettings:b.querySettings}})}_ensureSkypePresence(){try{if(!this._skypeIntegration){let a=new O365Shell_Shim.SkypeIntegration;a.OnApiReady(()=>{this._skypeIntegration=a})}}catch(a){}}_graphSearch(a,b){return this._graphPeoplePickerHelper.getGraphToken().then(c=>{if(F()||this._logTokenQOS("graphToken","00000003-0000-0ff1-ce00-000000000000",c),!c)return this.sharePointSearch(a,b);let e=v&&this._pageContext&&this._pageContext.msGraphEndpointUrl?this._pageContext?.msGraphEndpointUrl:"https://graph.microsoft.com",f=new r.a(`${e}/v1.0/me/people`);if(a){f.setQueryFromObject({$search:`"${a}"`,$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});let c=B._getPersonTypeFilter(b);c&&f.setQueryParameter("$filter",c)}let g=new s.a({name:"PeoplePickerGraphSearch"});return this._dataRequestor.send({apiName:"Graph.PeopleSearch",path:f.toString(),headers:{Authorization:"Bearer "+c,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(c=>{if(b.onToggleGetMoreResults&&b.onToggleGetMoreResults(!0),c&&c.value&&0!==c.value.length)g.end({resultType:s.b.Success});else if(g.end({resultType:s.b.ExpectedFailure,extraData:{error:"graph search return empty results"}}),a)return this.sharePointSearch(a,b);let e=c.value,f=[];return e.forEach(a=>{let c,e;if(a.personType.subclass&&this._isIgnorablePeopleSubType(a.personType.subclass))return;let g=a.scoredEmailAddresses[0]?a.scoredEmailAddresses[0].address:"",h=a.userPrincipalName&&this._isValidEmail(a.userPrincipalName,!1)?a.userPrincipalName:g;c=E()?D()?{Key:h,IsResolved:!1}:{Key:h,IsResolved:!1,EntityData:{ObjectId:a.id}}:{Key:h,IsResolved:!1,EntityData:{ObjectId:a.id},PeopleType:a.personType.class,PeopleSubtype:a.personType.subclass};let j="ImplicitContact"===a.personType.subclass,k="OrganizationUser"===a.personType.subclass,l="Group"===a.personType.class&&"UnifiedGroup"===a.personType.subclass,n="PublicDistributionList"===a.personType.subclass,o=(0,m.a)(this._webAbsoluteUrl,g);n&&(e=d.c.PublicDistributionList),l&&(e=d.c.unified);let p={department:a.department,email:g,image:j?void 0:o,job:!1===b.fallbackToEmailIfNoJob?a.jobTitle:a.jobTitle||g,name:a.displayName,providerName:k?"Provider":void 0,userId:h,rawData:c,rawPersonData:c,isExternal:!k,aadObjectId:a.id,fromDataSource:d.b.graph,detailedGroupInfo:e};k?(p.entityType=d.a.regularUser,p.principalType=i.a.user,p.isResolved=!0):l?(p.entityType=d.a.group,p.principalType=i.a.securityGroup,p.isResolved=!1,p.userId=a.id):(p.principalType=n?i.a.distributionList:i.a.none,p.entityType="Group"===a.personType.class?d.a.group:d.a.externalUser,p.isResolved=!1,p.providerName=void 0),p.userId&&f.push(p)}),this._handleZeroSearchResult(f,a,b,d.b.graph)},c=>{let d=(0,o.e)(c)&&429===c.status||"Canceled"===c.name;if(g.end({resultType:d?s.b.ExpectedFailure:s.b.Failure,extraData:{error:c}}),(0,o.e)(c))switch(c.status){case 400:case 401:case 403:case 404:return this._graphPeoplePickerHelper.disableGraphCallsForPicker(),this.sharePointSearch(a,b);default:return this.sharePointSearch(a,b)}return("Canceled"!==c.name&&this._graphPeoplePickerHelper.disableGraphCallsForPicker(),"Canceled"===c.name)?null:this.sharePointSearch(a,b)})})}_substrateSearch(a,b){return this._substratePeoplePickerHelper.getSubstrateToken().then(c=>{if(!c)return this.sharePointSearch(a,b);let e=null;b.siteIBSegmentIDs&&b.siteIBSegmentIDs.length>0&&(e=b.siteIBSegmentIDs);let f=b.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],h={Authorization:"Bearer "+c,...!p.a.isActivated("BD8874ED-DA51-4414-80AC-F67CA38B3640")&&this._pageContext?.aadUserId&&this._pageContext?.aadTenantId?{"X-AnchorMailbox":`OID:${this._pageContext?.aadUserId}@${this._pageContext?.aadTenantId}`}:{}},j="",l=b.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"];b.filterPersonalAndImplictContacts&&(l.push("PersonalContact"),l.push("ImplicitContact")),x&&b.subTypesToBeFiltered&&b.subTypesToBeFiltered.length>0&&(l=b.subTypesToBeFiltered),b.allowSharePointGroups&&(l.push("UniversalSecurityGroup"),p.a.isActivated("86e26924-e87f-4912-84b8-0e6743f499e4")||l.push("ExchangeSecurityGroup"));let n=g.a.isValidGuid(a),q={Or:l.map(a=>({Term:{PeopleSubtype:a}}))},r=e?{Or:e.map(a=>({Term:{InformationBarrierSegment:a}}))}:null,u=n?{Or:{Term:{ExternalDirectoryObjectId:a}}}:null,v=e||n?n?e?{And:[q,r,u]}:{And:[q,u]}:{And:[q,r]}:q;j=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:f,Query:{QueryString:n?null:a},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype","Phones"],InformationBarrierMode:b.siteIBMode,Filter:v}],TimeZone:"UTC",Cvid:b.conversationId||g.a.generate(),Scenario:{Name:b.scenarioName||"documentshare"}});let w=b.scenarioName?`?scenario=${b.scenarioName}`:"",z=new s.a({name:"PeoplePickerSubstrateSearch"}),A=new s.a({name:"PeoplePickerAirGapEndpointAvailable"}),B=k.a;if(y&&(0,t.a)(this._pageContext.env2)){let a=this._pageContext.farmSettings;a&&a.ExternalService_exchangesearchurl?(B=a.ExternalService_exchangesearchurl,A.end({resultType:s.b.Success})):A.end({resultType:s.b.Failure,extraData:{error:"airgap endpoint not available, falling back to default substrate endpoint which doesn not work when user input less than 3 letters"}})}return this._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:B+`/api/v1/suggestions${w}`,headers:h,needsAuthorization:!1,requestType:"POST",postData:j,timeout:b.substrateTimeout}).then(c=>{b.onToggleGetMoreResults&&b.onToggleGetMoreResults(!0);let e=c.Groups[0]?c.Groups[0].Suggestions:[];if(0===e.length){if(z.end({resultType:s.b.Failure,extraData:{error:"substrate search return empty results"}}),a)return this.sharePointSearch(a,b)}else z.end({resultType:s.b.Success});let f=[];return e.forEach(a=>{let c,e,g;if(a.PeopleSubtype&&this._isIgnorablePeopleSubType(a.PeopleSubtype))return;let h=(p.a.isActivated("a8f919c0-84bd-4542-beb9-5f245329538c")?a.EmailAddresses[0]:this._firstValidEmail(a.EmailAddresses))||a.QueryText||"",j=a.UserPrincipalName&&this._isValidEmail(a.UserPrincipalName,!1)?a.UserPrincipalName:h;a.Id&&a.Id.indexOf("@")&&(c=a.Id.substring(0,a.Id.indexOf("@"))),b.useNew3Ssearch&&!j&&a.Id&&a.Id.indexOf("@")&&(j=a.Id.substring(0,a.Id.indexOf("@"))),e=E()?D()?{Key:j,IsResolved:!1}:{Key:j,IsResolved:!1,EntityData:{ObjectId:c}}:{Key:j,IsResolved:!1,EntityData:{ObjectId:c},PeopleType:a.PeopleType,PeopleSubtype:a.PeopleSubtype};let k="ImplicitContact"===a.PeopleSubtype,l="OrganizationUser"===a.PeopleSubtype,n="LinkedIn"===a.PeopleSubtype,o="Group"===a.PeopleType&&"UnifiedGroup"===a.PeopleSubtype,q="PublicDistributionList"===a.PeopleSubtype,r=(0,m.a)(this._webAbsoluteUrl,h);q&&(g=d.c.PublicDistributionList),o&&(g=d.c.unified);let s={department:a.Department,office:a.OfficeLocation,email:h,image:k?void 0:r,job:!1===b.fallbackToEmailIfNoJob?a.JobTitle:a.JobTitle||h,name:a.DisplayName,providerName:"Provider",userId:j,rawData:e,rawPersonData:e,isExternal:!l,detailedGroupInfo:g,...x?{phones:a.Phones?.map(a=>({type:a.Type,number:a.Number}))??void 0}:{}};l?(s.entityType=d.a.regularUser,s.principalType=i.a.user,s.isResolved=!0):o?(s.entityType=d.a.group,s.principalType=i.a.securityGroup,s.isResolved=!1,s.providerName=void 0):n?s.entityType=d.a.linkedinUser:(s.principalType=q?i.a.distributionList:i.a.none,s.entityType="Group"===a.PeopleType?d.a.group:d.a.externalUser,s.isResolved=!1,s.providerName=void 0),s.userId&&f.push(s)}),this._handleZeroSearchResult(f,a,b,d.b.substrate)},d=>{let e,f;try{e=JSON.parse(atob(c.split(".")[1])).exp<Date.now()/1e3}catch(a){}if(d&&(0,o.e)(d)&&d.status&&(f=d.status),z.end({resultType:s.b.Failure,resultCode:f?f.toString():"unknown",extraData:{error:d,jsonExtraData:JSON.stringify({tokenExpired:e})}}),(0,o.e)(d))switch(d.status){case 400:case 401:case 403:case 404:return this._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),this.sharePointSearch(a,b);default:return this.sharePointSearch(a,b)}return"Canceled"!==d.name&&(this._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),this.sharePointSearch(a,b)),null})})}_handleZeroSearchResult(a,b,c,e){if(!b)return a;if(!1!==c.resolveEmailIfNoResults&&0===a.length&&this._isValidEmail(b,!1)){let f={Key:b,IsResolved:!1};a.push({email:b,entityType:d.a.externalUser,isResolved:!1,job:!1===c.fallbackToEmailIfNoJob?void 0:b,name:b,userId:b,rawData:f,rawPersonData:f,isExternal:!0,fromDataSource:e})}return a}_isValidEmail(a,b){return a?!(a.indexOf(" ")>-1||a.indexOf(";")>-1)&&q.a.isValidEmailSyntax(a,!1):!b}_firstValidEmail(a){if(a)for(let b=0;b<a.length;b++){let c=a[b];if("string"==typeof c&&c&&this._isValidEmail(c,!1))return c}}static _getPersonTypeFilter(a){let b="";return a.principalType&i.a.user&&(b+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),a.principalType&i.a.securityGroup&&(b&&(b+=" or "),b+="personType/subclass eq 'UnifiedGroup'"),a.principalType&i.a.distributionList&&null!==a.filterPublicDistributionList&&!p.a.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")!==a.filterPublicDistributionList&&(b&&(b+=" or "),b+="personType/subclass eq 'PublicDistributionList'"),b}_isIgnorablePeopleSubType(a){return!!a&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(b=>b===a)}_transformData(a,b){return a.map(a=>{let c=a.EntityData,e={name:a.DisplayText,email:c.Email,userId:a.Key,job:c.Title,department:c.Department,phone:c.MobilePhone,providerName:a.ProviderDisplayName,entityType:a.EntityType,isResolved:a.IsResolved,multipleMatches:a.MultipleMatches,rawPersonData:a,rawData:a};p.a.isActivated("2d29e305-4283-48bb-b578-47520e9bc783","08/23/2024","Add object id when using sharepoint search")||("User"!==a.EntityType?e.aadObjectId=a.Key.split("|")[2]:e.aadObjectId=a.EntityData.ObjectId),e.multipleMatches.length>0&&(e.multipleMatches=this._transformData(e.multipleMatches,b),b&&(e.multipleMatches=e.multipleMatches.filter(a=>a.entityType!==d.a.externalUser)));let f=e.email;e.isResolved&&(f?e.image=(0,m.a)(this._webAbsoluteUrl,f):e.image=null);let g=c.PrincipalType||a.EntityType;switch(g){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":e.entityType=d.a.externalUser,e.principalType=i.a.user,e.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!p.a.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==g){e.entityType=d.a.group,"SharePointGroup"===g?e.principalType=i.a.sharePointGroup:e.principalType=i.a.securityGroup,"SharePointGroup"===g?e.detailedGroupInfo=d.c.SPGroup:e.detailedGroupInfo=d.c.securityGroup;break}default:e.entityType=d.a.regularUser,e.principalType=i.a.user}return e})}_logTokenQOS(a,b,c){if(!c)return;let d=new s.a({name:`peoplePicker_${a}`}),e=(0,u.c)(c).appid||"",f="08e18876-6177-487e-b8b5-cf950c1e598c"!==e&&e===b?s.b.Failure:s.b.Success;d.end({resultCode:e,resultType:f})}constructor(a,b){const c=C(a)?a:b.pageContext,d=!!b?.noRedirect,e=b?.tokenProvider??(z?void 0:b?.pageContext?.tokenProvider);super({dataSourceName:"PeoplePickerDataSource"},{pageContext:c,noRedirect:d,tokenProvider:e}),this._isSubstrateAPIWarm=!1;const f=C(a)?a.apiUrlHelper:b.apiUrlHelper;this._apiUrlHelper=f||new l.a({webAbsoluteUrl:c.webAbsoluteUrl}),this._capabilities={supportsMruCaching:!0},b&&(this._dataRequestor=b.dataRequestor,this._graphPeoplePickerHelper=b.graphPeoplePickerHelper,this._substratePeoplePickerHelper=b.substratePeoplePickerHelper,this._livePeoplePickerHelper=b.livePeoplePickerHelper,(z||e?.getAuthToken)&&(this._getAuthToken=b.getAuthToken)),this._webAbsoluteUrl=c.webAbsoluteUrl}}function C(a){return!!a.webAbsoluteUrl}function D(){return p.a.isActivated("3ca1ecbf-ea9f-45eb-bd26-5dfb3924d136","12/4/23","add objectId to rawData")||f.a.isFeatureEnabled({ECS:1173676})}function E(){return p.a.isActivated("E5965CCD-495A-4747-A28A-75901A57468A")}function F(){return p.a.isActivated("f94177d2-4b45-4413-a1b8-bcb5fd7dc7dc")}function G(){return p.a.isActivated("16eb1d2b-a7a1-4b21-9eb6-3b23906f822c")}}
,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(99),e=c(72),f=c(258);class g{abort(a){this._abortRequest()&&!a&&this._callFailureCallback(this._request,-3,!1)}start(a,b){this._successCallback=a,this._failureCallback=b;let{_method:c,_headers:d}=this;try{this._request=this._getRequest();let{_progressCallback:a,_uploadProgressCallback:b,_request:f,_responseType:g}=this;for(let h in a&&(f.onprogress=b=>{try{a(b)}catch(a){e.a.logError(a)}}),b&&(f.upload.onprogress=a=>{try{b(a)}catch(a){e.a.logError(a)}}),this._async.setTimeout(()=>{this._completed||this._timeoutCallback()},this._requestTimeoutInMS),f.onreadystatechange=()=>{if(!this._completed){let a=4;try{a=f.DONE||4}catch(a){}f.readyState===a&&this._requestEndCallback()}},f.open(c,this._url,!0),"withCredentials"in f&&(f.withCredentials=this._withCredentials),f.responseType=g,d)f.setRequestHeader(h,d[h]);f.send(this._postData)}catch(a){e.a.logError(a,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:(0,f.a)(d),method:c}),this._abortRequest(),this._callFailureCallback(this._request,-1,!1)}}_getRequest(){if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;let a=new XDomainRequest;return a.setRequestHeader=()=>{},a.onprogress=()=>{},a.ontimeout=()=>{},a.onload=()=>{this._requestEndCallback()},a}_abortRequest(){let a=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort()}catch(a){}a=!0}return a}_timeoutCallback(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,-2,!0))}_callSuccessCallback(a,b){try{this._successCallback&&this._successCallback(a,b)}catch(a){e.a.log(a)}}_callFailureCallback(a,b,c){try{this._failureCallback&&this._failureCallback(a,b,c)}catch(a){e.a.log(a)}}_requestEndCallback(){if(!this._completed){this._completed=!0;let a=-1;try{this._async.dispose();try{a=this._request.status}catch(a){}}catch(b){a=-1,e.a.log(b)}a<400&&a>0?this._callSuccessCallback(this._request,a):this._callFailureCallback(this._request,a,!1)}}constructor(a){this._async=new d.a(this);const{url:b,requestTimeoutInMS:c=g.DEFAULT_TIMEOUT_MS,json:e,responseType:f="",headers:h={},withCredentials:i=!1,needsCors:j=!1,onProgress:k,onUploadProgress:l}=a,{method:m=e?"POST":"GET"}=a;this._url=b,this._requestTimeoutInMS=c,this._postData=e,this._headers=h,this._method=m,this._withCredentials=i,this._needsCors=j,this._responseType=f,this._progressCallback=k,this._uploadProgressCallback=l}}g.DEFAULT_TIMEOUT_MS=3e4}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return p}});var d=c(19),e=c(3);let f=c(0).a.isActivated("C55E83F0-3687-4B0B-96B3-4EA3194C5B49"),g={Small:1,Medium:2,Large:3},h="_oat_",i="UserPhotoAspx",j={},k={},l="TryGetAlternativeUrlFailure",m="_spPageContextInfo",n="_spHomePageContext";function o(a){if(-1===a.indexOf(h))return!0;let b=k[a];if(b)return Date.now()/1e3<b;let c=new d.a(a),f=c.getQueryParameter(h);if(f){let c=f.split("_");if(2===c.length&&(b=Number(c[0])),!b)return new e.a({name:l}).end({resultType:e.b.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:f}}),k[a]=Date.now()/1e3+86400,!0;if(b-=30,k[a]=b,Date.now()/1e3>b)return!1}let g=c.getQueryParameter("P1");if(!g)return!0;let i=Number(g);return i-=30,k[a]=Math.min(i,k[a]),!(Date.now()/1e3>i)}function p(a,b,c){let h;switch(c=c||function(a){function b(a){return o(window[a].userPhotoCdnBaseUrl)?window[a].userPhotoCdnBaseUrl:(f&&delete window[a].userPhotoCdnBaseUrl,"")}try{let c=j&&j[a];if(!c&&i===a&&(window[m]?.userPhotoCdnBaseUrl?c=b(m):window[n]?.userPhotoCdnBaseUrl&&(c=b(n))),!c)return;if(!o(c))return void(f?delete j[a]:j[a]&&delete j[a]);return c}catch(a){f&&new e.a({name:l}).end({resultType:e.b.Failure,resultCode:"Unexpected",extraData:{error:a}})}}(i)||"/_layouts/15/userphoto.aspx",b){case g.Medium:h="M";break;case g.Large:h="L";break;default:h="S"}let k=new d.a(c);return k.setQueryParameter("size",h),k.setQueryParameter("accountname",a||""),k.toString()}}
,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(127),e=c(56);class f extends d.c{}class g extends d.b{getUrlParts(a){return super.getUrlParts(a)}getItemUrlParts(a){let b=(0,e.a)(a);return this.getUrlParts({path:b.id,listUrl:b.listurl})}constructor(a,b){const{itemUrlPartsType:c=f}=b;super({context:b.pageContext,itemUrlPartsType:c})}}}
,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(127),e=c(136);class f extends e.b{webByUrl(a){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(a))}webByItemUrl(a){let{siteRelation:b,isCrossDomain:c,fullItemUrl:e}=a,f=this;return(c||b===d.d.crossSite)&&(f=f.method("SP.RemoteWeb",e)),f.segment("web")}listById(a,b){return this.webByItemUrl(a).segment("lists").method("GetById",b)}clone(){return new f({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})}constructor(a,b){super({webAbsoluteUrl:b.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:b.encodeWebAbsoluteUrl}),this._pageContext=b.pageContext,this._shouldEncodeWebAbsoluteUrl=b.encodeWebAbsoluteUrl,this._itemUrlHelper=b.itemUrlHelper}}class g extends e.a{build(){return new this._apiUrlType}constructor(a,b){super({webAbsoluteUrl:b&&b.pageContext?b.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:b.encodeWebAbsoluteUrl});const{itemUrlHelper:c,pageContext:d,encodeWebAbsoluteUrl:e}=b,{apiUrlType:g=class extends f{constructor(){super({},{itemUrlHelper:c,pageContext:d,encodeWebAbsoluteUrl:e})}}}=b;this._apiUrlType=g}}}
,function(a,b,c){c.d(b,{a:function(){return j},b:function(){return l}});var d=c(7),e=c(6),f=c(3),g=c(60),h=c(43);let i={ODB:387},j="https://graph.microsoft.com",k="DisableGraph";class l{canUseGraph(){if(this._graphToken)return!0;if(this._pageContext&&this._pageContext.authToken)return!1;let a=this._pageContext&&this._oAuthTokenProvider&&e.a.isFeatureEnabled(i);return this._dataStore&&(a=a&&!this._dataStore.getValue(k,h.a.session)),a}disableGraphCallsForPicker(){this.initializeDataStore(),this._dataStore.setValue(k,!0,h.a.session)}getGraphToken(){if(this._graphToken)return d.c.resolve(this._graphToken);if(this._oAuthTokenProvider){let a=new f.a({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken({resource:j,apiQosName:"PeoplePicker.GetGraphToken"}).then(b=>(a.end({resultType:f.b.Success}),b),b=>d.c.isCanceled(b)?(a.end({resultType:f.b.ExpectedFailure,resultCode:"Canceled"}),d.c.reject(b)):(a.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:f.b.Failure,extraData:{serverErrorCode:b._serverErrorCode,message:b.message}}),this.disableGraphCallsForPicker(),null))}return null}initializeDataStore(){this._dataStore||(this._dataStore=new g.a("PeoplePicker",h.a.session))}constructor(a,b){this._pageContext=b.pageContext,this._sharingContextInformation=b.sharingContextInformation,this._oAuthTokenProvider=b.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}}}
,function(a,b,c){c.d(b,{a:function(){return i}});var d=c(441),e=c(6),f=c(84),g=c(15),h=c(0);class i{getApiRoot(a,b,c,i=!1){let j;if(this._sharingContextInformation){let{isFolder:c,isListSharing:h,itemUrl:j,listId:k,listItemId:l,listUrl:m,resourceId:n,serverRelativeItemUrl:o,uniqueId:p,webAbsoluteUrl:q}=this._sharingContextInformation,r=(i?b?.properties?.listId??k:k)||"",s=(i?b?.properties?.ID??l:l)||"",t=(i?b?.properties?.uniqueId??p:p)||"";if(h)return a.build().webByUrl({webUrl:q}).method("Lists",k);if(p){if(k)return a.build().webByUrl({webUrl:q}).segment("lists").method("getbyid",r).method("GetItemByUniqueId",t);let d=i&&b?.type===f.a.Folder||c?"GetFolderById":"GetFileById",e={guid:i?b?.properties?.uniqueId??p:p};return a.build().webByUrl({webUrl:q}).method(d,e).segment("ListItemAllFields")}return m?a.build().webByUrl({listUrl:m}).method("GetListItem",o):j?e.a.isFeatureEnabled({ODB:1236})?a.build().webByUrl({webUrl:q}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:new g.a(j).path}).segment("ListItemAllFields"):a.build().webByUrl({webUrl:q}).method("GetFileByUrl",d.b(j)).segment("ListItemAllFields"):k&&l?a.build().webByUrl({webUrl:q}).method("Lists",r).method("GetItemById",s):a.build().webByUrl({webUrl:q}).method("GetListItemByResourceId",n)}if(j=b.properties.path?this._itemUrlHelper.getUrlParts({path:b.properties.path}):this._itemUrlHelper.getItemUrlParts(b.key),!h.a.isActivated("c75d69bb-a1f0-46fc-a252-78d6cdeac52b","05/08/2024","call GSI using itemType and uniqueId")&&!c&&b?.properties?.uniqueId&&b?.type){let c=b.type===f.a.Folder?"GetFolderById":"GetFileById",d={guid:b.properties.uniqueId};return a.build().webByItemUrl(j).method(c,d).segment("ListItemAllFields")}let k=a.build().webByItemUrl(j).method("Lists",c);return b.isRootFolder||(k=b.properties.ID?k.method("GetItemById",b.properties.ID):k.method("GetItemByUniqueId",b.properties.uniqueId)),k}getFileUrl(a){return this._itemUrlHelper.getItemUrlParts(a.key).fullItemUrl}canUseSecurable(a){let b=a.properties;return!!b&&(a.isRootFolder?!!a.list&&!!a.list.id:!!b.ID||!!b.uniqueId)}static getUniqueSharingPrincipals(a){if(!a)return;let b=new Set;return a.filter(a=>!b.has(a.loginName)&&(b.add(a.loginName),!0))}constructor(a){this._itemUrlHelper=a.itemUrlHelper,this._sharingContextInformation=a.sharingContextInformation}}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,b=!0){return a=encodeURI(a),b&&a&&(a=a.replace(/#/g,"%23")),a}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}}
,function(a,b,c){c.d(b,{a:function(){return h},b:function(){return g}});var d=c(7),e=c(44);class f{_serialize(){let a={};return this._features.forEach((b,c)=>{a[c]={Version:b.version,Enabled:b.enabled}}),a}get(a){if(!a||a&&0===a.length)throw Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(a)}constructor(a){if(this._features=new Map,!a)throw Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(const b in a)if(void 0!==b){const c=a[b];this._features.set(b,{version:c.Version,enabled:c.Enabled})}}}function g(a,b,c){let e=0;return new d.c(function(d,f){let g=setInterval(()=>{if(e*b<=c)e++,a()&&(clearInterval(g),d());else throw clearInterval(g),"Timed out waiting for checker "+a},b)})}function h(a){if(!a.featureInfo)return Number(a.webTemplate)===e.b.sitePagePublishing;{let b=new f(a.featureInfo);if(!b)return!1;{let a=b.get("SitePagePublishing");return!!a&&a.enabled}}}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={unknown:0,prefetch:1,hostapp:2,api:3}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(98);function e(a,b=!1){let c=new Date(a),f=0>c.getTimezoneOffset(),g=c.getFullYear()+"",h=(0,d.d)(c.getMonth()+1+"",2),i=(0,d.d)(c.getDate()+"",2),j=(0,d.d)(c.getHours()+"",2),k=(0,d.d)(c.getMinutes()+"",2),l=(0,d.d)(c.getSeconds()+"",2),m=(0,d.d)(f?(Math.ceil(c.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(c.getTimezoneOffset()/60)+"",2),n=(f?"+":"-")+m+(0,d.d)((c.getTimezoneOffset()%60).toString().replace("-",""),2);return b?g+"-"+h+"-"+i+"T"+j+":"+k+":"+l+n:g+h+i+"T"+j+k+l+n}}
,function(a,b,c){c.d(b,{a:function(){return j},b:function(){return g},c:function(){return h},d:function(){return i}});var d,e,f=c(633);function g(a){return Number(a)===e.DocumentLibrary}function h(a){return a===f.a.genericList||a===f.a.announcements||a===f.a.issueTracking||a===f.a.contacts||a===f.a.customGrid}function i(a){return Number(a)===f.a.promotedLinks}(d=e||(e={}))[d.invalidType=-1]="invalidType",d[d.GenericList=0]="GenericList",d[d.DocumentLibrary=1]="DocumentLibrary",f.a.mySiteDocumentLibrary,f.a.documentLibrary,f.a.pictureLibrary,f.a.xmlFormLibrary,f.a.webPageLibrary,f.a.publishingPageLibrary,f.a.publishingAsset,f.a.documentLibrary,f.a.contentCenterPrimeLibrary;var j=f.a}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_CAMPAIGNS:"SuiteMenu_MenuItem_SiteCampaigns",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",SITE_TEMPLATES:"SuiteMenu_MenuItem_SiteTemplates",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LIST_SETTINGS:"SuiteMenu_ListSettings",LANGUAGE:"SuiteMenu_Language",BRAND_CENTER:"Brand_Center",CHANGE_THE_LOOK:"Change_The_Look",VIVA_CONNECTIONS:"Viva_Connections_Settings",GET_ONEDRIVE_APPS:"GetOneDriveApps",MANAGE_OR_CANCEL_SUBSCRIPTION:"ManageOrCancelSubscription",CLOUD_IMPORT_SETTING:"Cloud_Import_Setting",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",PRIVACY_CHOICES:"ShellPrivacyChoices",LEGAL:"ShellLegal",WINDOWS_PRIVACY:"ShellWindowsPrivacy",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",STREAM:"ShellStream",LISTS:"Lists",VIVASUITEHOME:"VivaSuiteHome",SHAREPOINT:"Sharepoint",CLIPCHAMP:"Clipchamp"}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return g}});var d=c(6),e=c(0);function f(){return!e.a.isActivated("19CFF699-BC25-4595-AF4E-60224802FA48")&&d.a.isFeatureEnabled({ODB:62582})}function g(){return!e.a.isActivated("51fc5d19-6c14-420a-8a00-601ea7d164d0","10/23/2025","KS for use external token provider in SharingTopLevelTokenProvider")}}
,function(a,b,c){let d,e;function f(a,b){let c,f;return d&&e===a||((f=b||window._spPageContextInfo)&&(c=a.webThemeProvider(f)),d=c,e=a),d}c.d(b,{a:function(){return f}})}
,function(a,b,c){c.d(b,{a:function(){return x}});var d=c(7),e=c(277),f=c(60),g=c(43),h=c(77);let i="Data",j="CacheToken",k="CacheVersion",l="CacheExpires",m=/^#[0-9A-Fa-f]{6}$/i,n=/^(#[0-9A-Fa-f]{6});web#\d+$/i,o=/^\/.+_catalogs\/theme\/Themed\/.+$/i;class p{static clearThemeCache(){let a=p.getThemeDataStore();a.remove(i),a.remove(j),a.remove(k),a.remove(l)}static getCachedTheme(a,b){let c,d=p.getThemeDataStore();try{let e=d.getValue(l);a===d.getValue(j)&&"1.7"===d.getValue(k)&&(!e||Date.now()<e)&&(c=d.getValue(i),b&&p._isDirtyCache(a,c)&&(p.clearThemeCache(),c=void 0))}catch{}return c}static updateThemeCache(a,b){let c=p.getThemeDataStore();if(c.setValue(i,a),c.setValue(j,b||a.cacheToken),c.setValue(k,"1.7"),a?.cacheMaxAge){let b=1e3*a.cacheMaxAge;c.setValue(l,Date.now()+b)}else c.remove(l)}static getHeaderThemeCache(a,b){let c=p._getHeaderThemeDataStore().getValue(i);if(c){let d=c.find(b=>b.siteAbsoluteUrl===a);if(d&&d.themedCssFolderUrl===b)return d.themeData}}static updateHeaderThemeCache(a,b,c){let d=p._getHeaderThemeDataStore(),e=d.getValue(i)||[],f={siteAbsoluteUrl:a,themeData:b,themedCssFolderUrl:c};e.length||(e.unshift(f),d.setValue(i,[f]));let g=e.findIndex(b=>b.siteAbsoluteUrl===a);-1!==g&&e.splice(g,1),e.unshift(f),e.length>20&&e.pop(),d.setValue(i,e)}static getThemeDataStore(){return new f.a("odTheme",g.a.local)}static _getHeaderThemeDataStore(){return new f.a("odHeaderTheme",g.a.local)}static _isDirtyCache(a,b){let c=!1;try{if(a&&b&&b.cacheToken){let d=p._getRefinedCacheTokenFromCacheToken(a)||"",e=p._getRefinedCacheTokenFromThemeData(b)||"";d&&e?c=d.toLowerCase()!==e.toLowerCase():(h.a.logData({name:"ThemeCache.UnknownPattern",extraData:{cacheToken:a,cacheTokenInTheme:b.cacheToken}}),c=!1)}}catch{}return c&&h.a.logData({name:"ThemeCache.DirtyCache",extraData:{cacheToken:a,cacheTokenInTheme:b.cacheToken}}),c}static _getRefinedCacheTokenFromThemeData(a){if(a&&a.cacheToken){let b=a.cacheToken.split(":");if(4===b.length)return b[1];let c=a.cacheToken.match(m);if(c)return c[0]}}static _getRefinedCacheTokenFromCacheToken(a){if(a){let b=a.match(o);if(b)return b[0];let c=a.match(n);if(c)return c[1]}}}var q=c(3),r=c(231),s=c(0);class t{static getBackgroundUrl(a){return a?t._makeCssUrl(a.backgroundImageUri):"none"}static _makeCssUrl(a){let b="none";return a&&(b='url("'+t._escapeQuotesAndParentheses(a)+'")'),b}static _escapeQuotesAndParentheses(a){let b={"'":"%27",'"':"%22","(":"%28",")":"%29"},c=null;return null!=a&&(c=a.replace(/(['"\(\)])/gm,function(a,c){return b[c]})),c}loadThemeTokenMap(a,b){return this.loadThemeData(a,b).then(function(a){let b;if(a&&a.palette){b={};let c=a.palette;for(let a in c){let d=c[a];b[a]=d?e.a.toHtmlString(d):null}b.backgroundImageUri=t._makeCssUrl(a.backgroundImageUri)}return b},a=>null)}loadThemeData(a,b){if(!b&&this._dataPromise)return this._dataPromise;let c=!s.a.isActivated("c315e78f-4479-425b-bf5c-91c954c3f823"),e=this,f=null,g=q.b.Failure;return this._dataPromise=(0,r.a)(q.a,{name:"ThemeProvider.LoadData"},()=>new d.c(function(h,i){let j=null;b||(j=p.getCachedTheme(a,c)),j?h(j):e._loadData(b).done(function(b){b?(b.cacheToken&&p.updateThemeCache(b,a),h(b)):(f="NoData",i&&i("No model returned"))},function(a){d.c.isCanceled(a)?(f="Canceled",g=q.b.ExpectedFailure):f="ServerLoadFailure",i&&i(a)})}),null,function(a){d.c.isCanceled(a)&&(g=q.b.ExpectedFailure,f="Canceled");let b=a;return a&&(b=JSON.stringify({name:a.name||void 0,message:a.message&&a.message.value||a.message||void 0,correlationId:a.correlationId||void 0})),{resultType:g,resultCode:f||"Other",error:b}}),this._dataPromise}constructor(a){this._loadData=a}}var u=c(44),v=c(178),w=c(6);class x{loadThemeSlotsMap(a){let b=this._getThemeCacheToken();return b?this._themeProvider.loadThemeTokenMap(b,a):d.c.resolve()}loadFullFormattedThemeData(a){return this.loadFullThemeData(a).then(a=>this._handleIThemeDataToFullFormattedThemeData(a))}loadFullThemeData(a){let b=this._getThemeCacheToken();return b?this._themeProvider.loadThemeData(b,a):d.c.resolve(void 0)}loadThemeDataWithCacheToken(a){return this._forceLoadServerTheme().then(a=>this._handleIThemeDataToFullFormattedThemeData(a))}loadGeneratedTheme(){return this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(a=>a?a.loadGeneratedTheme().then(a=>this._handleIThemeDataToFullFormattedThemeData(a)):d.c.resolve())}getThemeCacheToken(){return this._getThemeCacheToken()}_getThemeCacheToken(){let a,b=this._pageContext;if(b){let c=Number(b.webTemplate),d=c===u.a.teamSite||c===u.a.group?b.groupColor:void 0,e=d?d+";web#"+b.webTemplate:null;a=b.themedCssFolderUrl||e||void 0}return a}_loadTheme(a){return this._getThemeCacheToken()?(this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(b=>b?b.loadTheme(a):d.c.resolve())):d.c.resolve()}_forceLoadServerTheme(){return this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(a=>a?a.loadServerTheme():d.c.resolve())}_handleIThemeDataToFullFormattedThemeData(a){let b,c,d,f,g,h,i;if(!a)return;let j={},k=a.palette;for(let a in k){let b=k[a];b&&(j[a]=e.a.toHtmlString(b))}if(a.backgroundImageUri&&(j.backgroundImageUri=t.getBackgroundUrl(a)),(0,v.c)(this._pageContext)&&(0,v.d)(a.themeSchemaVersion)){let g={};for(let b in a.otherMode?.palette){let c=a.otherMode.palette[b];c&&(g[b]=e.a.toHtmlString(c))}b=Object.keys(g).length>0?{...a.otherMode,palette:g}:void 0;let h=[],i=[];for(let b of a.secondaryColors?.dark??[]){let a=this._handleColorPair(b);h.push(a)}for(let b of a.secondaryColors?.light??[]){let a=this._handleColorPair(b);i.push(a)}c={dark:h,light:i},f=a.displayMode,d=a.themeSchemaVersion}if((0,v.b)(this._pageContext)&&a.fontPackage&&a.fontPackage.fontFaces&&a.fontPackage.fontSlots){g=a.fontPackage.fontFaces,h={},i=a.fontPackage.fontPackageSource;let b=a=>{let b;if(b=this._isEnquoteKillswitchActivated?{fontFamily:a.fontFamily&&'"'+a.fontFamily.replace(/"/g,'\\"')+'"'}:{fontFamily:a.fontFamily&&this._enquoteIfNeeded(a.fontFamily)},a.fontVariationSettings){let c=Object.keys(a.fontVariationSettings),d="";for(let e of c){let c=a.fontVariationSettings[e];switch(e){case"wght":b.fontWeight=c;break;case"wdth":b.fontStretch=c;break;case"slnt":b.fontStyle=`oblique ${c}deg`;break;case"ital":b.fontStyle=c?"italic":"normal";break;case"opsz":b.fontOpticalSizing=c;break;default:d+=d?", ":"",this._isEnquoteKillswitchActivated?d+=`"${e}" ${c}`:d+=`${this._enquoteIfNeeded(e)} ${c}`}}d&&(b.fontVariationSettings=d)}return w.a.isFeatureEnabled({ODB:60044})&&w.a.isFeatureEnabled({ODB:62505})&&(b.fontFace=a.fontFace,b.fontVariationSettings=a.fontVariationSettings),b};for(let[c,d]of Object.entries(a.fontPackage.fontSlots))s.a.isActivated("661c8da2-e6df-4c44-95fb-d32ccf03998f","12/12/2023")?h[c]={fontFamily:d?.fontFamily}:h[c]=b(d)}let l={palette:j,isInverted:a.isInverted,fontPackageSource:i,fontFaces:g,fontSlots:h,...b&&{otherMode:b},...c&&{secondaryColors:c},...f&&{displayMode:f??"light"},...d&&{themeSchemaVersion:d}};return(0,v.a)(l,this._pageContext)}_enquoteIfNeeded(a){return a.startsWith('"')&&a.endsWith('"')?a:`"${a.replace(/"/g,'\\"')}"`}_handleColorPair(a){try{return{themePrimary:e.a.toHtmlString(a.themePrimary),backgroundColor:a.backgroundColor?e.a.toHtmlString(a.backgroundColor):void 0}}catch(a){return{themePrimary:""}}}constructor(a){this._isEnquoteKillswitchActivated=s.a.isActivated("b39f1385-ab28-4f24-b610-ec20f5dfac7b"),this._pageContext=a.pageContext?a.pageContext:window._spPageContextInfo,this._getThemeDataSource=a.getThemeDataSource,this._themeProvider=new t(this._loadTheme.bind(this))}}}
,function(a,b){class c{static clone(a){return c.fromRgba(a.R,a.G,a.B,a.A)}static equals(a,b){let c=!a,d=!b;return c||d?c&&d:a.R===b.R&&a.G===b.G&&a.B===b.B&&a.A===b.A}static fromRgba(a,b,d,e){let f=new c;return f.R=Math.round(a),f.G=Math.round(b),f.B=Math.round(d),f.A=null!=e?Math.round(e):c.maxComponent,f}static fromRgbaString(a){let b=new c;if(/^rgb.+/.test(a)){let d=a.match(/[\d.]+/g);b=c.fromRgba(Number(d[0]),Number(d[1]),Number(d[2]),4===d.length?Number(d[3])*c.maxComponent:null)}return b}static fromHtmlColor(a){function b(a,b,c){return parseInt(a.charAt(b)+a.charAt(c),16)}let d=new c;if("string"==typeof a&&"#"===a.charAt(0))switch(a.length){case 9:d.A=b(a,1,2),d.R=b(a,3,4),d.G=b(a,5,6),d.B=b(a,7,8);break;case 7:d.R=b(a,1,2),d.G=b(a,3,4),d.B=b(a,5,6);break;case 4:d.R=b(a,1,1),d.G=b(a,2,2),d.B=b(a,3,3)}else/^rgb.+/.test(a)&&(d=c.fromRgbaString(a));return d}static toHtmlString(a,b){function d(a){let b=Number(a);if(!(b>=0&&b<=c.maxComponent))throw Error("Argument must be a Number in [0, 255]");let d=b.toString(16);return b<16&&(d="0"+d),d}return a.A<c.maxComponent&&!b?"rgba("+a.R.toString(10)+", "+a.G.toString(10)+", "+a.B.toString(10)+", "+(a.A/c.maxComponent).toFixed(2)+")":"#"+(b?d(a.A):"")+d(a.R)+d(a.G)+d(a.B)}constructor(){this.R=0,this.G=0,this.B=0,this.A=c.maxComponent}}c.maxComponent=255,b.a=c}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={ShareToTeams:0,SimplifiedV2:1}}
,function(a,b,c){let d;function e(){return d}function f(a){d=a}c.d(b,{a:function(){return e},b:function(){return f}})}
,,,,,,,function(a,b,c){c.d(b,{a:function(){return k}});var d=c("react-lib"),e=c("prop-types-lib");(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Header-width{width:100%}@media screen and (max-width:352px){.Header-width{max-width:294px}}.Header-flex-row{display:flex;flex-direction:row;align-items:center;column-gap:.25rem}.Header-flex-row i{font-size:.875rem}@supports (font:-apple-system-body){.Header-flex-row i{font:-apple-system-body}}.Header-flex-row button:hover{outline:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:4px}.Header-flex-grow{flex-grow:1}.Header-main-text{white-space:nowrap;overflow:hidden;display:flex;flex-direction:column;align-self:center}.Header-filename{margin:0;font-size:1.25rem;font-weight:600;overflow:hidden;text-overflow:ellipsis}@media screen and (max-width:511px){.Header-filename{font-size:1rem}@supports (font:-apple-system-body){.Header-filename{font:-apple-system-body}}}.Header-filename.ie{font-size:1.25rem}@supports (font:-apple-system-title2){.Header-filename{font:-apple-system-title2}}.Header-filename.mobile{overflow:unset;text-overflow:unset;white-space:break-spaces;word-break:break-all}.Header-subheader{font-size:.875rem}@supports (font:-apple-system-body){.Header-subheader{font:-apple-system-body}}.Header-subheader.ie{max-width:320px;overflow:hidden;text-overflow:ellipsis}.Header-odc h1{font-size:1.25rem}.Header-contextual{font-weight:600;font-size:.75rem}.Header-actions{padding-left:5px;gap:5px;flex-shrink:1;row-gap:.5rem}.Header-actions button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.Header-backButton button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin-right:5px}[dir=rtl] .Header-backButton button{transform:scale(-1,1)}"}]);var f=c(18),g=c(20),h=c(112),i=c(189),j=c(16);function k({actions:a,mainHeaderText:b,subHeaderText:c,className:e,fullHeaderText:k,isFilenameTruncated:l,isSubHeaderTextTruncated:m,itemTypePrefix:n,renderBackButton:o,onBackButtonClicked:p,isContextualHeader:q},{platformDetection:r}){let s=r.isIE?"ie":"",t=`Header-filename ${!(0,j.U)()&&r.isMobile?"mobile ":""} ${s}`,u=n?n+" "+b:b,v=()=>q?d.createElement("div",{className:t+" Header-contextual","aria-label":l?void 0:u},b):d.createElement("h1",{className:t,"aria-label":l?void 0:u},b),w=()=>d.createElement("span",{className:`Header-subheader ${s}`},c);return d.createElement("div",{className:`Header-flex-row Header-width ${s} ${e}`},o&&d.createElement("div",{className:"Header-flex-row Header-backButton"},d.createElement(i.a,{iconProps:{iconName:"Back"},ariaLabel:g.ub,onClick:p,tooltipContent:g.ub,automationId:"Header-backButton"})),d.createElement("div",{className:"Header-main-text Header-flex-grow"},l?(0,h.b)(v(),k,{position:f.a.bottomLeftEdge}):v(),m?(0,h.b)(w(),c,{styles:{root:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"320px"}},position:f.a.bottomLeftEdge}):w(),o&&h.a(b,"assertive","alert")),d.createElement("div",{className:"Header-flex-row Header-actions"},a))}k.contextTypes={platformDetection:e.object.isRequired}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return h},b:function(){return f},c:function(){return d},d:function(){return k},e:function(){return j},f:function(){return i},g:function(){return g},h:function(){return e},i:function(){return l},j:function(){return m}});let d=6e4,e=12e4,f=36e5,g=72e5,h=864e5,i=1728e5,j=6048e5,k=27648e5;function l(a,b){return a.getDate()===b.getDate()&&Math.abs(b.getTime()-a.getTime())<h}function m(a,b,c){if(a)try{return a.toLocaleDateString(b,c)}catch(b){return a.toLocaleDateString([],c)}}}
,function(a,b,c){c.d(b,{a:function(){return q}});var d=c("react-lib"),e=c(495),f=c(51),g=c(4),h=c(2),i=c(9),j=c(317),k=c(48);let l=(0,f.a)({root:{fontSize:"inherit",fontWeight:"inherit",[h.h]:{color:"LinkText"}}}),m=(0,f.a)({root:{fontSize:"inherit",fontWeight:"inherit",[h.h]:{MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},outlineColor:"transparent"}}),n=(0,f.a)({disabled:{color:j.a.semanticDisabledText,":hover":{color:j.a.semanticDisabledText},":active":{color:j.a.semanticDisabledText}}}),o=new Set(["as","componentRef","disabled","styles","theme","type","underline"]),p=(0,i.a)({useStaticStyles:!0}),q=a=>{let b=(a=>{let{as:b,componentRef:c,disabled:d,ref:e,type:f,underline:i,href:j}=a,q=l(),r=m(),s=n(),t=p(a.styles,{theme:a.theme||(0,h.C)()});return{...(0,k.d)(a,o),appearance:"default",as:b||(j?"a":"button"),type:f,disabled:d,ref:c||e,inline:i,className:(0,g.a)("ms-Link","ms-LinkShim",(j?r:q).root,a.disabled&&s.disabled,t.root,a.className)}})(a);return d.createElement(e.a,b)};q.displayName="LinkShim"}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={...c(494).a,vivaConnectionsSoftBackground:"var(--vivaConnectionsSoftBackground)",semanticPrimaryButtonText:"var(--semanticPrimaryButtonText)",semanticPrimaryButtonTextHovered:"var(--semanticPrimaryButtonTextHovered)",semanticPrimaryButtonBackgroundHovered:"var(--semanticPrimaryButtonBackgroundHovered)",semanticButtonBackgroundDisabled:"var(--semanticButtonBackgroundDisabled)",semanticPrimaryButtonBackgroundDisabled:"var(--semanticPrimaryButtonBackgroundDisabled)",semanticButtonTextDisabled:"var(--semanticButtonTextDisabled)",semanticDisabledBackground:"var(--semanticDisabledBackground)",semanticButtonTextHovered:"var(--semanticButtonTextHovered)",semanticButtonBackgroundHovered:"var(--semanticButtonBackgroundHovered)",semanticPrimaryButtonBackgroundPressed:"var(--semanticPrimaryButtonBackgroundPressed)",semanticPrimaryButtonTextPressed:"var(--semanticPrimaryButtonTextPressed)",semanticDisabledText:"var(--semanticDisabledText)",semanticActionLink:"var(--semanticActionLink)",semanticBodyText:"var(--semanticBodyText)",semanticDisabledBodyText:"var(--semanticDisabledBodyText)",semanticDisabledBodySubtext:"var(--semanticDisabledBodySubtext)",semanticInputBackground:"var(--semanticInputBackground)",semanticInputText:"var(--semanticInputText)",semanticPrimaryButtonTextDisabled:"var(--semanticPrimaryButtonTextDisabled)",semanticPrimaryButtonBackground:"var(--semanticPrimaryButtonBackground)",semanticButtonBackground:"var(--semanticButtonBackground)",semanticButtonBorder:"var(--semanticButtonBorder)",semanticButtonBackgroundPressed:"var(--semanticButtonBackgroundPressed)",semanticErrorText:"var(--semanticErrorText)"}}
,,function(a,b){b.a={unavailable:-1,none:0,disabled:1,notShareableByLink:2,parentListIsPrivate:3,parentListIsCatalogDocLib:4,notSupportedByWopi:5,irmIsEnabled:6,documentIsProtectedByDlp:7,forceCheckoutEditLink:8,anonymousEditLinkNotAllowedByTenant:9,nonClaimsWebapp:10,accessDeniedToAnonGuest:11,blockedByWhoCanShareSettings:12,blockedByExternalShareSettings:13,accessDeniedNotEnoughPermissions:14,sharingBlockedByVirusCheckStatus:40,loopFilesExternalSharingNotSupported:43,azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported:49}}
,function(a,b,c){let d,e;c.d(b,{a:function(){return aF}});var f,g,h,i,j,k,l=c("react-lib"),m=c(10);(0,m.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:flex;flex-direction:row;flex-wrap:nowrap}.od-Share-PeoplePickerContainer.space-between{justify-content:space-between}.od-Share-PeoplePickerContainer.normal{justify-content:normal}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-ErrorWarnings-wrapper,.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - (1.75rem + 34px));width:100%;flex-grow:1}.od-Share-PeoplePicker-flexGrow{flex-grow:1;height:100%}.od-Share-PeoplePicker-PeoplePickerIcon{font-size:1.5rem;padding-top:10px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker-PeoplePickerIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker-PeoplePickerIcon{padding-right:12px}#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-RoleSelector{align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}[dir=ltr] .od-Share-PeoplePicker.withIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker.withIcon{padding-right:12px}.od-Share-PeoplePicker .ms-Callout{width:100%}.od-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{font:-apple-system-body}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-body}}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem;font:-apple-system-caption1}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body;white-space:nowrap}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:auto}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker{height:100%;padding:12px 6px 12px 0}.od-Simplified-Share-PeoplePicker.smaller-padding{padding:10px 5px 10px 3px}.od-Simplified-Share-PeoplePicker .ms-Callout{width:100%}.od-Simplified-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Simplified-Share-PeoplePicker.inline .ms-Callout-container{position:static}.od-Simplified-Share-PeoplePicker .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%}.od-Simplified-Share-PeoplePicker.isIE.initial-padding{padding-bottom:4px}.od-Simplified-Share-PeoplePicker.isIE .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%;max-width:320px}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%;height:100%;padding:0}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body}}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Simplified-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{font:-apple-system-body;white-space:break-spaces}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-body;white-space:break-spaces}}@keyframes fadein{0%{opacity:0}100%{opacity:1}}@keyframes fadeout{0%{opacity:1}100%{opacity:0}}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.875rem}.od-Simplified-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem;font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px;height:0;overflow:hidden;opacity:0;align-items:center}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{white-space:nowrap;font:-apple-system-body}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content:focus::after{border-radius:16px;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:";outline-color:transparent;outline:0!important}@media screen and (-ms-high-contrast:active){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content:focus::after{border-radius:16px;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:";outline-color:transparent;outline:0!important}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker .ms-SelectionZone{height:100%}@media screen and (min-width:400px){.ms-Suggestions,.ms-Suggestions-none{width:370px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE{width:448px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-none{width:448px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE{width:432px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-none{width:432px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.inline .ms-Suggestions-spinner{position:static}.od-Share-PeoplePicker-Suggestions-Simplified-Share button.ms-SearchMore-button.is-selected{border:1px solid "},{theme:"black",defaultValue:"#000"},{rawString:"}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Persona-primaryText,.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Persona-secondaryText{font:-apple-system-body}}.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions-Simplified-Share button.ms-Suggestions-itemButton{display:inline-block}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px;width:100%}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{display:inline-block}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container div.ms-PeoplePicker-personaContent{font:-apple-system-headline;height:auto}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button span.ms-Button-label{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir=ltr] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir=rtl] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-selectedItem--warning .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";background-color:RGBA("},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText{color:inherit}}@media (forced-colors:active) and (prefers-color-scheme:dark){:-ms-input-placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){:-ms-input-placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}}.od-RoleSelectorCompact-permissionButton:focus{outline:1px solid}.od-Share-PeoplePicker-selectedItem--error{display:flex}.od-Share-PeoplePicker-height{height:auto}"}]);var n=c(91),o=c(82),p=c(509),q=c(498),r=c(508),s=c(2),t=c(0),u=c(7);class v extends q.b{constructor(...a){super(...a),this.onClick=a=>{this.props.inputProps&&this.props.inputProps.onClick&&this.props.inputProps.onClick(a),0!==a.button||a&&a.target&&a.target.value||this.onEmptyInputFocus()},this.onInputFocus=a=>{!t.a.isActivated("543f1508-f671-478a-9d8e-f38cf68393fd","04/19/2023","Respect the onEmptyResolveSuggestions prop passed to PeoplePicker")&&(this.props.showDefaultSuggestionOnlyByClick||a&&a.target&&a.target.value||!this.props.onEmptyResolveSuggestions||this.onEmptyInputFocus(),!t.a.isActivated("b4438ced-79e1-4575-83ee-86b38ef5fce5","03/30/2025","Show suggestions - on Focus when input is populated")&&this.props.showSuggestionsOnFocusForNonEmptyInput&&a&&a.target&&a.target.value&&this.props.onResolveSuggestions&&u.c.resolve(this.props.onResolveSuggestions(a.target.value,this.state.items)).then(a=>{1===a.length&&a[0].isExternal&&(this.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!0}),this.updateSuggestions(a))}).catch(()=>{})),t.a.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")||this.props.inputProps?.onFocus?.(a)}}}var w=c(259),x=c(60),y=c(43),z=c(331);class A extends x.a{static clear(){new x.a(A._Key,A._DataStoreCachingType).remove(A._StorageKey)}static isCacheEntryFresh(a,b){return a.name===b.name&&a.email===b.email&&a.job===b.job&&a.office===b.office&&a.department===b.department&&a.phone===b.phone}setItem(a){let b=this._getItemKey(a),c=this._data[b];if(c)if(A.isCacheEntryFresh(c,a))return;else{let b=this._buffer.dataArray.map(a=>a.userId).indexOf(a.userId);this._buffer.dataArray[b]=a}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);let b=this._buffer.dataArray[this._buffer.index],c=this._getItemKey(b);delete this._data[c],this._buffer.dataArray[this._buffer.index]=a}else this._buffer.dataArray.push(a),this._buffer.index++;this._data[b]=a,this.setValue(A._StorageKey,this._buffer)}getItems(a,b){let c=[];for(let d=0;d<this._buffer.dataArray.length;d++){let e=(this._buffer.index-d+this._MaxItems)%this._MaxItems,f=this._buffer.dataArray[e];(f.email&&f.email.toLowerCase().indexOf(a.toLowerCase())>=0||f.name&&f.name.toLowerCase().indexOf(a.toLowerCase())>=0)&&!(b&&f.entityType===o.a.externalUser)&&c.push(f)}return c}containsItem(a){let b=this._getItemKey(a);return!!this._data[b]}initializeBuffer(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()}_getItemKey(a){return a.email||a.userId||(0,z.a)(JSON.stringify(a)).toString()}constructor(){if(super(A._Key,A._DataStoreCachingType),this._MaxItems=200,this._Version=5,this._buffer=this.getValue(A._StorageKey),this._buffer&&this._buffer.version===this._Version&&this._buffer.lastCachePrune||this.initializeBuffer(),this._data={},Date.now()<this._buffer.lastCachePrune+6048e5)for(let a=0;a<this._buffer.dataArray.length;a++){const b=this._buffer.dataArray[a],c=this._getItemKey(b);this._data[c]=b}else this.initializeBuffer(),this.setValue(A._StorageKey,this._buffer)}}A._Key="ClientPeoplePicker",A._StorageKey="MRU",A._DataStoreCachingType=y.a.local;class B{search(a,b){let c,d,e={cached:null,promise:null};return this._mruCache&&!b.groupID&&(d=this.searchMruCache(a,b&&b.filterExternalUsers)).length>0&&(e.cached=d),e.promise=new u.c((e,f)=>{c=this._dataSource.search(a,b).then(a=>{if(a)if(d){d.length>0&&(d=this._removeStaleCacheResults(d,a));let b=d.map(a=>a.userId);e(a.filter(a=>0>b.indexOf(a.userId)))}else e(a)},a=>{f(a)})},()=>{c&&c.cancel()}),e}resolve(a,b){return this._dataSource.resolve(a,b).then(a=>(this._mruCache&&a.isResolved&&this.addToMruCache(a),a))}getPersonaDetails(a){return this._dataSource.getPersonaDetails(a).then(a=>a)}subscribePresence(a,b){return this._dataSource.subscribePresence(a,b)}addToMruCache(a){let b=this._mruCache;b&&a.rawPersonData&&a.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==a.rawPersonData.EntityData.PrincipalType&&b.setItem(a)}getPickerEntityInformation(a){return this._dataSource.getPickerEntityInformation(a)}sharePointSearch(a,b){return this._dataSource.sharePointSearch(a,b).then(a=>a)}canUseGraph(a){return this._dataSource.canUseGraph(a)}canUseSubstrate(a){return this._dataSource.canUseSubstrate(a)}getLivePersonaPickerHelper(){return this._dataSource.getLivePersonaPickerHelper()}searchMruCache(a,b){let c=[],d=this._mruCache;if(d){c=d.getItems(a,b);let e=this.MaxCacheSuggestions;c.length>e&&(c=c.splice(0,e))}return c}_removeStaleCacheResults(a,b){let c=a.map(a=>a.userId),d=[];return b.forEach(b=>{let e=c.indexOf(b.userId);if(e>-1){let c=a[e];A.isCacheEntryFresh(c,b)&&d.push(c)}}),d}constructor(a){this._dataSource=a.peoplePickerDataSource?a.peoplePickerDataSource:new w.a({imageAbsoluteWebUrl:a.imageAbsoluteWebUrl},{pageContext:a.pageContext,apiUrlHelper:a.apiUrlHelper,graphPeoplePickerHelper:a.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new A,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}}var C=c(83),D=c(75),E=c(326),F=c(63),G=c(18),H=c(64),I=c(12),J=c(54),K=c(39);(0,m.b)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_0da91ac4{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.itemContent_0da91ac4>.fui-Persona{vertical-align:bottom}.peoplePickerPill_0da91ac4{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerPillLong_0da91ac4{overflow-x:hidden}.peoplePickerClose_0da91ac4{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_0da91ac4{padding-left:4px}html[dir=rtl] .peoplePickerClose_0da91ac4{padding-right:4px}.peoplePickerClose_0da91ac4:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_0da91ac4{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.personDisplayName_0da91ac4{white-space:nowrap}html[dir=ltr] .personDisplayName_0da91ac4{padding-left:8px}html[dir=rtl] .personDisplayName_0da91ac4{padding-right:8px}.personDisplayNameLong_0da91ac4{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .personDisplayNameLong_0da91ac4{padding-left:8px}html[dir=rtl] .personDisplayNameLong_0da91ac4{padding-right:8px}"}]);let L="itemContent_0da91ac4",M="placeholderUser_0da91ac4";var N=c(503),O=c(28),P=c(400);function Q(a){return!!(a.invitationId||(a.rawData||a.rawPersonData)?.EntityData?.invitation)}(f=i||(i={}))[f.standalone=0]="standalone",f[f.pill=1]="pill";var R=c(19);let S=O.b.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||t.a.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function T(a,b,c){let d="3rem";if(b)switch(b){case D.c.size24:d="1.5rem";break;case D.c.size32:d="2rem";break;case D.c.size40:d="2.5rem";break;case D.c.extraSmall:d="1.75rem";break;default:d="3rem"}let e={text:a.name?a.name:"",imageUrl:a.image?a.image:"",tertiaryText:a.email?a.email:"",secondaryText:a.job?a.job:"",imageInitials:"",imageAlt:a.imageAlt,coinProps:{styles:{coin:{width:d,height:d,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:d+"!important",height:d+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:d,height:d,maxWidth:"75px",maxHeight:"75px"},initials:{width:d,height:d,fontSize:"0.625rem",lineHeight:d}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return Q(a)&&void 0!==c?(0,P.default)(e,function(a,b={}){let c=(0,s.C)(),{fontSize:d}=b;return{coinProps:{styles:{initials:0===a?{border:`1px dashed ${c.palette.themePrimary}`,boxSizing:"border-box",fontSize:d??"16px",fontWeight:"normal",color:c.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:d??"12px",color:c.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:D.a.transparent,onRenderInitials:()=>l.createElement(I.a,{iconName:"Contact",style:{fontWeight:"normal"}})}}(c)):e}t.a.isActivated("7bea0040-4f76-46a3-90db-3a21f5719701"),t.a.isActivated("81c3fff0-7a03-4efe-9c89-ec39ac25fd96");let U=a=>l.createElement("div",{className:"ms-PeoplePicker-personaContent"},l.createElement(E.a,{...a.personaProps,presence:D.b.none,size:D.c.size40,className:"ms-PeoplePicker-pickerPersona"}),a.person.entityType===o.a.linkedinUser&&l.createElement(I.a,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"})),V=a=>{let{item:b,onRemoveItem:c,index:d,selected:e,removeButtonAriaLabel:f}=a,g=T(b,D.c.extraSmall,i.pill);return S||(g.onRenderPrimaryText=()=>l.createElement(F.a,{content:b.email||g.text,directionalHint:G.a.topLeftEdge},g.text)),l.createElement("div",{className:(0,J.a)("ms-PickerPersona-container",{"is-selected":!!e,[M]:Q(b)}),"data-is-focusable":!0,"data-selection-index":d,key:d,role:"listitem"},l.createElement("div",{className:(0,J.a)("ms-PickerItem-content",L)},l.createElement(E.a,{...g,presence:D.b.none,size:D.c.extraSmall})),l.createElement(H.a,{styles:{root:{flexShrink:0}},onClick:c,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":f??K.b(N.b,b.name),disabled:a.disabled}))},W=a=>{let{item:b,onRemoveItem:c,index:d,selected:e}=a,f=T(b,D.c.size40),g="PickerPersonaId"+Math.floor(1e4*Math.random()),h=K.b(N.b,b.name);return l.createElement("div",{className:(0,J.a)("ms-PickerPersona-container is-listbelow",{"is-selected":!!e}),"data-is-focusable":!0,"data-selection-index":d,key:d,"aria-labelledby":g,role:"listitem"},l.createElement("div",{className:"ms-PickerPersona-content"},l.createElement(E.a,{id:g,...f,presence:D.b.none,size:D.c.size40})),l.createElement("div",{className:"ms-PickerItem-content"},l.createElement(H.a,{onClick:c,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":h})))},X=a=>{let{item:b,onRemoveItem:c,index:d,selected:e,removeButtonAriaLabel:f}=a,g=T(b,D.c.extraSmall,i.pill),h=l.useRef(null),j=l.useRef(null);l.useEffect(()=>{h.current&&j.current&&(h.current.style.animation="fadein 200ms",h.current.style.transition="height 200ms cubic-bezier(0.33,0.00,0.10,1.00)",h.current.style.height=`${j.current.scrollHeight}px`,h.current.style.opacity="1")},[]);let k=b.email&&b.email!==g.text;return S||(g.onRenderPrimaryText=()=>l.createElement(F.a,{content:l.createElement("div",null,l.createElement("div",null,g.text&&g.text),k&&l.createElement("div",null,b.email)),directionalHint:G.a.topLeftEdge},g.text)),l.createElement("div",{className:(0,J.a)("ms-PickerPersona-container",{"is-selected":!!e,[M]:Q(b)}),"data-is-focusable":!0,key:d,role:"listitem",ref:h},l.createElement("div",{ref:j,className:(0,J.a)("ms-PickerItem-content",L)},l.createElement(E.a,{...g,presence:D.b.none,size:D.c.extraSmall})),l.createElement(H.a,{styles:{root:{flexShrink:0}},onClick:c,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":f??K.b(N.b,b.name),disabled:a.disabled}))};(g=j||(j={}))[g.normal=0]="normal",g[g.listBelow=1]="listBelow",(0,m.b)([{rawString:".userEditorSuggestions button.ms-SearchMore-button.is-selected{border:1px solid "},{theme:"black",defaultValue:"#000"},{rawString:"}:global(.ms-Suggestions){width:260px}"}]);var Y=c(6);let Z=t.a.isActivated("99213f0a-a674-46cb-9a5e-862f6da36e46")||Y.a.isEcsFeatureEnabled({ECS:1529785}),$=t.a.isActivated("92e03f61-4fc9-4abf-b8b5-4a1c50e7ed61","05/10/2025","joannakuo: show search directory button for cached results"),_=q.a;class aa extends n.a{get selectedPeople(){return this._peoplePicker&&this._peoplePicker.items||[]}render(){let{className:a,onRenderItem:b,onRenderSuggestionsItem:c,defaultSelectedItems:d,onSelectedPersonasChange:e,suggestionsHeaderText:f,suggestionsClassName:g,suggestionsItemClassName:h,noResultsFoundText:k,loadingText:m,inputProps:n,onSuggestionSelected:o,suggestionsAvailableAlertText:p,enableSelectedSuggestionAlert:q,selectedItems:r,itemLimit:t,onInputChange:u,onGetMoreResults:w,searchForMoreIcon:x,searchForMoreText:y,ariaLabel:z="",pickerCalloutProps:A,mergeStyles:B,pickerOverrideStyles:C,theme:E,disabled:F,onGetMoreResultsClicked:G,removeButtonAriaLabel:H,onEmptyResolveSuggestions:I,customizeSuggestionPersonaProps:J,showDefaultSuggestionOnlyByClick:K}=this.props;this._onGetMoreResultsClicked=G;let L={className:a,onRenderSuggestionsItem:c||(a=>((a,b)=>{let c,d=T(a,D.c.size40,i.standalone);if(c=d,b&&(c=b(d)),c&&c.imageUrl){let a=new R.a(c.imageUrl);a.setQueryParameter("fromPeoplePicker","true"),c.imageUrl=a.toString()}return l.createElement(U,{person:a,personaProps:c})})(a,J)),onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:d,selectedItems:r,onChange:e,inputProps:n,enableSelectedSuggestionAlert:q,theme:E||(B?(0,s.C)():void 0),pickerSuggestionsProps:{suggestionsHeaderText:f,loadingText:m,noResultsFoundText:k,className:g,suggestionsItemClassName:h,suggestionsAvailableAlertText:p,searchForMoreIcon:x,searchForMoreText:y||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:N.a},onItemSelected:o,itemLimit:t,onInputChange:u,onGetMoreResults:w||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:A,styles:B?this._mergeStylesWithBasePicker:C,"aria-label":z,disabled:F,removeButtonAriaLabel:H,onEmptyResolveSuggestions:K&&(this._canCallGraph||!Z&&this.props.useSubstrateForDefaultSuggestions)?()=>(this.props.initRumone&&this.props.initRumone("",!0),this._onResolveSuggestions("")):I,showDefaultSuggestionOnlyByClick:K,onBlur:this.props.onGhostHide,showSuggestionsOnFocusForNonEmptyInput:this.props.showSuggestionsOnFocusForNonEmptyInput};return this.props.peoplePickerType===j.listBelow?(L.onRenderItem=b||W,l.createElement(_,{...L,componentRef:this._resolveRef("_peoplePicker")})):(L.onRenderItem=b||V,l.createElement(v,{...L,componentRef:this._resolveRef("_peoplePicker")}))}focusInput(){this._peoplePicker&&this._peoplePicker.focusInput()}_getPeoplePickerQueryParams(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:C.a.user|C.a.securityGroup|C.a.sharePointGroup}}_dedupeSuggestions(a){let b=[],c=this._peoplePicker&&this._peoplePicker.items||[];for(let d of(c=[...c],a)){let a=this._getItemKey(d);c.some(b=>a===this._getItemKey(b))||(b.push(d),c.push(d))}return b}_getItemKey(a){return a.email||a.userId||(0,z.a)(JSON.stringify(a)).toString()}_onToggleGetMoreResults(a){this.state&&(a&&!this.state.searchForMoreText||!a&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(a)})}_getSearchForMoreText(a){return a?N.c:void 0}constructor(a){if(super(a),this._onResolveSuggestions=a=>{if(this._peoplePickerSearchPromise&&(this._peoplePickerSearchPromise.cancel(),this._peoplePickerSearchPromise=void 0),a=a.trim(),Z&&!a&&!this._canCallGraph)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],a):[];let b=this._getPeoplePickerQueryParams(),c=b?.conversationId;b&&b.conversationId&&delete b.conversationId;let d=`peoplePickerSearch_${a.trim()}_${JSON.stringify(b)}`;if(b&&c&&(b.conversationId=c),!Z&&this.props.useSubstrateForDefaultSuggestions&&(b.useSubstrate=!0),!Z){let c=!!(!Z&&this.props.useSubstrateForDefaultSuggestions&&this._dataProvider.canUseSubstrate?.(b));if(!a&&!this._canCallGraph&&!c)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],a):[]}let e=()=>{let c=this._dataProvider.search(a.trim(),b);if(!c)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],a):[];let d=c.cached?c.cached:[];return this._peoplePickerSearchPromise=c.promise,this._peoplePickerSearchPromise.then(a=>(this._peoplePickerSearchPromise=void 0,a?d.concat(a):[])).then(b=>{let c=this._dedupeSuggestions(b);return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions(c,a):c})};if(!this.props.peoplePickerImprovementsExperiment||!this.props.persistCachePeopleSearch)return e().then(a=>(this._callRumOneLoggerFromProps(),a));try{return this.props.persistCachePeopleSearch({getData:e,key:d}).then(a=>{let b=!isNaN(a.cacheStats.lastModified);return this._callRumOneLoggerFromProps(b),$||this.props.peoplePickerQueryParams?.onToggleGetMoreResults?.(!0),a.data})}catch{return e().then(a=>(this._callRumOneLoggerFromProps(),a))}},this._callRumOneLoggerFromProps=(a=!1)=>{this.props.writeUserInputDataToRumoneLogger&&this.props.writeUserInputDataToRumoneLogger(a)},this._onGetMoreResults=a=>{let b;return(this._onGetMoreResultsClicked&&this._onGetMoreResultsClicked(),this.props.peoplePickerQueryParams&&((b={...this.props.peoplePickerQueryParams}).useGraph=!1,b.useSubstrate=!1),this._dataProvider&&this._dataProvider.sharePointSearch&&b)?this._dataProvider.sharePointSearch(a,b).then(b=>{if(this.props.onResolvedSuggestions){let c=this.props.onResolvedSuggestions(b,a);if(c instanceof Array)return c}return b}):[]},this._mergeStylesWithBasePicker=a=>{let b=(0,r.a)(a);return(0,s.t)(b,this.props.pickerOverrideStyles)},a.dataProvider)this._dataProvider=a.dataProvider;else{if(!a.context)throw Error("No pageContext available for PeoplePickerProvider.");this._dataProvider=new B({pageContext:a.context,peoplePickerDataSource:a.dataSource})}this._canCallGraph=!!(this._dataProvider.canUseGraph&&this.props.peoplePickerQueryParams&&this._dataProvider.canUseGraph(this.props.peoplePickerQueryParams)),this._handleGetMoreResultsInBaseClass=this._canCallGraph&&!this.props.onGetMoreResults,this.state={hasUnresolvedText:!1,searchForMoreText:this._getSearchForMoreText(this._handleGetMoreResultsInBaseClass)}}}var ab=c(85),ac=c(37),ad=c(45),ae=c(206),af=c("prop-types-lib"),ag=c(20),ah=c(47),ai=c(74),aj=c(105),ak=c(34),al=c(150),am=c(207),an=c(16),ao=c(112),ap=c(321),aq=c(26),ar=c(322),as=c(133),at=c(92),au=c(496),av=c(315),aw=c(323),ax=c(139);(h=k||(k={}))[h.None=0]="None",h[h.Family=1]="Family",h[h.FamilyMember=2]="FamilyMember",d=`
  @media screen and (-ms-high-contrast: active) {
    .ms-Button-flexContainer:hover {
      font-size: inherit !important;
      color: inherit !important;
      forced-color-adjust: none;
    }
  }
  `,(e=document.createElement("style")).innerHTML=d,document.head.insertAdjacentElement("beforeend",e);let ay="peoplepicker";class az extends n.a{UNSAFE_componentWillReceiveProps(a){let b=a.defaultSelectedItems,c=this.props.defaultSelectedItems,d=[];c.forEach(a=>{let c=b.filter(b=>b.name===a.name);c.length>0&&d.push({name:c[0].name,userId:c[0].userId})}),this.setState({selectedItems:b,addedUsers:d})}componentDidUpdate(a,b){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;let c=b.addedUsers,d=this.state.addedUsers,{removedUsers:e}=this.state;a.defaultSelectedItems?.length!==this.props.defaultSelectedItems?.length&&this.setState({previousUsers:a.defaultSelectedItems}),this._showSimplifiedDialog&&this._peoplePicker?.scrollHeight&&this._peoplePicker.scrollHeight!==this.props.height&&this.props.setHeight&&(this.state.previousUsers?.length>this.props.defaultSelectedItems.length?this.props.setHeight(this._peoplePicker?.scrollHeight):this.props.setHeight("auto"));let f=200*!!this._showSimplifiedDialog;this._resizeTracker?setTimeout(()=>{this._resizeTracker.checkSizeChange(this._peoplePicker)},f):(this._showSimplifiedDialog||null!==this.props.error&&null===a.error)&&setTimeout(()=>{this._resize()},f);let g=!1;c.length>d.length?(e=c.filter(function(a){return -1===d.indexOf(a)}),this.setState({removedUsers:e}),g=!0):c.length!==d.length&&e.length>0&&(this.setState({removedUsers:[]}),g=!0);let h=this._platformDetection&&this._platformDetection.isIE;(this._peoplePickerControl&&(!h||this._showSimplifiedDialog)&&this.props.error&&!this._hasTakenErrorFocus||g||this.props.focusPeoplePicker)&&(this._peoplePickerControl.current?.focusInput(),this.props.error&&(this._hasTakenErrorFocus=!0)),an.Jb()||this.props.sharingInformation.errorCategory!==ab.a.shareObject||c.length===d.length||this.context.sharingStore.resetSharingInformationError()}componentDidMount(){let a=this._platformDetection&&this._platformDetection.isIE;this._peoplePickerControl&&(!a||this._showSimplifiedDialog)&&this._peoplePickerControl.current?.focusInput()}render(){let a,b={placeholder:this._computePlaceholderText(),autoFocus:!0,onFocus:a=>{this._onFocus()},onBlur:a=>{this._onBlur()},"aria-label":this._computePlaceholderText()},c=this.props.pickerSettings,d=!!this.props.sharingInformation.enforceIBSegmentFiltering,e={principalSource:c.PrincipalSource,principalType:this._convertPrincipalType(c.PrincipalAccountType),querySettings:c.QuerySettings,allowEmailAddresses:!!an.xb()||c.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:c.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph&&!an.E(),useSubstrate:d||an.E(),onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:ak.a.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:this.props.sharingInformation.siteIBMode,useNew3Ssearch:c.useNew3Ssearch,filterPersonalAndImplictContacts:an.Fb(),enforceIBSegmentFiltering:d},f=this.state.selectedItems.length>0&&"smaller-padding",g=this._platformDetection?.isIE&&`isIE ${0===this.state.selectedItems.length&&"initial-padding"}`,h=this.props.renderIcon?"withIcon":"",i=this.props.error&&!this._showSimplifiedDialog?"od-Share-PeoplePicker ms-Share-PeoplePicker--error "+h:this._showSimplifiedDialog?`od-Simplified-Share-PeoplePicker ${g} ${f}`+h:"od-Share-PeoplePicker "+h;i+=" inline";let j=ah.g(this.props.clientId)||this._platformDetection&&this._platformDetection.isMobile,k={preventDismissOnScroll:j,preventDismissOnResize:!0};this._showSimplifiedDialog&&(k.target=this.props.peoplePickerRef,k.doNotLayer=!0,k.styles={root:{left:"0 !important",...{top:`${Math.min(this._peoplePicker?.scrollHeight+2,126)}px !important`}}});let m=j?ag.Ad:ag.Ld,n=this.props.roleSelectorProps&&this.props.roleSelectorProps.roleSelectorAs,o=document.body,p=o?parseInt(getComputedStyle(o).fontSize,10):null;p&&p>16&&!(this._platformDetection&&this._platformDetection.isIE)&&(a={flexWrap:"wrap"}),this._showSimplifiedDialog&&(a={...a,width:"100%",height:this.props.height&&this.props.height,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"});let q=a=>{let b=this._persistentRequestCache.getRequestKey(a.key,"POST");return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:an._c()?aw.a.useCacheIfNotExpired:aw.a.useCacheAndUpdateInTheBackground,cacheTimeoutTime:av.a,cacheRequestKey:b,getData:a.getData,returnStatistics:!0})},r=`od-Share-PeoplePicker-Suggestions${this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":""}`;return this._showSimplifiedDialog&&(r=`od-Share-PeoplePicker-Suggestions-Simplified-Share ${this._platformDetection.isIE?"isIE":"isNotIE"} od-Share-PeoplePicker-Suggestions-condensed`),r+=" inline",l.createElement("div",{style:a,ref:this.props.peoplePickerRef},l.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",role:"presentation",className:this._showSimplifiedDialog?"od-Share-PeoplePicker-height":void 0},ao.a(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),l.createElement("div",{className:this._showSimplifiedDialog?`od-Share-PeoplePicker-flexGrow ${this.props.renderIcon?"normal":"space-between"}`:`od-Share-PeoplePickerContainer ${this.props.renderIcon?"normal":"space-between"}`},this.props.renderIcon&&l.createElement(I.a,{className:"od-Share-PeoplePicker-PeoplePickerIcon",iconName:"CirclePlus"}),l.createElement("div",{className:"od-Share-PeoplePicker-wrapper",ref:a=>{this._peoplePicker=a}},l.createElement(aa,{"aria-describedby":"inputErrorMessage",componentRef:a=>{this._peoplePickerControl.current=a},className:i,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:b,loadingText:ag.ke,noResultsFoundText:ag.yf,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:e,suggestionsClassName:r,onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store&&this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,customizeSuggestionPersonaProps:this._customizeSuggestionsItem,onGetMoreResults:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:m,enableSelectedSuggestionAlert:this._platformDetection&&this._platformDetection.isIE,role:"presentation",pickerCalloutProps:k,peoplePickerImprovementsExperiment:!!at.d(),persistCachePeopleSearch:q,writeUserInputDataToRumoneLogger:this._writeUserInputDataToRumoneLogger,initRumone:this._initRumone,showDefaultSuggestionOnlyByClick:!0,useSubstrateForDefaultSuggestions:an.E(),showSuggestionsOnFocusForNonEmptyInput:!0})),this.props.renderRoleSelector&&l.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},l.createElement(n,this.props.roleSelectorProps))),!this._showSimplifiedDialog&&l.createElement("div",{className:"od-Share-PeoplePickerContainer"},l.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))))}_onResolvedSuggestions(a,b){if((an.S()||(0,ax.d)()&&an.R())&&ah.t(this.props.clientId)){let c=this._store.getFamily(),d=this._store.getFamilyMembers();if(c&&b.length>1){let e=0===ag.Md.toLocaleLowerCase().indexOf(b.toLocaleLowerCase()),f=!1,g=0;e?(g=1,f=!0,a=[c].concat(d,a)):(a.forEach((b,e)=>{d.forEach(d=>{(f||b.userId!==d.userId)&&b.email!==d.email||(a.splice(e+1,0,c),f=!0)})}),f&&(g=2)),this.setState({familyType:g}),f&&!this.state.familyResolveEventFired&&(this.setState({familyResolveEventFired:!0}),this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:ac.a.share,familySuggestionType:k[g]}))}}let c=[],d=[this._store.getCurrentUserId()],e=[];a.forEach(a=>{(0,aq.tb)(a.image,this._clientId)&&(a.image=void 0),(0,ax.d)()&&an.R()&&!an.T()&&(a.rawPersonData=a.rawPersonData??(a.entityType===o.a.group?{Key:a.userId,EntityData:{PermissionIdentityType:"Group"},isResolved:!1}:{Key:a.email,isResolved:!1})),-1===d.indexOf(a.userId)&&-1===c.indexOf(a.email)&&(this.state.addedUsers.some(b=>b.name===a.name&&b.userId===a.userId)||e.push(a),a.userId&&d.push(a.userId),a.email&&c.push(a.email))});try{return this.props.onResolvedSuggestions(e)}catch(a){return e}}_createGenericPerson(a){return{userId:a,name:a,email:a,isResolving:!0}}_customizeSuggestionsItem(a){return{...a,"aria-label":`${a.text} ${a.secondaryText}`}}_onRenderSuggestionsItem(a){let b=a.email&&a.email!==a.name?a.email:"",c={text:a.name||"",imageUrl:a.image||"",tertiaryText:a.email&&a.email!==a.name?a.email:"",secondaryText:b,imageInitials:"",imageAlt:a.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return c["aria-label"]=`${c.text} ${c.secondaryText}`,l.createElement("div",{className:"ms-PeoplePicker-personaContent"},l.createElement(E.a,{...c,presence:D.b.none,size:D.c.size40,className:"ms-PeoplePicker-pickerPersona"}),a.entityType===o.a.linkedinUser&&l.createElement(I.a,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))}_onAutoResolve(a){let b=this.props.pickerSettings,c={principalSource:b.PrincipalSource,principalType:this._convertPrincipalType(b.PrincipalAccountType),querySettings:b.QuerySettings,allowEmailAddresses:b.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:this._showSimplifiedDialogV2,forceResolve:!0};this._peoplePickerProvider.resolve(a.email,c).then(b=>{!b.email&&b.rawData&&b.rawData.EntityData&&(b.email=b.rawData.EntityData.OtherMails),!b.name&&b.rawData&&b.rawData.EntityData&&(b.name=b.rawData.EntityData.OtherMails);let c=[];this.state.selectedItems.forEach(d=>{d.email===a.email?c.push(b):c.push(d)}),this.setState({selectedItems:c},()=>{this.props.onChange(c)})}).catch(()=>{let b={...a,isResolving:!1},c=[];this.state.selectedItems.forEach(d=>{d.email===a.email?c.push(b):c.push(d)}),this.setState({selectedItems:c},()=>{this.props.onChange(c)})})}_isResolveInProgress(){for(let a of this.state.selectedItems)if(a.isResolving)return!0;return!1}_computePlaceholderText(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?ag.nh:ag.th}_computePeopleAddOrRemoveMessage(){let{previousUsers:a}=this.state,b=this.props.defaultSelectedItems,c=(a,b)=>{let c={};a.map(a=>c[a.email]?c:c[a.email]=a),b.map(a=>c[a.email]?c:c[a.email]=a);let d={};a.map(a=>d[a.email]=d[a.email]?d[a.email]+1:1);let e=b.filter(function(a){return!d[a.email]||(d[a.email]=d[a.email]-1,!1)});return Object.keys(d).forEach(function(a){for(;d[a];)e.push(c[a]),d[a]=d[a]-1}),e};if(a?.length>b?.length){let d=c(a,b),e=[];return e.push(d.map(a=>K.b(ag.$g,a.name))),e.length>0?e.join(", "):""}if(b?.length){let d=c(b,a),e=[];return e.push(d.map(a=>K.b(ag.Zg,a.name))),e.length>0?`${e.join(", ")}. ${ag.th}`:""}}_convertPrincipalType(a){if(!a)return C.a.none;let b=C.a.none;for(let c of a.split(","))"User"===c&&(b|=C.a.user),"DL"===c&&(b|=C.a.distributionList),"SecGroup"===c&&(b|=C.a.securityGroup),"SPGroup"===c&&(b|=C.a.sharePointGroup);return b}_computeAllowExternalUsers(a,b,c){let d=a===ad.a.organizationView,e=a===ad.a.organizationEdit,f=!b&&(0,al.h)(c);return!(d||e)&&(b||f)}_renderError(){let a=this.props.error;if(a&&!this._isResolveInProgress())return this._peoplePickerControl&&!this._hasTakenErrorFocus&&(this._peoplePickerControl.current?.focusInput(),this._hasTakenErrorFocus=!0),l.createElement(ap.a,{messages:[{error:a}],backgroundColor:"#FDE7E9",className:"od-Simplified-Share-PeoplePickerErrorIcon",iconName:"Blocked2",textColorType:"error"})}_renderWarnings(){let a=this.props.oversharingExternalsWarning,b=this.props.oversharingGroupsWarning,c=[],d={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error&&(this.state.selectedItems.length===this.props.selectionLimit&&c.push(l.createElement(p.a,{ariaLabel:ag.Xg,styles:d},ag.Xg)),a&&c.push(l.createElement(p.a,{ariaLabel:a,styles:d},a)),b&&c.push(l.createElement(p.a,{ariaLabel:b,styles:d},b)),c.length>0))return l.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},c)}_getSearchForMoreText(a){return a?ag.Vi:void 0}_onFocus(){this._sharingClientMessenger?this._sharingClientMessenger.sendPeoplePickerFocused():ai.s(),this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!0)}_onBlur(){this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!1)}constructor(a,b){super(a),this._inputs=[],this._onItemsChange=a=>{let b=this.state.selectedItems.concat(a);this.setState({selectedItems:b},()=>{this.props.onChange(b)}),a.forEach(a=>{this._onAutoResolve(a)})},this._initRumone=(a,b=!1)=>{(this._inputStartTime||b||!(a.length>1))&&(this._inputStartTime||!b||0!==a.length)||(this._inputStartTime=Date.now(),this._rumoneLogger||(this._rumoneLogger=new ar.a(ay)),this._rumoneLogger.resetRumOneApiMeasurement(),this._rumoneLogger.resetRumOne(),as.a.getRUMOneLogger({name:ay}).startAPIMeasurement({ignore:a=>a.indexOf("/Collector/3.0/")>=0,getAPIName:a=>{let b=a.toLowerCase();return -1!==b.indexOf("graph.microsoft.com/v1.0/me/people")&&-1!==b.indexOf("search")?"GraphSearch":-1!==b.indexOf("/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface.clientpeoplepickersearchuser")?"SPClientPeoplePickerSearchUser":-1!==b.indexOf("https://outlook.office.com/search/api/v1/suggestions")?"SubstrateSearch":void 0}}))},this._onInputChange=a=>{if(this._inputs.push(a),this._initRumone(a),this._hasTakenErrorFocus=!1,a&&a.indexOf(";")>-1){let b=a.split(";").map(a=>{let b=/<[^\]]*>/g.exec(a);if(b&&b[0]&&(a=b[0].substring(1,b[0].length-1)),a=a.trim())return this._createGenericPerson(a)}).filter(a=>a);return this._onItemsChange(b),this.props.onInputChange&&this.props.onInputChange(""),""}let b=/['"].*['"]/g.exec(a);return b&&b[0]?b[0].substring(1,b[0].length-1):(this.props.onInputChange&&this.props.onInputChange(a),a)},this._onGetMoreResults=a=>{let b=this.props.pickerSettings,c={principalSource:b.PrincipalSource,principalType:this._convertPrincipalType(b.PrincipalAccountType),querySettings:b.QuerySettings,allowEmailAddresses:!!an.xb()||b.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!an.ob()&&!!this.props.allowSPGroups||this._showSimplifiedDialogV2,forceResolve:!0,useSubstrate:!!this.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,filterPersonalAndImplictContacts:an.Fb()};return this._peoplePickerProvider.sharePointSearch(a,c).then(a=>a.filter(a=>0===this.state.selectedItems.filter(b=>b.email===a.email).length))},this._onSuggestionSelected=a=>{let b=this.props.pickerSettings,c={principalSource:b.PrincipalSource,principalType:this._convertPrincipalType(b.PrincipalAccountType),querySettings:b.QuerySettings,allowEmailAddresses:b.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:this._showSimplifiedDialogV2,forceResolve:!0};if(this._store.getEngagementHelper().log("PeoplePicker.SuggestionSelected",{clientId:this.props.clientId,mode:ac.a.share,detailedGroupInfo:a.detailedGroupInfo,principalType:void 0===a.principalType?"unknown":C.a[a.principalType],entityType:void 0===a.entityType?"unknown":o.a[a.entityType],isDefaultSuggestion:!/\S/.test(this._inputs.join(""))}),an.S()&&ah.t(this.props.clientId)){let b=this._store.getFamily(),c=this._store.getFamilyMembers();b&&c&&(a.userId===b.userId?this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:this.props.clientId,scenarioId:"",familySuggestionType:k[this.state.familyType],mode:ac.a.share}):c.some(function(b){return b.userId===a.userId})&&this._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:this.props.clientId,scenarioId:"",familySuggestionType:k[this.state.familyType],mode:ac.a.share}))}if(!1===a.isExternal||a.isExternal&&a.providerName)return a;a.principalType===C.a.distributionList&&(c.isGraphDistributionList=!0,c.useGraph=!0);let d=(0,al.j)(a),e=(0,al.h)(a),f=a.userId;return(an.a()&&(0,ax.d)()&&((a.rawData||a.rawPersonData)&&(a.isResolved=a.rawData?.IsResolved??a.rawPersonData?.IsResolved??a.isResolved),f=a.email),!a.isResolved||d)?this._peoplePickerProvider.resolve(f,c).then(b=>(!b.email&&b.rawData&&b.rawData.EntityData&&(b.email=b.rawData.EntityData.OtherMails),!b.name&&b.rawData&&b.rawData.EntityData&&(b.name=b.rawData.EntityData.OtherMails),a.entityType===o.a.linkedinUser&&(b.entityType=a.entityType),void 0===b.isExternal&&(d||e)&&(b.isExternal=!0),b)):a},this._onRenderItem=a=>{let b=this.props.permissionsMap,c=this._computeAllowExternalUsers(this.props.sharingLinkKind,this.props.sharingInformation.canAddExternalPrincipal,a.item),d=!this._showSimplifiedDialogV2||this.props.shareTargetClicked===aq.f.copy,e=!this._showSimplifiedDialog&&this.props.sharingLinkKind===ad.a.direct&&b&&(void 0!==b[a.item.email]&&b[a.item.email]===ae.a.none||void 0!==b[a.item.userId]&&b[a.item.userId]===ae.a.none),f=d&&a.item.isExternal&&!c,g=!this._showSimplifiedDialogV2&&f||d&&e||!a.item.isResolved&&!a.item.isResolving,h=a.item.isExternal,i=a.item.name;return(a.removeButtonAriaLabel=K.b(ag.vi,i),a.item.imageAlt=K.b(ag.cl,i),g||h)?l.createElement("div",{className:`od-Share-PeoplePicker-selectedItem${g?"--error":h?"--warning":""}`},this._showSimplifiedDialog?l.createElement(X,a):l.createElement(V,a)):a.item.isResolving?l.createElement(aj.a,{className:"od-Share-PeoplePicker-resolve-spinner"}):this._showSimplifiedDialog?l.createElement(X,a):l.createElement(V,a)},this._onToggleGetMoreResults=a=>{this.setState({searchForMoreText:this._getSearchForMoreText(this.props.sharingInformation.isGraphAvailable||a)})},this._writeUserInputDataToRumoneLogger=(a=!1)=>{if(this._rumoneLogger){let b=this._rumoneLogger.breakdownData,c={modeName:"peoplePicker",startTime:this._inputStartTime,endTime:Date.now(),breakDownData:{customerInputs:b(this._inputs.length),isSearchFromCache:a}};this._rumoneLogger.logSharingPerformance(c)}this._inputs=[],this._inputStartTime=null},this._peoplePickerProvider=b.peoplePickerProvider,this._resize=b.resize,this._platformDetection=b.platformDetection,this._hasTakenErrorFocus=!1,this._store=b.sharingStore,this._clientId=b.clientId,this._rumoneLogger=null,this._sharingClientMessenger=b.sharingClientMessenger,this._persistentRequestCache=new au.a({id:"PeoplePickerSearch"},{pageContext:b}),this._showSimplifiedDialogV1=(0,aq.ib)(this._clientId,this._store)&&this.props.mode===ac.a.share,this._showSimplifiedDialogV2=(0,aq.ab)(this._clientId,this._store)&&this.props.mode===ac.a.share,this._showSimplifiedDialog=this._showSimplifiedDialogV1||this._showSimplifiedDialogV2,this.state={selectedItems:a.defaultSelectedItems,searchForMoreText:this._getSearchForMoreText(a.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:0,familyResolveEventFired:!1,previousUsers:[]},this._resizeTracker=new am.a(b.resize),this._peoplePickerControl=l.createRef()}}az.contextTypes={peoplePickerProvider:af.object.isRequired,resize:af.func.isRequired,platformDetection:af.object.isRequired,sharingStore:af.object.isRequired,clientId:af.number.isRequired,sharingClientMessenger:af.object};class aA extends l.PureComponent{static getDerivedStateFromError(a){return{hasError:!0}}render(){return this.state.hasError?this.props.fallback?this.props.fallback:null:l.createElement(l.Fragment,null,this.props.children)}componentDidCatch(a,b){this.props.onError&&this.props.onError(a,b)}constructor(a){super(a),this.state={hasError:!1}}}var aB=c(72),aC=c(35),aD=c(208);function aE(a){let{onError:b,componentName:c}=a,d=(0,aD.a)((a,b)=>{aB.a.logError(a,{"react.componentStack":b.componentStack,"react.component":c},{eventName:"ReactRenderError",resultCode:"",resultType:aC.a.Failure})});return l.createElement(aA,{...a,onError:d})}class aF extends l.Component{render(){return l.createElement(aE,{componentName:"peoplePicker.peoplePickerWrapper"},l.createElement(az,{...this.props,selectionLimit:100}))}}}
,function(a,b,c){c.d(b,{a:function(){return j}});var d=c("react-lib"),e=c("prop-types-lib");(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerErrorContainer{display:flex;padding:8px 32px 8px 12px}.od-Share-PeoplePickerErrorContainer .od-Share-PeoplePickerErrorDiv{padding:0 8px;font-size:.75rem;color:#323130}.od-Simplified-Share-PeoplePickerErrorContainer{display:flex;flex-direction:row;padding:4px 0 0 4px}.od-Simplified-Share-PeoplePickerErrorIcon{padding-top:3px}.od-Simplified-Share-PeoplePickerErrorIcon{padding-right:5px;font-size:.625rem}.od-Simplified-Share-PeoplePickerErrorText{font-size:.75rem}.od-Simplified-Share-primary{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Simplified-Share-warning{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-warning i{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-Simplified-Share-info{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-info i{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-error{color:"},{theme:"errorText",defaultValue:"#a4262c"},{rawString:"}.PeoplePickerError-moreDetails{display:flex;flex-direction:row;border:none!important;padding:0!important;font-weight:400!important;font-size:.75rem!important;background-color:transparent!important;height:auto!important;padding-top:2px!important}.PeoplePickerError-moreDetails:hover{background-color:transparent!important}.PeoplePickerError-moreDetailsText:hover{text-decoration:underline}.PeoplePickerError-icon{padding-left:5px}.PeoplePickerError-detailsContainer{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var f=c(12),g=c(26),h=c(119),i=c(208);function j(a,b){let[c,e]=d.useState(!1),j=(0,g.ib)(b.clientId,b.sharingStore)||(0,g.ab)(b.clientId,b.sharingStore),k=(0,i.a)(()=>{e(!c)});return j?d.createElement(d.Fragment,null,a.messages.map((b,e)=>{if(b.errorDetails){let g=d.createElement("div",null,d.createElement(h.a,{className:"PeoplePickerError-moreDetails",onClick:k},d.createElement("div",{className:"PeoplePickerError-moreDetailsText"},"More Details"),d.createElement(f.a,{className:"PeoplePickerError-icon",iconName:"ChevronDown"}))),i=d.createElement("div",null,d.createElement(h.a,{className:"PeoplePickerError-moreDetails",onClick:k},d.createElement("div",{className:"PeoplePickerError-moreDetailsText"},"Hide Details"),d.createElement(f.a,{className:"PeoplePickerError-icon",iconName:"ChevronUp"})),d.createElement("div",{className:"PeoplePickerError-detailsContainer"},b.errorDetails));return d.createElement("div",{key:e,className:`od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-${a.textColorType}`},d.createElement(f.a,{className:`od-Simplified-Share-PeoplePickerErrorIcon ${a.className}`,iconName:a.iconName}),d.createElement("div",{className:`od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-${a.textColorType}`},b.error,c?i:g))}return d.createElement("div",{key:e,className:`od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-${a.textColorType}`},d.createElement(f.a,{className:`od-Simplified-Share-PeoplePickerErrorIcon ${a.className}`,iconName:a.iconName}),d.createElement("div",{className:`od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-${a.textColorType}`},b.error))})):d.createElement(d.Fragment,null,a.messages.map((b,c)=>d.createElement("div",{key:c,className:"od-Share-PeoplePickerErrorContainer",style:{backgroundColor:a.backgroundColor}},d.createElement(f.a,{iconName:a.iconName,className:a.className}),d.createElement("div",{className:"od-Share-PeoplePickerErrorDiv"},b.error))))}j.contextTypes={sharingStore:e.object.isRequired,clientId:e.number.isRequired}}
,function(a,b,c){c.d(b,{a:function(){return k}});var d=c(133),e=c(426),f=c(251),g=c(135),h=c(79);let i="ShareControl",j="TeamsCopyLinkControl";class k{setTeamsCopyLinkLogger(){this._rumOneTeamsCopyLinkLogger=d.a.getRUMOneLogger({name:"sharedialog-copyLink-teams"})}logTeamsCopyLinkPerformance(a){if(this._rumOneTeamsCopyLinkLogger&&this._rumOneTeamsCopyLinkLogger.isRunning())if(this._rumOneTeamsCopyLinkLogger.writeScenarioId("ShareDialog.CopyLink.Teams"),this._rumOneTeamsCopyLinkLogger.addExpectedControl(j),this._rumOneTeamsCopyLinkLogger.setSettings({getStartTime:()=>a}),f.b){let b=new f.a({controlId:j,startTime:a,endTime:Date.now(),renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumOneTeamsCopyLinkLogger.writeControlPerformanceData(b)}else this._rumOneTeamsCopyLinkLogger.components.reportComponent({id:j,startTime:a,endTime:Date.now()})}logSharingPerformance(a,b){if(this._rumone&&this._rumone.isRunning()){let c=this.breakdownData;this._rumone.writeScenarioId(`ShareDialog.${a.modeName}`),this._rumone.addExpectedControl(i),this._rumone.writePageTransitionType(b||e.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();let d=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;if(d&&(this._rumone.collectSPClientFlights(window._spPageContextInfo),this._evaluateExperiments(window._spPageContextInfo)),this._rumone.setSettings({TTISettings:{enabled:!0},getStartTime:()=>this._regulateTime(a.startTime)}),f.b){let b=new f.a({controlId:i,startTime:a.startTime,endTime:a.endTime,renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(b)}else this._rumone.components.reportComponent({id:i,startTime:a.startTime,endTime:a.endTime});let{breakDownData:g}=a,h=this._getResponseEnd();g={...g,waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),isShareDialogASPXHosted:c(d),w3cResponseEnd:c(h-performance.timing.navigationStart),appStart:c(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(h)),render:c(this._regulateTime(a.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))},this._rumone.writeEUPLBreakdown(JSON.stringify(g))}}resetRumOne(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)}breakdownData(a){return{data:a,needFlatten:!0}}_isDateTime(a){let b=new Date;return a>new Date(b.setDate(b.getDate()-1)).getTime()}_regulateTime(a){return this._isDateTime(a)&&g.a?a-performance.timing.navigationStart:a}_getResponseEnd(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN}_evaluateExperiments(a){a&&(0,h.c)(90089,a)}constructor(a="sharedialog"){this.resetRumOneApiMeasurement=()=>{this._rumone.undoAPIInstrument()},this.computeRenderTime=a=>a&&a.startTime&&a.endTime?a.endTime-a.startTime:0,this.checkRenderTimeRequiredDataAvailable=a=>!!a&&!!a.startTime&&!!a.endTime,this._rumone=d.a.getRUMOneLogger({name:a})}}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4,useCacheIfNotExpiredOrOnFailure:5,useCacheAndImmediatelyUpdate:6}}
,,,function(a,b,c){c.d(b,{a:function(){return C}});var d=c("react-lib"),e=c(51),f=c(111),g=c(4),h=c(507),i=c(205),j=c(9),k=c(75),l=c(12),m=c(49),n=c(327),o=c(48);let p=(0,j.a)({cacheSize:100}),q=new Map([[k.b.none,"unknown"],[k.b.away,"away"],[k.b.blocked,"blocked"],[k.b.busy,"busy"],[k.b.dnd,"do-not-disturb"],[k.b.offline,"offline"],[k.b.online,"available"]]),r=new Map([[k.c.size8,16],[k.c.size24,24],[k.c.size32,32],[k.c.size40,40],[k.c.size48,48],[k.c.size56,56],[k.c.size72,72],[k.c.size100,96],[k.c.size120,120],[k.c.tiny,16],[k.c.extraExtraSmall,24],[k.c.extraSmall,28],[k.c.small,40],[k.c.regular,48],[k.c.large,72],[k.c.extraLarge,96],[k.c.size10,16],[k.c.size16,16],[k.c.size28,28]]),s=new Set(["allowPhoneInitials","className","coinProps","coinSize","componentRef","hidePersonaDetails","imageAlt","imageInitials","imageShouldFadeIn","imageShouldStartVisible","imageUrl","initialsColor","initialsTextColor","isOutOfOffice","onPhotoLoadingStateChange","onRenderCoin","onRenderInitials","onRenderOptionalText","onRenderPersonaCoin","onRenderPrimaryText","onRenderSecondaryText","onRenderTertiaryText","optionalText","presence","presenceColors","presenceTitle","primaryText","ref","secondaryText","showInitialsUntilImageLoads","showOverflowTooltip","showSecondaryText","showUnknownPersonaCoin","size","styles","tertiaryText","text","theme"]),t="--colorPersonaShimInitialsColor",u="--colorPersonaShimInitialsTextColor",v=[k.a.lightBlue,k.a.blue,k.a.darkBlue,k.a.teal,k.a.green,k.a.darkGreen,k.a.lightPink,k.a.pink,k.a.magenta,k.a.purple,k.a.orange,k.a.lightRed,k.a.darkRed,k.a.violet,k.a.gold,k.a.burgundy,k.a.warmGray,k.a.cyan,k.a.rust,k.a.coolGray],w=v.length,x=a=>{let{imageInitials:b,allowPhoneInitials:c,showUnknownPersonaCoin:e,text:f,primaryText:g,theme:h}=a;if(e)return d.createElement(l.a,{iconName:"Help"});let i=(0,m.b)(h),j=b||(0,n.a)(f||g||"",i,c);return""!==j?d.createElement("span",null,j):d.createElement(l.a,{iconName:"Contact"})};var y=c(504),z=c(61);let A=(0,j.a)({useStaticStyles:!0}),B=(0,e.a)({text:{textAlign:"left"},displayTextKilled:{width:"100%",...f.a.overflow("hidden"),textOverflow:"ellipsis"},displayText:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},initialsColor:{backgroundColor:`var(${t})`},initialsTextColor:{color:`var(${u})`},noAvatarSpacing:{"--fui-Persona__avatar--spacing":0}}),C=d.forwardRef((a,b)=>{let{onRenderCoin:c,onRenderPersonaCoin:e,onRenderPrimaryText:f}=a,j=B();if(c||e||f&&f.length>0||a.children)return d.createElement(y.a,{...a,ref:b});let{className:l,styles:m}=a,n=((a,b)=>{let c,{allowPhoneInitials:d,coinProps:e,hidePersonaDetails:f,imageAlt:h,imageInitials:j,imageUrl:l,initialsColor:m,initialsTextColor:n,onRenderPrimaryText:y,onRenderSecondaryText:z,optionalText:A,presence:B,primaryText:C,secondaryText:D,showSecondaryText:E,showUnknownPersonaCoin:F,size:G,tertiaryText:H,text:I,theme:J,onRenderInitials:K}=a,L=B?{status:q.get(B)}:void 0,M=r.get(a.size||k.c.size48),N=(a=>{switch(a){case k.c.tiny:case k.c.size8:case k.c.size10:case k.c.size16:return"extra-small";case k.c.extraExtraSmall:case k.c.size28:case k.c.size24:return"small";case k.c.extraSmall:case k.c.size32:case k.c.small:case k.c.size40:case k.c.regular:case k.c.size48:return"medium";case k.c.large:case k.c.size56:case k.c.size72:return"extra-large";case k.c.extraLarge:case k.c.size100:case k.c.size120:return"huge";default:return"medium"}})(G),O={},P=e?.initialsColor||m;O[u]=e?.initialsTextColor||n,P&&"string"==typeof P?(O[t]=P,O[u]=O[u]||i.a.colorNeutralForegroundOnBrand):c=(a=>{switch(a){case k.a.lightBlue:return"cornflower";case k.a.blue:return"blue";case k.a.darkBlue:return"royal-blue";case k.a.teal:return"teal";case k.a.lightGreen:return"seafoam";case k.a.green:return"forest";case k.a.darkGreen:return"dark-green";case k.a.lightPink:return"lilac";case k.a.pink:return"pink";case k.a.magenta:return"magenta";case k.a.purple:return"purple";case k.a.black:return"anchor";case k.a.orange:return"peach";case k.a.red:return"cranberry";case k.a.darkRed:return"dark-red";case k.a.violet:return"grape";case k.a.lightRed:return"red";case k.a.gold:return"gold";case k.a.burgundy:return"dark-red";case k.a.warmGray:return"mink";case k.a.coolGray:return"platinum";case k.a.gray:return"anchor";case k.a.cyan:return"royal-blue";case k.a.rust:return"brown"}return"colorful"})(m||function(a){let b=k.a.blue;if(!a)return b;let c=0;for(let b=a.length-1;b>=0;b--){let d=a.charCodeAt(b),e=b%8;c^=(d<<e)+(d>>8-e)}return v[c%w]}(I||C));let Q=p(e?.styles),R={imageInitials:j,allowPhoneInitials:d,showUnknownPersonaCoin:F,text:I,primaryText:C,theme:J},S=y&&y()||I||C,T=z&&z()||D,U=72===Number(M)||100===Number(M)?H:void 0,V=100===Number(M)?A:void 0;return{...{avatar:{className:(0,g.a)("ms-Persona-coin",Q.coin,f&&b.noAvatarSpacing),color:c,image:{className:(0,g.a)("ms-Persona-image",Q.image),src:l,alt:h},initials:{style:O,className:(0,g.a)("ms-Persona-initials",Q.initials,O[t]&&b.initialsColor,O[u]&&b.initialsTextColor),children:K?K(R,x):x(R)},size:M},size:N,presence:L,primaryText:!f&&S,secondaryText:!f&&(E||M&&M>32)&&T,tertiaryText:!f&&U,quaternaryText:!f&&V,textAlignment:"center"},...(0,o.d)(a,s)}})(a,j),C=A(m),D=(0,z.I)(),E=(0,g.a)(D?j.displayTextKilled:j.displayText,"ms-Persona-secondaryText");return d.createElement(h.a,{ref:a.componentRef||b,...n,className:(0,g.a)("ms-Persona",l,C.root,j.text),primaryText:n.primaryText?{className:(0,g.a)(D?j.displayTextKilled:j.displayText,"ms-Persona-primaryText",C.primaryText),children:n.primaryText}:void 0,secondaryText:n.secondaryText?{className:E,children:n.secondaryText}:void 0})});C.displayName="PersonaShim"}
,,,,,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){if(!a||0===a.length)return 0;let b=5381;for(let c=0;c<a.length;c++)b=(b<<5)+b+a.charCodeAt(c),b&=b;return b}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d=c("react-lib").createContext(!1)}
,,,,function(a,b){var c,d;(d=c||(c={}))[d.button=0]="button",d[d.link=1]="link",d[d.copyLink=2]="copyLink",b.a=c}
,function(a,b,c){c.d(b,{a:function(){return C},b:function(){return A},c:function(){return B},d:function(){return s},e:function(){return t},f:function(){return F},g:function(){return y},h:function(){return G},i:function(){return u},j:function(){return I},k:function(){return H},l:function(){return D},m:function(){return v},n:function(){return w},o:function(){return z},p:function(){return E}});var d=c(32),e=c(319),f=c(37),g=c(28),h=c(204),i=c(46),j=c(151),k=c(16),l=c(92),m=c(26),n=c(518),o=c(154),p=c(519);let q={ODB:772},r={ODB:1935};function s(a){return"anyoneLinkAbilities"===a||"anonymousLinkAbilities"===a?d.a.anyone:"organizationLinkAbilities"===a?d.a.organization:"peopleSharingLinkAbilities"===a?d.a.specificPeopleFlex:void 0}function t(a,b){if(a===d.a.anyone)if(b.anyoneLinkAbilities)return b.anyoneLinkAbilities;else return b.anonymousLinkAbilities;return a===d.a.organization?b.organizationLinkAbilities:a===d.a.specificPeopleFlex||a===d.a.specificPeople||a===d.a.customLabeledSpecificPeople?b.peopleSharingLinkAbilities:b.directSharingAbilities}function u(a,b){let c=t(a,b);return c?.canManageEditLink?c.canManageEditLink.enabled:!!c?.canAddInternalPrincipal&&c.canAddInternalPrincipal.enabled}function v(a,b,c,d,e){return d?b.canRequestAccessForGrantAccess:e!==p.a.ShareSitePageDraft&&e!==p.a.ShareSitePageDraftFromLibrary&&e!==p.a.SharePrivateDraft}function w(a,b,c){let d=t(a,b);return(!!k.Ic()||c!==p.a.ShareSitePageDraft)&&c!==p.a.ShareSitePageDraftFromLibrary&&c!==p.a.SharePrivateDraft&&!!d?.canManageReadLink&&d?.canManageReadLink?.enabled}function x(a,b,c,d,e){return!!(e&&E(a,b)&&((0,n.b)(c,n.a.AllowMediaTA)||d===j.a.folder))}function y(a,b,c,d,e){return d&&(0,m.k)(c,i.a.restrictedview)&&((0,n.b)(b,n.a.AllowMediaTA)||a===j.a.folder)&&!k.s()&&e.supportsRestrictedViewPermission?.enabled}function z(a,b,c){if(!g.b.isFeatureEnabled(q)||h.a[c])return!1;{let c=t(a,b);return c?.canManageReviewLink?c.canManageReviewLink.enabled:!!c?.supportsReviewPermission&&c.supportsReviewPermission.enabled}}function A(a){let b={fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:!1,shouldDisplay:!1},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!1,shouldDisplay:!1},view:{enabled:!1,shouldDisplay:!1},blockDownload:{enabled:!1,shouldDisplay:!1}};switch(a.role){case i.a.view:b.view.enabled=b.view.shouldDisplay=!0;break;case i.a.restrictedview:b.blockDownload.enabled=b.blockDownload.shouldDisplay=!0;break;case i.a.review:b.review.enabled=b.review.shouldDisplay=!0}return b}function B(a){let{clientId:b,sharingStore:c,sharingInformation:e,audience:g,mode:h,isPreventDownloadAllowed:l}=a,n=!1,p=!1,q=!1,r=!1,s=!0,v=!1;if(!(0,m.V)(e)){n=e.sharedObjectType===j.a.list,p=function(a){let{audience:b,sharingAbilities:c,sharingRole:e}=a,f=t(b,c);return f?.canManageManageListLink?f.canManageManageListLink.enabled:b===d.a.existing&&(e===i.a.manageList||e===i.a.owner)}({audience:g,sharingAbilities:e.sharingAbilities,sharingRole:e.userRole}),r=z(g,e.sharingAbilities,e.fileExtension)||D(g,e.sharingAbilities,e.fileExtension),q=u(g,e.sharingAbilities);let a=!k.Ic()&&c?.getScenarioId&&c.getScenarioId();s=w(g,e.sharingAbilities,a);let f="video"===(0,o.a)(e.fileExtension)&&x(g,e.sharingAbilities,e.fileExtension,e.sharedObjectType,l),h=(0,m.ab)(b,c)&&x(g,e.sharingAbilities,e.fileExtension,e.sharedObjectType,l);v=f||h}let y=h===f.a.addPeople||h===f.a.manageAccess||q,A=s;return(g==d.a.specificPeople&&I(g,e.sharingAbilities)||e.requiresAccessApproval)&&(y=A=!0),{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:p,shouldDisplay:n},review:{enabled:r,shouldDisplay:r},edit:{enabled:y,shouldDisplay:!0},view:{enabled:A,shouldDisplay:A},blockDownload:{enabled:v,shouldDisplay:v}}}function C(a){let{audience:b,clientId:c,sharingInformation:g,scenarioId:l,isPreventDownloadAllowed:n,shareMode:p,sharingStore:q}=a,r=!1,s=!1,u=!1,w=!1,x=!1,z=!1,A=!1;if(!(0,m.V)(g)){var B,C;let a,D,E,F=g.sharingAbilities?.directSharingAbilities,H=p===f.a.addPeople||p===f.a.manageAccess;a=g.sharedObjectType===j.a.list,u=H&&a&&g.userRole===i.a.owner,r=g.sharedObjectType===j.a.list,s=function(a){let{sharingRole:b}=a;return b===i.a.manageList||b===i.a.owner}({sharingRole:g.userRole})&&F.supportsManageListPermission?.enabled,D=t(d.a.direct,g.sharingAbilities),E=D.canAddInternalPrincipal?.enabled||D.canAddExternalPrincipal?.enabled,z=(!(0,m.ab)(c,q)||!G(d.a.specificPeople,g.sharingAbilities,e.a.forceCheckoutEditLink)&&E)&&F.supportsEditPermission?.enabled,B=g.fileExtension,C=g.userRole,w=!!(h.b===h.a[B]&&(0,m.k)(C,i.a.review))&&F.supportsReviewPermission?.enabled,A=v(b,g,g.sharingAbilities,g.requiresAccessApproval,l)&&F.supportsReadPermission?.enabled;let I="video"===(0,o.a)(g.fileExtension)&&y(g.sharedObjectType,g.fileExtension,g.userRole,n,F),J=(0,m.ab)(c,q)&&y(g.sharedObjectType,g.fileExtension,g.userRole,n,F);x=(I||J)&&(!k.s()||F.supportsRestrictedViewPermission?.enabled)}return{fullControl:{enabled:u,shouldDisplay:u},manageList:{enabled:s,shouldDisplay:r},review:{enabled:w,shouldDisplay:w},edit:{enabled:z,shouldDisplay:z},view:{enabled:A,shouldDisplay:A},blockDownload:{enabled:x,shouldDisplay:x}}}function D(a,b,c){if(h.b!==h.a[c])return!1;{let c=t(a,b);return c?.canManageReviewLink?c.canManageReviewLink.enabled:!!c?.supportsReviewPermission&&c.supportsReviewPermission.enabled}}function E(a,b){let c=t(a,b);return!!c?.supportsRestrictedView&&c.supportsRestrictedView.enabled}function F(a,b){if(l.c())return[];let c=[];if(g.b.isFeatureEnabled(r)){for(let d of b)if(d.linkDetails&&d.linkDetails.shareId){let b=t(d.linkDetails.audience,a);!(b.canManageEditLink&&b.canManageEditLink.enabled||b.canManageReviewLink&&b.canManageReviewLink.enabled||b.canManageReadLink&&b.canManageReadLink.enabled)&&(d.linkDetails.expiration&&d.linkDetails.expiration<new Date(Date.now())||c.push(d.linkDetails))}}return c}function G(a,b,c){if(void 0===a||!b)return!1;let d=t(a,b);for(let a in d)if(d[a]?.disabledReason==c)return!0;return!1}function H(a,b){return G(a,b,e.a.sharingBlockedByVirusCheckStatus)}function I(a,b){return G(a,b,e.a.irmIsEnabled)}}
,function(a,b,c){c.d(b,{a:function(){return p}});var d,e,f=c("react-lib"),g=c(46),h=c(299),i=c(18),j=c(64),k=c(39),l=c(20);(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir=rtl] .od-RoleSelectorCompact-permissionButton{margin-right:8px}.od-RoleSelectorCompact-permissionButton svg{height:1.125rem;width:1.125rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.simplified-share{height:100%;align-self:center;border-radius:0 4px 4px 0}[dir=ltr] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-right:0}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:flex;flex-direction:column;margin:8px}[dir=ltr] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir=rtl] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem;font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{font:-apple-system-body;height:auto!important}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.blockdownload{height:1rem}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem;font:-apple-system-body}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem;font:-apple-system-caption1;max-width:160px;white-space:normal}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem.selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem.selected .ms-ContextualMenu-link{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}.od-RoleSelectorCompact-simplifiedPermissionsButton{height:100%!important;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"!important;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:0 4px 2px 0!important;height:100%;align-self:center;padding:2px}[dir=ltr] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-right:0}.od-RoleSelectorCompact-simplifiedPermissionsButton svg{height:1.125rem;width:1.125rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus{outline:unset}.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{height:100%;padding-left:10px;padding-right:10px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-AddPeople-Edit-Section button.od-RoleSelectorCompact-simplifiedPermissionsButton{border-radius:2px!important}.od-AddPeople-Edit-Section span.ms-Button-flexContainer{padding:0}.od-RoleSelectorCompact-checkmarkIcon{font-size:.75rem;max-height:unset}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-checkmarkIcon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-itemText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-secondaryText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked i.ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-checkmarkIcon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-itemText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-secondaryText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover i.ms-ContextualMenu-icon{background-color:highlight;border-color:highlight;color:highlighttext!important}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron{color:highlighttext;font-weight:600;forced-color-adjust:none}}"}]);var m=c("prop-types-lib"),n=c(112),o=c(26);(d=e||(e={})).edit="edit",d.view="view",d.review="comment",d.fullControl="full-control",d.manageList="manage-list",d.restrictedView="restricted-view",d.divider="divider",d.stopSharing="stop-sharing",d.linkSettings="linkSettings";class p extends f.Component{render(){let a;this._selectedRole=this._parseRole(this.props.sharingRole);let{menuPermissionOptions:b,showLinkSettings:c,showStopSharing:d}=this.props,e=this._getMenuItems({menuPermissionOptions:b,showLinkSettings:c,showStopSharing:d,sharingRole:this.props.sharingRole}),m=e.filter(a=>a.itemType!==h.a.Divider).length,{manageList:{shouldDisplay:o=!1}}=b;switch(this.props.sharingRole){case g.a.owner:a=l.Vd;break;case g.a.edit:a=o?l.vb:l.Db;break;case g.a.review:a=l.wb,this.props.showDropdownWithOfficeReview&&(a=l.xb);break;case g.a.view:a=l.Pb;break;case g.a.restrictedview:a=l.fb;break;case g.a.manageList:a=l.gb;break;case g.a.none:a="";break;default:return null}let p={directionalHint:i.a.bottomAutoEdge,shouldFocusOnMount:!0,items:e,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:()=>{this._logRoleSelectorClicked(this.context.sharingStore),this._menuOpen=!0},onMenuDismissed:()=>{this._menuOpen=!1,this._roleSelectorRef.current?.focus()},styles:{subComponentStyles:{callout:{root:{maxHeight:"100%",overflowY:"auto"},main:{overflowY:"auto"}},menuItem:{root:{height:"auto !important"},label:{margin:"0",fontSize:"0.875rem",fontWeight:"600",lineHeight:"1.3"},secondaryText:{paddingLeft:"0",fontSize:"0.75rem",lineHeight:"1.3",textAlign:"left",whiteSpace:"normal"}}}},calloutProps:{minPagePadding:3}},q={iconName:"ChevronDown",className:"od-RoleSelectorCompact-permissionButton-Chevron"};if(this.props.shimmer)return f.createElement(j.a,{menuIconProps:q,iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:p,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}});let r=this._menuOpen?k.b(l.ye,this.props.ariaLabel||"",a,m):k.b(l.ve,this.props.ariaLabel||"",a,m);return n.b(f.createElement(j.a,{persistMenu:!0,renderPersistedMenuHiddenOnMount:!0,componentRef:this._roleSelectorRef,menuIconProps:q,iconProps:this.getRoleIconName(this.props.sharingRole),className:this._useSimplifiedDialog&&!this.props.isGrantAccess?"od-RoleSelectorCompact-simplifiedPermissionsButton":"od-RoleSelectorCompact-permissionButton",menuProps:p,disabled:this.props.disabled,ariaLabel:r,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),a,{position:i.a.bottomRightEdge,styles:this._useSimplifiedDialog&&{root:{height:"100%",display:"flex"}}})}_renderContent(a,b){return f.createElement(f.Fragment,null,b.renderCheckMarkIcon(a),b.renderItemIcon(a),f.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},b.renderItemName(a),b.renderSecondaryText(a)),b.renderSubMenuIcon(a))}_parseRole(a){if(a===g.a.review&&!this.props.menuPermissionOptions.review.enabled||a===g.a.owner&&!this.props.menuPermissionOptions.fullControl.enabled)return g.a.edit;if(a===g.a.restrictedview)if(!this.props.menuPermissionOptions.blockDownload.enabled)return g.a.view;else return g.a.restrictedview;return a}_addRenderContent(a){return a.map(a=>({...a,onRenderContent:this._renderContent}))}_getMenuItems(a){let b=[],{menuPermissionOptions:c,showLinkSettings:d,showStopSharing:e,sharingRole:f}=a,{fullControl:{enabled:i=!1,shouldDisplay:j=!1},review:{enabled:m=!1,shouldDisplay:n=!1},edit:{enabled:o=!0,shouldDisplay:p=!0},view:{enabled:q=!0,shouldDisplay:r=!0},manageList:{enabled:s=!1,shouldDisplay:t=!1},blockDownload:{enabled:u=!1,shouldDisplay:v=!1}}=c,w={key:"edit",text:t?l.vb:l.Db,disabled:!o,secondaryText:t?l.yb:l.Sb,ariaLabel:k.b(l.Hi,t?l.vb:l.Db,t?l.yb:l.Sb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:f===g.a.edit},x=a.menuPermissionOptions.blockDownload.enabled||this._showSimplifiedDialogV2?f===g.a.view:this._showSimplifiedDialog&&(f===g.a.view||f===g.a.restrictedview),y={key:"view",text:l.Pb,secondaryText:t?l.kb:l.Mb,ariaLabel:k.b(l.Hi,l.Pb,t?l.kb:l.Mb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"View"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:x},z={key:"full-control",text:l.Vd,secondaryText:l.jd,ariaLabel:k.b(l.Hi,l.Vd,l.jd),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Signin"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:f===g.a.owner},A={key:"manage-list",text:l.gb,disabled:!s,secondaryText:l.bb,ariaLabel:k.b(l.Hi,l.gb,l.bb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"EditListPencil"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:f===g.a.manageList},B={key:"comment",text:l.wb,secondaryText:l.Ob,ariaLabel:k.b(l.Hi,l.wb,l.Ob),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:f===g.a.review},C={key:"comment",text:l.xb,secondaryText:l.Ib,ariaLabel:k.b(l.Hi,l.xb,l.Ib),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:f===g.a.review},D={key:"divider",itemType:h.a.Divider},E={key:"stop-sharing",text:l.bk,ariaLabel:l.bk,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing",iconProps:{iconName:"Delete"}},F={key:"linkSettings",text:l.Ke,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:l.Ke},G={key:"restricted-view",text:l.fb,secondaryText:l.pb,ariaLabel:k.b(l.Hi,l.fb,l.pb),className:`od-RoleSelectorCompact-menuItem blockdownload ${!this._useSimplifiedDialog&&f===g.a.restrictedview?"selected":""}`,iconProps:{iconName:"BlockDownloadIcon"},itemProps:{styles:{checkmarkIcon:this._useSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:this._useSimplifiedDialog,isChecked:this._useSimplifiedDialog&&f===g.a.restrictedview};return j&&b.push(z),t&&b.push(A),p&&b.push(w),n&&(this.props.showDropdownWithOfficeReview?b.push(C):b.push(B)),r&&b.push(y),v&&b.push(G),e&&b.push(D,E),d&&b.push(D,F),this._addRenderContent(b)}_logRoleSelectorClicked(a){a.getEngagementHelper().compactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})}getRoleIconName(a){let b;switch(a=this._parseRole(a)){case g.a.owner:b="Signin";break;case g.a.edit:b="Edit";break;case g.a.view:b="View";break;case g.a.review:b="Feedback";break;case g.a.manageList:b="EditListPencil";break;case g.a.restrictedview:b="BlockDownloadIcon";break;case g.a.none:b="";break;default:throw Error("Sharing role does not exist")}return{iconName:b}}constructor(a,b){super(a),this._linkSettingsClickedInRoleSelector=()=>{this.context.sharingStore.getEngagementHelper().linkSettingsInCompactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode}),this.props.onLinkSettingsClicked()},this._onItemClicked=(a,b)=>{let c;switch(b.key){case"full-control":c=g.a.owner;break;case"manage-list":c=g.a.manageList;break;case"edit":c=g.a.edit;break;case"view":c=g.a.view;break;case"comment":c=g.a.review;break;case"restricted-view":c=g.a.restrictedview;break;default:c=g.a.none}this._selectedRole!==c&&this.props.onRoleChange(c,this.props.permissionId||""),this._roleSelectorRef.current?.focus()},this._selectedRole=this._parseRole(a.sharingRole),this._menuOpen=!1,this._showSimplifiedDialogV2=(0,o.ab)(this.props.clientId,b.sharingStore),this._showSimplifiedDialog=(0,o.ib)(this.props.clientId,b.sharingStore),this._useSimplifiedDialog=this._showSimplifiedDialog||this._showSimplifiedDialogV2,this._roleSelectorRef=f.createRef()}}p.contextTypes={sharingStore:m.object.isRequired}}
,function(a,b,c){b.a=c(69).a("images/brand-icons/product/svg/outlook_48x1.svg")}
,function(a,b,c){b.a=c(69).a("images/brand-icons/product/svg/teams_48x1.svg")}
,function(a,b,c){c.d(b,{a:function(){return n}});var d=c("react-lib"),e=c(520),f=c(9),g=c(51),h=c(111),i=c(4),j=c(48);let k=new Set(["alignContent","styles","theme","vertical","className"]),l=(0,g.a)({noFlexGrow:{flexGrow:0},verticalPadding:{...h.a.padding("0","4px")},horizontalPadding:{...h.a.padding("4px","0")}}),m=(0,f.a)({useStaticStyles:!0}),n=a=>{let b,c,f,g=(b=l(),c=m(a.styles),f=a.vertical??!1,{...{alignContent:a.alignContent??"center",vertical:f,className:(0,i.a)(b.noFlexGrow,f&&b.verticalPadding||b.horizontalPadding,a.className,c.root,"ms-SeparatorShim")},...(0,j.d)(a,k)});return d.createElement(e.a,g,a.children)};n.displayName="SeparatorShim"}
,function(a,b,c){c.d(b,{a:function(){return D}});var d=c(521),e=c("react-lib"),f=c(9),g=c(12),h=c(51),i=c(111),j=c(4),k=c(522),l=c(524),m=c(525),n=c(186),o=c(52),p=c(113),q=c(66),r=c(48);let s=new Set(["ariaLabel","autoAdjustHeight","autoComplete","borderless","canRevealPassword","className","componentRef","defaultValue","deferredValidationTime","description","disabled","elementRef","errorMessage","iconProps","inputClassName","invalid","label","multiline","onChange","onGetErrorMessage","onNotifyValidationResult","onRenderDescription","onRenderInput","onRenderLabel","onRenderPrefix","onRenderSuffix","prefix","readOnly","resizable","revealPasswordAriaLabel","styles","suffix","theme","underlined","validateOnFocusIn","validateOnFocusOut","validateOnLoad","value"]);function t(a,b){let c,d={...(0,r.d)(a,s),...b,autoComplete:a.autoComplete,defaultValue:a.defaultValue,disabled:a.disabled,readOnly:a.readOnly,value:a.value,"aria-label":a.ariaLabel};return a.multiline?{...d,...(c=a.resizable??!0,{...(0,r.d)(a,s),appearance:"outline",resize:c?"both":"none"})}:{...d,...{...(0,r.d)(a,s),appearance:a.underlined?"underline":"outline"}}}var u=c(317),v=c(343),w=c(61);let x=(0,f.a)(),y=(0,h.a)({root:{height:"32px"},icon:{pointerEvents:"none",position:"absolute",bottom:"6px",right:"8px",top:"auto",fontSize:u.a.fontSizeBase400,lineHeight:"18px"},iconDisabled:{color:u.a.colorNeutralForegroundDisabled},underline:{"&.ms-TextField-fieldGroup":{backgroundColor:u.a.colorTransparentBackground,...i.a.borderRadius(0),borderTopStyle:"none",borderRightStyle:"none",borderLeftStyle:"none","::after":{left:0,right:0}}},underlineInteractive:{"&.ms-TextField-fieldGroup":{":hover":{borderTopStyle:"none",borderRightStyle:"none",borderLeftStyle:"none",borderBottomColor:u.a.colorNeutralStrokeAccessibleHover},":active,:focus-within":{borderTopStyle:"none",borderRightStyle:"none",borderLeftStyle:"none",borderBottomColor:u.a.colorNeutralStrokeAccessiblePressed},"::after":i.a.borderRadius(0)}},borderless:{...i.a.border(0,"none"),":hover":{...i.a.border(0,"none")},":active":{...i.a.border(0,"none")},":focus-within":{...i.a.border(0,"none")},"::after":i.a.border(0,"none")},validationMessage:{display:"flex"},fieldDisplay:{display:"flex",flexDirection:"column"},requiredWithoutLabel:{"&.fui-Input::before, &.fui-Textarea::before":{content:"'*'",color:u.a.colorPaletteRedForeground3,position:"absolute",right:"-10px",top:"-5px"}},label:{display:"inline-block",lineHeight:"normal",...i.a.padding("5px","0px")},labelRequired:{"& .fui-Label__required":{paddingRight:"12px"}},inputBackground:{backgroundColor:u.a.semanticInputBackground},textAreaFieldGroup:{minHeight:"60px"},padding:{paddingLeft:"8px",paddingRight:"8px"},input:{textOverflow:"ellipsis"}}),z=(0,h.a)({autoAdjustHeight:{overflowY:"hidden",maxHeight:"none"}}),A=e.forwardRef(function({validateOnLoad:a=!0,deferredValidationTime:b=200,...c},d){let f,h,i,r,s,u=(0,o.a)("TextField"),A=(0,o.a)("field-"),B=A+"-control",C=y(),D=z(),E=e.useRef(""),F=0,G=(0,v.a)("TextField",c),H=x(G.styles,{theme:c.theme}),I=e.useRef(),J=d||I,[K,L]=(0,p.a)({defaultState:c.defaultValue,state:c.value,initialState:""}),M=e.useRef(K),[N,O]=e.useState(u),[P,Q]=e.useState(""),R=e.useRef(ae);R.current=ae;let S=e.useRef(new q.a),T=e.useRef(!0),U=e.useCallback(S.current.debounce(a=>R.current?.(a),b),[]);e.useEffect(()=>{a&&ae(V())},[]),e.useEffect(()=>{P&&!c.errorMessage&&Q(""),T.current?T.current=!1:(af(c)&&U(V()),void 0===M.current&&void 0!==c.value&&(M.current=c.value,O(`textFieldId-${c.value}`)))},[K,c.value,c.defaultValue]),e.useImperativeHandle(c.componentRef,()=>({get value(){return V()},set value(newValue){L(newValue)},focus:()=>{J.current?.focus()},blur:()=>{J.current?.blur()},select:()=>{J.current?.select()},setSelectionStart:a=>{J.current&&(J.current.selectionStart=a)},setSelectionEnd(a){J.current&&(J.current.selectionEnd=a)},selectionStart:J.current?.selectionStart??-1,selectionEnd:J.current?.selectionEnd??-1,setSelectionRange:(a,b)=>{J.current?.setSelectionRange(a,b)}}),[K,c.value]);let V=e.useCallback(()=>{let a=J.current?.value;return"number"==typeof a?String(a):a},[K,c.value]);e.useLayoutEffect(()=>{if(J.current&&c.autoAdjustHeight&&c.multiline){let a=J.current;a.style.height=a.scrollHeight+"px"}},[K,c.value]);let W=c.id??u,X=(0,w.w)(),Y=()=>{let a=ac();return a?{children:(b,c)=>{let d=(0,j.a)("ms-TextField-errorMessage","errorMessage",c.className,C.validationMessage);return e.createElement("div",{...c,className:d},!!c.children&&e.createElement("div",null,c.children),e.createElement("span",{"data-automation-id":"error-message"},a))}}:null};function Z(a){return()=>e.createElement(e.Fragment,null,a.onRenderLabel(a,$))}function $(a){return a?.label?e.createElement(n.a,{required:a.required,htmlFor:B,disabled:a.disabled,id:A,className:(0,j.a)("ms-Label",C.label,a.required&&C.labelRequired)},a.label):null}function _(a){return a?.prefix?e.createElement("div",{className:"ms-TextField-prefix"},e.createElement("span",{style:{paddingBottom:"1px"}},a.prefix)):null}function aa(a){return a?.suffix?e.createElement("div",{className:"ms-TextField-suffix"},e.createElement("span",{style:{paddingBottom:"1px"}},a.suffix)):null}function ab(a){return a?.description?e.createElement("span",null,a.description):null}function ac(){return c.errorMessage?c.errorMessage:P||""}function ad(a){let b=a.target.value;void 0!==b&&b!==K&&(c.onChange?.(a,b),L(b))}function ae(a){if(E.current===a&&!af(c))return;E.current=a;let b=c.onGetErrorMessage&&c.onGetErrorMessage(a||"");if(void 0!==b)if("string"!=typeof b&&"then"in b){let c=++F;b.then(b=>{c===F&&Q(b),ag(a,b)})}else Q(b),ag(a,b);else ag(a,"")}function af(a){return!(a.validateOnFocusIn||a.validateOnFocusOut)}function ag(a,b){a===V()&&c.onNotifyValidationResult&&c.onNotifyValidationResult(b,a)}function ah(a){c.onFocus&&c.onFocus(a),c.validateOnFocusIn&&ae(V())}function ai(a){c.onBlur&&c.onBlur(a),c.validateOnFocusOut&&ae(V())}if(c.multiline){let a,b,d,f;return a="boolean"==typeof c.invalid?c.invalid:!!ac(),b=t(G,{onFocus:ah,onBlur:ai,onChange:ad}),delete b.defaultValue,b.className=(0,j.a)("ms-TextField-fieldGroup",H.fieldGroup,C.textAreaFieldGroup,!c.label&&c.required&&C.requiredWithoutLabel,c.borderless&&C.borderless,...c.underlined?[C.underlineInteractive,C.underline]:[C.inputBackground]),b.textarea={className:(0,j.a)("ms-TextField-field",H.field,c.inputClassName,c.autoAdjustHeight&&D.autoAdjustHeight,c.borderless&&C.borderless,!(0,w.v)()&&C.padding)},d=Y(),f={required:!c.onRenderLabel&&!!c.label&&c.required,hint:c.onRenderDescription?.(c,ab)||c.description,validationMessage:d,validationState:a?"error":"none"},e.createElement("div",{className:(0,j.a)("ms-TextField","ms-TextFieldShim",H.root,c.className)},e.createElement(k.a,{label:c.onRenderLabel||c.label?{children:c.onRenderLabel?Z(c):c.label,className:(0,j.a)("ms-Label",C.label,f.required&&C.labelRequired),...!(0,w.u)()?{htmlFor:W}:{}}:void 0,...f,className:X?(0,j.a)("ms-TextField-wrapper",H.wrapper,C.fieldDisplay):C.fieldDisplay},X?e.createElement(l.a,{id:W,...b,value:K,ref:J,key:N}):e.createElement("div",{className:(0,j.a)("ms-TextField-wrapper",H.wrapper,C.fieldDisplay)},e.createElement(l.a,{id:W,...b,value:K,ref:J,key:N}))))}return f="boolean"==typeof c.invalid?c.invalid:!!ac(),h=t(G,{onFocus:ah,onBlur:ai,onChange:ad}),delete h.defaultValue,i=!!(c.onRenderPrefix||c.prefix),(0,w.C)()?h.contentBefore={className:"ms-TextField-prefix",children:c.onRenderPrefix?.(c,_)||c.prefix}:h.contentBefore=i?{className:"ms-TextField-prefix",children:c.onRenderPrefix?.(c,_)||c.prefix}:null,h.contentAfter=c.onRenderSuffix?.(c,aa)||aa(c)||(c.iconProps?e.createElement(g.a,{className:(0,j.a)(H.icon,C.icon,c.disabled&&C.iconDisabled),...c.iconProps}):null),h.className=(0,j.a)("ms-TextField-fieldGroup",C.root,H.fieldGroup,!c.label&&c.required&&C.requiredWithoutLabel,c.underlined?C.underline:C.inputBackground,c.borderless&&C.borderless),h.input={className:(0,j.a)("ms-TextField-field",H.field,c.inputClassName,c.borderless&&C.borderless,!(0,w.v)()&&C.padding,!(0,w.v)()&&C.input)},r=Y(),s={required:!c.onRenderLabel&&!!c.label&&c.required,hint:c.onRenderDescription?.(c,ab)||c.description,validationMessage:r,validationState:f?"error":"none"},e.createElement("div",{className:(0,j.a)("ms-TextField","ms-TextFieldShim",H.root,c.className)},e.createElement(k.a,{label:c.onRenderLabel||c.label?{children:c.onRenderLabel?Z(c):c.label,className:(0,j.a)("ms-Label",C.label,s.required&&C.labelRequired),...!(0,w.u)()?{htmlFor:W}:{}}:void 0,...s,className:X?(0,j.a)("ms-TextField-wrapper",H.wrapper,C.fieldDisplay):C.fieldDisplay},X?e.createElement(m.a,{id:W,...h,value:K,ref:J,key:N}):e.createElement("div",{className:(0,j.a)("ms-TextField-wrapper",H.wrapper,C.fieldDisplay)},e.createElement(m.a,{id:W,...h,value:K,ref:J,key:N}))))});var B=c(156),C=c(121);let D=a=>(0,B.a)(d.a,A,a,C.a.FluentUIV9ShimTextField)}
,function(a,b,c){c.d(b,{a:function(){return h}});var d=c("react-lib"),e=c(145),f=c(80),g=c(168);function h(a,b,c=["styles","theme"]){let i=(0,d.useContext)(e.a),j=f.a.getSettings(c,a,i.customizations),k={};if(j.styles&&"function"==typeof j.styles&&(j.styles=j.styles({...j,...b})),j.styles){if(k.default!==j.styles||k.component!==b?.styles){let a=(0,g.a)(j.styles,b?.styles);k.default=j.styles,k.component=b?.styles,k.merged=a}return{...j,...b,styles:k.merged}}return{...j,...b}}}
,,function(a,b,c){c.d(b,{a:function(){return s}});var d=c("react-lib");(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharedWith{align-items:center;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;font:-apple-system-body;margin:0}[dir=ltr] .od-SharedWith .label{padding-right:4px}[dir=rtl] .od-SharedWith .label{padding-left:4px}.od-SharedWith-Facepile{display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:flex}.od-SharedWith-List{display:flex}.od-SharedWith-List li{flex-shrink:0}.od-SharedWith-List:focus-visible{outline:1px solid}.od-SharedWith-Link--simplified{display:flex}.od-SharedWith-Link--simplified li{flex-shrink:0}.od-SharedWith-Link--simplified .ms-Button-flexContainer{align-items:flex-end}.od-SharedWith-Discoverable--simplified,.od-SharedWith-Link--simplified,.od-SharedWith-More--simplified,.od-SharedWith-Persona--simplified{position:relative}.od-SharedWith-Discoverable--simplified .ms-Button-flexContainer,.od-SharedWith-Link--simplified .ms-Button-flexContainer,.od-SharedWith-More--simplified .ms-Button-flexContainer,.od-SharedWith-Persona--simplified .ms-Button-flexContainer{align-items:center}.od-SharedWith-Discoverable--simplified .fui-Avatar__image,.od-SharedWith-Discoverable--simplified .ms-Image,.od-SharedWith-Link--simplified .fui-Avatar__image,.od-SharedWith-Link--simplified .ms-Image,.od-SharedWith-More--simplified .fui-Avatar__image,.od-SharedWith-More--simplified .ms-Image,.od-SharedWith-Persona--simplified .fui-Avatar__image,.od-SharedWith-Persona--simplified .ms-Image{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-SharedWith-Persona--simplified .ms-Persona-initials{position:relative;top:2px;right:-2px}.od-SharedWith-Persona--simplified .ms-Persona-initials.fui-Avatar__initials{position:absolute;left:2px}.od-SharedWith-Discoverable--simplified i,.od-SharedWith-Discoverable--simplified svg{height:1rem;width:1.125rem}.od-SharedWith-Discoverable--simplified .ms-Persona-initials{border:2px solid "},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.od-SharedWith-Discoverable--simplified .fui-Avatar__initials{box-sizing:content-box}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.od-SharedWith-Discoverable--simplified .ms-Persona-initials{box-sizing:unset;color:WindowText}}.od-SharedWith-More--simplified .ms-Persona-initials{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-SharedWith-More--simplified .fui-Avatar__initials{box-sizing:content-box}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.od-SharedWith-More--simplified .ms-Persona-initials{box-sizing:unset;color:WindowText}}.od-SharedWith-Persona{display:flex;position:relative}.od-SharedWith-Persona-measure{left:0;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}@media screen and (-ms-high-contrast:active){.od-SharedWith-Link .ms-Persona-initials{color:WindowText}}.od-SharedWith-Discoverable .ms-Persona-initials{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-SharedWith-Discoverable .ms-Persona-initials{color:WindowText}}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-SharedWith-More .ms-Persona-initials{color:WindowText}}.ms-Tooltip-subtext{font-size:.75rem}@supports (font:-apple-system-body){.ms-Tooltip-subtext{font:-apple-system-body}}.od-SharedWith-facepile-button{width:100%!important;height:auto}.od-SharedWith-facepile-button:hover{background-color:transparent!important}.od-SharedWith-facepile-button:active{background-color:transparent!important}.od-SharedWith-facepile-button:focus{outline:unset!important}.od-SharedWith-facepile-padding{padding:2px}"}]);var e=c(83),f=c(20),g=c(39),h=c("react-dom-lib"),i=c(64),j=c(18),k=c(75),l=c(12),m=c(326),n=c(63),o=c(26),p=c("prop-types-lib");!function(){if("object"!=typeof window)return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function a(a){try{return a.defaultView&&a.defaultView.frameElement||null}catch(a){return null}}let b=function(b){let c=b,d=a(c);for(;d;)d=a(c=d.ownerDocument);return c}(window.document),c=[],d=null,e=null;class f{constructor(a){this.time=a.time,this.target=a.target,this.rootBounds=k(a.rootBounds),this.boundingClientRect=k(a.boundingClientRect),this.intersectionRect=k(a.intersectionRect||j()),this.isIntersecting=!!a.intersectionRect;const b=this.boundingClientRect,c=b.width*b.height,d=this.intersectionRect,e=d.width*d.height;c?this.intersectionRatio=Number((e/c).toFixed(4)):this.intersectionRatio=+!!this.isIntersecting}}function g(a,b,c,d){"function"==typeof a.addEventListener?a.addEventListener(b,c,d||!1):"function"==typeof a.attachEvent&&a.attachEvent("on"+b,c)}function h(a,b,c,d){"function"==typeof a.removeEventListener?a.removeEventListener(b,c,d||!1):"function"==typeof a.detatchEvent&&a.detatchEvent("on"+b,c)}function i(a){let b;try{b=a.getBoundingClientRect()}catch(a){}return b?(b.width&&b.height||(b={top:b.top,right:b.right,bottom:b.bottom,left:b.left,width:b.right-b.left,height:b.bottom-b.top}),b):j()}function j(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function k(a){return!a||"x"in a?a:{top:a.top,y:a.top,bottom:a.bottom,left:a.left,x:a.left,right:a.right,width:a.width,height:a.height}}function l(a,b){let c=b.top-a.top,d=b.left-a.left;return{top:c,left:d,height:b.height,width:b.width,bottom:c+b.height,right:d+b.width}}function m(a,b){let c=b;for(;c;){if(c==a)return!0;c=n(c)}return!1}function n(c){let d=c.parentNode;return 9==c.nodeType&&c!=b?a(c):(d&&d.assignedSlot&&(d=d.assignedSlot.parentNode),d&&11==d.nodeType&&d.host)?d.host:d}function o(a){return a&&9===a.nodeType}window.IntersectionObserver=class{_setupCrossOriginUpdater(){return d||(d=function(a,b){e=a&&b?l(a,b):j(),c.forEach(function(a){a._checkForIntersections()})}),d}_resetCrossOriginUpdater(){d=null,e=null}observe(a){if(!this._observationTargets.some(function(b){return b.element==a})){if(!(a&&1==a.nodeType))throw Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:a,entry:null}),this._monitorIntersections(a.ownerDocument),this._checkForIntersections()}}unobserve(a){this._observationTargets=this._observationTargets.filter(function(b){return b.element!=a}),this._unmonitorIntersections(a.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()}disconnect(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()}takeRecords(){let a=this._queuedEntries.slice();return this._queuedEntries=[],a}_initThresholds(a){let b=a||[0];return Array.isArray(b)||(b=[b]),b.sort().filter(function(a,b,c){if("number"!=typeof a||isNaN(a)||a<0||a>1)throw Error("threshold must be a number between 0 and 1 inclusively");return a!==c[b-1]})}_parseRootMargin(a){let b=(a||"0px").split(/\s+/).map(function(a){let b=/^(-?\d*\.?\d+)(px|%)$/.exec(a);if(!b)throw Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(b[1]),unit:b[2]}});return b[1]=b[1]||b[0],b[2]=b[2]||b[0],b[3]=b[3]||b[1],b}_monitorIntersections(c){let d=c.defaultView;if(!d||-1!=this._monitoringDocuments.indexOf(c))return;let e=this._checkForIntersections,f=null,i=null;if(this.POLL_INTERVAL?f=d.setInterval(e,this.POLL_INTERVAL):(g(d,"resize",e,!0),g(c,"scroll",e,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in d&&(i=new d.MutationObserver(e)).observe(c,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(c),this._monitoringUnsubscribes.push(function(){let a=c.defaultView;a&&(f&&a.clearInterval(f),h(a,"resize",e,!0)),h(c,"scroll",e,!0),i&&i.disconnect()}),c!=(this.root&&(this.root.ownerDocument||this.root)||b)){let b=a(c);b&&this._monitorIntersections(b.ownerDocument)}}_unmonitorIntersections(c){let d=this._monitoringDocuments.indexOf(c);if(-1==d)return;let e=this.root&&(this.root.ownerDocument||this.root)||b;if(this._observationTargets.some(function(b){let d=b.element.ownerDocument;if(d==c)return!0;for(;d&&d!=e;){let b=a(d);if((d=b&&b.ownerDocument)==c)return!0}return!1}))return;let f=this._monitoringUnsubscribes[d];if(this._monitoringDocuments.splice(d,1),this._monitoringUnsubscribes.splice(d,1),f(),c!=e){let b=a(c);b&&this._unmonitorIntersections(b.ownerDocument)}}_unmonitorAllIntersections(){let a=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(let b=0;b<a.length;b++)a[b]()}_checkForIntersections(){if(!this.root&&d&&!e)return;let a=this._rootIsInDom(),b=a?this._getRootRect():j();this._observationTargets.forEach(function(c){let e=c.element,g=i(e),h=this._rootContainsTarget(e),k=c.entry,l=a&&h&&this._computeTargetAndRootIntersection(e,g,b),m=null;this._rootContainsTarget(e)?(!d||this.root)&&(m=b):m=j();let n=c.entry=new f({time:window.performance&&performance.now&&performance.now(),target:e,boundingClientRect:g,rootBounds:m,intersectionRect:l});k?a&&h?this._hasCrossedThreshold(k,n)&&this._queuedEntries.push(n):k&&k.isIntersecting&&this._queuedEntries.push(n):this._queuedEntries.push(n)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}_computeTargetAndRootIntersection(a,c,f){if("none"==window.getComputedStyle(a).display)return;let g=c,h=n(a),j=!1;for(;!j&&h;){let a=null,c=1==h.nodeType?window.getComputedStyle(h):{};if("none"==c.display)return null;if(h==this.root||9==h.nodeType)if(j=!0,h==this.root||h==b)d&&!this.root?e&&(0!=e.width||0!=e.height)?a=e:(h=null,a=null,g=null):a=f;else{let b=n(h),c=b&&i(b),d=b&&this._computeTargetAndRootIntersection(b,c,f);c&&d?(h=b,a=l(c,d)):(h=null,g=null)}else{let b=h.ownerDocument;h!=b.body&&h!=b.documentElement&&"visible"!=c.overflow&&(a=i(h))}if(a&&(g=function(a,b){let c=Math.max(a.top,b.top),d=Math.min(a.bottom,b.bottom),e=Math.max(a.left,b.left),f=Math.min(a.right,b.right),g=f-e,h=d-c;return g>=0&&h>=0&&{top:c,bottom:d,left:e,right:f,width:g,height:h}||null}(a,g)),!g)break;h=h&&n(h)}return g}_getRootRect(){let a;if(this.root&&!o(this.root))a=i(this.root);else{let c=o(this.root)?this.root:b,d=c.documentElement,e=c.body;a={top:0,left:0,right:d.clientWidth||e.clientWidth,width:d.clientWidth||e.clientWidth,bottom:d.clientHeight||e.clientHeight,height:d.clientHeight||e.clientHeight}}return this._expandRectByRootMargin(a)}_expandRectByRootMargin(a){let b=this._rootMarginValues.map(function(b,c){return"px"==b.unit?b.value:b.value*(c%2?a.width:a.height)/100}),c={top:a.top-b[0],right:a.right+b[1],bottom:a.bottom+b[2],left:a.left-b[3],height:0,width:0};return c.width=c.right-c.left,c.height=c.bottom-c.top,c}_hasCrossedThreshold(a,b){let c=a&&a.isIntersecting?a.intersectionRatio||0:-1,d=b.isIntersecting?b.intersectionRatio||0:-1;if(c!==d)for(let a=0;a<this.thresholds.length;a++){let b=this.thresholds[a];if(b==c||b==d||b<c!=b<d)return!0}}_rootIsInDom(){return!this.root||m(b,this.root)}_rootContainsTarget(a){let c=this.root&&(this.root.ownerDocument||this.root)||b;return m(c,a)&&(!this.root||c==a.ownerDocument)}_registerInstance(){0>c.indexOf(this)&&c.push(this)}_unregisterInstance(){let a=c.indexOf(this);-1!=a&&c.splice(a,1)}constructor(a,b){this.THROTTLE_TIMEOUT=100,this.POLL_INTERVAL=null,this.USE_MUTATION_OBSERVER=!0;const c=b||{};if("function"!=typeof a)throw Error("callback must be a function");if(c.root&&1!=c.root.nodeType&&9!=c.root.nodeType)throw Error("root must be a Document or Element");this._checkForIntersections=function(a,b){let c=null;return function(){c||(c=setTimeout(function(){a(),c=null},b))}}(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=a,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(c.rootMargin),this.thresholds=this._initThresholds(c.threshold),this.root=c.root||null,this.rootMargin=this._rootMarginValues.map(function(a){return a.value+a.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}},window.IntersectionObserverEntry=f}();var q=c(16),r=c(213);function s(a,b){var c,k,l;let m,p,s,u,w,{ariaLabel:x,label:y,getPhotoUrl:z,onClick:A,isDiscoverable:B,isAccessRequest:C,isNotification:D,sharingPrincipals:E,sharingLinks:F,personaSizeInPixels:G=24,renderOverlap:H}=a,I=(0,o.ib)(b.clientId,b.sharingStore)||(0,o.ab)(b.clientId,b.sharingStore),J=d.useRef(null),K=d.useRef(null),L=d.useRef(null),M=d.useRef(null),[N,O]=d.useState(!0),[P,Q]=d.useState(0),R=d.useRef(0),S=d.useRef(0),T=d.useMemo(()=>{let a=[],c={},h=0;if(F.length)for(let a of F){if(a.principals.length||a.invitees.length){for(let b of a.principals)c[b.loginName||b.email]=b;let b=new Date(a.expiration);if(a.isActive&&(!a.expiration||b.getTime()>Date.now()))for(let b of a.invitees)c[b.loginName||b.email]=b}h++}for(let b of(B&&a.push(d.createElement(d.Suspense,{fallback:d.createElement(d.Fragment,null)},d.createElement(r.b,null,d.createElement(t,{ariaLabel:f.Xc,className:`${I&&H?"od-SharedWith-Discoverable--simplified":"od-SharedWith-Discoverable"}`,iconName:"BuildingIcon",key:".discoverable",onClick:A,title:f.Xc,personaSizeInPixels:G,renderOverlap:H})))),E))c[b.loginName||b.email]=b;if(R.current=v(c,e.a.user),S.current=v(c,e.a.securityGroup,e.a.sharePointGroup),h&&!I){let b=1===h?f.bj:(0,g.b)(f.hj,h);a.push(d.createElement(t,{ariaLabel:b+(x?", "+x:""),className:`${I&&H?"od-SharedWith-Link--simplified":"od-SharedWith-Link"}`,iconName:"Link",key:".link",onClick:A,title:b,personaSizeInPixels:G,renderOverlap:H}))}for(let f of Object.keys(c)){let g,h=c[f];g=h.imageUrl?h.imageUrl:h.type===e.a.user&&z?z(f):void 0,(0,o.tb)(g,b.clientId)&&(g=void 0);let i=h.primaryText+(x?", "+x:""),j=h.email&&h.email!==h.primaryText?`${h.primaryText} <${h.email}>`:h.primaryText;a.push(d.createElement(t,{ariaLabel:i,imageUrl:g,className:`${I&&H?"od-SharedWith-Persona--simplified":""}`,key:(0,q.z)()?h.primaryText:h.id,onClick:A,text:h.primaryText,title:j,personaSizeInPixels:G,renderOverlap:H}))}return a},[E,F]);d.useEffect(()=>(J.current=new IntersectionObserver(Z,{root:M.current,threshold:1}),()=>J.current.disconnect()),[]),d.useEffect(()=>{if(J.current&&K.current){let a=[];for(let b=0;b<K.current.children.length;b++){let c=K.current.children[b];J.current.observe(c),a.push(c)}return()=>{for(let b of a)J.current.unobserve(b);b.resize?.()}}});let U=D?function(a,b,c,d){let h="",i="";if(1===b)h=f.tk;else if(b>1)h=g.b(f.$e,b);else if(a>0&&a<=3)for(let b=0;b<c.length;b++)c[b].type===e.a.user&&(i+=`${c[b].primaryText}`),a>=2&&(b===c.length-2?i+=g.b(f.J):b<c.length-2&&(i+=", "));else a>3?i=g.b(f.tf,a):1===a&&(i=f.ak);return 0!==b&&(a>1?i=g.b(f.tf,a):1===a&&(i=f.ak)),g.b(d?f.Ai:f.yj,i,b>0&&a>0?f.J:"",h)}(R.current,S.current,E,C):(c=R.current,k=S.current,l=F.length,m="",p="",s="",u="",1===c?s=f.ak:c>1&&(s=g.b(f.tf,c)),1===k?p=f.tk:k>1&&(p=g.b(f.$e,k)),1===l?m=f.nk:l>1&&(m=g.b(f.ef,l)),B&&(u=f.Xc),""===(w=[u,s,p,m].filter(a=>""!==a).join(", "))?f.If:g.b(f.vj,w)),V=`${U} ${f.zi}`,W=f.gj+(x?" "+x:""),X=!N&&d.createElement(i.a,{className:"od-SharedWith-facepile-button",onClick:A,tabIndex:0,"data-is-focusable":!0,"aria-label":V},d.createElement("ul",{className:"od-SharedWith-List",ref:L,tabIndex:-1,id:"od-SharedWith-List"},T.slice(0,P<T.length-1?P:void 0),P<T.length-1?d.createElement(t,{ariaLabel:W,className:`${I&&H?"od-SharedWith-More--simplified":"od-SharedWith-More"}`,iconName:"More",key:".more",onClick:A,title:f.gj,personaSizeInPixels:G,renderOverlap:H}):null)),Y=d.createElement("div",{"aria-label":y,className:"od-SharedWith-Facepile"},X,d.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:K,role:"presentation"},T));return d.useEffect(()=>{if(L?.current&&K?.current)if(I&&H){let a=(0,o.Q)();for(let b=0;b<L.current.children.length;b++){let c=L.current.children[b];a?c.style.left=`${6*b}px`:c.style.right=`${6*b}px`}for(let b=0;b<K.current.children.length;b++){let c=K.current.children[b];a?c.style.left=`${6*b}px`:c.style.right=`${6*b}px`}for(let a=0;a<K.current.children.length;a++){let b=K.current.children[a].firstChild;b.setAttribute("data-is-focusable","false"),b.setAttribute("tabindex","-1")}}else for(let a=0;a<K.current.children.length;a++){let b=K.current.children[a].firstChild.firstChild;b.setAttribute("data-is-focusable","false"),b.setAttribute("tabindex","-1")}}),I?d.createElement("div",{className:"od-SharedWith",ref:M},y&&d.createElement("h2",{className:"label"},y),d.createElement(n.a,{hostClassName:"od-SharedWith-tooltip",calloutProps:{gapSpace:0,directionalHint:a.isNotification?j.a.topCenter:j.a.topLeftEdge},content:`${U} ${a.isNotification?f.zi:""}`},Y)):d.createElement("div",{className:"od-SharedWith",ref:M},y&&d.createElement("h2",{className:"label"},y),Y);function Z(a){let b=0,c=1e3;if(K.current){for(let d of a)for(let a=0;a<K.current.children.length;a++)if(K.current.children[a]===d.target){d.intersectionRect.width===d.boundingClientRect.width?b=Math.max(b,a):c=Math.min(c,a);break}0===b&&1e3!==c&&(b=Math.max(0,c-1)),(0,h.unstable_batchedUpdates)(()=>{Q(a=>a!==b?b:a),O(!1)})}}}function t(a,b){let{ariaLabel:c,className:e,iconName:f,imageUrl:g,onClick:h,text:i,title:p,personaSizeInPixels:q,renderOverlap:r}=a,s=u(q),t=q/16,v=(0,o.ib)(b.clientId,b.sharingStore)||(0,o.ab)(b.clientId,b.sharingStore),w={styles:{coin:{width:`${t}rem`,height:`${t}rem`},image:{width:`${t}rem!important`,height:`${t}rem !important`},imageArea:{width:`${t}rem`,height:`${t}rem`},initials:{width:`${t}rem`,height:`${t}rem`,fontSize:"0.625rem",lineHeight:`${t}rem`}}},x={className:!v&&"od-SharedWith-facepile-padding",text:i,imageUrl:g,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:s||k.c.size24,onRenderInitials:f?()=>d.createElement(l.a,{iconName:f}):void 0,coinProps:w,styles:{root:{height:"1.5rem",minWidth:`${q}px`},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},y=d.createElement(m.a,x);return y=h?d.createElement("span",{tabIndex:-1,"aria-label":c,"data-is-focusable":!1,role:"img"},y):d.createElement("span",{className:"od-SharedWith-noninteractivePersona",tabIndex:0,"aria-label":c,"data-is-focusable":!0,role:"img"},y),v?d.createElement("li",{className:e},y):d.createElement("li",{className:e},d.createElement(n.a,{hostClassName:"od-SharedWithPersona-tooltip",calloutProps:{gapSpace:0},content:p,directionalHintForRTL:j.a.topLeftEdge},y))}s.contextTypes={clientId:p.number.isRequired,resize:p.func.isRequired,sharingStore:p.object.isRequired},t.contextTypes={sharingStore:p.object.isRequired,clientId:p.number.isRequired};let u=a=>{switch(a){case 24:default:return k.c.size24;case 28:return k.c.size28;case 48:return k.c.size48}},v=(a,b,c)=>{let d=0;for(let e in a)(a[e].type===b||c&&a[e].type===c)&&d++;return d}}
,function(a,b){b.a={anyone:0,workGroup:1,specificPeople:2,onlyYou:3,existing:4,chat:5,mail:6}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(48);let e=a=>({...(0,d.c)(a),...(0,d.d)(a,f)}),f=new Set(["ariaLabelledBy","componentRef","disableFirstFocus","disableRestoreFocus","disabled","elementToFocusOnDismiss","enableAriaHiddenSiblings","firstFocusableSelector","firstFocusableTarget","focusPreviouslyFocusedInnerElement","forceFocusInsideTrap","ignoreExternalFocusing","isClickableOutsideFocusTrap"])}
,,,,,,,,function(a,b,c){var d,e=c(20),f=c(47),g=c(74);(d||(d={})).getAttachAsCopyOptions=function(a,b,c,d,h,i){let j=[],k=function(a,b,c,d,h){let i=c.name.split("."),j="";if(i.length>1&&(j=i[1].toLowerCase()),!((0,g.l)()||h))return;let k=()=>{a.getEngagementHelper().sendACopyOfficeClicked(d),(0,g.u)()};return f.p(b)||["doc","docx","dot","docm","odt","rtf","txt"].indexOf(j)>-1?{key:"word",name:e.pl,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:k}:f.l(b)||["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(j)>-1?{key:"powerpoint",name:e.Rh,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:k}:f.e(b)||["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(j)>-1?{key:"excel",name:e.cd,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:k}:f.o(b)||["vsd","vsdx"].indexOf(j)>-1?{key:"visio",name:e.ul,iconProps:{iconName:"VisioLogo"},onClick:k}:{key:"document",name:e.Zc,iconProps:{iconName:"Document"},onClick:k}}(c,a,b,d,h);k&&j.push(k);let l=function(a,b,c){if((0,g.m)()||c)return{key:"pdf",name:e.Lg,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:()=>{a.getEngagementHelper().sendACopyPdfClicked(b),(0,g.w)()}}}(c,d,i);return l&&j.push(l),j},b.a=d}
,function(a,b,c){c.d(b,{a:function(){return g}}),(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}"}]);var d=c("react-lib"),e=c(105),f=c(106);class g extends d.Component{render(){return d.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},d.createElement("div",null,d.createElement(e.a,{type:f.b.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),d.createElement("span",{role:"alert"},this.props.message))}}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.default=0]="default",e[e.shareShimmer=1]="shareShimmer",e[e.modifyPermissions=2]="modifyPermissions",e[e.permissionsList=3]="permissionsList",e[e.linkSuccess=4]="linkSuccess",e[e.grantPermissions=5]="grantPermissions",e[e.policyDetails=6]="policyDetails",e[e.error=7]="error",e[e.linkSettings=8]="linkSettings",e[e.notify=9]="notify",e[e.addPeople=10]="addPeople",e[e.linksFromTemplateList=12]="linksFromTemplateList",e[e.atMention=13]="atMention",e[e.spinner=14]="spinner",e[e.copyLinkShortcut=15]="copyLinkShortcut",e[e.permissionsPivot=16]="permissionsPivot",e[e.shareToTeams=17]="shareToTeams"}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){return{clientId:a.clientId,scenarioId:a.scenarioId,correlationId:a.correlationId,hostOptions:a.hostOptions}}}
,function(a,b,c){var d,e,f,g;c.d(b,{a:function(){return d},b:function(){return e}}),(f=d||(d={}))[f.CompletedSuccessfully=0]="CompletedSuccessfully",f[f.AccessRequestsQueued=1]="AccessRequestsQueued",f[f.Error=2]="Error",(g=e||(e={}))[g.UnshareLink=0]="UnshareLink",g[g.ShareLink=1]="ShareLink",g[g.FetchSharingInformation=2]="FetchSharingInformation",g[g.GrantAccess=3]="GrantAccess",g[g.AtMention=4]="AtMention"}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){return a}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={})).ScriptLoaded="share_scriptsLoaded",e.CopyLinkClicked="share_copyLinkClicked",e.ShareSendClicked="share_sendClicked",e.ShareTeamsClicked="share_teamsClicked",e.ShareTeamsClickedWithContext="share_teamsClickedWithContext",e.ShareAddPeopleCompleted="share_addPeopleCompleted",e.PeoplePickerFocused="share_peoplePickerFocused",e.UIReady="share_uiReady",e.Ready="share_ready",e.Error="share_error",e.Resize="share_resize",e.NewToken="share_newToken",e.GrantAccessCompleted="share_grantAccessCompleted",e.Dismiss="share_dismiss",e.ReadyForRecipients="share_readyForRecipients",e.OutlookClicked="share_outlookClicked",e.SendRecipients="atMention_defaultRecipients",e.ManageAccessClicked="share_manageAccessClicked",e.ShareCompleted="share_completed",e.MakeVisible="share_makeVisible",e.Destruct="share_destruct",e.ResetMakeVisible="share_resetMakeVisible",e.InstantLoadReady="share_instantLoadReady",e.ShareContextInformation="share_postContextInformation",e.Started="share_started",e.LinkSettingCompleted="share_linkSettingsCompleted",e.GetToken="share_getToken",e.DocumentInformation="share_documentInformation",e.ReloadWithAuthToken="share_reloadWithAuthToken",e.SharingInfoBarInformation="share_sharingInfoBarInformation",e.SharingStoreReady="share_sharingStoreReady",e.ShareLoadResult="share_loadResult",e.ShareRefreshCookies="share_refreshCookies",e.CopyToClipboard="share_copyToClipboard",e.ShareCopySharingLinkToClipboard="share_copySharingLinkToClipboard",e.CopyToClipboardResult="share_copyToClipboardResult",e.GetShareAppsConfig="share_getShareAppsConfig",e.ShareAppsConfigResult="share_shareAppsConfigResult",e.ShareAppClicked="share_shareAppClicked",e.ShareAppClickedResult="share_shareAppClickedResult",e.GetPreviewData="share_getPreviewData",e.PreviewDataResult="share_previewDataResult",e.GetShareAsAttachmentData="share_getShareAsAttachmentData",e.ShareAsAttachmentDataResult="share_shareAsAttachmentDataResult",e.SendCopy="share_sendCopy",e.SendPdf="share_sendPdf",e.ShareClicked="share_clicked",e.CopyLinkNotificationShown="share_copyLinkNotificationShown"}
,function(a,b,c){let d,e;c.d(b,{a:function(){return m},b:function(){return o},c:function(){return n}}),c(235),c(236),c(237);var f=c(557),g=c(363),h=c(364),i=c(34),j=c(40),k=c(164),l=c(55);function m(a){let b="",c=window.PageContext.env||"devbox",f=window.Flight;if(f)if(f.ramps&&!f.Ramps&&(f.Ramps=f.ramps),f.usingRedirectCookie)b=a.tokens.ppe;else switch(c.toLowerCase()){case"edog":case"dogfood":case"prodbubble":b=a.tokens.ppe;break;case"prod":case"dprod":b=a.tokens.prod}else b=a.tokens.prod;d=o(a),b&&(a.initOneDS||(0,h.b)()?(e?.dispose(),(e=new k.a({sourceName:"od-core",tenantToken:b,context:d})).attach(l.a)):(e=void 0,h.a.Init(b,d)))}function n(a){if(d){let b=o(a),c={...d,...b,context:{...d.context,...a.context}};e?e.updateContext(c):h.a.UpdateContext(c)}}function o(a){let b=window.PageContext,c=b.env||"devbox",d=window.Flight,e=a.oAuthToken&&function(a){if(!a)return;let b=a.split(".");if(3===b.length)try{return JSON.parse(atob(b[1].replace(/-/g,"+").replace(/_/g,"/")))}catch(a){return}}(a.oAuthToken),f=e&&e.puid||d.session,g=e&&e.puid||b.userName,h=e&&e.tid,k=h||b.siteSubscriptionId,l=h||b.aadTenantId;return{isAuthenticated:!!g,market:b.mkt,session:i.a.generate(),collectorUrl:b.ariaCollectorUrl,oneDsCollectorUrl:b.oneDsCollectorUrl,version:d.version,manifest:d.manifest||d.name,userId:f,accountType:g?j.a.Business:j.a.BusinessAnonymous,siteSubscriptionId:k,farmLabel:b.farmLabel,environment:c,workload:a.workload,disableCookies:!b.userName,context:a.context,cloudType:b.cloudType,homeTenantId:b.homeTenantId||l,resourceTenantId:l}}(0,f.a)(),g.a.init()}
,function(a,b,c){let d;c.d(b,{a:function(){return h}});var e=c(30),f=c(11);let g=(0,e.a)({eventName:"PageInit,",shortEventName:"PageInit"},{screenWidth:f.a.Number,screenHeight:f.a.Number,availableScreenWidth:f.a.Number,availableScreenHeight:f.a.Number,renderWidth:f.a.Number,renderHeight:f.a.Number,browserWidth:f.a.Number,browserHeight:f.a.Number,devicePixelRatio:f.a.Number,referrer:f.a.String});class h{static init(){return d||(d=g.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0})),d}}}
,function(a,b,c){let d,e,f,g,h,i;c.d(b,{a:function(){return at},b:function(){return aw}});var j,k=c(6),l=c(40),m=c(55),n=c(94),o=c(11);let p=(0,n.a)({eventName:"Beacon,",shortEventName:"Beacon"},{name:o.a.String,status:o.a.String,success:o.a.Boolean,retryCount:o.a.Number,totalRetries:o.a.Number,eventCount:o.a.Number});var q=c(72),r=c(31),s=c(260);class t{get endpointUrl(){return this._endpointUrl}get dataCompletenessJson(){return this._dataCompletenessJson}send(){new s.a({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start((a,b)=>{},(a,b,c)=>{})}constructor(a,b,c,d,e){this._endpointUrl=a.callbackEndpoint.authority+a.callbackEndpoint.path;const f={};if(e)for(let a=0;a<e.length;++a)f[e[a].EventType]=f[e[a].EventType]+1||1;const g={TelemetryTenantId:a.telemetryTenantToken.substring(0,32),AppVersion:a.appVersion,EventType:b,StatusCode:c,EventCount:e?e.length:0,Timestamp:d,Environment:a.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:f,Workload:a.workload||"",FarmLabel:a.farmLabel||"",FarmName:a.farmName||""};this._dataCompletenessJson=JSON.stringify(g)}}var u=c(15),v=c(365);class w{attach(a){let b,c=!1;return this._getHandler().then(d=>{c||(b=d.attach(a))}),()=>{c=!0,b&&b()}}_getHandler(){let a=this._handlerLoader();return this._getHandler=()=>a,a}constructor(a){this._handlerLoader=a}}var x=c(7),y=c(366);function z(a){try{return"string"==typeof a&&0!==a.length&&isNaN(Number(a))&&"true"!==a&&"false"!==a}catch{return!1}}class A{shouldScan(a){return this._scanned++,!0}sanitize(a){return this._sanitized++,`SANITIZED - ${this.identifier}`}warn(a){return`WARNING - ${this.identifier} - ${a}`}flushSummary(){let a={scanned:this._scanned,sanitized:this._sanitized,sanitizedRatio:0===this._scanned?0:this._sanitized/this._scanned};return this._scanned=0,this._sanitized=0,a}constructor(a){this._scanned=0,this._sanitized=0}}var B=c(367);let C=/(?:^|[^A-Za-z0-9_-])[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{3,}\.[A-Za-z0-9_-]{20,}/,D=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],E=["Mozilla","AppleWebKit","Gecko","Safari","Chrome","Edg"],F=/\d+\.\d+(\.\d+)?(\.\d+)?/,G=/\b\d{1,2}\/\d{1,2}\/(\d{4}|\d{2})\b/,H=/^\/\d+\/\d+\/\d+\/?$/,I=Array(128).fill(!1);function J(a,b,c){if(b>0&&"/"===a[b-1]||" "===a[b+1]||c<a.length-1&&" "===a[c+1])return!1;for(let d=b+1;d<c;d++){let b=a.charCodeAt(d);if(!(b>=128)&&!I[b])return!1}return c>b+1}[...D,"%","-",".","_","~",":","?","#","[","]","@","!","$","&","(",")","*","+",";"," ","=","'"].forEach(a=>{I[a.charCodeAt(0)]=!0});let K=/<soap:Envelope/i,L=/%[0-9A-Fa-f]{2}/,M=/_sp0[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/i;class N extends A{scan(a){for(let b of["https://","http://"]){let c=a.indexOf(b);if(-1!==c){let d=c+b.length;if(" "!==a[d]){if(a.substring(d).includes("{ length:"))return!1;return!0}}}return!1}warn(a){return`WARNING: aka.ms/ODSPSanitizerURL - ${a}`}constructor(...a){super(...a),this.identifier=B.a.URLOld}}let O=new Set(["/"," ","	","\n","\r","{","}"]),P="http://",Q="https://",R=new Set([...D,".","-","_","#"]),S=new Set([...D,".","-"]),T=new Set(D),U=["@","%40","_at_"],V=new Set([...D,".","-","_","#"]),W=new Set([...D,".","-"]),X=new Set(D),Y=/(?:^|[^A-Za-z0-9_-])[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{3,}\.[A-Za-z0-9_-]{20,}/,Z=/\bey[A-Za-z0-9_-]{18,}\.(?:[A-Za-z0-9_-]*)\.[A-Za-z0-9_-]{43,}\b/g,$=/ey[A-Za-z0-9_-]{18,}\./i,_={SPOPassword:class extends A{shouldScan(a){return super.shouldScan(a),-1!==a.toLowerCase().indexOf("_sp0")}scan(a){let b=a.match(M);return!!b&&0!==b.length}constructor(...a){super(...a),this.identifier=B.a.SPOPassword}},Soap:class extends A{scan(a){if(K.test(a))return!0;if(L.test(a))try{let b=decodeURIComponent(a);return K.test(b)}catch(a){}return!1}constructor(...a){super(...a),this.identifier=B.a.Soap}},KnownString:class extends A{scan(a){let b=a.toLowerCase();return this._targets.some(a=>-1!==b.indexOf(a))}constructor(...a){super(...a),this.identifier=B.a.KnownString,this._targets=["accesstoken:","password=",".files.1drv.com/",".s2s-files.1drv.com/",".livefilestore.com/","shares/u!","shares/b!","shares('u!","shares('b!","shares(u!","shares(b!","shares(@","shares(%40"]}},QueryParam:class extends A{shouldScan(a){return super.shouldScan(a),this._delimiters.some(b=>a.includes(b))}scan(a){let b=a.toLowerCase();return this._targets.some(a=>-1!==b.indexOf(a))}constructor(){for(const a of(super(),this.identifier=B.a.QueryParam,this._params=["access_token=","accesstoken=","auth_key=","authkey=","auth_token=","authtoken=","challengetoken=","email=","guestaccesstoken=","jwt=","login_hint=","originalpath=","password=","pageinfo=","patqp=","prooftoken=","querytemplate=","querytemplatepropertiesurl=","querytext=","redeem=","rwurl=","selectproperties=","share=","sig=","tempauth=","username=","wd="],this._delimiters=["&","?"],this._targets=[],this._params))for(const b of this._delimiters)this._targets.push(`${b}${a}`)}},SitePath:class extends A{shouldScan(a){return super.shouldScan(a),a.indexOf("/")>-1}scan(a){return function(a){if(a.includes("W3SVC")||E.some(b=>a.includes(b))||F.test(a)||G.test(a)||H.test(a))return!1;let b=a.length;for(let c=0;c<b;c++)if("/"===a[c]){let b=c,d=a.indexOf("/",b+1);if(-1===d||d-b<=1||!J(a,b,d))continue;let e=a.indexOf("/",d+1);if(-1===e)return!0;if(e-d<=1)continue;if(J(a,d,e))return!0}return!1}(a)}warn(a){return`WARNING: aka.ms/ODSPSanitizerSitePath - ${a}`}constructor(...a){super(...a),this.identifier=B.a.SitePath}},JWT:class extends A{shouldScan(a){return super.shouldScan(a),-1!==a.toLowerCase().indexOf("ey")}scan(a){return C.test(a)}constructor(...a){super(...a),this.identifier=B.a.JWT}},JWTOld:class extends A{shouldScan(a){return super.shouldScan(a),-1!==a.toLowerCase().indexOf("eyj0exaioijkv1qilc")}scan(a){return Y.test(a)}constructor(...a){super(...a),this.identifier=B.a.JWTOld}},JWTInDepth:class extends A{shouldScan(a){return super.shouldScan(a),$.test(a)}scan(a){let b,c;try{b=decodeURIComponent(a)}catch(c){b=a}for(Z.lastIndex=0;null!==(c=Z.exec(b));)if(this._isValidJWT(c[0]))return!0;return!1}_isValidJWT(a){let b=a.split(".");if(3!==b.length)return!1;let[c,d,e]=b;return this._isValidBase64Url(c)&&(0===d.length||this._isValidBase64Url(d))&&this._isValidBase64Url(e)}_isValidBase64Url(a){try{let b=a.replace(/-/g,"+").replace(/_/g,"/");if(b.length%4==1)return!1;let c=(4-b.length%4)%4,d=b+"=".repeat(c);return atob(d),!0}catch{return!1}}constructor(...a){super(...a),this.identifier=B.a.JWTInDepth}},URL:class extends N{shouldScan(a){return super.shouldScan(a),a.includes(P)||a.includes(Q)}scan(a){let b,c=this._findUrls(a),d=!1,e=c.next();for(;!e.done;){if(b=e.value,!a.includes("{ length:",b)){let c=this._extractDomain(a,b);if(c&&!this._trustedDomainsSet.has(c)&&!this._wwwTrustedDomainsSet.has(c)){d=!0;break}}e=c.next()}return d}*_findUrls(a){let b=0;for(;b<a.length;){let c=-1,d=a.indexOf("https://",b);if(-1!==d)c=d+Q.length;else{let d=a.indexOf("http://",b);-1!==d&&(c=d+P.length)}if(-1===c)break;yield c,b=c}}_extractDomain(a,b){let c=a.length;for(let d=b;d<a.length;d++)if(O.has(a[d])){c=d;break}return a.substring(b,c).toLowerCase()}constructor(a){super(a),this.identifier=B.a.URL;const b=a.trustedDomains?.map(a=>a.toLowerCase())||[];this._trustedDomainsSet=new Set(b),this._wwwTrustedDomainsSet=new Set(b.map(a=>`www.${a}`))}},URLOld:N,Email:class extends A{shouldScan(a){return super.shouldScan(a),null!==this._findAtCharacter(a.toLowerCase(),0)}scan(a){let b=a.toLowerCase(),c=this._findEmails(b),d=!1,e=c.next();for(;!e.done;){let a=e.value,f=this._isUserPartValid(b,a),g=this._extractDomain(b,a);if(f&&void 0!==g&&!this._trustedDomainsSet.has(g.toLowerCase())){d=!0;break}e=c.next()}return d}warn(a){return`WARNING: aka.ms/ODSPSanitizerEmail - ${a}`}_findAtCharacter(a,b){let c=null;for(let d of U){let e=a.indexOf(d,b);-1!==e&&(null===c||e<c.index)&&(c={index:e,variant:d})}return c}*_findEmails(a){let b=0;for(;b<a.length;){let c=this._findAtCharacter(a,b);if(null===c)break;yield c,b=c.index+c.variant.length}}_isUserPartValid(a,b){let c=b.index;if(c<3)return!1;for(let b=3;b>0;b--){let d=a.charCodeAt(c-b);if(!(d>=128)&&!R.has(String.fromCharCode(d)))return!1}return!0}_extractDomain(a,b){let c=b.index+b.variant.length;if(b.index<0||c>=a.length)return;let d=a.indexOf(".",c);if(-1===d||d-c>255||"-"===a[c])return;for(let b=c;b<d;b++){let c=a.charCodeAt(b);if(!(c>=128)&&!T.has(String.fromCharCode(c)))return}let e=d+1,f=e;for(;f<a.length&&128>a.charCodeAt(f)&&S.has(a[f]);)f++;if(!(f-e<2))return a.substring(c,f).toLowerCase()}constructor(a={}){super(),this.identifier="Email";const b=a.trustedDomains?.map(a=>a.toLowerCase())||[];this._trustedDomainsSet=new Set(b)}},EmailOld:class extends A{shouldScan(a){return super.shouldScan(a),-1!==a.indexOf("@")}scan(a){let b,c=this._findEmails(a),d=!1,e=c.next();for(;!e.done;){b=e.value;let f=this._isUserPartValid(a,b),g=this._extractDomain(a,b);if(f&&void 0!==g&&!this._trustedDomainsSet.has(g.toLowerCase())){d=!0;break}e=c.next()}return d}warn(a){return`WARNING: aka.ms/ODSPSanitizerEmail - ${a}`}*_findEmails(a){let b=0;for(;b<a.length;){let c=a.indexOf("@",b);if(-1===c)break;yield c,b=c+1}}_isUserPartValid(a,b){if(b<3)return!1;for(let c=3;c>0;c--){let d=a.charCodeAt(b-c);if(!(d>=128)&&!V.has(String.fromCharCode(d)))return!1}return!0}_extractDomain(a,b){if(b<0||b>=a.length-1)return;let c=a.indexOf(".",b);if(-1===c||c-b-1>255||"-"===a[b+1])return;for(let d=b+1;d<c;d++){let b=a.charCodeAt(d);if(!(b>=128)&&!X.has(String.fromCharCode(b)))return}let d=c+1,e=d;for(;e<a.length&&128>a.charCodeAt(e)&&W.has(a[e]);)e++;if(!(e-d<2))return a.substring(b+1,e).toLowerCase()}constructor(a={}){super(),this.identifier="EmailOld";const b=a.trustedDomains?.map(a=>a.toLowerCase())||[];this._trustedDomainsSet=new Set(b)}},CustomString:class extends A{shouldScan(a){return super.shouldScan(a),this._patterns.length>0&&a.length>0}scan(a){let b=a.toLowerCase();return this._patterns.some(a=>b.includes(a))}warn(a){return`WARNING: Custom pattern detected - ${a}`}constructor(a){super(a),this.identifier=B.a.CustomString,this._patterns=a?.customPatterns?.map(a=>a.toLowerCase())||[]}}},aa={};function ab(a,b){let c=new Map;for(let d of a)if("function"==typeof d){let a=d();c.set(a.identifier,a)}else c.set(d,new _[d](b?.[d]||aa));return c}class ac{addExclusion(a){this._excludedPaths.add(a)}addWarningPath(a){this._warningPaths.add(a)}flushSummary(){let a={sanitizedObjectCount:this._sanitizedObjectCount,viewedObjectCount:this._viewedObjectCount};return this._sanitizedObjectCount=0,this._viewedObjectCount=0,this._fieldScanners.forEach(b=>{a[b.identifier]=b.flushSummary()}),a}sanitizeOld(a,b,c){let d=!1;return this._fieldScanners.forEach(e=>{a=ad(a,(a,c)=>{try{if(this._shouldSanitize(e,c,a)){b?.(e.identifier,c),d=!0;let f=a;return this._warningScanners.has(e.identifier)&&(f=e.warn(f)),this._sanitizeScanners.has(e.identifier)&&(f=e.sanitize(f)),f}return a}catch(d){return b?.(e.identifier,`${c}!SanitizerError!`),a}},{...this._traversalContext,...c})}),this._viewedObjectCount++,d&&this._sanitizedObjectCount++,a}sanitize(a,b,c){if(null==a)return this._viewedObjectCount++,a;let d=!1,e=ad(a,(a,c)=>{if(!z(a))return a;let e=a,f=!1;return this._fieldScanners.forEach((a,g)=>{try{if(f||!a.shouldScan(e)||!a.scan(e))return;if(b?.(g,c),d=!0,this._warningPaths.has(c)){e=a.warn(e);return}if(this._sanitizeScanners.has(g)){e=a.sanitize(e),f=!0;return}this._warningScanners.has(g)&&(e=a.warn(e))}catch(a){b?.(g,`${c}!SanitizerError!`)}}),e},{...this._traversalContext,...c});return this._viewedObjectCount++,d&&this._sanitizedObjectCount++,e}_shouldSanitize(a,b,c){return z(c)&&a.shouldScan(c)&&a.scan(c)}constructor(a){if(this._excludedPaths=new Set,this._warningPaths=new Set,this._warningScanners=new Set,this._sanitizeScanners=new Set,this._fieldScanners=new Map,this._viewedObjectCount=0,this._sanitizedObjectCount=0,this._excludedPaths=new Set(a.excludedPaths||[]),this._warningPaths=new Set(a.warningPaths||[]),this._traversalContext={excludedPaths:this._excludedPaths,parseJsonStrings:a.parseJsonStrings||!1,parseArrayStrings:a.parseArrayStrings??(a.parseJsonStrings||!1),skipObjectKeys:a.skipObjectKeys||!1},a.isExternalScannerSupportKSActive){const b=[...a.warn||[],...a.sanitize||[]];this._fieldScanners=ab(b,a.scannerOptions),this._warningScanners=new Set(a.warn||[]),this._sanitizeScanners=new Set(a.sanitize||[]);return}const b=ab(a.sanitize||[],a.scannerOptions),c=ab(a.warn||[],a.scannerOptions);b.forEach(a=>{this._fieldScanners.set(a.identifier,a),this._sanitizeScanners.add(a.identifier)}),c.forEach(a=>{this._fieldScanners.set(a.identifier,a),this._warningScanners.add(a.identifier)})}}function ad(a,b,c){let{excludedPaths:d,parseJsonStrings:e,parseArrayStrings:f,skipObjectKeys:g}=c||{},h=c?.currentPath||"";if(d?.has(h))return a;if(Array.isArray(a))return a.map((a,d)=>ad(a,b,{...c,currentPath:`${h}[${d}]`}));if("object"==typeof a&&null!==a){let e={};for(let f of Object.keys(a)){let i=`${h}#`;g||d?.has(i)||(f=b(f,i)),e[f]=ad(a[f],b,{...c,currentPath:h?`${h}.${f}`:f})}return e}if("string"!=typeof a||!e||"{"!==a.charAt(0)&&(!f||"["!==a.charAt(0)))return b(a,h);try{let d=JSON.parse(a),e=ad(d,b,{...c,currentPath:`${h}$`});return JSON.stringify(e)}catch{return b(a,h)}}var ae=c(0);let af=["gcc","dod","gcch","ag08","ag09","chn"];function ag(a){return!!a&&af.includes(a.toLowerCase())}let ah=new Set(["accounttype","appname","appid","browserismobile","browsermajver","browserminver","browsername","browseruseragent","clientname","cloudtype","environment","farmlabel","farmname","isauthenticated","issharedcontrol","market","manifest","osname","osversion","session","sitesubscriptionid","userid","version","workload","appinfo.language","appinfo.session","appinfo.manifest","appinfo.version","userinfo.language","userinfo.id","deviceinfo.id","deviceinfo.osname","deviceinfo.osversion","debug.isworker","debug.isoffline","isnucleusenabled","webtemplateid","weblog_type_qos","weblog_fullname","weblog_eventtype","webid","useragent","tenantid","siteid","sessionid","resourcetenantid","privacyclassification","originalsession","name","hometenantid","debug.eventsource","correlationvector","browserispwa","weblog_type_pageusage","eupl","failure","feature","result","weblog_type_engagement","usagetype","sitetype","listid","isintentional","docid","currentpage","component","weblog_type_rumonedataupload","rumonedataupload_dictionary_eupl","rumonedataupload_dictionary_fcp","rumonedataupload_dictionary_emergencyuploaded","rumonedataupload_dictionary_pagetransitiontype","rumonedataupload_dictionary_scenarioid","rumonedataupload_dictionary_tti","rumonedataupload_dictionary_sw_isgenerated","rumonedataupload_dictionary_sw_bypassed","rumonedataupload_streamname","persistence","weblog_type_customerpromise","duration","pillar","resulttype","ring","scenario","servergu","tenantid"]),ai=(a,b=ah)=>(Object.keys(a).forEach(c=>{b.has(c.toLowerCase())||delete a[c]}),a),aj="AriaBeacon",ak={logStartEvents:!1,Init:function(a,b,c,e={}){try{let f;ak.logStartEvents=!0;let g=ao(b,e.platformDetection),h=new u.a(b.completenessCallbackEndpoint),i={telemetryTenantToken:a,appVersion:b.version,environment:b.environment,workload:b.workload,farmLabel:b.farmLabel,farmName:b.farmName,callbackEndpoint:h},j={ariaLoader:()=>x.c.resolve(c),context:g,tenantToken:a,disableCookies:b.disableCookies,ariaLogConfiguration:{collectorUrl:b.collectorUrl},logStartEvents:ak.logStartEvents,offlineDetection:e.offlineDetection,offlineCache:e.offlineCache,ariaQos:{isQosEvent:a=>p.isTypeOf(a)&&!!a.data&&a.data.name===aj,reportQos:a=>{let{result:b,statusCode:c,events:d}=a;new p({name:aj,retryCount:0,totalRetries:0,eventCount:d?d.length:0}).end({success:0===b,status:c+""}),""!==h.authority&&new t(i,b,c,new Date().getTime(),d).send()}}},k=b.getAuthToken?new w(async()=>{let a;try{a=await b.getAuthToken()}catch{}return d=new am({userAuthToken:a,...j})}):d=new al(j);return f=e.customManager?k.attach(e.customManager):k.attach(m.a),()=>{f(),d=void 0}}catch(a){return a instanceof c.Exception&&(a=Error(`Aria error: ${a.toString()}`)),q.a.log(a),d=void 0,()=>{}}},updateContext:function(a,b={}){if(d){let c=ao(a,b.platformDetection);d.updateContext(c)}},isInitialized:function(a){return!!d},flushTelemetry:an},al=(j=o.b.requiredService,a=>{let b="function"==typeof j?j:()=>j;return class extends a{constructor(a){const{onLogEvent:c}=a;super({...a,onLogEvent:a=>{let d=c?c(a):a;if(d.data)return{...d,data:{...d.data,privacyClassification:b(d)}}}})}}})(ae.a.isActivated("1FC93BFB-D44C-4A37-BB6A-4E061AFB0D52")?v.a:(g=v.a,h=class extends g{updateContext(a){if(!this._sanitizer)return void super.updateContext(a);let b=this._sanitizer.sanitize(a);super.updateContext(b)}constructor(a){let b;const c=(0,y.a)()||{};if(c.disable||!c.sanitize||0===c.sanitize.length)return void super(a);try{b=new ac(c)}catch(b){super(a);return}const{onLogEvent:d,context:e}=a;super({...a,context:b.sanitize(e),onLogEvent:a=>{let c=d?d(a):a;return(c.data||c.context)&&(c={...c,data:b.sanitize(c.data),context:b.sanitize(c.context)}),c}}),this._sanitizer=b}},class extends h{updateContext(a){ag(a.Environment||a.CloudType||a.Ring)&&ai(a),super.updateContext(a)}constructor(a){if(!ag(a.context?.Environment||a.context?.CloudType||a.context?.Ring))return void super(a);const{onLogEvent:b,context:c}=a;c["Debug.StrictContextRequired"]=!0,ai(c),super({...a,context:c,onLogEvent:a=>{let c=b?b(a):a;return c.data&&ai(c.data),c.context&&ai(c.context),c}})}})),am=(i=al,class extends i{constructor(a){const{context:b={}}=a,{userAuthToken:c,userId:d,context:e,...f}=a,g=c&&function(a){try{let b=a.split(".")[1];if(b)return JSON.parse(atob(b.replace(/-/g,"+").replace(/_/g,"/")))}catch(a){return}}(c),h=g&&g.puid?"Business":"Unknown",i=g&&g.app_displayname||"Unknown",j=g&&g.appid||"Unknown",k=function(a,b,c){if(a)if("Unknown"===c)return"";else return a;return"Business"===c&&b&&b.puid||""}(d,g,h);super({context:{AccountType:h,AppName:i,AppId:j,IsAuthenticated:+!!k,SiteSubscriptionId:g&&g.tid||"Unknown",UserId:k,...b},...f})}});async function an(){d&&await d.flush()}function ao(a,b=new r.a){return{AccountType:l.a[a.accountType],BrowserIsMobile:b.isMobile,BrowserIsPWA:b.isPWA,BrowserMajVer:b.browserMajor,BrowserMinVer:b.browserMinor,BrowserName:b.browserName,BrowserUserAgent:b.userAgent,CloudType:a.cloudType,Environment:a.environment,FarmLabel:a.farmLabel,FarmName:a.farmName,IsAuthenticated:+!!a.isAuthenticated,Market:a.market,Manifest:a.manifest,OSName:b.osName,OSVersion:b.osVersion,Session:a.session,SiteSubscriptionId:a.siteSubscriptionId||"",UserId:a.userId,Version:a.version,Workload:a.workload,SiteId:a.siteId,WebId:a.webId,WebTemplateId:a.webTemplateId,pageCorrelationId:a.pageCorrelationId,originalSession:a.originalSession,ResourceTenantId:a.resourceTenantId,listId:a.listId,product:a.product,SessionId:a.session,TenantId:a.siteSubscriptionId,UserAgent:b.userAgent,ServerGU:a.sideBySideToken,...a.context||{}}}var ap=c(126);function aq(){return c.e("odsp.aria.lib").then(c.bind(c,"aria-lib"))}let ar={ODB:-990,ODC:"ForceEnableAria"},as={ODB:1607,ODC:"EnableAll1DSTelemetry"};class at{static Init(a,b,c=aq,d,f){a&&au(b)&&(e=c().then(c=>{ak.Init(a,b,c,{offlineDetection:d,customManager:f})},a=>{}))}static InitCustomerPromise(a,b,c=aq,d){a&&au(b)&&(f=c().then(c=>{ak.Init(a,b,c,{offlineDetection:d,customManager:(0,ap.a)()})},a=>{}))}static UpdateContext(a){e&&e.then(()=>{ak.updateContext(a)}).catch(()=>{}),f&&f.then(()=>{ak.updateContext(a)}).catch(()=>{})}static get logStartEvents(){return ak.logStartEvents}static set logStartEvents(a){ak.logStartEvents=a}static async flushTelemetry(){if(e)try{await ak.flushTelemetry()}catch{}}static getAriaTimeZone(a){let b=Math.abs(a),c=b%60,d=Math.floor(b/60);return`${a>0?"-":"+"}${d>=10?d:`0${d}`}:${c>=10?c:`0${c}`}`}}function au(a){let{version:b,env2:c}=a,d=!1;return ae.a.isActivated("5C0A45DF-2014-4FE8-9D90-180A716AC309")||(d="onebox"===c),!(!ae.a.isActivated("010437DC-D681-4308-A21E-8BD4ADE3783C","11/12/2021","Use session storage TAB test running flag to bypass client-side logging.")&&av("_isRunningTABTest"))&&("dev"!==b&&!d||!!k.a.isFeatureEnabled(ar)||av("enableAriaUpload")||av("enableTelemetryUpload"))}function av(a){let b=!ae.a.isActivated("6DC50D29-3FD6-465C-9E8D-80A877497A9D","10/10/2022","Ensure that a boolean value is returned and not undefined.");try{if("sessionStorage"in window&&window.sessionStorage){let c=window.sessionStorage[a],d=c&&"true"===c.toLowerCase();if(b)return!!d&&"undefined"!=typeof console&&!!console;return d&&"undefined"!=typeof console&&!!console}}catch(a){}return!1}function aw(){return k.a.isFeatureEnabled(as)}}
,function(a,b,c){c.d(b,{a:function(){return k}});var d=c(40),e=c(0),f=c(98),g=c(331);function h(a,b){let{Session:c,Version:d,OSName:e,OSVersion:h,Market:i,UserId:j,Manifest:k,...l}=b,m=a.getSemanticContext();if(c&&a.setContext("AppInfo.Session",c),k&&a.setContext("AppInfo.Manifest",k),d&&m.setAppVersion(d),m.setUserLanguage(i||""),j){let a=j&&j.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,(a,b,c,d,e,f)=>`${b}${(0,g.a)(e)}${f}`);m.setUserId(a)}for(let b in e&&m.setDeviceOsName(e),h&&m.setDeviceOsVersion(h),l)if(Object.prototype.hasOwnProperty.call(l,b)){if(null==l[b])continue;let c=(0,f.a)(b);a.setContext(c,l[b])}}var i=c(95),j=c(642);class k{attach(a){return this._createLogHandler(),a.addEventHandler({sourceName:"AriaTelemetryHandler",handler:this.logEvent,handleMissedEvents:!0})}updateContext(a){this._getLogger().then(([b])=>h(b,a))}flush(){return this._getAria().then(a=>{a.LogManager.flush()})}constructor(a){this.logEvent=a=>{let b=this._onLogEvent?this._onLogEvent(a):a;this._createLogHandler().then(a=>a(b))},this._getAria=l(()=>a.ariaLoader().then(b=>(b.LogManager.isInitialized()||(b.LogManager.initialize(a.tenantToken,{disableCookies:a.disableCookies,...a.offlineCache?{browserOverrides:{onGetData:a.offlineCache.getData,onSaveData:a.offlineCache.saveData}}:{},...a.ariaLogConfiguration||{}}),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",()=>{b.LogManager.flush()})),b.LogManager.addCallbackListener((b,c,d,e)=>{d===a.tenantToken&&a.ariaQos&&a.ariaQos.reportQos({result:b,statusCode:c,events:e})}),b))),this._getLogger=l(()=>this._getAria().then(b=>{let d=function(a,b,c={}){let d=new a.Logger(b);return h(d,c),d}(b,a.tenantToken,a.context),e=a.offlineDetection;return j.a&&e?c.e(42).then(c.bind(c,621)).then(c=>(this._offlineEventQueue=c.makeOfflineAriaEventQueue(d,a.tenantToken,e),[d,b])):Promise.resolve([d,b])})),this._createLogHandler=l(()=>this._getLogger().then(([b,c])=>(function(a,b,c=!0,g,h){return k=>{try{if((k.eventType!==d.b.Start||c)&&!(g&&g.isQosEvent(k))){let c=function(a,b,c){var g;let{name:h,values:i}=function(a){let b={CorrelationVector:a.vector.toString(),WebLog_FullName:a.eventName,WebLog_EventType:d.b[a.eventType]},c=a.eventName.split(",");for(let a of c)a&&(b[`WebLog_Type_${a}`]=1);let{data:e,context:g}=a;if(g){for(let a in g)if(Object.prototype.hasOwnProperty.call(g,a)){let c=g[a];if(null==c)continue;b[(0,f.a)(a)]=c}}if(e){for(let c in e)if(Object.prototype.hasOwnProperty.call(e,c)){let d=e[c];if(null==d)continue;let g=a.metadata[c];if(g){let a=g.isPrefixingDisabled?(0,f.a)(c):`${(0,f.a)(g.definedInName)}_${c}`,e=g.type;if(4===e){for(let c in d)if(Object.prototype.hasOwnProperty.call(d,c)){let e=d[c];if(null!=e&&""!==e){let d;if("object"==typeof e)try{d=JSON.stringify(e)}catch(a){d=e}else d=e;b[`${a}_${c.replace(/\./g,"_")}`]=d}}}else b[a]=6===e?g.typeRef[d]:d}}}return{name:a.isEventTypePrefixingDisabled?c[c.length-2]:`ev_${c[c.length-2]}`,values:b}}(b),j=new a.EventProperties;return j.name=h,e.a.isActivated("2657d5a5-7313-42a0-ab20-287781f44d1b")||(g=i.Name,"AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"!==g&&"SPO.DashboardWebPart.Load"!==g&&"AdaptiveCardExtension.CardAction"!==g&&"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"!==g&&"TeamsSiteHeader.RefreshButtonClicked"!==g&&"TeamsSiteHeader.CopyLinkButtonClicked.successful"!==g&&"TeamsSiteHeader.GoToBrowserButtonClicked"!==g)||(j.eventType="VivaAnalytics"),function(a,b,c,d){let e;try{for(let a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e=a,b.setProperty(a,c[a]))}catch(f){let b,c;throw f instanceof a.Exception&&(b=f.ErrorCode(),c=Error(`Aria error: ${f.toString()}`)),c&&(f.handled=!0,d&&d.logError(c,{errorCode:b,propertyKey:e})),f}}(a,j,i,c),j}(a,k,i);j.a&&h?.storeEventIfNecessary(c)||b.logEvent(c)}}catch(c){let b;c instanceof a.Exception&&(b=Error(`Aria error: ${c.toString()}`)),c&&c.handled||i.log(b||c)}}})(c,b,a.logStartEvents,a.ariaQos,this._offlineEventQueue))),this._onLogEvent=a.onLogEvent}}function l(a){let b;return()=>(b||(b=a()),b)}}
,function(a,b,c){c.d(b,{a:function(){return i}});var d=c(367),e=c(0);function f(a){if(e.a.isActivated("BABB93B6-A527-424E-BE9D-FDAA87163C4A"))return!1;switch(a){case d.a.SPOPassword:return!e.a.isActivated("4D2C42D9-AD8D-4CDD-BBDE-1A59004B0D5F");case d.a.KnownString:return!e.a.isActivated("5881AB4E-62A3-466A-9121-4696A4C7FFAB");case d.a.QueryParam:return!e.a.isActivated("74E05F7C-7187-4B3C-9B48-13C1742D5BB7");case d.a.JWTOld:return e.a.isActivated("EBFAA43D-4287-4B42-B15E-915E6C993511");case d.a.JWT:return!e.a.isActivated("865C15CD-213C-4A6A-A51D-67398DCE0975");case d.a.SitePath:return!e.a.isActivated("ABCC634A-D509-4E2F-8DBD-72D6DDB70304");case d.a.URL:return!e.a.isActivated("538060DB-E344-47C6-B004-746651420C50");case d.a.URLOld:return e.a.isActivated("20E10301-7F7C-4806-8943-1C9E19D7EAB2");case d.a.Soap:return!e.a.isActivated("0EDD0E35-2E79-453E-9674-E3EAAB9CB032");case d.a.Email:return!e.a.isActivated("436FE24B-4602-4C6C-830B-CFF37FF73F30");case d.a.EmailOld:return e.a.isActivated("89E1A753-A099-48A0-B909-E830C31F9745");default:return!0}}function g(a){switch(a){case d.a.SitePath:return!e.a.isActivated("E51A83DC-7071-44F9-B5B7-96C4604CAE9F");case d.a.URL:return!e.a.isActivated("5C465AAE-218B-439A-894C-8F10019A3B0D");case d.a.Email:return!e.a.isActivated("0B689E10-1669-4662-A229-A7A6CDDC97A7");default:return!1}}function h(a){return"function"!=typeof a}function i(){let a;if(e.a.isActivated("D1A947A7-FF47-4643-936F-AA49C462EA70"))return{disable:!0};let b={warn:[],sanitize:[d.a.SPOPassword,d.a.KnownString,d.a.QueryParam,d.a.SitePath,d.a.URL,d.a.JWT,d.a.Email],parseJsonStrings:!0},c=b.sanitize?.filter(a=>h(a)&&f(a)&&!g(a))||[],i=b.sanitize?.filter(a=>h(a)&&f(a)&&g(a))||[];return{...b,sanitize:c,warn:i,shouldScanExtensionFields:e.a.isActivated("9BDABF72-C748-41CA-8A43-1EE2CD6C4D26"),parseJsonStrings:!e.a.isActivated("AD54604C-78BF-4068-B45C-67C6B7D59373"),parseArrayStrings:!e.a.isActivated("A7DBBB71-8A21-44E1-9888-ECFE5D5BC304"),excludedPaths:Object.keys(a={"UserInfo.Id":"32622FEC-0A09-4437-9304-7F37A3B8C3C7","#":"75E7DF52-7261-44FC-A849-3C4E4E1355EF"}).filter(b=>!e.a.isActivated(a[b])),skipObjectKeys:e.a.isActivated("F15D4019-401C-4065-9B1D-E7AFF16ABEAD"),isOptimzeSanitizeKSActive:e.a.isActivated("E120FBF9-6179-4A1B-B922-0A4E2660A429"),scannerOptions:{[d.a.URL]:{trustedDomains:e.a.isActivated("F5BB0FC8-289D-4965-8353-A6EB2135BB4E")?void 0:["res-2.df.onecdn.static.microsoft","res-1.cdn.office.net","r4.res.office365.com","js.monitor.azure.com","ajax.aspnetcdn.com"]}},isExternalScannerSupportKSActive:e.a.isActivated("05BD759F-D561-4F40-B83E-AD4C02F9CD12")}}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={SPOPassword:"SPOPassword",SitePath:"SitePath",URL:"URL",URLOld:"URLOld",Soap:"Soap",KnownString:"KnownString",QueryParam:"QueryParam",JWT:"JWT",JWTOld:"JWTOld",JWTInDepth:"JWTInDepth",Email:"Email",EmailOld:"EmailOld",CustomString:"CustomString"}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(31);function e(a=new d.a){return{BrowserIsMobile:a.isMobile,BrowserIsPWA:a.isPWA,BrowserMajVer:a.browserMajor,BrowserMinVer:a.browserMinor,BrowserName:a.browserName,BrowserUserAgent:a.userAgent,OSName:a.osName,OSVersion:a.osVersion}}}
,,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(175);function e(a,b,c){let e="",f=!0;for(let g in b&&(a={...b,...a}),a){let b=a[g];if(!c||"object"!=typeof b&&b||"object"==typeof b&&b&&b.uriValue||"number"==typeof b||"boolean"==typeof b){let a;f?f=!1:e+="&",a="object"==typeof b&&b&&b.uriValue?b.uriValue:(0,d.b)(`${b}`),e+=`${g}=${a}`}}return e}}
,,,,,function(a,b,c){c.d(b,{a:function(){return f}});let d=c(215).a.env;function e(){switch(d&&d.toLowerCase()){case"soak3":return 4;case"soak2":return 3;case"dev":return 2;case"df":return 1;default:return 0}}function f(a="v1.0"){let b=function(){switch(e()){case 3:return"soak2.test.";case 4:return"soak3.test.";case 2:return"newapi.dev.";default:return""}}(),c=2===e()?"storage.live-int.com":"api.onedrive.com";return`https://${b}${c}/${a}`}}
,,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(42);class e extends Error{constructor(a={}){let b,c;const{message:e,innerError:f}=a;e&&("string"==typeof e?b=e:(b=(0,d.a)(e))&&(c=e)),!b&&f&&(b=f.message,f.loggableMessage&&(c=f.loggableMessage)),super(b),this.innerError=f,this.loggableMessage=c||(0,d.c)(this.message,!1);const g=Object.getPrototypeOf(this).constructor;Error.captureStackTrace&&Error.captureStackTrace(this,g)}}}
,,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(42);function e(a){try{if(!a)return;if("string"==typeof a)return(0,d.c)(a,!1);if((0,d.b)(a))return a;if(a.message){if(a.loggableMessage)return a.loggableMessage;return(0,d.c)(a.message,!1)}if(a.name)return(0,d.c)(a.name,!0);if(a.description)return(0,d.c)(a.description,!1)}catch{}}}
,,,,,function(a,b,c){c.d(b,{a:function(){return d}});let d=new(c(5)).a("navigation")}
,,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(215);let e=d.a?.mpcDomain||"https://my.microsoftpersonalcontent.com";function f(a="v2.0"){return`${e}/_api/${a}`}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});var d=c(0);let e=!d.a.isActivated("07410C5C-2872-473F-B7CE-7827E0BF1F57"),f=!d.a.isActivated("3084B236-EDC2-4FEE-A833-8E1D9084B005");d.a.isActivated("F6E111F0-6D77-4CBD-885A-F252116BF795")}
,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(30),e=c(11),f=c(230);let g=(0,d.a)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:e.a.String},privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}},f.a).withData({privacyClassification:e.b.requiredService})}
,,,function(a,b,c){c.r(b),c.d(b,{GraftOperationType:function(){return d},backup:function(){return g},default:function(){return function a(b,c){if(!i(b))throw Error("Value for 'base' passed to 'graft' is not an object.");if(!i(c))throw Error("Value for 'extension' passed to 'graft' is not an object");if(c===b)return b;for(let e of Object.keys(c)){let f,g=c[e],h=b[e];if(g===h)continue;let k=g;if(i(k)&&k.graftOperationType)if(k.graftOperationType===d.replace){let{value:a}=k;h=void 0,g=a}else if(k.graftOperationType===d.backup){let{value:a}=k;if(void 0!==b[e])continue;g=a}else if(k.graftOperationType===d.optional){let{value:a}=k;if(void 0===a)continue;g=a}else if(k.graftOperationType===d.remove){delete b[e];continue}else throw Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.");if(g instanceof Date)f=new Date(g.getTime());else if(j(g)){let a=h;j(a)||(a=[]),a.splice(0,a.length,...g),f=a}else if(i(g)){let b=h;i(b)||(b={}),a(b,g),f=b}else f=g;b[e]=f}return b}},optional:function(){return f},remove:function(){return e},replace:function(){return h}});let d={none:0,replace:1,optional:2,remove:3,backup:4};function e(){return{graftOperationType:d.remove}}function f(a){return{graftOperationType:d.optional,value:a}}function g(a){return{graftOperationType:d.backup,value:a}}function h(a){return{graftOperationType:d.replace,value:a}}function i(a){return"object"==typeof a&&!!a}function j(a){return Array.isArray(a)}}
,,,,function(a,b,c){let d,e,f;c.d(b,{a:function(){return B},b:function(){return x},c:function(){return z},d:function(){return A}}),c(235),c(236),c(237);var g=c(0),h=c(3);class i extends h.a{send(){super.end()}constructor({chunkId:a,error:b}){super({name:"chunkLoadError",resultType:h.b.Failure,resultCode:a,error:b})}}g.a.isActivated("36B91871-323F-47AE-856A-593D771BB6C5")&&!g.a.isActivated("6FA6188C-D5C4-4714-93E0-90339B6F2F07")&&window.addEventListener("unhandledrejection",function(a){a.reason?.name==="ChunkLoadError"&&new i({chunkId:a.reason.chunkId,error:a.reason.message}).send()});var j=c(55),k=c(363),l=c(557),m=c(164),n=c(364),o=c(126),p=c(19);let q=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi,r=["guestaccesstoken","access_token","prooftoken","tempauth","share","auth_token","auth_key","originalPath","querytext","querytemplate","selectproperties","hithighlightedproperties","refiners","sortlist","refinementfilters","collapsespecification","hiddenconstraints","querytemplatepropertiesurl","zerotermsuggestions","pageinfo","immediacyquerystring","immediacytitle","immediacyurl","k","q","InplaceSearchQuery","Default"],s=["/_api/search/","/_api/searchsetting/","/results.aspx","/osssearchresults.aspx","/peopleresults.aspx","/conversationresults.aspx","/videoresults.aspx","/sharepoint.aspx","/search.aspx","RenderListDataAsStream"];var t=c(34),u=c(40);let v=g.a.isActivated("C3E59A6A-1D1B-479E-A536-AD846D2EBE39","5/18/2023","Use accountType from options, if available, or a better default logic"),w=g.a.isActivated("B0493589-74F3-4204-AFC6-2B77AA14095B");function x(a={}){let b,c,{pageContext:d=window._spPageContextInfo||{},spModuleLink:e=window._spModuleLink}=a,f=d.env||"devbox",h=d.cloudType||f,i=d.env2,j="",k="",l=!1,m=h;switch(m.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":b="ppe";break;default:m="prod",b="prod"}return"onebox"!==i||g.a.isActivated("C7635348-9E0C-4AD6-A922-EECF98EB3CB6")||(b="ppe"),e&&(j=e.buildNumber,k=e.manifestName,e.usingRedirectCookie?j="dev":(c=e.targetBuildNumber,l=e.isBuildAsExperimentRunning)),{version:j,manifest:k,appEnvironment:m,ariaEnvironment:b,isBuildAsExperimentRunning:l,buildAsExperimentTargetVersion:c}}function y(a){return a&&a.length>36&&(a=a.replace(/[{}]/g,"")),a}function z(a){let b=()=>{},c=function(a){let b,c;if(d)return d;let{pageContext:e=window._spPageContextInfo||{}}=a,{version:f,manifest:h,appEnvironment:i}=x(a),{isAnonymousGuestUser:j,currentUICultureName:k,systemUserKey:l,userLoginName:m,siteSubscriptionId:n,farmLabel:o,farmName:p,siteId:q,webTemplate:r,webId:s,ariaCollectorUrl:z,oneDsCollectorUrl:A,CorrelationId:B,cloudType:C,getAuthToken:D,tokenProvider:E,homeTenantId:F,aadTenantId:G,listId:H,SideBySideToken:I,env2:J}=e;b=v?m?u.a.Business:u.a.BusinessAnonymous:void 0!==a.accountType?a.accountType:j?u.a.BusinessAnonymous:u.a.Business;let K=g.a.isActivated("2B916BE9-50BE-4939-BFE2-C8740954C1F8")||"undefined"==typeof localStorage?void 0:localStorage?.getItem("nucleus.offlineModeStatus");return w?D&&(c=async()=>D()):E?.getAuthToken&&(c=async()=>{let a=await E.getAuthToken({url:window.location.href,disallowCookies:!0,apiQosName:"AriaUtils.getAriaContext"});return"object"==typeof a?a.authToken:a}),d={isAuthenticated:!j,market:k,session:a.sessionId||t.a.generate(),version:f,manifest:h,userId:l,accountType:b,siteSubscriptionId:n,farmLabel:o,farmName:p,collectorUrl:z,oneDsCollectorUrl:A,environment:i,env2:J,workload:a.workload,disableCookies:j,siteId:y(q),webTemplateId:r,webId:y(s),context:a.context,pageCorrelationId:B,cloudType:C,getAuthToken:c,listId:y(H),sideBySideToken:I,product:a.product,homeTenantId:F||G,resourceTenantId:G,offlineModeStatus:K}}(a);if(!c)return;let h=function(a){let{ariaEnvironment:b="ppe"}=x(a);return b&&a.tokens[b]}(a);if(a.initOneDS||(0,n.b)()){let d=`spo-core-${a.sourceName}`;e=new m.a({sourceName:d,tenantToken:h,context:c,offlineDetection:a.offlineDetection}),a.initCustomerPromise&&(f=new m.a({sourceName:d,tenantToken:h,context:c,offlineDetection:a.offlineDetection}));let g=e.attach(a.customManager??j.a),i=()=>{};a.initCustomerPromise&&(i=f.attach((0,o.a)())),b=()=>{g(),i()}}else e=void 0,n.a.Init(h,c,a.ariaLoader,a.offlineDetection,a.customManager),a.initCustomerPromise&&(f=void 0,n.a.InitCustomerPromise(h,c,a.ariaLoader,a.offlineDetection));return{dispose:()=>{b?.()}}}function A(a,b){if(!d)return;let c=d?d={...d,...b}:null;c={...c,context:{...d.context,...a}},e?(e.updateContext(c),f?.updateContext(c)):n.a.UpdateContext(c)}function B(){if(d)if(e)return f?.flush(),e.flush();else return n.a.flushTelemetry()}(0,l.a)(),j.a.cleanString=function(a,b,c){return function(a,b={}){let c,{keyDeclaration:d,pathsToSanitize:e=[],keysToSanitize:f=[]}=b;if(d&&d.isKey&&(a=a.replace(q,"<guid>")),0>a.indexOf("http"))return a;try{c=new p.a(a)}catch(b){return a}if(""===c.getAuthority())return a;let g=!1;for(let a=0;a<e.length;a++)if(c.getPath().indexOf(e[a])>=0){g=!0;break}if(g)a=`${c.getScheme()}://${c.getAuthority()}${c.getPath()}<scrubbedquerystring>...`;else{let b=c.getQueryAsObject();for(let a=0;a<f.length;a++){let c=f[a];b[c]&&(b[c]="<scrubbed>")}c.setQueryFromObject(b),a=c.getDecodedStringForDisplay()}return a}(a,{key:b,keyDeclaration:c,keysToSanitize:r,pathsToSanitize:s})},k.a.init()}
,,,,function(a,b,c){c.d(b,{a:function(){return j}});let d=!!(window?.Flight&&("dev"===window.Flight.version||window.Flight.devMode)),e=window?.document?.cookie.indexOf("srr")!==-1,f=window&&window.location?.origin==="https://www.onedrive-tst.com"&&window.document?.cookie.indexOf("devhost")!==-1,g=e||d||f;function h(){return"/files/fabric-cdn-prod_20251010.003"}function i(){return`https://res-1.cdn.office.net${h()}`}let j=function(a){let b=g?i():"";if(!b){let a=window.require?.toUrl?.("");b=a?`${function(a){let b=a.indexOf("//"),c=a.indexOf("/"),d=b>-1&&b<=c?b+2:-1;if(!(d>-1))return"";{let b=a.indexOf("/",d);return b>-1?a.slice(0,b):a}}(a)}${h()}`:i()}return`${b}`}(0)}
,,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(15),e=c(395),f=c(384);function g(a){return function(a){let b=new d.a(a);if(!b.authority)return!1;let c=(0,f.a)();return new d.a(c).authority===b.authority}(a)||function(a){let b=new d.a(a);if(!b.authority)return!1;let c=(0,e.a)();return new d.a(c).authority===b.authority}(a)}}
,function(a,b,c){c.d(b,{a:function(){return v}});var d=c(72),e=c(99);class f{static init(){this._initialized||(this._initialized=!0,this._originalBeforeUnload=window.onbeforeunload,window.onbeforeunload=window.__onbeforeunload=a=>this._handleBeforeUnload(a))}static registerHandler(a){this._handlers.push(a)}static unRegisterHandler(a){for(let b=0;b<this._handlers.length;b++)if(this._handlers[b]===a){this._handlers.splice(b,1);break}}static registerOnContinueHandler(a){this._onContinueHandler=a}static unRegisterOnContinueHandler(a){this._onContinueHandler=null}static dispose(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null}static _handleBeforeUnload(a){let b;if(!this._allowNavs){for(let a=0;a<this._handlers.length;a++)try{if(b=this._handlers[a](!0))break}catch(a){d.a.log(a)}if(!b&&this._originalBeforeUnload)try{b=this._originalBeforeUnload(a)}catch(a){d.a.log(a)}}return b||void 0}registerAsyncHashNavHandler(a){this._asyncHashNavHandlers.push(a)}unregisterAsyncHashNavHandler(a){let b=this._asyncHashNavHandlers.indexOf(a);-1!==b&&this._asyncHashNavHandlers.splice(b,1)}registerHashNavDialogCallback(a){this._hashNavDialogCallback=a}registerHashNavDialogHandler(a){if(this._hashNavDialogHandler)throw Error("Registering HashNavDialogHandler when one is already set");this._hashNavDialogHandler=a}unregisterHashNavDialogHandler(){this._hashNavDialogHandler=void 0}isHashNavDialogHandlerRegistered(){return!!this._hashNavDialogHandler}async allowHashNavAsync(a,b){if(0===this._asyncHashNavHandlers.length)return a(),!0;try{for(let a of this._asyncHashNavHandlers)if(!await a())return b?.(),!1;return a(),!0}catch(a){return b?.(),!1}}allowHashNav(a,b){let c;if(!f._isDialogOpen&&!f._allowNavs){for(let a=0;a<f._handlers.length;a++)try{if(c=f._handlers[a](!1))break}catch(a){d.a.log(a)}c&&(f._isDialogOpen=!0,this._hashNavDialogCallback(c).then(()=>{f._isDialogOpen=!1,f._allowNavs=!0,f._blockNavsAgainId||(f._blockNavsAgainId=f._async.setImmediate(()=>{f._allowNavs=!1,f._blockNavsAgainId=null})),a&&a()},()=>{f._isDialogOpen=!1,b&&b()}))}return!c&&!f._isDialogOpen}blockHashNav(a,b){let c=null;if(this._dialogWasJustDismissed)return this._dialogWasJustDismissed=!1,!1;for(let a=0;a<f._handlers.length;a++)try{if(c=f._handlers[a](!1))break}catch(a){d.a.log(a)}return!!c&&!!this._hashNavDialogHandler&&(this._hashNavDialogHandler(c,()=>{f._onContinueHandler?f._onContinueHandler().then(()=>{this._dialogWasJustDismissed=!0,a()}).catch(()=>{}):(this._dialogWasJustDismissed=!0,a())},b),!0)}registerHandler(a){this._localHandlers.push(a),f.registerHandler(a)}unRegisterHandler(a){for(let b=0;b<this._localHandlers.length;b++)if(this._localHandlers[b]===a){this._localHandlers.splice(b,1);break}f.unRegisterHandler(a)}registerOnContinueHandler(a){f.registerOnContinueHandler(a)}unRegisterOnContinueHandler(a){f.unRegisterOnContinueHandler(a)}hasActiveBlock(){return 0!==this._localHandlers.length}dispose(){for(let a of this._localHandlers)f.unRegisterHandler(a)}constructor(){this._localHandlers=[],this._asyncHashNavHandlers=[]}}f._handlers=[],f._async=new e.a,f._initialized=!1,f.init();var g=c(31),h=c(59),i=c(171),j=c(0),k=c(56),l=c(379);function m(a){return"string"==typeof a?a:(0,l.a)(a)}let n=window.history,o=window.applicationCache,p=new g.a,q=!j.a.isActivated("DE394832-0B5E-447E-B070-CFB40B970AFE"),r=j.a.isActivated("a6d295af-8283-417b-85ed-1090c39b73cf"),s=j.a.isActivated("74b52c7a-41cb-4a56-a4d3-836e5320e6fd"),t=!j.a.isActivated("E2B6560C-7D5A-4493-ABF2-F2DE0CA09EEE"),u=!j.a.isActivated("49B2EAF5-4526-4E43-A44D-AE26B0BBE483");var v=class{get _history(){return this._overrideHistory?this._overrideHistory:history}dispose(){this.setNavEventListeners("off"),this.scope.dispose()}get viewParams(){return this._viewParams}navigateTo(a){s?this._doNavigate(a):(async()=>{await this.beforeUnload.allowHashNavAsync(()=>this._doNavigate(a))})().catch(()=>{})}updateViewParams(a,b={}){let c="string"==typeof a?(0,k.a)(a):a,d={...b.clearOtherParams?{}:this._viewParams,...c};!r&&b.paramsToDelete&&b.paramsToDelete.forEach(a=>{delete d[a]}),b.ignoreHistory?this._replaceState(d,b.clearPath,void 0,b.UNSAFE_suppressChangeEvent):this._pushState(d,void 0,b.UNSAFE_suppressChangeEvent)}updateViewParamsWithoutHistoryChange(a,b){this._updateUrlState({type:"popstate",state:{viewParams:a,useViewParamsFromState:!0}},b)}getUrlFromViewParams(a){let b=m(a),c=this._getStateUrl(a,b);return`${window.location.origin}${c}`}reload(){window.location.reload()}setNavEventListeners(a){let b=("on"===a?this._events.on:this._events.off).bind(this._events);b(window,"hashchange",this._updateUrlState),b(window,"popstate",this._updateUrlState)}_updateUrlState(a,b){let c=!1;if(q?!this.beforeUnload.blockHashNav(()=>this._updateUrlState(a,b),()=>this._resetBeforeNavBlock()):this._dontBlockNextNav||this.beforeUnload.allowHashNav(()=>this._updateUrlState(a,b),()=>this._resetBeforeNavBlock())){this._dontBlockNextNav=!1;let{viewParams:d,usingHashParams:e,viewParamsString:f}=function(a){let{event:b,prettyPathMap:c,paramsPreference:d}=a||{},e=!1,f="";(!d||"hash"===d)&&location?.href?.indexOf("#")>-1?(f=location.hash.substr(1),e=!0):(!d||"search"===d)&&location?.search?.length&&(f=location.search.substr(1));let g=(0,k.a)(f);c&&({viewParams:g,viewParamsString:f}=c.getEffectiveViewParamState({currentPathname:location?.pathname||"",actualViewParams:g,actualViewParamsString:f}));let h=function(a){let b="";if(a&&"popstate"===a.type&&a.state){let{useViewParamsFromState:c,viewParams:d}=a.state;c&&d&&(b=m(d))}return b}(b),i=(0,k.a)(h),j=i,l=h;for(let a in g)if(i[a]!==g[a]){j=g,l=f;break}return{viewParams:j,viewParamsString:l,usingHashParams:e}}({event:a,prettyPathMap:this._prettyPathMap,...u?{paramsPreference:this._paramsPreference}:{}});f!==this._viewParamsString&&(this._viewParamsString=f||"",this._viewParams=d,c=!0),a&&this._shouldReloadOnNavigate&&this._shouldReloadOnNavigate()&&window.location.reload(),e&&this._performHashConversion&&this._supportsHistoryApi&&this._replaceState(f,void 0,void 0,b),c&&!b&&this._events.raise("change"),this._prevHash=t?window.location.hash:window.document.location.hash}else c=!1,a&&a.preventDefault();return c}_resetBeforeNavBlock(){if(this._dontBlockNextNav=!0,this._supportsHistoryApi)try{history.forward()}catch(a){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)}_pushState(a,b,c){let d=m(a);if(this._supportsHistoryApi)try{let b=this._getStateUrl(a,d,void 0);this._history.pushState({},"",b)}catch(a){this._hashNav(d)}else this._hashNav(d);this._updateUrlState(void 0,c),b&&this._setMaskUrl(b)}_replaceState(a,b,c,d){let e=m(a);if(this._supportsHistoryApi)try{let c=this._getStateUrl(a,e,b);this._history.replaceState({},"",c)}catch(a){this._supportsHistoryApi=!1,this._hashNav(e)}else this._hashNav(e);this._updateUrlState(void 0,d),c&&this._setMaskUrl(c)}_setMaskUrl(a){if(a&&this._supportsHistoryApi){let b={useViewParamsFromState:!0,viewParams:this._viewParams};this._history.replaceState(b,"",a)}}_getStateUrl(a,b,c){let d=t?window.location.pathname:document.location.pathname;return this._prettyPathMap?this._prettyPathMap.getUpdatedUrl({currentPathname:d,viewParams:a,viewParamsString:b,clearPath:c}):function(a){let{pathname:b,viewParamsString:c,clearPath:d}=a;return`${d?"/":b}${c.length>0?"?":""}${c}`}({pathname:d,viewParamsString:b,clearPath:c})}_hashNav(a){t?window.location.hash=a:document.location.hash=a}_doNavigate(a){if(q||this.beforeUnload.allowHashNav(()=>this.navigateTo(a))){let b,c,d="string"==typeof a?{url:a}:a,e=d.url,f=a.hasOwnProperty("viewParams")?a.viewParams:void 0,g=a.hasOwnProperty("directOpen")?a.directOpen:void 0;if(f&&"#"===f[0]?(b=f.substr(1),c=e):(b="#"===e[0]?e.substr(1):void 0,c=void 0),void 0===d.frameId&&p.isPWA&&"#"!==e&&(d.frameId="_blank"),void 0!==b)d.ignoreHistory??this._history?.ignore?this._replaceState(b,!1,c,d.UNSAFE_suppressChangeEvent):this._pushState(b,c,d.UNSAFE_suppressChangeEvent);else{let a,b=!1;if(d&&d.frameId&&"_self"!==d.frameId)try{(a=window.open(g?e:"",d.frameId))&&"_blank"===d.frameId&&(a.opener=null),a&&!g&&(this._disableNavigationEventListeners&&"#"===e?this.updateViewParams("",{ignoreHistory:d.ignoreHistory,clearOtherParams:!0,UNSAFE_suppressChangeEvent:d.UNSAFE_suppressChangeEvent}):a.location.href=e),b=!0}catch(a){}if(!a&&!b)try{d.ignoreHistory??this._history?.ignore?window.location.replace(e):window.location.href=e}catch(a){}}}}constructor(a={}){this._viewParamsString="",this._dontBlockNextNav=!1;const{disableHashConversion:b=!1,disableNavigationEventListeners:c=!1,shouldReloadOnNavigate:d,history:e,prettyPathMap:g}=a;this._overrideHistory=e,this._shouldReloadOnNavigate=d,this._performHashConversion=!b,this._disableNavigationEventListeners=a.disableNavigationEventListeners,this._viewParams={},this._prettyPathMap=g,this._paramsPreference=a.paramsPreference,this.scope=new i.a,this._prevHash=window.location.hash,this._supportsHistoryApi=n&&!!n.pushState&&(!o||o.status===o.UNCACHED),this.beforeUnload=new f,this.scope.attach(this.beforeUnload),this._events=this.scope.attach(new h.a(this)),this._events.declare("change"),c||this.setNavEventListeners("on"),this._updateUrlState()}}}
,,,,,function(a,b,c){}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={ppe:"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",prod:"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157"}}
,,,function(a,b,c){b.a=c(69).a("fluenthybridfont/odsp-next-icons-11c89b6d.woff")}
,function(a,b,c){b.a=c(69).a("fluenthybridfont/patch/odsp-patch-icons-33e61432.woff")}
,function(a,b,c){b.a=c(69).a("fluenthybridfont/app-icons-98056e21.woff")}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(172);async function e(a){let b=await Promise.all(a.map(a=>a.then(a=>({result:a}),a=>({error:a})))),c=[],e=[],f=!0;for(let a of b)"error"in a?((0,d.c)(a.error)||(f=!1),e.push(a.error)):(c.push(a.result),f=!1);if(e.length>0)if(f)throw new d.a;else throw e[0];return c}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,b){return class extends a{constructor(a){super(a,b)}}}}
,function(a,b){var c,d;(d=c||(c={}))[d.none=0]="none",d[d.viewChange=1]="viewChange",d[d.inPageNavigation=2]="inPageNavigation",d[d.pageToPageNavigation=3]="pageToPageNavigation",d[d.fullPageLoad=4]="fullPageLoad",d[d.onePageAppNavigation=5]="onePageAppNavigation",b.a=c}
,function(a,b,c){let d;c.d(b,{a:function(){return h},b:function(){return i}});var e=c(15),f=c(42);let g="cdn.office.net";function h(){if(!d){d=[g];let a=c.p||"undefined"!=typeof window&&window.require?.toUrl("");a&&0>a.indexOf(g)&&new e.a(a).authority&&d.push(new e.a(a).authority)}return d}function i(a){try{let b=a.stack??("string"==typeof a?a:void 0);if(!b)return;let c=[],d=!1,e=b.split("\n"),g=h();for(let a=1;a<e.length;a++){let b=e[a],f=!1;for(let a of g)if(b.includes(a)){f=!0;break}f?(d=!0,c.push(b)):c.push("<scrubbed-stack-line>")}if(!d)return(0,f.c)("<scrubbed-stack>");return(0,f.c)(c.join("\n"))}catch{return}}}
,function(a,b,c){let d;c.d(b,{a:function(){return t}});var e=c(81),f=c(0),g=c(6),h=c(3);class i{gatherNetworkNotificationAccuracyTelemetry(a,b){let c=new h.a({name:"offlineDetection.networkNotificationAccuracy"});this._logger?.log(`ID: ${this._transitionId}, Event: ${a}, Current: ${this._logger.offlineToString(!b)}, New: ${this._logger.offlineToString(b)}`),fetch(this._telemetryUrl,{cache:"no-store"}).then(d=>{let e;e=this._statusAndTypeCheckKS||0!==d.status||"error"!==d.type?!b:b,this._reportReliability(a,b,e,c)}).catch(()=>this._reportReliability(a,b,b,c))}sendNetworkTransitionTelemetry(a,b,c){new h.a({name:"offlineDetection.networkTransition"}).end({extraData:{eventName:a,transitionToOffline:b},resultType:h.b.Success}),c&&this.gatherNetworkNotificationAccuracyTelemetry(a,b)}_reportReliability(a,b,c,d){this._logger?.log(`ID: ${this._transitionId}, Event: ${a}, Reliability: ${c?"success":"failure"}`),this._transitionId<1e3?this._transitionId++:this._transitionId=0,d.end({extraData:{eventName:a,offline:b},resultType:c?h.b.Success:h.b.Failure})}constructor(a){this._telemetryEndpoint="/_layouts/15/images/BLANK.gif",this._statusAndTypeCheckKS=f.a.isActivated("828f5168-1dc2-4aa0-8e72-51441433d0b6","7/24/2024"),this._transitionId=0,this._telemetryUrl=window.location.origin+this._telemetryEndpoint,this._logger=a}}class j{log(a){this._logFn&&this._logFn(a)}offlineToString(a){return void 0===a?"undefined":a?"offline":"online"}constructor(){this._nucleusLogToConsoleFlag="sharepoint.datasync.nucleus.logToConsole";try{const a=window.localStorage?.getItem(this._nucleusLogToConsoleFlag);a&&"TRUE"===a.toUpperCase()&&(this._logFn=a=>{let b=new Date().toISOString(),c=`[offline detector][${b}] ${a}`;console.log(c)})}catch{}}}let k="nucleusoffline",l="nucleusonline";class m{onChange(a){return this._ensureInitialized(),this._listeners.push(a),()=>{let b=this._listeners.indexOf(a);-1!==b&&this._listeners.splice(b,1)}}dispose(){this._logger?.log("Offline detector disposing"),this._events&&this._events.dispose()}get offline(){return this._useNucleusNetworkNotifications()?void 0!==this._offline?this._offline:this._swOffline():this._browserOffline||this._swOffline()&&!this._ignoreSWOffline}_createNucleusDebouncer(){return new n(m.NucleusDebounceDelay)}_createBrowserDebouncer(){return new n(!this._longBrowserDebounceDelayKS?m.BrowserDebounceDelay2:!this._differentDebounceDelayForBrowserKS?m.BrowserDebounceDelay:m.NucleusDebounceDelay)}_ensureInitialized(){!this._initialized&&(this._logger&&this._logger.log(`Offline detector initializing. Initial state: ${this._logger.offlineToString(this.offline)}`),this._initialized=!0,this._listeners=[],this._events=new e.a(window),this._events.on(window,"online",this._browserDebouncer.debounce(this._onStateChange.bind(this,!1,"online"),!1)),this._events.on(window,"offline",this._browserDebouncer.debounce(this._onStateChange.bind(this,!0,"offline"),!0)),this._events.on(window,"swonline",this._onStateChange.bind(this,!1,"swonline")),this._events.on(window,"swoffline",this._onStateChange.bind(this,!0,"swoffline")),this._useNucleusNetworkNotifications()&&(this._events.on(window,l,this._nucleusDebouncer.debounce(this._onStateChange.bind(this,!1,l),!1)),this._events.on(window,k,this._nucleusDebouncer.debounce(this._onStateChange.bind(this,!0,k),!0))))}_onStateChange(a,b){if(this._useNucleusNetworkNotifications())if(this._offline!==a)this._reliabilityTelemetryLoggingKS&&this._logger&&this._logger.log(`Event: ${b}, Current: ${this._logger.offlineToString(this._offline)}, New: ${this._logger.offlineToString(a)}`),this._telemetry?.sendNetworkTransitionTelemetry(b,a,!0),this._offline=a;else{this._logger&&this._logger.log(`Event: ${b}, offline state unchanged: ${this._logger.offlineToString(this._offline)}`);return}else{let c=this.offline;this._swOffline()&&"online"===b&&(this._ignoreSWOffline=!0),"online"===b?this._browserOffline=!1:"offline"===b&&(this._browserOffline=!0),this._telemetry&&c!==this.offline&&this._telemetry.sendNetworkTransitionTelemetry(b,a,!0)}let c=this.offline;this._listeners&&this._listeners.forEach(a=>{try{a(c)}catch(a){}})}_swOffline(){return!!window.__swstats&&void 0!==window.__swstats.offline&&window.__swstats.offline}_useNucleusNetworkNotifications(){return g.a.isFeatureEnabled({ODB:1235})}constructor(a){this._reliabilityTelemetryLoggingKS=f.a.isActivated("113f8f8f-700a-4c7c-9de7-9da1d7941868","8/13/2024"),this._enableDiagnosticsParamKS=f.a.isActivated("9d87a3bf-4d22-4fbf-a877-d131429d0d91","8/15/2024"),this._differentDebounceDelayForBrowserKS=f.a.isActivated("987bf2d5-399e-47fd-b101-eab6ed615ab0","8/28/2024"),this._longBrowserDebounceDelayKS=f.a.isActivated("93bfb463-5396-4022-ba60-81d11fad3ecf","9/10/2024"),this._initialized=!1,this._ignoreSWOffline=!1,this._offline=void 0,this._browserOffline=!1,(this._enableDiagnosticsParamKS||a)&&(this._logger=new j,this._telemetry=new i(!this._reliabilityTelemetryLoggingKS?this._logger:void 0)),this._nucleusDebouncer=this._createNucleusDebouncer(),this._browserDebouncer=this._createBrowserDebouncer()}}m.NucleusDebounceDelay=5e3,m.BrowserDebounceDelay=7e3,m.BrowserDebounceDelay2=15e3;class n{debounce(a,b){return 0===this._millisecondDelay?a:()=>{b!==this._lastOfflineNotification&&(clearTimeout(this._timer),this._lastOfflineNotification=b,this._timer=setTimeout(()=>{this._lastOfflineNotification=void 0,a()},this._millisecondDelay))}}constructor(a){this._millisecondDelay=a}}class o{startDebouncing(a){return new Promise(b=>{this._resolveDebouncePromise=b,this._resetDebounce(a)})}debounceNewNotification(a){a!==this._lastOfflineNotification&&this._resetDebounce(a)}dispose(){clearTimeout(this._timer),this._lastOfflineNotification=void 0}_resetDebounce(a){clearTimeout(this._timer),this._lastOfflineNotification=a,this._timer=setTimeout(()=>{let a=this._lastOfflineNotification;this._lastOfflineNotification=void 0,this._resolveDebouncePromise(a)},this._millisecondDelay)}constructor(){this._millisecondDelay=5e3}}class p{validateNotificationWithPing(a){return fetch(this._pingUrl,{cache:"no-store"}).then(b=>0===b.status&&"error"===b.type?a:!a).catch(()=>a)}attemptToReconnect(){return new Promise(a=>{this._logger.log("Starting to retry pings to see if we reconnected");let b=0,c=()=>{b<p.retryIntervals.length?(this._logger.log(`Retry attempt ${b} in ${p.retryIntervals[b]}ms`),this._retryTimer=setTimeout(()=>{this._logger.log(`Retry attempt ${b}. Pinging the network`),this.validateNotificationWithPing(!1).then(d=>{this._retryTimer=void 0,d?(this._logger.log(`Retry attempt ${b} successful. We're online`),a(!0)):(this._logger.log(`Retry attempt ${b} failed.`),b++,c())})},p.retryIntervals[b])):(this._logger.log(`Retries failed after ${b} attempts. We're still offline`),this._retryTimer=void 0,a(!1))};c()})}stopTryingToReconnect(){this._retryTimer&&(this._logger.log("Stopping retry pings"),clearTimeout(this._retryTimer),this._retryTimer=void 0)}dispose(){this.stopTryingToReconnect()}constructor(a){this._pingUrl=window.location.origin+p._pingEndpoint,this._logger=a}}p.retryIntervals=[7500,15e3,3e4],p._pingEndpoint="/_layouts/15/images/BLANK.gif";class q{onChange(a){return this._listeners.push(a),()=>{let b=this._listeners.indexOf(a);-1!==b&&this._listeners.splice(b,1)}}dispose(){this._logger.log("Offline detector disposing"),this._listeners=[],this._events.dispose(),this._currentDebouncer&&(this._currentDebouncer.dispose(),this._currentDebouncer=void 0),this._pinger.dispose(),this._pinger=void 0}get offline(){return this._offline}_initializeNotificationListeners(){this._listeners=[],this._events=new e.a(window),this._events.on(window,"swonline",this._onNotification.bind(this,!1,"swonline")),this._events.on(window,"swoffline",this._onNotification.bind(this,!0,"swoffline")),this._events.on(window,"online",this._onNotification.bind(this,!1,"online")),this._events.on(window,"offline",this._onNotification.bind(this,!0,"offline")),this._events.on(window,"nucleusonline",this._onNotification.bind(this,!1,"nucleusonline")),this._events.on(window,"nucleusoffline",this._onNotification.bind(this,!0,"nucleusoffline")),this._pageResumeNotificationKS||this._events.on(window,"resume",this._onPageResume.bind(this),{capture:!0})}_onNotification(a,b){!this._verifySwNotificationsKS||this._notificationRequiresDebounce(b)?this._handleDebouncing(a,b)?.then(a=>{this._offline!==a&&(this._logger.log(`Validating ${b} notification with ping`),this._pinger.validateNotificationWithPing(a).then(c=>{c?(this._logger.log(`Ping matched ${b} notification`),this._handleStateChange(a,b)):this._logger.log(`Ping did not match ${b} notification. Dropping notification`)}))}):this._handleStateChange(a,b)}_notificationRequiresDebounce(a){switch(a){case"swonline":case"swoffline":return!1;default:return!0}}_handleDebouncing(a,b){if(!this._notificationRequiresDebounce(b))return Promise.resolve(a);if(this._currentDebouncer)this._currentDebouncer.debounceNewNotification(a);else if(this._offline!==a)return this._currentDebouncer=new o,this._currentDebouncer.startDebouncing(a).then(a=>(this._currentDebouncer=void 0,a)).catch(()=>(this._currentDebouncer=void 0,!1))}_onStateChange(a,b){this._telemetry.sendNetworkTransitionTelemetry(b,a),this._logger.log(`Event: ${b}, Current: ${this._logger.offlineToString(this._offline)}, New: ${this._logger.offlineToString(a)}`),this._offline=a;let c=this.offline;this._listeners.forEach(a=>{try{a(c)}catch(a){}})}_handleStateChange(a,b){this._offline!==a?(this._onStateChange(a,b),a?this._pinger.attemptToReconnect().then(a=>{a&&this._onStateChange(!1,"pingRetry")}):this._pinger.stopTryingToReconnect()):this._logger.log(`Event: ${b}, offline state unchanged: ${this._logger.offlineToString(this._offline)}`)}_onPageResume(){let a=!this.offline;this._logger.log(`Page resumed. Check if the page is ${this._logger.offlineToString(a)}`),this._pinger.validateNotificationWithPing(a).then(b=>{b?(this._logger.log("Offline state changed while the page was frozen"),this._handleStateChange(a,"resume")):this._logger.log("Offline state did not change while the page was frozen")})}constructor(){this._pageResumeNotificationKS=f.a.isActivated("76aced53-5aed-40a2-9a9d-1d65e0c57d3e","11/11/24"),this._startOfflineRetryKS=f.a.isActivated("3a2c2405-a47a-4015-bb2b-544055311c2c","11/13/24"),this._validateStartStateKS=f.a.isActivated("b0cd0220-0be4-47b2-8b7d-9cac9d1d2321","12/13/24"),this._verifySwNotificationsKS=f.a.isActivated("3a6d44e7-5bf5-4d40-818b-9e206d158087","12/17/24"),this._offline=window.__swstats?.offline??!1,this._logger=new j,this._telemetry=new i(this._logger),this._pinger=new p(this._logger),this._initializeNotificationListeners(),this._logger.log(`Offline detector initialized. Initial state: ${this._logger.offlineToString(this.offline)}`),this._validateStartStateKS&&(this._startOfflineRetryKS||!this._offline)||(this._logger.log(`Validating initial ${this._logger.offlineToString(this._offline)} state with a ping`),this._pinger.validateNotificationWithPing(!this._offline).then(a=>{a?this._handleStateChange(!this._offline,"initialPing"):this._logger.log(`Initial state was correct. We are ${this._logger.offlineToString(this._offline)}`)}))}}let r=g.a.isFeatureEnabled({ODB:62167}),s=f.a.isActivated("fc7b922a-f61d-498c-ae7b-9ad1f1a1e3de");function t(a){return s&&!r?new m(a):(d||(d=r?new q:new m(!0)),d)}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(425);class e{create(a){return{instance:(0,d.a)(this._type,a)}}constructor(a,b){this._type=a,this.dependencies={...a.dependencies||{},...b||{}}}}}
,function(a,b,c){c.d(b,{a:function(){return d}});let d="https://outlook.office365.com"}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return h},c:function(){return i},d:function(){return j},e:function(){return k}});var d=c(432),e=c(433);let f=new WeakMap;class g{apply(){}constructor(){this.isDelete=!0}}class h{constructor(){this.isPatch=!0}}function i(a,b){return(function(a={}){let{freeze:b=!1}=a,c=new Map,i=new Map;function l(a){return c.set(a,!0),a}return function(a){let m=a(function a(m,n){let o=c.get(m)?m:void 0;if(n){if(i.get(n))throw Error("Encountered a circular reference in patch supplied to graft().");for(let p of(i.set(n,!0),Object.keys(n))){let i=m[p],q=n[p];if(!(0,e.a)(q,i)){let n;if(q&&j(q)?n=q:q&&k(q)?n=q.apply(i,{graft:a,unlock:l}):q&&"object"==typeof q&&Object.getPrototypeOf(q)!==Object.prototype?n=q:q&&"object"==typeof q&&i&&"object"==typeof i?n=a(i,q):"object"==typeof q&&q&&function a(b,c){let{ancestors:d}=c;if(d.get(b))throw Error("Encountered circular reference in patch supplied to graft().");let e=f.get(b);if(void 0!==e)return e;d.set(b,!0);let i=!1;for(let d in b)if(Object.prototype.hasOwnProperty.call(b,d)){let e=b[d];if(e&&e instanceof g||e&&e instanceof h||e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&a(e,c)){i=!0;break}}return d.delete(b),f.set(b,i),i}(q,{ancestors:new Map})?(n=a(l({}),q),b&&n&&"object"==typeof n&&!c.get(n)&&(0,d.a)(n)):n=q,!(0,e.a)(n,i)||!(p in m)){if(!o)for(let a of(o=l({}),Object.keys(m)))o[a]=m[a];j(n)?delete o[p]:o[p]=n}}}i.delete(n)}let p=o||m;return p&&f.set(p,!1),p},{unlock:l});return b&&c.forEach((a,b)=>{(0,d.a)(b)}),m}})()(c=>c(a,b))}function j(a){return a instanceof g}function k(a){return a instanceof h}}
,function(a,b,c){let d,e;c.d(b,{a:function(){return g}});let f=(d={},e=new WeakMap,Object.freeze(d),e.set(d,!0),!!e.get(d));function g(a){f&&!Object.isFrozen(a)&&Object.freeze(a)}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,b){return a===b?0!==a||1/a==1/b:a!=a&&b!=b}}
,function(a,b,c){c.d(b,{a:function(){return m},b:function(){return l},c:function(){return k},d:function(){return i},e:function(){return j},f:function(){return g}});var d=c(70);let e="EUPL",f="undefined"!=typeof window?window.performance:void 0;function g(){try{if(f&&f.now)return Math.round(performance.now())}catch{}return Date.now()}function h(a,b=!0){return b&&0!==a.lastIndexOf(`${e}.`)?`${e}.${a}`:a}function i(a,b){try{f&&f.mark&&f.mark(h(a,b))}catch{}}function j(a,b,c,d){try{f&&f.measure&&f.measure(h(a,d),h(b,d),h(c,d))}catch{}}function k(a,b,c){i(`${a}${b?`(${b})`:""} (start)`,c)}function l(a,b,c,d){i(`${a}${c?`(${c})`:""} (end${b?`, ${b}`:""})`,d),j(`${a}${c?`(${c})`:""}${b?` (${b})`:""}`,`${a}${c?`(${c})`:""} (start)`,`${a}${c?`(${c})`:""} (end${b?`, ${b}`:""})`,d)}function m(){let a=performance.getEntriesByType("mark");for(let b of(a.sort((a,b)=>a.startTime-b.startTime),a))console.log(`${b.startTime.toFixed(0)} : ${b.name}`)}(0,d.b)("performance",{get:()=>({logMarks:m})}),window.__debugLogPerformanceMarks=m}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.anonymous=1]="anonymous",e[e.msa=2]="msa",e[e.aad=3]="aad"}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,...b){return b.reduce((a,b)=>({...a,...b,...a.extraMetrics||b.extraMetrics?{extraMetrics:{...a.extraMetrics||{},...b.extraMetrics||{}}}:{},...a.extraData||b.extraData?{extraData:{...a.extraData||{},...b.extraData||{}}}:{}}),a)}}
,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(260),e=c(7);class f{static start(a){let b=new d.a(a);return new e.c((a,c)=>{b.start(a,c)},()=>{b.abort(!0)})}static startAndPostProcess(a,b){let c=new d.a(a);return new e.c((a,d)=>{c.start((c,d)=>{a(b(c,d))},d)},()=>{c.abort(!0)})}}}
,function(a,b,c){c.d(b,{a:function(){return e},b:function(){return i},c:function(){return f},d:function(){return h},e:function(){return g}});var d=c(41);class e extends d.a{constructor(a,b){const{response:{error:{innerError:{stackTrace:c=""}={}}={}}={},response:d,request:e,status:f,code:g=i(d,f,a=>`${a}`)||"unhandled"}=b;super({innerError:a,code:g,...b}),this.name="GraphError",this.response=d,this.status=f,this.serverStack=c,this.request=e,this.error=a}}function f(a){let b={};if(b.errorMessage=a.message,g(a)){b.vroomStatus=a.status;let{response:c}=a;if(c&&c.error){let a=c.error;b.vroomErrorCode=a.code,b.vroomErrorMessage=a.message;let d=a.innerError||a.innererror;d&&(b.vroomErrorInnerCode=d.code,b.vroomErrorInnerMessage=d.message,b.vroomErrorInnerDebugMessage=d.debugMessage,b.vroomErrorInnerStack=d.stackTrace)}}return b}function g(a){return!!a&&a instanceof e}function h(a){return function(a,b){if(a&&g(a)){let{response:c,status:d}=a;return i(c,d,c=>b(c,a))}}(a,a=>`${a}`)||"unhandled"}function i(a,b,c){if(a){let b=[],d=a.error;for(;d;)b.push(d),d=d.innerError||d.innererror;for(;d=b.pop();)if(void 0!==d.code){let a=c(d.code);if(void 0!==a)return a}}return c(b)}}
,function(a,b,c){b.a=c(163).a}
,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(7),e=c(3);class f{getToken(a){let{resource:b,skipCache:c,apiQosName:f}=a,g=new e.a({name:"getToken"});return this._dataSource.getToken({resource:b,skipCache:c,apiQosName:f}).then(a=>(g.end({resultType:e.b.Success}),a),a=>(g.end({resultType:e.b.Failure}),d.c.reject(a)))}getInstrumentedToken(a){let{resource:b,skipCache:c,apiQosName:f}=a,g=new e.a({name:"getToken"});return this._dataSource.getInstrumentedToken({resource:b,skipCache:c,apiQosName:f}).then(a=>(g.end({resultType:e.b.Success}),a),a=>(g.end({resultType:e.b.Failure}),d.c.reject(a)))}constructor(a={},b){this._dataSource=b.oAuthTokenDataSource}}}
,function(a,b,c){c.d(b,{a:function(){return j},b:function(){return i},c:function(){return g},d:function(){return h}});var d=c(266),e=c(28),f=c(0);function g(a){let b=a.lastIndexOf("/");return b>=0?a.substring(b+1):a}function h(a){return decodeURI(a)}function i(a){let b;try{b=decodeURI(a)}catch(c){b=a}return b===a?a=(0,d.a)(a,!0):(a=a.replace("#","%23"),!f.a.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")&&!e.b.isFeatureEnabled({ECS:83959})&&a.indexOf("%25")&&(a=(0,d.a)(a,!0))),a}function j(a){return a&&0>a.indexOf("?")&&(a=(a=encodeURI(a)).replace(/#/g,"%23")),a}}
,,function(a,b,c){c.d(b,{a:function(){return T}});var d=c(271),e=c(262),f=c(263),g=c(137),h=c(268),i=c(270),j=c(267),k=c(85),l=c(46),m=c(36),n=c(45),o=c(32),p=c(86),q=c(632),r=c(37),s=c(102),t=c(84),u=c(265),v=c(630),w=c(44),x=c(628),y=c(0),z=c(269),A=c(631),B=c(103),C=c(28),D=c(139);let E="Prefer",F="ocdiAsDefault";function G(a){return!y.a.isActivated("9e83ffc0-b39a-4fbf-8c0b-6e0c5bb9c0e6","07/29/2025","Add prefer header to support OCDI for WSET Item")&&!y.a.isActivated("61ff1676-78f4-428f-9283-ba6cc93f3303","10/06/2025","Enable OCDI as default preferred functionality via spPageContextInfo")&&a?.isOCDIAsDefaultPreferred===!0}var H=c(3),I=c(101);let J=!y.a.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),K=y.a.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link"),L=y.a.isActivated("edb05947-5f5b-47a0-91ef-ddc0cef4e7a1","07/03/2024","sbarrameda: fix to use loginName if userId is undefined"),M=y.a.isActivated("46a06a91-966f-47f1-af68-09d8b3864e12","07/03/2023","Override navId with navIdSendLinkOverride")||C.b.isFeatureEnabled({ECS:1107386}),N=y.a.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||C.b.isFeatureEnabled({ECS:1059927}),O=y.a.isActivated("9c1ecbd5-cae0-484e-ba86-18863f653357","09/18/2023","KS for using AgeGroup returned from GSI")||C.b.isFeatureEnabled({ECS:1132016}),P=y.a.isActivated("8b8c00d5-55fe-4115-9289-1f3c0a6e37b4","02/15/2024","Use maxPrincipalsToReturn and maxLinkMembersToReturn in GSI request")||C.b.isFeatureEnabled({ECS:1231607}),Q=y.a.isActivated("ecde6cd1-4c53-4160-a2c0-137609d6f987","05/13/2025","joannakuo: add navid to share object"),R=y.a.isActivated("bb4978a7-7997-465d-8306-ce0f2683a9ee","06/10/2025","joannakuo: log auth token appId"),S=y.a.isActivated("2feadc3c-a1d2-4ee9-a73a-ac8a60ce73f6","07/09/2025","joannakuo: remove padding from navId string");class T extends g.b{static parsePeople(a){return a.map(a=>{let b={role:T.parseSharingRole(a.CurrentRole),statusCode:Number(!a.Status),errorMessage:a.Message||null};return{name:a.DisplayName,email:a.Email,userId:a.UserId,sharingInfo:b}})}static parseSharingRole(a){switch(a){case 0:return h.a.None;case 1:default:return h.a.View;case 2:return h.a.Edit;case 6:return h.a.Review}}getSharingInformation(a,b,c,d,e,f){let g,h=(d=d||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a))).segment("GetSharingInformation"),j="pickerSettings";return b&&(j+=",permissionsInformation"),c&&(j+=",sharingLinkTemplates"),e&&(j+=",addressBarLinkSettings"),g=h.oDataParameter("$Expand",j).toString(),this.getData(()=>g,b=>{let c=JSON.parse(b),d=this._parseGetSharingInformationResponse(c,a);return d.getSharingInformationSources=i.a.api,d},"GetSharingInformation",()=>JSON.stringify({request:{maxPrincipalsToReturn:P?30:100,maxLinkMembersToReturn:P?30:100}}),"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&(0,D.e)(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`,...G(this._pageContext)?{[E]:F}:{}}:G(this._pageContext)?{[E]:F}:void 0,null,null,!0,void 0,void 0,this._getExtraData(),f)}getSharingInformationForRMA(a,b,c){let d=(b=b||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a))).segment("GetSharingInformation");return this.getData(()=>d.toString(),a=>{let b=JSON.parse(a);return this._parseGetSharingInformationResponseForRMA(b)},"GetSharingInformation",()=>"","POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&(0,D.e)(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`,...G(this._pageContext)?{[E]:F}:{}}:G(this._pageContext)?{[E]:F}:void 0,null,null,!0,void 0,void 0,this._getExtraData(),c)}getShareLinkApi(a,b,c){return b.method("Lists",this._getParentListId(a)).method("GetItemById",c).segment("ShareLink")}emailWithoutPermissioning(a,b,c,d){let e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b)).segment("ForwardObjectLink").toString();return this.getData(()=>e,a=>{let c=JSON.parse(a).d,d=[];c.UniquelyPermissionedUsers&&c.UniquelyPermissionedUsers.results&&(d=c.UniquelyPermissionedUsers.results);let e=[];c.InvitedUsers&&c.InvitedUsers.results&&(e=c.InvitedUsers.results);let f={};if(f.statusCode=c.StatusCode,f.errorMessage=c.ErrorMessage,f.people=T.parsePeople(d),f.invitedUsers=T.parsePeople(e),f.itemId=b&&b.id,e.length>0&&(f.invitationLink=e[0].InvitationLink),f.invalidEmails=[],c.UsersWithInvalidEmails&&c.UsersWithInvalidEmails.results)for(let a of c.UsersWithInvalidEmails.results)f.invalidEmails.push(a.User);return f},"ForwardObjectLink",()=>{let b=[];for(let c of a)b.push(c.rawPersonData);let e={peoplePickerInput:JSON.stringify(b),emailBody:c,emailSubject:d,linkParameters:{}};return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink&&!K&&(this._sharingContextInformation.navIdSendLinkOverride&&!M?e.linkParameters.nav=S?this._sharingContextInformation.navIdSendLinkOverride:this._sharingContextInformation.navIdSendLinkOverride?.replace(/=/g,""):this._sharingContextInformation.navId&&(e.linkParameters.nav=S?this._sharingContextInformation.navId:this._sharingContextInformation.navId?.replace(/=/g,""))),JSON.stringify(e)},"POST",G(this._pageContext)?{[E]:F}:void 0)}checkPermissions(a,b){let c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b)).segment("CheckPermissions").toString();return this.getData(()=>c,a=>{let b=JSON.parse(a);return b.d?b.d.CheckPermissions.results:null},"CheckPermissions",()=>JSON.stringify({recipients:a}))}share(a,b){let c=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(b.items[0]);if(b.linkType===j.a.Organization||b.linkType===j.a.Edit||b.linkType===j.a.View)return this._shareLink(a,b);{let d,e={};if(c){let a=b.items[0];d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareObject").toString()}else d=this._shareUrl;this._sharingContextInformation&&this._sharingContextInformation.listId&&(0,D.e)(this._sharingContextInformation.listId.slice(1,-1))&&(e["X-SP-REQUESTRESOURCES"]=`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`),G(this._pageContext)&&(e[E]=F);let f=a.length;if(!R&&this._pageContext.authToken){let a=new H.a({name:"SharingDataSource.Share.authTokenAppId"}),b=(0,I.c)(this._pageContext.authToken).appid||"",c="08e18876-6177-487e-b8b5-cf950c1e598c"!==b&&"c58637bb-e2e1-4312-8a00-04b5ffcd3403"===b?H.b.Failure:H.b.Success;a.end({resultType:c,extraData:{appId:b,clientId:this.getClientId(),scenarioId:this._sharingContextInformation.scenarioId,correlationId:this._sharingContextInformation.correlationId,hostSessionId:this._sharingContextInformation.hostSessionId,pageContextCorrelationId:this._pageContext.CorrelationId}})}return this.getData(()=>d,a=>{let c=JSON.parse(a).d,d=[];(0,B.a)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(c)),c.UniquelyPermissionedUsers&&c.UniquelyPermissionedUsers.results&&(d=c.UniquelyPermissionedUsers.results);let e=[];c.InvitedUsers&&c.InvitedUsers.results&&(e=c.InvitedUsers.results);let f={};if(f.statusCode=c.StatusCode,f.errorMessage=c.ErrorMessage,f.people=T.parsePeople(d),f.invitedUsers=T.parsePeople(e),f.itemId=b.items[0]&&b.items[0].id,e.length>0&&(f.invitationLink=e[0].InvitationLink),f.invalidEmails=[],c.UsersWithInvalidEmails&&c.UsersWithInvalidEmails.results)for(let a of c.UsersWithInvalidEmails.results)f.invalidEmails.push(a.User);return f},"Share",()=>{let d=[];for(let b=0;b<a.length;b++){let c=a[b];d.push(c.rawPersonData)}b.roleValue===h.a.Edit.toString()?b.roleValue=A.a:b.roleValue===h.a.View.toString()&&(b.roleValue=A.e);let e={peoplePickerInput:JSON.stringify(d),roleValue:b.roleValue,sendEmail:b.sendEmail,emailBody:b.message,emailSubject:b.subject,includeAnonymousLinkInEmail:!b.requireSignIn,propagateAcl:b.propagateSharing,useSimplifiedRoles:!0},f=this._sharingContextInformation?.navIdSendLinkOverride||this._sharingContextInformation?.navId||"";!Q&&f&&(e.linkParameters={nav:S?f:f.replace(/=/g,"")}),c||(e.url=this._sharingDataSourceHelper.getFileUrl(b.items[0]));let g=JSON.stringify(e);return(0,B.a)()&&window.sessionStorage.setItem("Share_Payload",g),g},"POST",e,void 0,void 0,!0,void 0,void 0,this._getExtraData(f)).catch(c=>{let d="";try{d=JSON.stringify(c)}catch(a){}return{error:k.b.generic,debugErrorMessage:d,people:a,statusCode:c.statusCode,errorMessage:c.errorMessage,invitedUsers:[],itemId:b.items[0]&&b.items[0].id||""}})}}updatePermissions2(a,b,c){let d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b),(0,D.d)()).segment("UpdateDocumentSharingInfo").toString();return this.getData(()=>d,a=>{let b=JSON.parse(a).d;return b?{role:b.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",()=>{let b;switch(c){case l.a.none:case l.a.view:case l.a.manageList:case l.a.restrictedview:case l.a.review:case l.a.edit:case l.a.owner:b=c;break;default:b=l.a.view}return JSON.stringify({userRoleAssignments:[{UserId:a.loginName,Role:b}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0})})}updatePermissionsMultiple(a,b,c,d,e){let f=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b)).segment("UpdateDocumentSharingInfo").toString();return this.getData(()=>f,a=>{let b=JSON.parse(a).d;return b?{role:b.UpdateDocumentSharingInfo.results[0].CurrentRole,success:b.UpdateDocumentSharingInfo.results.map(a=>a.Status).reduce((a,b)=>a&&b,!0)}:null},"UpdatePermissionsMultiple",()=>{let b;switch(c){case l.a.none:b=0;break;case l.a.view:b=1;break;case l.a.review:b=6;break;case l.a.edit:b=2;break;case l.a.restrictedview:b=7;break;default:b=1}return JSON.stringify({userRoleAssignments:a.map(a=>({UserId:L?a.userId:a.userId||a.loginName,Role:b})),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:d,customMessage:e,includeAnonymousLinksInNotification:!1,propagateAcl:!0})})}parseRawSharingInformation(a,b){return this._parseGetSharingInformationResponse(a,b)}parseRawSharingInformationForRMA(a){return this._parseGetSharingInformationResponseForRMA(a)}unshareLink(a){let b=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a.item,this._getParentListId(a.item),(0,D.d)()).segment("UnshareLink").toString();return this.getData(()=>b,a=>!!JSON.parse(a).d,"UnshareLink",()=>JSON.stringify({linkKind:a.kind,shareId:a.shareId}))}shareLink(a){let b=a.settings,c=a.items[0],e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a.items[0],this._getParentListId(c),(0,D.d)()).segment("ShareLink").toString(),f={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&(0,D.e)(this._sharingContextInformation.listId.slice(1,-1))&&(f["X-SP-REQUESTRESOURCES"]=`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(f.Prefer="DirectUrlWithShareToken")),G(this._pageContext)&&(f[E]?f[E]+=`,${F}`:f[E]=F),this.getData(()=>e,a=>{let b=JSON.parse(a);return b.d?((0,B.a)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(b.d)),function(a){if(a.d)return U(a.d.ShareLink.sharingLinkInfo)}(b)):b.error?{error:k.b.generic,errorMessage:b.error.message}:void 0},"ShareLink",()=>{let c=null;b.expiration&&(c=(0,d.a)(b.expiration.toString()));let e=null;if(a.recipients&&a.recipients.length>0)for(let b of(e=[],a.recipients))b.rawPersonData&&e.push(b.rawPersonData);let f=null;if(b.inviteesToRemove&&b.inviteesToRemove.length>0)for(let a of(f=[],b.inviteesToRemove))f.push({id:a.id,loginName:a.loginName,name:a.primaryText,isExternal:a.isExternal,principalType:a.type,email:a.email});let g={request:{createLink:!!b.createLink,settings:{allowAnonymousAccess:b.allowAnonymousAccess,trackLinkUsers:b.trackLinkUsers,linkKind:b.sharingLinkKind,expiration:c,role:b.role,restrictShareMembership:b.restrictShareMembership,updatePassword:b.updatePassword,password:b.password,shareId:b.shareId,description:b.description,scope:b.scope,nav:""}}};if(this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink&&!K&&(this._sharingContextInformation.navIdSendLinkOverride&&!M?g.request.settings.nav=this._sharingContextInformation.navIdSendLinkOverride:this._sharingContextInformation.navId&&(g.request.settings.nav=this._sharingContextInformation.navId)),f&&(g.request.settings.inviteesToRemove={results:f}),e&&e.length>0){g.request.peoplePickerInput=JSON.stringify(e);let b=a.emailData,c=a.emailSubject;void 0!==b&&void 0===c&&(g.request.emailData={body:a.emailData,subject:""}),void 0===b&&void 0!==c&&(g.request.emailData={body:"",subject:a.emailSubject}),void 0!==b&&void 0!==c&&(g.request.emailData={body:a.emailData,subject:a.emailSubject})}let h=a.settings.shareId;h&&(g.request.settings.shareId=h,g.request.emailData={body:""});let i=JSON.stringify(g);return(0,B.a)()&&window.sessionStorage.setItem("ShareLink_Payload",i),i},"POST",0!==Object.keys(f).length?f:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(a=>{if(J)return{error:a};let b="";try{b=JSON.stringify(a)}catch(a){}return{error:k.b.generic,debugErrorMessage:b}})}setAddressBarLinkCapability(a,b){let c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("SetAddressBarLinkCapability").toString();return this.getData(()=>c,a=>!!JSON.parse(a).d,"SetAddressBarLinkCapability",()=>JSON.stringify({enable:b}))}shareLinkExpress(a,b,c){let d=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",a).method("GetItemById",b).segment("ShareLinkExpress").toString();return this.getData(()=>d,a=>{let b=JSON.parse(a);return b.error||!b.d?.ShareLinkExpress?.sharingLinkInfo?{error:k.b.generic,errorMessage:b?.error?.message||"No sharing link info returned"}:b.d?U(b.d.ShareLinkExpress.sharingLinkInfo):void 0},"ShareLinkExpress",()=>JSON.stringify({expressOption:c}),"POST",G(this._pageContext)?{[E]:F}:void 0,null,null,!0,void 0,void 0,this._getExtraData()).catch(a=>{if(J)return{error:a};let b="";try{b=JSON.stringify(a)}catch(a){}return{error:k.b.generic,debugErrorMessage:b}})}getClientId(){let a=Number(this._pageContext.webTemplate);if((0,z.a)(this._pageContext))return m.a.sharePoint;switch(a){case w.b.teamSite:case w.b.group:case w.b.subgroup:case w.b.sitePagePublishing:return m.a.sharePoint;case w.b.mySite:return m.a.odb;default:return m.a.sharePoint}}_shareLink(a,b){let c=b.items[0],e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,c,this._getParentListId(c)).segment("ShareLink").toString();return this.getData(()=>e,c=>({statusCode:0,errorMessage:"",people:a,itemId:b.items[0].id,invitedUsers:[]}),"ShareLink",()=>{let c=[];for(let b of a)c.push(b.rawPersonData);let e=null;return b.expiration&&(e=(0,d.a)(b.expiration)),JSON.stringify({request:{peoplePickerInput:JSON.stringify(c),emailData:{body:b.message,subject:b.subject},linkKind:this._getSharingLinkKind(b.linkType,b.roleValue),createLink:!0,expiration:e}})},"POST",G(this._pageContext)?{[E]:F}:void 0)}_getSharingLinkKind(a,b){let c=n.a.direct;return a===j.a.Edit?c=n.a.anonymousEdit:a===j.a.View?c=n.a.anonymousView:a===j.a.Organization&&(c=b===h.a.Edit.toString()?n.a.organizationEdit:n.a.organizationView),c}_parseGetSharingInformationResponse(a,b){if(a.error)return{error:k.b.generic,ageGroup:void 0,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExistingExternalPrincipal:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,itemUrl:void 0,siteId:void 0,listId:void 0,substrateFileId:void 0,tenantId:void 0,isConsumerFiles:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};let c=a.d,{userPhotoCdnBaseUrl:d,permissionsInformation:e}=c,f=!!e,g=!!c.sharingLinkTemplates,h=!!c.addressBarLinkSettings,i=f?this._parseSharingLinks(e.links.results,c.directUrl,d,(0,D.d)()):[],j=g?this._parseSharingLinkTemplates(c.sharingLinkTemplates.templates.results,d):[],l=h?c.addressBarLinkSettings:null,m=[];if(f){let a=e.siteAdmins.results,b=e.principals.results,c=this._parseSharingPrincipals(a,void 0,d);c.forEach(a=>a.isSiteAdmin=!0);let f=this._parseSharingPrincipals(b,void 0,d);m=c.concat(f)}let q=this._getDefaultSharingLink(c.defaultLinkKind,c.defaultShareLinkScope,i,c.sharingAbilities),r=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;N||r||!c||(r=c.displayName);let s={name:r,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:c.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(b){let a=b.properties,d=a.ItemChildCount?parseInt(a.ItemChildCount,10):0,e=a.FolderChildCount?parseInt(a.FolderChildCount,10):0,f=b.type===t.a.OneNote?0:d+e,g=this._isPolicyTipFlagSet(b.policyTip,v.a.blockSharing),h=b.name;N||h||!c.displayName||(h=c.displayName),s={name:h,childCount:f,hasDlpPolicy:g,extension:b.extension,appmap:b.appMap,itemType:b.type}}let u=c.canRequestAccessForGrantAccess||c.canAddInternalPrincipal||i.length>1,w={anonymousLinkExpirationRestrictionDays:0===c.anonymousLinkExpirationRestrictionDays?-1:c.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:c.anyoneLinkTrackUsers,allOrganizationSecurityGroupId:c.uniqueAccessGroups?.discoverableByOrganization?.groupId,canAddExistingExternalPrincipal:c.canAddExistingExternalPrincipal,canAddExternalPrincipal:c.canAddExternalPrincipal,canAddInternalPrincipal:c.canAddInternalPrincipal,defaultShareLinkToExistingAccess:c.defaultShareLinkToExistingAccess,canManagePermissions:u,defaultSharingLink:q,fileExtension:c.fileExtension,sharedObjectType:c.sharedObjectType,hasInheritedLinks:!!f&&c.permissionsInformation.hasInheritedLinks,isShared:(0,D.a)(i,m),item:s,sharingLinks:i,sharingPrincipals:m,peoplePickerSettings:c.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:c.blockPeoplePickerAndSharing,requiresAccessApproval:!c.canAddInternalPrincipal&&c.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:c.canRequestAccessForGrantAccess,userRole:c.currentRole,defaultShareLinkPermission:c.defaultShareLinkPermission,sharingAbilities:c.sharingAbilities,defaultLinkKind:c.defaultLinkKind,defaultShareLinkScope:c.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:o.a.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"00000000-0000-0000-0000-000000000000",sharingLinkKind:n.a.direct,sharingScope:p.a.existing,url:c.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},discoverableByOrganizationEnabled:c.uniqueAccessGroups?.discoverableByOrganization?.enabled,hasPermissionsInformation:!!c.permissionsInformation,sharingLinkTemplates:j,addressBarLinkSettings:l,webTemplateId:c.webTemplateId,itemUniqueId:c.itemUniqueId,itemUrl:c.itemUrl,siteId:c.siteId,listId:c.listId,substrateFileId:c.substrateFileId,tenantId:c.tenantId,isConsumerFiles:!!c.isConsumerFiles&&c.isConsumerFiles,customizedExternalSharingServiceUrl:c.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:c.siteIBSegmentIDs?c.siteIBSegmentIDs.results:null,siteIBMode:c.siteIBMode,enforceIBSegmentFiltering:!!c.enforceIBSegmentFiltering,enforceSPOSearch:!!c.enforceSPOSearch,outlookEndpointHostUrl:c.outlookEndpointHostUrl?c.outlookEndpointHostUrl:null,webUrl:c.webUrl?c.webUrl:null,isStubFile:!!c.isStubFile&&c.isStubFile,userPhotoCdnBaseUrl:c.userPhotoCdnBaseUrl,permissionsInformation:c.permissionsInformation,sensitivityLabelInformation:c.sensitivityLabelInformation,displayName:c.displayName,isPremium:c.isPremium,isMultiTenantOrganization:c.isMultiTenantOrganization,...!O&&c.ageGroup?{ageGroup:c.ageGroup}:{}};if((0,B.a)()){let a=window.sessionStorage.getItem("Get_Sharing_Information");if(a&&Object.keys(a).length>0){let b=JSON.parse(a);return{...w,...b}}}return w}_parseGetSharingInformationResponseForRMA(a){let b=a.d;return{currentRole:b.currentRole,fileExtension:b.fileExtension,fileName:b.displayName,sharedObjectType:b.sharedObjectType,sensitivityLabelInformation:b.sensitivityLabelInformation}}_parseSharingLinks(a,b,c,d=!1){d||(a=a.filter(a=>!a.isInherited));let e=a.map(a=>{let b,e=a.linkDetails;return b=void 0!==e.Scope&&e.Scope!==p.a.uninitialized?V(e.LinkKind,e.Scope):(0,D.c)(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership),{allowsAnonymousAccess:e.AllowsAnonymousAccess,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload,description:e.Description,audience:b,expiration:e.Expiration?new Date(e.Expiration):null,isActive:e.IsActive,isEdit:W(e.LinkKind)||e.IsEditLink,isReview:e.IsReviewLink,isManageList:e.IsManageListLink,principals:this._parseSharingPrincipals(a.linkMembers.results,e.LinkKind,c),invitees:this._parseLinkInvitees(e,c),shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:this._parseSharingPrincipal(e.PasswordLastModifiedBy,c),isCreateOnlyLink:e.IsCreateOnlyLink,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created,trackLinkUsers:e.TrackLinkUsers,...d?{inheritedLinkInfo:a.inheritedFrom}:{},...a.linkStatus?{enabled:a.linkStatus.enabled}:{}}});return(e=e.sort((a,b)=>this._getLinkRanking(b)-this._getLinkRanking(a))).push({allowsAnonymousAccess:!1,audience:o.a.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:n.a.direct,sharingScope:p.a.specificPeople,url:b,updatePassword:!1,password:"",passwordLastModifiedBy:null}),e}_getLinkRanking(a){let b=0;switch(a.audience){case o.a.anyone:b+=30;break;case o.a.organization:b+=20;break;case o.a.specificPeopleFlex:b+=10}return a.isEdit?b+=3:a.isReview?b+=2:a.isEdit||a.isReview||a.blockDownload||(b+=1),b}_getSharingLinkTemplateRanking(a){let b=0;if(a&&a.linkDetails&&a.linkDetails.shareId){switch(a.scope){case q.a.anyone:b+=30;break;case q.a.organization:b+=20;break;case q.a.specificPeople:b+=10}switch(a.role){case l.a.edit:b+=3;break;case l.a.review:b+=2;break;case l.a.view:b+=1}}return b}_parseSharingLinkTemplates(a,b){return a.map(a=>{let c,d=a.linkDetails;if(null!==d){let a;a=void 0!==d.Scope&&d.Scope!==p.a.uninitialized?V(d.LinkKind,d.Scope):(0,D.c)(d.LinkKind,d.AllowsAnonymousAccess,d.RestrictedShareMembership),c={allowsAnonymousAccess:d.AllowsAnonymousAccess,hasPassword:d.RequiresPassword,blockDownload:d.BlocksDownload,audience:a,expiration:d.Expiration?new Date(d.Expiration):null,description:d.Description,isActive:d.IsActive,isEdit:W(d.LinkKind)||d.IsEditLink,isReview:d.IsReviewLink,principals:void 0,invitees:this._parseLinkInvitees(d,b),shareId:d.ShareId,sharingLinkKind:d.LinkKind,sharingScope:d.Scope,url:d.Url,updatePassword:d.UpdatePassword,password:d.Password,passwordLastModifiedBy:this._parseSharingPrincipal(d.PasswordLastModifiedBy,b)}}return{linkDetails:c,passwordProtected:a.passwordProtected,role:a.role,scope:a.scope,shareKind:a.shareKind}}).sort((a,b)=>this._getSharingLinkTemplateRanking(b)-this._getSharingLinkTemplateRanking(a))}_parseLinkInvitees(a,b){let c=a.Invitations;if(!c)return[];let d=[];for(let a of c.results)a&&a.invitee&&d.push(a.invitee);return d.map(a=>({id:a.id,email:a.email,primaryText:a.name,isExternal:a.isExternal,loginName:a.loginName,role:null,secondaryText:a.jobTitle,type:a.principalType,imageUrl:(0,x.a)(this._pageContext.webAbsoluteUrl,a.email,b)}))}_parseSharingPrincipals(a,b,c){let d=a.map(a=>{let d=a.principal;d||(d=a);let e={id:d.id,isExternal:d.isExternal,loginName:d.loginName,primaryText:d.name,role:a.role,secondaryText:d.jobTitle,type:d.principalType,imageUrl:(0,x.a)(this._pageContext.webAbsoluteUrl,d.email,c),email:d.email};return b&&(e.sharingLinkKind=b),e});return u.a.getUniqueSharingPrincipals(d)}_getExtraData(a){let b;return this._sharingContextInformation&&(b={clientId:this._sharingContextInformation.clientId,mode:r.a[this._sharingContextInformation.mode],numRecipients:a}),b}_parseSharingPrincipal(a,b){if(a){let c=a.principal;return c||(c=a),{id:c.id,isExternal:c.isExternal,loginName:c.loginName,primaryText:c.name,role:a.role,secondaryText:c.jobTitle,type:c.principalType,imageUrl:(0,x.a)(this._pageContext.webAbsoluteUrl,c.email,b),email:c.email}}return null}_getDefaultSharingLink(a,b,c,d){let e;d.peopleSharingLinkAbilities&&(d.peopleSharingLinkAbilities.canManageEditLink.enabled||d.peopleSharingLinkAbilities.canManageReadLink.enabled)&&a===n.a.direct&&(a=n.a.flexible);let f=a,g=b;return d.anyoneLinkAbilities?(f!==n.a.anonymousEdit||d.anyoneLinkAbilities.canManageEditLink.enabled||(f=n.a.anonymousView),f!==n.a.anonymousView||d.anyoneLinkAbilities.canManageReadLink.enabled||(f=n.a.organizationEdit),g!==p.a.anyone||d.anyoneLinkAbilities.canManageReadLink.enabled||d.anyoneLinkAbilities.canManageReadLink.enabled||(g=p.a.organization)):(f!==n.a.anonymousEdit||d.anonymousLinkAbilities.canManageEditLink.enabled||(f=n.a.anonymousView),f!==n.a.anonymousView||d.anonymousLinkAbilities.canManageReadLink.enabled||(f=n.a.organizationEdit),g!==p.a.anyone||d.anonymousLinkAbilities.canManageReadLink.enabled||d.anonymousLinkAbilities.canManageReadLink.enabled||(g=p.a.organization)),d.organizationLinkAbilities&&(f!==n.a.organizationEdit||d.organizationLinkAbilities.canManageEditLink.enabled||(f=n.a.organizationView),f!==n.a.organizationView||d.organizationLinkAbilities.canManageReadLink.enabled||(f=n.a.direct),g!==p.a.organization||d.organizationLinkAbilities.canManageReadLink.enabled||d.organizationLinkAbilities.canManageEditLink.enabled||(g=p.a.specificPeople)),!d.peopleSharingLinkAbilities||g!==p.a.specificPeople||d.peopleSharingLinkAbilities.canManageReadLink.enabled||d.peopleSharingLinkAbilities.canManageEditLink.enabled||(g=p.a.existing),a===n.a.anonymousEdit||a===n.a.anonymousView?e=o.a.anyone:a===n.a.organizationEdit||a===n.a.organizationView?e=o.a.organization:a===n.a.direct?e=o.a.specificPeople:a===n.a.flexible&&(e=o.a.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:e,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:f,sharingScope:g,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}}_isPolicyTipFlagSet(a,b){return a&&(a&b)===b}constructor(a,b={pageContext:a.pageContext}){super({dataSourceName:"SharingDataSource"},b),this._getParentListId=a.getParentListId,this._itemUrlHelper=a.itemUrlHelper||new e.a({},{pageContext:a.pageContext}),this._apiUrlHelper=a.apiUrlHelper||new f.a({},{pageContext:a.pageContext,itemUrlHelper:this._itemUrlHelper}),this._sharingContextInformation=a.sharingContextInformation||void 0,this._sharingDataSourceHelper=new u.a({itemUrlHelper:this._itemUrlHelper,sharingContextInformation:this._sharingContextInformation,isItemUrlEncoded:a.isItemUrlEncoded});const c=(0,s.a)(this._pageContext);this._shareUrl=c+"/_api/SP.Web.ShareObject"}}function U(a){let b;b=void 0!==a.Scope&&a.Scope!==p.a.uninitialized?V(a.LinkKind,a.Scope):(0,D.c)(a.LinkKind,a.AllowsAnonymousAccess,a.RestrictedShareMembership);let c=a.Expiration?new Date(a.Expiration):void 0;return{link:{allowsAnonymousAccess:a.AllowsAnonymousAccess,audience:b,expiration:c,description:a.Description,isActive:a.IsActive,isEdit:W(a.LinkKind)||a.IsEditLink,principals:null,invitees:null,hasPassword:a.RequiresPassword,shareId:a.ShareId,sharingLinkKind:a.LinkKind,sharingScope:a.Scope,url:a.Url,updatePassword:a.UpdatePassword,password:a.Password,passwordLastModifiedBy:a.PasswordLastModifiedBy,shareTokenString:a.ShareTokenString,isAddressBarLink:a.IsAddressBarLink,isUnhealthy:a.IsUnhealthy,status:a.SharingLinkStatus,created:a.Created}}}function V(a,b){if(a===n.a.anonymousEdit||a===n.a.anonymousView)return o.a.anyone;if(a===n.a.organizationEdit||a===n.a.organizationView)return o.a.organization;if(a===n.a.direct)return o.a.specificPeople;if(a===n.a.flexible)if(b==p.a.anyone)return o.a.anyone;else if(b===p.a.organization)return o.a.organization;else return o.a.specificPeopleFlex}function W(a){return a===n.a.anonymousEdit||a===n.a.organizationEdit||a!==n.a.anonymousView&&a!==n.a.organizationView&&null}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return d},c:function(){return e}});let d=a=>{let b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)");return b&&b.pop()||""},e=(a,b,c,d,e)=>{let f="";if(c){let a=new Date;a.setTime(a.getTime()+24*c*36e5),f=` expires= + ${a.toUTCString()} + ;`}let g="";e&&(g=` samesite=${e};`,"none"===e.toLowerCase()&&(g+=" secure;")),document.cookie=`${a}=${b};${f} path=${d||"/"};${g}`},f=a=>{document.cookie=`${a}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.uninitialized=0]="uninitialized",e[e.AddressBarLink=1]="AddressBarLink"}
,,,,function(a,b,c){c.d(b,{a:function(){return d}});let d="share"}
,,function(a,b,c){c.d(b,{a:function(){return e},b:function(){return f},c:function(){return d}});let d={none:0,allow:1,allowWithJustification:2},e={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},f={override:0,reportFalsePositive:1}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={})).Augloop="ms-augloop",e.Substrate="ms-substrate",e.Graph="ms-graph",e.SharePoint="SharePoint_MSAL"}
,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(137),e=c(19);class f extends d.b{reloadSharingWithPostData(a){let b=document.createElement("form");b.method="POST";let c=new e.a(window.location.href);c.setQueryParameter("cookieexpirationreload","true"),b.action=c.toString();let d=document.createElement("input");d.type="hidden",d.name="access_token",d.value=a,b.appendChild(d),this._sharingContextInformation.authToken||(this._sharingContextInformation.authToken=a);let f=document.createElement("input");f.type="hidden",f.name="context",f.value=JSON.stringify(this._sharingContextInformation),b.appendChild(f),document.body.appendChild(b),b.submit()}constructor(a,b){super({dataSourceName:"S3CommonSharingReloadDataSource"},b),this._sharingContextInformation=b.sharingContextInformation}}}
,function(a,b,c){let d;c.d(b,{a:function(){return Q}});var e=c(2),f=c(252),g=c(60),h=c(43),i=c(455),j=c(30),k=c(11);let l=(0,j.a)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError"},{message:k.a.String,stack:k.a.String,type:k.a.String});var m=c(44),n=c(273),o=c(59),p=c(6),q=c(0),r=c(275),s=c(276),t=c(238),u=c(7),v=c(140),w=c(456),x=c(31);class y{static hasClass(a,b){return a.classList?a.classList.contains(b):-1!==(a.className?a.className.split(" "):[]).indexOf(b)}static toggleClass(a,b,c){if(a.classList)c?a.classList.add(b):a.classList.remove(b);else{let d=a.className?a.className.split(" "):[],e=d.indexOf(b);c?-1===e&&d.push(b):e>-1&&d.splice(e,1),a.className=d.join(" ")}}static loadStyles(a){y._platform.isUnlimitedStyleSheetsSupported?y.registerStyle(a):y.registerStyleIE(a)}static registerStyle(a){let b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.appendChild(document.createTextNode(a)),b.appendChild(c)}static registerStyleIE(a){let b=document.getElementsByTagName("head")[0],c=y._lastStyleElement?y._lastStyleElement.styleSheet.cssText:"";(!y._lastStyleElement||c.length+y._styleText.length>y.MAX_STYLE_CONTENT_SIZE)&&(y._lastStyleElement=document.createElement("style"),y._lastStyleElement.type="text/css",b.appendChild(y._lastStyleElement)),y._lastStyleElement.styleSheet.cssText+=a}static loadStylesheet(a){let b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.href=a,document.head.appendChild(b)}static setText(a,b){void 0===d&&(d=void 0!==y.ce("div").textContent?"textContent":"innerText"),a[d]=b}static ce(a,b,c){let d=document.createElement(a);if(b){let a=Object.keys(b);for(let c=0;c<a.length;c++){let e=a[c];d.setAttribute(e,b[e])}}if(c)for(let a=0;a<c.length;a++)d.appendChild(c[a]);return d}static setShadowParent(a,b){a[y.SHADOW_PARENT_KEY]=b}static getParent(a,b=!0){return b&&a[y.SHADOW_PARENT_KEY]||a.parentElement}static ct(a){return document.createTextNode(a)}static createComment(a){return document.createComment(a)}static clickElement(a){a.onclick?a.onclick(void 0):a.click&&a.click()}static insertAfter(a,b){let c=b.parentNode,d=b.nextSibling;d?c.insertBefore(a,d):c.appendChild(a)}static waitForElement(a,b,c,d){let e=d||document,f=e.querySelector(a);if(f)b(f);else{let f=new MutationObserver((c,d)=>{let f=e.querySelector(a);f&&(b(f),d.disconnect())});return f.observe(c||d||document.documentElement,{childList:!0,subtree:!0}),f}}static getElementByTagAndPartialId(a,b,c){let d=[],e=a.getElementsByTagName(b);for(let a=0;a<e.length;a++)e[a].id.indexOf(c)>=0&&d.push(e[a]);return d.length>0?d[0]:null}static findAncestor(a,b,c=!0){for(;a&&a!==document.body;){if(y.hasClass(a,b))return a;a=y.getParent(a,c)}return null}static isElementOrAncestorsEqualToTarget(a,b){for(;a&&a!==document.body;){if(a===b)return!0;a=y.getParent(a)}return!1}static calculateRect(a,b){let c=a.getBoundingClientRect(),d=0,e=0,f=0,g=0;if(b){let b=window.getComputedStyle(a);d=parseFloat(b.marginLeft),e=parseFloat(b.marginRight),f=parseFloat(b.marginTop),g=parseFloat(b.marginBottom)}return new w.a(c.left-d,c.top-f,c.width+d+e,c.height+f+g)}static calculateSubtreeRect(a){let b=null,c=[a];for(;c.length>0;){a=c.shift();let d=y.calculateRect(a);d.width>0&&d.height>0&&(b=b?b.union(d):d);for(let b=0,d=a.children.length;b<d;b++)c.push(a.children[b])}return b||(b=new w.a),b}static insertAtIndex(a,b,c,d){if(!a||!b)return;c=c<0?0:c;let e=a.firstElementChild,f=0;for(;f<c&&e;)(!d||d===e.tagName)&&f++,e=e.nextElementSibling;e?a.insertBefore(b,e):a.appendChild(b)}}y.MAX_STYLE_CONTENT_SIZE=1e4,y.SHADOW_PARENT_KEY="_OneDrive_shadowParent",y._platform=new x.a,y._lastStyleElement=null,y._styleText="";var z=c(77),A=c(3),B=c(231),C=c(35),D=c(269);class E{static GetLoadPromise(){return window.o365ShellLoadPromise}static GetRenderPromise(){return window.o365ShellRenderPromise}static GetPostRenderPromise(){return window.o365ShellPostRenderPromise}}class F{get FlexPane(){return O365Shell.FlexPane}get Header(){return O365Shell.Header}get Navigation(){return O365Shell.Navigation}get Settings(){return O365Shell.Settings}get Theme(){return O365Shell.Theme}get Search(){return O365Shell.Search}get NFD(){return O365Shell.NFD}get Extensibility(){return O365Shell.Extensibility}get MeControl(){return O365Shell.MeControl}get DTT(){return O365Shell.DTT}SetData(a){O365Shell.SetData(a)}Render(a,b){O365Shell.Render(a,()=>this._signalAction(b))}RenderAsync(a,b,c){O365Shell.RenderAsync(a,()=>this._signalAction(b),()=>this._signalAction(c))}GetResourceLoader(){return O365Shell.GetResourceLoader()}OnDataChanged(a){return O365Shell.OnDataChanged(a)}OnSuiteAPILoaded(a){return O365Shell.OnSuiteAPILoaded(a)}LoadShellPlus(){O365Shell.LoadShellPlus()}Exists(){return"undefined"!=typeof O365Shell}HasMember(a){return this.Exists()&&!!O365Shell[a]}OnHasMember(a,b){this.HasMember(a)?b():this._PostRenderSignal.getPromise().done(()=>this.OnHasMember(a,b))}_signalAction(a){a();let b=this._PostRenderSignal;this._PostRenderSignal=new f.a,b.complete()}constructor(){this._PostRenderSignal=new f.a,E.GetLoadPromise()&&E.GetLoadPromise().then(()=>{this._signalAction(()=>{})}),E.GetRenderPromise()&&E.GetRenderPromise().then(()=>{this._signalAction(()=>{})}),E.GetPostRenderPromise()&&E.GetPostRenderPromise().then(()=>{this._signalAction(()=>{})})}}class G{get suiteNavPlaceholder(){return this._suiteNavPlaceholder}set suiteNavPlaceholder(a){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=a)}getCapabilities(){return this._capabilities}getO365Shell(){if(!this._capabilities.supportsRealSuiteNav)return u.c.reject(Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));if(p.a.isFeatureEnabled({ODB:!0,ODC:!1})){let a=new F;return u.c.resolve().then(E.GetLoadPromise).then(()=>a)}return this._getO365ShellViaBootstrapper()}getInitialRenderNavBarData(){return this._dataSourceBasic.getInitialRenderNavBarData()}getCachedData(){let a;if(this._capabilities.supportsCaching&&this._isCacheValid()){let b=this._cache.getValue(this._cacheDataKey);a=b&&b.data}return a}getCachedThemeData(){let a;if(this._capabilities.supportsCaching){let b=this._cache.getValue(this._cacheThemeDataKey);b&&b.themeData&&(a=b.themeData)}return a}updateCachedThemeData(a){let b={themeData:a,cacheDate:new Date().toISOString()};this._cache.setValue(this._cacheThemeDataKey,b)}_getO365ShellViaBootstrapper(){let a=new f.a,b=this._qosEvents&&this._qosEvents["SuiteNavProvider.GetO365Shell"];return this._getSuiteNavShellViaBootstrapper(a),a.getPromise().then(()=>{this._qosRecordSuccess(b)},a=>{this._qosRecordError(b,a)}),a.getPromise()}_requestShellCore(a,b,c){let d=b?a+"?odb_cb="+new Date().toISOString():a,e=new f.a,g="SuiteNavShellCore";return this._require(d,g,a=>{c&&c();let b=new F;b.Exists()?e.complete(b):e.error(H({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:d}}))},(a,b)=>{G.removeHeadScriptElement(g),e.error(H({error:b||a.message,resultCode:"LoadScriptError",extraData:{shellUrl:d}}))}),e.getPromise()}static removeHeadScriptElement(a){let b=document.head.querySelector("#"+a);b&&b.parentNode.removeChild(b)}_isGuestModeNavData(a){if(!a)return!1;try{let b=a.ClientData&&JSON.parse(a.ClientData);return b&&b.IsGuestMode}catch(a){return!0}}_isCacheValid(){let a=this._cache.getValue(this._cacheDataKey),b=this._cache.getValue(this._cacheVersionKey),c=Date.parse(this._cache.getValue(this._cacheDateKey)),d=this._capabilities.supportsRealSuiteNav,e=this._dataSourceBasic;return a&&a.data&&(this._stopCachingGuestModeNavDataKSActivated||!this._isGuestModeNavData(a.data))&&(!d||a.jsUrl)&&b===this._cacheVersion&&a.userIdentifier===e.getUserIdentifier()&&a.cacheToken===e.getCacheToken()&&this._isSameUserLanguage(a.data.CultureName)&&this._isCacheNotExpired(c,this._cacheExpire)}_qosRecordSuccess(a){a&&a.end({resultType:C.a.Success})}_qosRecordError(a,b){a&&a.end(H({error:b}))}_logEngagementData(a){this._engagementEvent&&this._engagementEvent.logData(a)}_isSameUserLanguage(a){return!(!q.a.isActivated("3e9c64de-101f-4c42-8514-06ef6dd97edb","08/09/2023","Fix language not updated in Feedback and Help section")&&a&&this._pageContext?.currentUICultureName)||a.toLowerCase()===this._pageContext.currentUICultureName.toLowerCase()}_isCacheNotExpired(a,b){return!isNaN(a)&&Date.now()-a<60*b*6e4}_getSuiteNavShellViaBootstrapper(a,b){let c=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(c,b).then(b=>{a.complete(b)},b=>{b=H({error:b}),this._hasRetriedO365Shell?a.error(b):(this._hasRetriedO365Shell=!0,this._getSuiteNavShellViaBootstrapper(a,!0))})}static require(a,b,c,d){let e=()=>void 0!==window.O365Shell;if(e()){c&&c(null);return}let f=document.head.querySelector("#"+b);if(f&&f.src===a)try{(0,D.b)(e,300,3e4).then(()=>{c(null)})}catch(a){d(null,"Unable to load O365Shell")}else{f&&f.src!==a&&G.removeHeadScriptElement(b);let e=document.createElement("script");e.id=b,e.src=a,c&&e.addEventListener("load",a=>{c(a)}),d&&e.addEventListener("error",a=>{d(a)}),document.head.appendChild(e)}}constructor(a,b){this._cachePrefix="odSuiteNav",this._cacheDataKey="Data",this._cacheThemeDataKey="ThemeData",this._cacheDateKey="CacheDate",this._cacheVersionKey="CacheVersion",this._cacheSessionKey="CachedThisSession",this._cacheVersion=6,this._cacheExpire=24,this._cacheRenew=12,this._cache=new g.a(this._cachePrefix,h.a.local),this._dataSourceBasic=b.dataSource,this._pageContext=b.pageContext,this._engagementEvent=a.engagementEvent,this._qosEvents=a.qosEvents,this._capabilities=this._dataSourceBasic.getCapabilities();const{require:c=G.require}=b;this._stopCachingGuestModeNavDataKSActivated=q.a.isActivated("2b530fb4-c76f-442e-a49e-e0259135ce2f"),this._require=c}}function H(a){let b=a.error;if(b&&b.resultCode)return b;let c=C.a.Failure;return u.c.isCanceled(b)&&(c=C.a.ExpectedFailure,a.resultCode="Canceled"),{resultType:c,resultCode:a.resultCode||"Other",error:b,extraData:a.extraData}}var I=c(176),J=c(633),K=c(638);let L={ODB:556,ODC:!1,Fallback:!1},M={ODB:1302,ODC:!1,Fallback:!1},N=q.a.isActivated("54d52105-eb9a-472b-98c2-17bc1192a994"),O=q.a.isActivated("9056088c-2632-4fce-9d66-8fd7c79af4b8"),P=!q.a.isActivated("c3f12d1f-4f42-4a72-9f99-f0bc79a94244","06/9/2025","Always add feedback button for videohub.aspx");class Q extends G{clearCachedPromise(){this._modelPromise=void 0}loadData(a){return this._loadModel(a).then(a=>a.data)}getO365Shell(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return super.getO365Shell();{if(!this._capabilities.supportsRealSuiteNav)throw Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");let a=new f.a,b=new A.a({name:"SuiteNavProvider.GetO365Shell"});return this._getSuiteNavShell(a),a.getPromise().then(()=>{b.end({resultType:A.b.Success})},a=>{b.end(H({error:a}))}),a.getPromise()}}getMailUrl(){return this._loadModel().then(a=>{let b=a&&a.data&&a.data.WorkloadLinks;if(b){for(let a of b)if(a&&a.Id===n.a.MAIL)return a.Url}})}updateWorkloadSettingsLinks(a){let b;return this.getO365Shell().then(c=>(b=c)&&b.Settings?this.loadData(a):void 0).then(a=>{a&&a.CurrentWorkloadSettingsSubLinks&&a.CurrentWorkloadSettingsSubLinks.length>0&&b.Settings.SetWorkloadSettingsLinks(a.CurrentWorkloadSettingsSubLinks)}).catch(a=>{z.a.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})}trySetDataAfterInitialRender(a,b){let c=new A.a({name:"SuiteNavProvider.SetDataCalled"}),d=this._dataSource.getSuiteNavContext();if(d&&d.isConsumer)return a.NFD&&(d.helpNamespace&&a.NFD.UpdateHelpNamespace(d.helpNamespace),this._addFeedbackButton(a)),d.actionsMap&&a.Navigation.OnLinkClick(a=>{let b=d.actionsMap[a.Id];b&&(a.Cancel=!b({...a}))}),u.c.wrap(!0);let{actionContext:e,bundleLoader:f}=b;return this.loadData().then(b=>{if(!b||!a)return!1;let d=this._isStreamAspx(),g=this._isVideoEditorAspx(),h=this._isVideoHubAspx(),i=(d||g||h||this._isFeedbackButtonEnabled())&&!!a.NFD,j=i&&(d||g||h||this._shouldAddFeedbackButton(a));if(this._pageContext){let{cloudType:a,env2:b}=this._pageContext;((0,I.c)(b)||(0,I.a)(b)||"gcc"===a)&&(j=i=!1)}if(j){let a=JSON.parse(b.ClientData);this._isFeedbackButtonEnabled()&&(this._isODb()||v.d)&&(a.EnableVNextFeedback=!0,a.OcpsOauthEnabled=!0,a.OcpsOauthEndpointUrl="https://clients.config.office.net/user/v1.0/web/policies"),a.OCVFeedbackMAXEnabled||v.d?(a.OCVFeedbackMAXEnabled=!1,b.ClientData=JSON.stringify(a)):i=j=!1}try{a.SetData(b),N||(0,K.b)(b,c,this._pageContext)}catch(a){return(0,B.a)(A.a,{name:"SuiteNav.RefreshCacheAfterInvalidShellData"},()=>this.loadData(!0)),!1}return b.ActionsMap&&a.Navigation.OnLinkClick(a=>{let c=b.ActionsMap[a.Id];c&&(a.Cancel=!c({...a,...e||{}}))}),a.OnHasMember("OnDataChanged",()=>{a.OnDataChanged(()=>(0,B.a)(A.a,{name:"SuiteNav.RefreshCacheForShellDataChanged"},()=>this.loadData(!0)).done())}),i&&j&&this._addFeedbackButton(a),f&&f.pageRenderingIsComplete(),!0},a=>(z.a.logData({name:"SuiteNavProvider.LoadDataError"}),!1))}_getSuiteNavShell(a,b){this._loadModel().then(c=>{!this._cssLoaded&&c.cssUrl&&(y.loadStylesheet(c.cssUrl),this._dataSource.onCssLoad&&this._dataSource.onCssLoad(c),this._cssLoaded=!0),this._requestShellCore(c.jsUrl,b,R).then(b=>{a.complete(b)},b=>{this._modelPromise=void 0,(b=H({error:b}))&&"LoadScriptError"===b.resultCode&&this._isDataFromCache?(z.a.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),this._clearCache(),this._getSuiteNavShell(a)):this._hasRetriedShell?a.error(b):(this._hasRetriedShell=!0,this._cssLoaded=!1,z.a.logData({name:"SuiteNavProvider.O365ShellRetry"}),this._getSuiteNavShell(a,!0))})})}_isODb(){return this._pageContext&&void 0!==this._pageContext.listBaseTemplate&&!q.a.isActivated("5488D0DA-5FA4-41EF-95EE-032C1D85ACFF")?this._pageContext.listBaseTemplate===J.a.mySiteDocumentLibrary:v.a}_loadModel(a){let b,c,d;if(!a&&this._modelPromise)return this._modelPromise;let e=new f.a,g=this._capabilities.supportsCaching,h=this._dataSource,i=A.b.Failure,j=(0,B.a)(A.a,{name:"SuiteNavProvider.LoadData"},()=>new u.c((c,d)=>{let e;if(!a&&g&&this._isCacheValid()&&(e=this._cache.getValue(this._cacheDataKey)),e&&e.data){let a=new A.a({name:"SuiteNavProvider.GetCachedData"});h.updateDataForCurrentPage&&(e.data=h.updateDataForCurrentPage(e.data)),g&&this._isCacheOutdated()&&h.loadData().then(a=>{this._updateCache(a)}),N||(0,K.b)(e.data,a,this._pageContext),this._isDataFromCache=!0,c(e)}else this._isDataFromCache=!1,h.loadData().done(a=>{let e;a?a.data?(g&&!((e=a&&a.data&&a.data.WorkloadLinks)&&e.some(a=>a&&!a.Url))&&this._updateCache(a),c(a)):(b="NoModelData",d("Model with no data returned")):(b="NoModel",d("No model returned"))},a=>{u.c.isCanceled(d)?(b="Canceled",i=A.b.ExpectedFailure):b="ServerLoadFailure",d(a)})}),null,a=>(u.c.isCanceled(a)&&(i=A.b.ExpectedFailure,b="Canceled"),{resultType:i,resultCode:b||"Other",error:a}));return(d=window._spPageContextInfo,c=(0,r.a)({webThemeProvider:()=>new s.a({pageContext:d,getThemeDataSource:()=>u.c.resolve(new t.default(d))})},d))?this._modelPromise=u.c.all({suiteNavModel:j,theme:c.loadThemeSlotsMap()}).then(a=>{let{suiteNavModel:b,theme:c}=a,d=b&&b.data,e=b&&b.hasCobranding,f=d&&d.UseSPOBehaviors,g=p.a.isFeatureEnabled(L),h=c&&c.suiteBarBackground;return h&&d&&f&&(!e||!g)&&(d.ThemeColors=[h,c.primaryText,h,c.suiteBarText,c.suiteBarDisabledText,c.topBarBackground,c.topBarText,c.topBarHoverText,c.primaryBackground,c.themeLighterAlt,c.dialogBorder]),b}):this._modelPromise=j,this._modelPromise.then(a=>e.complete(a),a=>e.error(a)),e.getPromise()}_isFeedbackButtonEnabled(){return p.a.isFeatureEnabled({ODB:this._isODb()?60887:1246,ODC:!1,Fallback:!1})}_shouldAddFeedbackButton(a){let b=!1;if(this._isFeedbackButtonEnabled()){let a=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():m.b.invalid;b=a!==m.b.mySiteHost&&!v.b&&a!==m.b.tenantAdmin||/\/_layouts\/15\/Lists.aspx$/i.test(window.location.pathname)}return!b&&this._isStreamAspx()&&(b=p.a.isFeatureEnabled({ODB:1246,ODC:!1,Fallback:!1})),!q.a.isActivated("75697801-be84-49ba-8965-a7f46603d722","08/13/2025","Never add feedback button for accessdenied.aspx")&&/\/_layouts\/15\/accessdenied.aspx$/i.test(window.location.pathname)&&(b=!1),!q.a.isActivated("a1dc3b5f-8668-4cdf-afdf-57bdc0194b53","06/13/2023","Always add feedback button for videoeditor.aspx")&&!b&&/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&!v.b&&(b=!0),b}_isStreamAspx(){return q.a.isActivated("1da070f4-d176-43bf-a6db-6b00339b819b","02/07/2024","Check stream path from serverRequestPath")?/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname):/\/stream\.aspx/i.test(this._pageContext?.serverRequestPath??"")}_isVideoEditorAspx(){return!!(!q.a.isActivated("a1dc3b5f-8668-4cdf-afdf-57bdc0194b53","06/13/2023","Always add feedback button for videoeditor.aspx")&&/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname))}_isVideoHubAspx(){return!!(P&&/\/_layouts\/15\/videohub.aspx$/i.test(window.location.pathname))}_addFeedbackButton(a){let b="GiveFeedbackButton",c="Feedback",d=()=>{a.FlexPane?.CloseFlexPaneForProvider(c),o.a.raise(document.body,"resize",void 0,!0),O||document.getElementById(b)?.focus()},f=()=>{a.NFD&&a.NFD.OnFeedbackMetadataRequested((a,b)=>a=this._dataSource.setFeedbackMetadata(a,b)),a.FlexPane&&(a.FlexPane.OpenFlexPaneForProvider(c),o.a.raise(document.body,"resize",void 0,!0)),a.Extensibility?.UpdateButtonState(b,!0)},g=this._isMultipleFontFacesKsActivated?"FabricMDL2Icons":"FabricMDL2Icons, Fluent MDL2 Hybrid Icons";q.a.isActivated("4dcd117e-f86f-4bbe-bef1-3afc60df78f7","03/02/2022","Load Feedback icon before using it")?a.Extensibility?.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:i.a,ariaLabel:i.a,iconFontFamily:g,iconFontName:"",id:b,onShow:f,onHide:d}):a.Extensibility&&((0,e.y)("Feedback"),a.Extensibility.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:i.a,ariaLabel:i.a,iconFontFamily:g,iconFontName:"",id:b,onShow:f,onHide:d}))}_clearCache(){this._cache.remove(this._cacheDataKey),this._cache.remove(this._cacheThemeDataKey),this._cache.remove(this._cacheDateKey),this._cache.remove(this._cacheVersionKey),this._cache.remove(this._cacheSessionKey,h.a.session)}_updateCache(a,b){(this._stopCachingGuestModeNavDataKSActivated||!this._isGuestModeNavData(a.data))&&(this._cache.setValue(this._cacheDataKey,a),this._cache.setValue(this._cacheDateKey,new Date),this._cache.setValue(this._cacheVersionKey,this._cacheVersion),this._cache.setValue(this._cacheSessionKey,!0,h.a.session))}_isCacheOutdated(){let a=this._cache.getValue(this._cacheSessionKey,h.a.session),b=Date.parse(this._cache.getValue(this._cacheDateKey));return g.a.hasStorageType(h.a.session)&&!a||Date.now()-b>=60*this._cacheRenew*6e4}constructor(a,b){super({engagementEvent:z.a,qosEvents:{"SuiteNavProvider.GetO365Shell":new A.a({name:"SuiteNavProvider.GetO365Shell"})}},b),this._dataSource=b.dataSource,this._cssLoaded=!1,this._isSuiteNavBootstrapperLoadingFlowEnabled=p.a.isFeatureEnabled(M),this._isMultipleFontFacesKsActivated=q.a.isActivated("7635e24c-97e6-4c2c-acd1-a141c2374dfa","1/08/2024","Use multiple font faces to load Feedback icon for in-place navigation scenario")}}function R(){let a=window._o365su;if(a&&a.b)for(let b of["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"])!function(a,b){let c=a[b];"function"==typeof c&&(a[b]=function(...a){try{return c.apply(this,a)}catch(a){l.logData({message:a&&a.message||"",stack:a&&a.stack||"",type:b})}})}(a.b,b)}}
,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(457),e=class{constructor(a,b){this.width=0,this.height=0,this.width=a,this.height=b}};class f{clip(a){let b=new f(this);return b.x<a.x&&(b.width-=a.x-b.x,b.x=a.x),b.getRight()>a.getRight()&&(b.width-=b.getRight()-a.getRight()),b.y<a.y&&(b.height-=a.y-b.y,b.y=a.y),b.getBottom()>a.getBottom()&&(b.height-=b.getBottom()-a.getBottom()),b}contains(a){if(a instanceof d.a)return a.x>=this.x&&a.y>=this.y&&a.x<=this.getRight()&&a.y<=this.getBottom();{let b=a.getPoint(),c=new d.a(a.getRight(),a.getBottom());return this.contains(b)&&this.contains(c)}}getCenter(){return new d.a(this.x+this.width/2,this.y+this.height/2)}getLeft(){return this.x}getTop(){return this.y}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}getPoint(){return new d.a(this.x,this.y)}getSize(){return new e(this.width,this.height)}inflate(a,b){let c,d;return"object"==typeof a?(c=a.width,d=a.height):(c=a,d=b),new f(this.x-c/2,this.y-d/2,this.width+c,this.height+d)}nudge(a){let b=new f(this);return b.x<a.x?b.x=a.x:b.getRight()>a.getRight()&&(b.x=a.getRight()-b.width),b.y<a.y?b.y=a.y:b.getBottom()>a.getBottom()&&(b.y=a.getBottom()-b.height),b}translate(a,b){return a instanceof d.a?this.translate(a.x,a.y):new f(this.x+a,this.y+b,this.width,this.height)}union(a){let b=Math.min(this.x,a.x),c=Math.min(this.y,a.y);return new f(b,c,Math.max(this.x+this.width,a.x+a.width)-b,Math.max(this.y+this.height,a.y+a.height)-c)}fit(a,b){let c=a;c=this.width&&this.height&&(b?this.width>c.width||this.height>c.height:this.width>c.width&&this.height>c.height)?this._scaleTo(a,b):this;let d=(a.width-c.width)/2,e=(a.height-c.height)/2;return new f(d+this.x,e+this.y,c.width,c.height)}_scaleTo(a,b){let c=a.width/a.height,d=this.width/this.height,e=0,g=0;return(b?d:c)<(b?c:d)?(g=a.height,e=d*a.height):(e=a.width,g=a.width/d),new f(this.x,this.y,e,g)}constructor(a,b,c,e){this.x=0,this.y=0,this.width=0,this.height=0,0==arguments.length?(this.x=0,this.y=0,this.width=0,this.height=0):a instanceof f?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):a instanceof d.a?(this.x=a.x,this.y=a.y,this.width=b.width,this.height=b.height):"object"==typeof a&&"number"==typeof a.left&&"number"==typeof a.top&&"number"==typeof a.width&&"number"==typeof a.height?(this.x=a.left,this.y=a.top,this.width=a.width,this.height=a.height):(this.x=a,this.y=b,this.width=c,this.height=e)}}var g=f}
,function(a,b,c){class d{static areEqual(a,b,c=1e-6){return Math.abs(a.x-b.x)<c&&Math.abs(a.y-b.y)<c}static getCenter(a){return a.reduce((a,b)=>a.add(b),d.ORIGIN).scale(1/a.length)}scale(a){return new d(this.x*a,this.y*a)}add(a){return new d(this.x+a.x,this.y+a.y)}subtract(a){return new d(this.x-a.x,this.y-a.y)}distance(a){let b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)}negate(){return new d(-this.x,-this.y)}abs(){return Math.sqrt(this.x*this.x+this.y*this.y)}unit(){let a=this.abs();return this.scale(a&&1/a||0)}toString(){return`[Point ${this.x}, ${this.y}]`}constructor(a=0,b=0){a instanceof d?(this.x=a.x,this.y=a.y):(this.x=a,this.y=b)}}d.ORIGIN=new d,b.a=d}
,function(a,b,c){var d=c(59),e=c(171);let f={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},g={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0};class h{static reduceBreakpoints(a,b){return{Small:b,Medium:a.Small,Large:a.Medium,XLarge:a.Large,XXLarge:a.XLarge,XXXLarge:a.XXLarge,XXXXLarge:1/0}}static determineWindowSize(a,b=g){if(0===a)return"Medium";for(let c in g)if(a<b[c])return c}static determineCssClass(a){return f[a]}static getScrollbarWidth(){let a=document.createElement("div"),b=document.createElement("div"),c=a.style;c.visibility="hidden",c.width="100px",c.msOverflowStyle="scrollbar",c.overflow="scroll",b.style.width="100%",document.body.appendChild(a),a.appendChild(b);let d=a.offsetWidth,e=b.offsetWidth;a.parentNode.removeChild(a);let f=d-e;return this.getScrollbarWidth=()=>f,f}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get formFactorSize(){return this._formFactorSize}get isHamburgerVisible(){return this._isHamburgerVisible}get showLabels(){return this._showLabels}get cssClass(){return this._cssClass}dispose(){this._scope.dispose()}compareSize(a,b){let c=this._breakpoints();return c[a]-c[b]}_afterContainerResize(){}_onContainerResize(){let{body:a,documentElement:b}=document,c=this._windowHeight=b.clientWidth||a.clientWidth;this._windowWidth=b.clientHeight||a.clientHeight;let d=this._formFactorSize,e=this._formFactorSize=h.determineWindowSize(c,this._breakpoints());this._cssClass=h.determineCssClass(e);let f=this._isHamburgerVisible;this._isHamburgerVisible=c<g.Large;let i=this._showLabels;this._showLabels=this.compareSize(e,"Medium")>0,d&&e!==d&&this._events.raise("formFactorChange"),"boolean"==typeof f&&f!==this._isHamburgerVisible&&this._events.raise("hamburgerVisibilityChange"),"boolean"==typeof i&&i!==this._showLabels&&this._events.raise("showCommandLabelsChange"),this._afterContainerResize()}constructor(a,b){this._scope=new e.a,this._events=new(this._scope.attached(d.a))(this),this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));const c=b.breakpoints;this._breakpoints="function"==typeof c?c:()=>c,this._windowWidth=0,this._windowHeight=0,this._onContainerResize()}}h.DEFAULT_BREAKPOINTS=g,h.MAC_SCROLL_BAR_WIDTH=8,b.a=h}
,,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.TooManyChildItemsWithUniqueScopes=-13]="TooManyChildItemsWithUniqueScopes",e[e.ExternalInvitationFailed=-40]="ExternalInvitationFailed",e[e.SharingToBlockedUserOnODB=-62]="SharingToBlockedUserOnODB",e[e.SharingToBlockedBySiteRAC=-84]="SharingToBlockedBySiteRAC",e[e.SharingToBlockedBySiteRACMSGraphThrottled=-87]="SharingToBlockedBySiteRACMSGraphThrottled"}
,function(a,b,c){let d;c.d(b,{a:function(){return d}});var e=c(462);d=c(0).a.isActivated("48EB9785-D133-4AF9-A10B-77DDBF104C80")?e.a:function(a,b={}){let c=document.createElement("style");c.setAttribute("data-merge-styles","true");let d=document.createElement("style");return d.setAttribute("data-make-styles-placeholder",""),document.head.insertAdjacentElement("afterbegin",c),document.head.insertAdjacentElement("afterbegin",d),b.insertionPoint||(b.insertionPoint=d),(0,e.a)(a,b)}}
,,,,,,,function(a,b,c){let d,e;c.d(b,{a:function(){return bO}});var f,g,h=c(10);(0,h.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:active){.od-Share.not-IE{border:3px solid}}.od-Share{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';border-radius:2px;min-height:130px}.od-Share.od-SimplifiedShare{border-radius:8px;min-height:inherit}.od-Share.animation{transition:height .2s cubic-bezier(.33, 0, .1, 1)}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Share.od-Share--permissionsPivot{overflow:unset!important}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"linkHovered",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:'}.od-Share .od-Share-noFocusBorder:focus{outline:0;border:none}.od-Share .ms-Button--default{outline:transparent;position:relative}.od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button--default:focus:after,.od-Share .ms-Button--default[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after,.od-Share .ms-Button[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b;color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c;color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939;color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e;color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}.od-Share .ms-Spinner{position:absolute;top:50%;left:50%}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share .ms-Button{overflow:visible}}#od-Share-backButton-tooltip{position:relative}button.od-Share-backButton{z-index:1;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:relative;left:inherit}button.od-Share-backButton#od-ShareToTeams-backButton{top:-40px}[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}button.od-Share-backButton.absolute{position:absolute;top:8px}[dir=ltr] button.od-Share-backButton.absolute{left:8px}[dir=rtl] button.od-Share-backButton.absolute{right:8px}button.od-Share-backButton.priorView{top:14px}[dir=ltr] button.od-Share-backButton.priorView{left:16px}[dir=rtl] button.od-Share-backButton.priorView{right:16px}.od-Share-shareMainDiv{position:relative;overflow:hidden auto}.od-Share-spinnerHolder{align-items:center;display:flex;height:130px;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary.is-disabled{border:none}.SendLink-statusIconItem{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .SendLink-statusIconItem{margin-left:4px}[dir=rtl] .SendLink-statusIconItem{margin-right:4px}[dir=ltr] .SendLink-statusIconItem{margin-right:4px}[dir=rtl] .SendLink-statusIconItem{margin-left:4px}.SendLink-statusIconItem .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconItem .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.SendLink-statusIconTooltip{font-size:.875rem}.SendLink-statusIcon{font-size:.625rem;width:2.75px;height:2.75px}.blockDownloadSVG{width:1.125rem;height:1.125rem}"}]);var i=c(37),j=c(118),k=c(45),l=c(32),m=c(46),n=c(85),o=c(86),p=c(319),q=c(36),r=c(469),s=c(105),t=c(106),u=c(63),v=c(12),w=c("react-lib"),x=c("prop-types-lib"),y=c(150),z=c(82),A=c(47),B=c(311),C=c(356),D=c(64),E=c(26),F=c(20),G=c(337),H=c(74),I=c(59),J=c(2),K=c(112),L=c(640),M=c(50),N=c(214),O=c(16),P=c(92),Q=c(207),R=c(34),S=c(101),T=c(358),U=c(359),V=c(151),W=c(360),X=c(159),Y=c(322),Z=c(426),$=c(357),_=c(213);class aa extends w.Component{render(){let{sharingInformation:a,viewState:b,clientId:c,companyName:d,currentSettings:e,onShareHintClick:f,customLabeledAudienceConfig:g,displayUrl:h}=this.props;switch(b){case $.a.linkSuccess:return this._initialLinkShown||(this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.r(this._shareClickTime,this.props.clientId,i.a.copy,this.props.scenarioId,this.props.correlationId),this._initialLinkShown=!0),w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.m,{...(0,T.a)(this.props),shareType:j.a.copy,itemName:a.item.name,linkUrl:h,sharingHintProps:{clientId:c,companyName:d,currentSettings:e,sharingInformation:a,onShareHintClick:f,linkRecipients:null,customLabeledAudienceConfig:g},shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this.props.engagementExtraData,onRenderComplete:this.props.onShareNotificationRenderComplete,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId}));case $.a.modifyPermissions:return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.i,{...this.props,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,showExistingAccessOption:!0,copyLinkShortcut:!0,onSelectedPeopleChange:()=>{},renderBackButton:!0}));default:return w.createElement("div",{className:"od-Share-spinnerHolder"},w.createElement(s.a,{className:"od-Share-spinner",label:F.Gb,type:t.b.large}))}}constructor(a,b){super(a),this._initialLinkShown=!1,this._onLinkSettingsCancelClick=()=>{this.setState({shouldCopyLinkToClipboard:!1},()=>{this.props.onLinkPermissionsCancelClicked()})},this._onLinkSettingsApplyClicked=a=>{this.setState({shouldCopyLinkToClipboard:!0},()=>{this.props.onLinkPermissionsApplyClicked(a)})},this._shareClickTime=b.shareClickTime,this._sharingClientMessenger=b.sharingClientMessenger,this.state={shouldCopyLinkToClipboard:!0}}}aa.contextTypes={shareClickTime:x.number,sharingClientMessenger:x.object.isRequired};var ab=c(179),ac=c(56),ad=c(154),ae=c(538),af=c(18);(0,h.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.ShareMain{display:flex;flex-direction:column;padding:24px}@media screen and (max-width:511px){.ShareMain{padding:16px}}.ShareMain-flex-row{width:100%;display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;gap:12px}.ShareMain-flex-row.space-between{justify-content:space-between}.ShareMain-flex-grow{display:flex;flex-grow:1}.ShareMain-flex-grow.flex-start{justify-content:flex-start}.ShareMain-action-footer{display:flex;flex-direction:row}.ShareMain-action-footer.flex-end{justify-content:flex-end;flex-wrap:wrap;row-gap:1.25rem}@supports (font:-apple-system-body){.ShareMain-action-footer button{height:auto;padding:8px}}.ShareMain-sharedWithSection{width:50%}@media screen and (max-width:375px){.ShareMain-sharedWithSection{width:40%}}@media screen and (max-width:360px){.ShareMain-sharedWithSection{width:30%}}.ShareMain-notShared i{font-size:.9375rem;height:1.625rem;width:1.625rem;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:50%;text-align:center;color:#707070;line-height:1.625rem;cursor:pointer}.ShareMain-notShared-button:active,.ShareMain-notShared-button:hover{background-color:transparent!important}.ShareMain-notShared-button:focus{outline:unset!important}.ms-ContextualMenu-linkContent i{display:inline-flex}@supports (font:-apple-system-body){.ms-ContextualMenu-linkContent{font:-apple-system-body}}.ShareMain-button i{font-size:.875rem}.ms-Tooltip-subtext{font-size:.75rem}.ShareMain-header{padding-bottom:10px}.SimplifiedShareTargets.ie .ms-ContextualMenu-linkContent i{display:inline}.SimplifiedShareTargets.icon-width img{width:100%}.ShareMain-requiresAccessApproval{margin-bottom:12px;border-radius:4px}.ShareMain-helpMenu .ShareMain-contextualMenu-link,.ShareMain-helpMenu .ms-ContextualMenu-link{display:flex;outline:transparent;position:relative;font-size:.875rem;font-weight:400;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border:none;width:100%;height:36px;line-height:36px;display:block;cursor:pointer;padding:0 8px 0 4px;text-align:left}.ShareMain-helpMenu .ShareMain-contextualMenu-link span,.ShareMain-helpMenu .ms-ContextualMenu-link span{display:inherit}.ShareMain-helpMenu .ShareMain-contextualMenu-link:hover,.ShareMain-helpMenu .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.ShareMain-helpMenu .ShareMain-contextualMenu-link .ShareMain-contextualMenu-linkContent,.ShareMain-helpMenu .ms-ContextualMenu-link .ShareMain-contextualMenu-linkContent{white-space:nowrap;height:inherit;display:flex;align-items:center;max-width:100%;padding:0 8px 0 4px}@supports (font:-apple-system-body){.ShareMain-helpMenu .ShareMain-contextualMenu-link .ShareMain-contextualMenu-linkContent,.ShareMain-helpMenu .ms-ContextualMenu-link .ShareMain-contextualMenu-linkContent{font:-apple-system-body}}.ShareMain-badge{margin-left:10px;align-self:center;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:';display:inline-flex;align-items:center;justify-content:center;position:relative;font-size:.625rem;height:8px;padding:3px 6px;border-radius:20px}.ShareMain-firstTimeUserMarker{background-color:#d13438;position:absolute;height:4px;width:4px;border-radius:20px;right:64px;top:32px;z-index:2}.ShareMain-copy-button-container{display:flex;flex-direction:"row";height:100%}'}]);var ag=c(49),ah=c(119),ai=c(39),aj=c(208),ak=c(3),al=c(286),am=c(342),an=c(193),ao=c(209);(0,h.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.SendLink-flex-column{display:flex;flex-direction:column;width:100%}.SendLink-flex-row{display:flex;flex-direction:row;width:100%}.SendLink-container{display:flex;flex-direction:column}.SendLink-container.odcSummary{padding-bottom:20px}.SendLink-messageBox-container{position:relative;padding-top:12px}.SendLink-messageBox{display:flex;flex-direction:row;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"!important;border-bottom:unset!important;border-radius:4px!important}.SendLink-messageBox.error{border:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"!important;border-bottom:unset!important}.SendLink-messageBox-textfield{width:100%}.SendLink-messageBox-textfield .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}.SendLink-messageBox-textfield .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.SendLink-messageBox-textfield .ms-TextField-field:-ms-input-placeholder{font:-apple-system-body}.SendLink-messageBox-textfield .ms-TextField-field::placeholder{font:-apple-system-body}}.SendLink-field{font-size:.875rem!important;padding:10px 8px 6px 8px!important}@supports (font:-apple-system-body){.SendLink-field{font:-apple-system-body}}.SendLink-fieldGroup{height:105px!important;overflow:hidden!important;border:none!important;border-radius:4px;background-color:transparent}.SendLink-fieldGroup:after{border:none!important}.SendLink-people-picker{max-height:126px;overflow-x:hidden;overflow-y:auto;display:flex;flex-direction:column-reverse;flex-grow:1}.SendLink-permissions-button-container{display:flex}.SendLink-permissions-button:hover{background-color:transparent}.SendLink-relative{position:relative;width:100%}.SendLink-border{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px;box-sizing:border-box;position:relative;width:100%}.SendLink-border.error{border:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-to{font-size:.875rem;font-weight:600;padding:12px 6px 12px 12px;white-space:nowrap;display:flex}[dir=rtl] .SendLink-to{padding:12px 12px 12px 6px}@supports (font:-apple-system-body){.SendLink-to{font:-apple-system-body}}.SendLink-to .SendLink-to-icon{font-size:.75rem}[dir=ltr] .SendLink-to .SendLink-to-icon{padding-right:4px}[dir=rtl] .SendLink-to .SendLink-to-icon{padding-left:4px}[dir=ltr] .SendLink-to .SendLink-to-icon{padding-left:1px}[dir=rtl] .SendLink-to .SendLink-to-icon{padding-right:1px}@supports (font:-apple-system-footnote){.SendLink-to .SendLink-to-icon{font:-apple-system-footnote}}.SendLink-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;flex-grow:1}@supports (font:-apple-system-body){.SendLink-label{font:-apple-system-body}}.SendLink-label:focus-visible{outline:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}.SendLink-label.padding{padding-right:12px}.SendLink-animation{box-sizing:border-box;border-bottom-left-radius:200px;border-bottom-right-radius:200px;border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-sizing:border-box;clip-path:inset(calc(100% - 2px) 0px 0px);animation-name:animate-underline;animation-duration:.25s;width:100%;position:absolute;height:4px;z-index:1;bottom:0}@keyframes animate-underline{from{transform:scaleX(0)}to{transform:scaleX(1);transition-property:transform;transition-duration:.2s;transition-delay:cubic-bezier(0.1, 0.9, 0.2, 1)}}.SendLink-underline{box-sizing:border-box;border-bottom:1px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";border-bottom-left-radius:200px;border-bottom-right-radius:200px;box-sizing:border-box;clip-path:inset(calc(100% - 2px) 0px 0px);width:100%;position:absolute;height:4px;bottom:0}.SendLink-underline.error{border-bottom:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-underline.focused{border-bottom:2px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.SendLink-roleSelector-divider{display:flex;background-color:#d1d1d1;width:1px;margin-top:3px;margin-bottom:3px}.SendLink-primary{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.SendLink-max-height{max-height:126px}.SendLink-characterCount{margin-top:6px;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.SendLink-characterCount.error{color:"},{theme:"errorText",defaultValue:"#a4262c"},{rawString:"}.SendLink-label-and-count-container{display:flex;flex-direction:row;height:28px}.SendLink-label-and-count-container.v2{padding-bottom:6px}.aiDisclaimerRowV1{display:flex;align-items:center;flex-wrap:wrap;gap:8px}.SendLink-aiDisclaimer-and-label{display:block}.SendLink-aiDisclaimer{display:inline-flex;align-items:center;font-size:.75rem;padding-top:6px}.SendLink-aiDisclaimer.v2{height:19px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";max-width:300px}[dir=ltr] .SendLink-aiDisclaimer.v2{margin-left:14px}[dir=rtl] .SendLink-aiDisclaimer.v2{margin-right:14px}[dir=ltr] .SendLink-aiDisclaimer.v2{padding-right:8px}[dir=rtl] .SendLink-aiDisclaimer.v2{padding-left:8px}.aiDisclaimer-successIcon{margin-top:3px}[dir=ltr] .aiDisclaimer-successIcon{padding-right:8px}[dir=rtl] .aiDisclaimer-successIcon{padding-left:8px}.SendLink-messageBox-summaryButtonArea{position:absolute;width:32px;bottom:14px}[dir=ltr] .SendLink-messageBox-summaryButtonArea{right:0}[dir=rtl] .SendLink-messageBox-summaryButtonArea{left:0}[dir=ltr] .SendLink-messageBox-summaryButtonArea{margin-right:5px}[dir=rtl] .SendLink-messageBox-summaryButtonArea{margin-left:5px}.SendLink-message-icon{font-size:.875rem;padding:13px 0 0 13px}@supports (font:-apple-system-body){.SendLink-message-icon{font:-apple-system-body}}[dir=rtl] .SendLink-message-icon{padding:13px 13px 0 0}.SendLink-characterContainer{height:19px}.SendLink-characterContainer.hidden{visibility:hidden}.SendLink-characterContainer.visible{visibility:visible;padding-bottom:3px;margin-inline-start:auto}.SendLink-permissionsLabelButton{height:100%;text-align:left;padding:6px 0}.SendLink-permissionsLabelButton:hover{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"!important}#permissionsLabelButton:hover #permissionsLabel{text-decoration:underline!important}.SendLink-permissionsLabelContainer{display:flex;flex-direction:row;align-items:center}.SendLink-permissionsLabel{font-size:.875rem}@supports (font:-apple-system-body){.SendLink-permissionsLabel{font:-apple-system-body}}.SendLink-statusIcons{display:flex;align-items:center;height:100%}.SendLink-permissionsLabelContainer{display:flex;flex-direction:row}"}]);var ap=c(320),aq=c(338),ar=c(321),as=c(539);(f=g||(g={})).success="success",f.error="error",f.inProgress="inProgress",f.closed="closed";let at=w.lazy(()=>c.e(35).then(c.bind(c,614))),au=w.lazy(()=>Promise.all([c.e("ondemand.resx"),c.e(34)]).then(c.bind(c,615)));function av({clientId:a,copyMessageBarStatus:b,currentSettings:c,engagementExtraData:d,errorMessage:e,linkRecipients:f,messageText:h,summaryState:j,oversharingExternalsWarning:k,oversharingGroupsWarning:l,permissionsMap:m,permissionsLabel:n,shareTargetClicked:o,sharingInformation:p,sharingByCopyIsDisabled:q,sharingBySendIsDisabled:r,showExternalSharingConfirmationDialog:s,warningMessages:t,handlerForOnLinkSettingsClicked:x,onInputChange:y,onRoleChange:z,onSelectedPeopleChange:A,onSendLinkMessageChange:B,getStatusIcons:C,generateSummary:D,updateSummaryData:G,onSendLinkSummaryStateChange:H},{sharingStore:I,platformDetection:J}){let L=(0,E.ab)(a,I),[M,N]=w.useState(!1),[Q,R]=w.useState(!1),[S,T]=w.useState("auto"),U=w.useRef(null),[V,W]=w.useState(""),[X,Y]=w.useState(""),[Z,$]=w.useState(as.c.CatchAll),[_,aa]=w.useState(),[ab,ac]=w.useState(),ad=w.useRef(null),[ae,af]=w.useState(!1),[ag,ah]=w.useState(!1),ai=w.useRef(null),ak=w.useRef(null);w.useEffect(()=>{if(!D){let a=I.getCopilotHelper().getCopilotSummaryDisabledReasonsMask();I.getEngagementHelper().summarizationDisabledReasonsMask(d,a);let b=I.getCopilotHelper().getCopilotSummaryV2Candidate(),c=I.getCopilotHelper().getCopilotSummaryV2Encrypted();void 0!==b&&void 0!==c&&I.getEngagementHelper().summarizationV2Candidate(d,b,c)}I.getEngagementHelper().summarizationEnabled(d,D?"enabled":"disabled"),I.getEngagementHelper().summarizationCopilotEnabled(d,I.getCopilotHelper().getIsCopilotEnabled())},[]);let al=w.useCallback(a=>{I.getEngagementHelper().summarizationFeedback(d,a)},[d,I]);w.useEffect(()=>{j===as.d.Succeeded?(G(X),B(h?h+"\n"+X:X),aw=1e3,(ae||M)&&ad.current&&!M&&ad.current.focus()):aw=500},[j]),w.useEffect(()=>{(!h||h.length<=1)&&j===as.d.Succeeded&&(I.getEngagementHelper().deletedSummary(d),H(as.d.Default),G("")),V&&h.length===V.length&&(j===as.d.Succeeded&&(H(as.d.Default),I.getEngagementHelper().deletedSummary(d)),W(""))},[h]);let ao=()=>{if(O.bb()){let a=I.getCopilotHelper().getAppData(),b=I.getCopilotHelper().getContextData(),c=I.getCopilotHelper().getCopilotFeedbackProps();return c?[c={...c,appData:a},{contextData:{cardMetaData:JSON.stringify({appData:a,contextData:b})}}]:[null,null]}return[null,null]},av=w.useRef(null),aK=a=>{av.current=a};w.useEffect(()=>()=>{av.current&&av.current.dispose()},[]);let aL=()=>{if(!O.bb()){let a=I.getCopilotHelper().getAppData(),b=I.getCopilotHelper().getContextData(),c=I.getCopilotHelper().getCopilotFeedbackProps();ac(c={...c,appData:a}),aa({contextData:{cardMetaData:JSON.stringify({appData:a,contextData:b})}})}};w.useEffect(()=>{e&&R(!0)},[e]);let aM=(0,aj.a)(a=>aD(a,I,d)),aN=(0,aj.a)(a=>O.Sb()?"":az(B,a)),aO=(0,aj.a)(a=>{W(a.clipboardData.getData("text"))}),aP=!e,aQ=q&&r,aR=w.useMemo(()=>aG(aQ,aP,e),[aQ,aP,e]),aS=w.useMemo(()=>aH(aQ,aP,e),[aQ,aP,e]),aT=w.useMemo(()=>(0,E.s)(h),[h]),aU=w.useMemo(()=>aF(p),[p]),aV=w.useMemo(()=>s!==E.c.seeing&&!(L&&aU&&b===g.error)&&aE(e,aU,t),[e,t,f,k,l,p,s]),aW=!M&&aT>aw,aX=()=>{let a=O.bb(),b=a?ai.current:ab,c=a?ak.current:_;return b&&c?w.createElement(w.Suspense,{fallback:null},w.createElement(au,{copilotFeedbackProps:b,feedbackData:c,onClickFeedback:al,...a?{handleFeedbackSetup:aK}:{}})):null};return w.createElement("div",{className:`SendLink-container ${!L&&(j===as.d.Succeeded||j===as.d.Failed?"odcSummary":"")}`},(()=>{if(X){if(M)return(0,K.a)(X,"assertive","status");if(!ag)return(0,K.a)(F.Tk,"assertive","status")}})(),w.createElement("div",{ref:U,className:`SendLink-flex-column SendLink-relative SendLink-max-height ${Q&&"focused"}`,style:{height:J.isIE&&S,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},w.createElement("div",{className:`SendLink-flex-row SendLink-border ${aR} SendLink-max-height`,style:{height:J.isIE&&S,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},w.createElement("div",{className:"SendLink-to"},w.createElement(u.a,{content:`${F.s}.`},w.createElement(an.a,{"aria-label":F.s,iconName:"Contact",className:"SendLink-to-icon"}))),w.createElement("div",{className:`SendLink-people-picker ${J.isIE&&" IE"} SendLink-max-height`,style:{height:J.isIE&&S,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},w.createElement(ap.a,{allowSPGroups:L,clientId:a,defaultSelectedItems:f,disableGraph:I.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:0===f.length?F.s:F.u,oversharingExternalsWarning:k,oversharingGroupsWarning:l,peoplePickerRef:U,permissionsMap:m,pickerSettings:p.peoplePickerSettings,sharingInformation:p,sharingLinkKind:c.sharingLinkKind,onChange:A,onInputChange:y||null,onResolvedSuggestions:aM,setPeoplePickerFocused:R,error:e,mode:i.a.share,setHeight:T,height:S,shareTargetClicked:o,focusPeoplePicker:Q})),ay(c,a,I)&&w.createElement(w.Fragment,null,w.createElement("div",{className:"SendLink-roleSelector-divider"}),w.createElement("div",{className:"SendLink-permissions-button-container",id:"SendLink-roleSelectorCompact"},w.createElement(aq.a,{menuPermissionOptions:L?aA(c,a,p,I):aB(a,I,p,c,I.isPreventDownloadAllowed&&I.isPreventDownloadAllowed()),sharingRole:c.sharingRole,mode:i.a.share,clientId:a,onRoleChange:z,roleSelectorAs:aq.a,disabled:P.c()&&p.requiresAccessApproval,ariaLabel:O.Rb()?void 0:F.w})))),w.createElement(aI,{focused:Q,color:aR,error:!!e})),w.createElement("span",{role:"alert","aria-live":"assertive"},L&&p.requiresAccessApproval&&!P.c()&&w.createElement(ar.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon",messages:[{error:w.createElement("span",null,F.Di)}],iconName:"InfoSolid",textColorType:"info"}),aV&&w.createElement(ar.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon",messages:aV,iconName:aS,textColorType:aR})),w.createElement("div",{className:"SendLink-messageBox-container"},w.createElement("div",{className:`SendLink-messageBox ${aW&&"error"}`},w.createElement("div",null,w.createElement(u.a,{content:`${F.Be}.`},w.createElement(an.a,{"aria-label":F.Be,iconName:"Handwriting",className:"SendLink-message-icon"}))),O.Sb()?w.createElement(am.a,{className:"SendLink-messageBox-textfield",multiline:!0,resizable:!1,placeholder:F.Be,value:h,onGetErrorMessage:aN,onChange:(a,b)=>{B(b),j===as.d.Succeeded&&""!==b&&I.getEngagementHelper().modifiedSummary(d)},styles:ax,onFocus:()=>{N(!0),X&&!ag&&ah(!0)},onBlur:()=>{M&&X&&!ag&&ah(!0),N(!1)},onPaste:aO,componentRef:ad}):w.createElement(am.a,{className:"SendLink-messageBox-textfield",multiline:!0,resizable:!1,placeholder:F.Be,defaultValue:h,onGetErrorMessage:aN,styles:ax,onFocus:()=>{N(!0)},onBlur:()=>N(!1)}),D&&w.createElement("div",{className:"SendLink-messageBox-summaryButtonArea"},w.createElement(w.Suspense,{fallback:null},w.createElement(at,{initiateGenerateSummary:()=>{X&&j===as.d.Default&&I.getEngagementHelper().summarizationClick(d,"cacheAdded"),D&&(j===as.d.Default?I.getEngagementHelper().summarizationClick(d,"initialClick"):j===as.d.Failed&&I.getEngagementHelper().summarizationClick(d,"retry"),H(as.d.InProgress),D().then(a=>{let[b,c]=ao();ai.current=b,ak.current=c;try{let{summary:b,fromCache:c,summaryType:e,isParroted:f}=JSON.parse(a);f?(H(as.d.Failed),$(as.c.DocumentLengthTooShort),aL(),I.getEngagementHelper().summarizationStatus({...d,summarizationError:as.c.DocumentLengthTooShort,augloopContextId:I.getCopilotHelper().getContextData()?.contextId,augloopSessionId:I.getCopilotHelper().getAppData()?.sessionId,fromCache:c},"failure")):(Y(b||""),H(as.d.Succeeded),aL(),I.getEngagementHelper().summarizationStatus({...d,augloopContextId:I.getCopilotHelper().getContextData()?.contextId,augloopSessionId:I.getCopilotHelper().getAppData()?.sessionId,summaryLength:b.length,fromCache:c,summaryType:e},"success"))}catch(b){let a=b instanceof Error?b.message:"string"==typeof b?b:JSON.stringify(b);H(as.d.Failed),aL(),I.getEngagementHelper().summarizationStatus({...d,augloopContextId:I.getCopilotHelper().getContextData()?.contextId,augloopSessionId:I.getCopilotHelper().getAppData()?.sessionId,summarizationError:`failed to use aiResult: ${a}`},"failure")}}).catch(a=>{let b,c,e,[f,g]=ao();ai.current=f,ak.current=g,H(as.d.Failed);let h=a?.message;try{let a=JSON.parse(h),d=JSON.parse(a?.error?.json)?.summaryResultStatus,f=a.queryId,{sessionId:g,fromCache:i}=a;$(d??as.c.CatchAll),h=d,b=i,c=g,e=f}catch(a){$(as.c.CatchAll)}aL(),I.getEngagementHelper().summarizationStatus({...d,summarizationError:h,augloopContextId:e??I.getCopilotHelper().getContextData()?.contextId,augloopSessionId:c??I.getCopilotHelper().getAppData()?.sessionId,fromCache:b},"failure")}))},summaryState:j,errorStatus:Z,showSimplifiedDialogV2:L,retryAvailable:j===as.d.Failed&&-1!==["Timeout","ResourceUnavailable","BlockedByQualityCheck","BlockedByPostfilter"].indexOf(Z),onFocusChange:a=>{af(a)}})))),w.createElement(aI,{focused:M,color:aW?"error":"primary",error:aW})),w.createElement("div",{className:`SendLink-label-and-count-container ${L&&"v2"}`},!L&&(j===as.d.Succeeded||j===as.d.Failed?w.createElement("div",{className:"SendLink-aiDisclaimer-and-label"},w.createElement("div",{className:"aiDisclaimerRowV1"},w.createElement("div",{className:"SendLink-aiDisclaimer"},w.createElement(v.a,{iconName:"Info",className:"aiDisclaimer-successIcon"}),j===as.d.Succeeded?F.Uk:F.Ak),aX()),w.createElement("div",{className:`SendLink-label ${aT>aw/2?"padding":""}`},aC(n,x,C))):w.createElement("div",{className:`SendLink-label ${aT>aw/2?"padding":""}`},aC(n,x,C))),L&&(j===as.d.Succeeded||j===as.d.Failed)&&w.createElement(w.Fragment,null,w.createElement("div",{className:`SendLink-aiDisclaimer ${L&&"v2 longerLanguage"}`,tabIndex:0,"aria-label":j===as.d.Succeeded?F.Uk:F.Ak,role:"note"},w.createElement(v.a,{iconName:"Info",className:"aiDisclaimer-successIcon"}),j===as.d.Succeeded?F.Uk:F.Ak),aX()),L?w.createElement(aJ,{messageLength:aT}):aT>aw/2&&w.createElement(aJ,{messageLength:aT})))}av.contextTypes={sharingStore:x.object.isRequired,platformDetection:x.object.isRequired};let aw=500,ax={fieldGroup:["SendLink-fieldGroup"],field:["SendLink-field"]},ay=(a,b,c)=>!!(0,E.ab)(b,c)||a.audience!==l.a.existing,az=(a,b)=>(a(b),""),aA=(a,b,c,d)=>{if(P.c()&&c.requiresAccessApproval){let e=d.getReShareLink(a.audience),f=a.sharingRole;return e&&(f=(0,E.K)(e,b,c)),(0,G.b)({role:f})}let e=d.getScenarioId&&d.getScenarioId(),f=d.isPreventDownloadAllowed&&d.isPreventDownloadAllowed();return(0,G.a)({audience:a.audience,sharingStore:d,clientId:b,sharingInformation:c,scenarioId:e,isPreventDownloadAllowed:f,shareMode:i.a.share})},aB=(a,b,c,d,e)=>(0,G.c)({clientId:a,sharingStore:b,sharingInformation:c,audience:d.audience,mode:i.a.share,isPreventDownloadAllowed:e}),aC=(a,b,c)=>w.createElement("div",{className:"SendLink-permissionsLabelContainer"},w.createElement(ao.a,{id:"permissionsLabelButton",className:"SendLink-permissionsLabelButton",onClick:b},w.createElement("div",{className:"SendLink-permissionsLabelContainer"},w.createElement("div",{id:"permissionsLabel",className:"SendLink-permissionsLabel"},a))),w.createElement("div",{className:"SendLink-statusIcons"},c())),aD=(a,b,c)=>(b.getEngagementHelper().peoplePickerLinkedinSuggestions(c,a),a),aE=(a,b,c)=>{if(a)return[{error:a,errorDetails:b}];let d=[];return c?.length>0&&c.map(a=>{a&&d.push({error:a})}),d},aF=a=>{if(a.errorCategory===n.a.shareLink||a.errorCategory===n.a.shareObject)if(a.error&&a.error.message)return w.createElement("span",null,a.error.message.value);else return w.createElement("span",null,a.errorMessage)},aG=(a,b,c)=>a?"error":c?"warning":b?"info":"warning",aH=(a,b,c)=>a?"AlertSolid":c?"WarningSolid":b?"InfoSolid":"WarningSolid",aI=({focused:a,color:b,error:c})=>w.createElement(w.Fragment,null,w.createElement("div",{className:a?"SendLink-animation":void 0}),w.createElement("div",{className:`SendLink-underline ${a&&"focused"} ${c&&b}`})),aJ=({messageLength:a})=>{let b=a>aw,c=a>aw/2,f=`SendLink-characterCount ${b?"error":""}`,g="",[h,i]=w.useState("");return O.bc()?(c||b)&&(a===aw||a===aw/2?g=(0,ai.b)(F.Nb,a,aw):(g="",d&&clearTimeout(d),e=a,d=setTimeout(()=>{e===a&&i((0,ai.b)(F.Nb,a,aw))},2e3))):g=(0,ai.b)(F.Nb,a,aw),w.createElement("div",{className:`SendLink-characterContainer  ${c?"visible":"hidden"}`,tabIndex:-1},w.createElement("span",{className:f},a,"/",aw),(b||c)&&w.createElement("span",{tabIndex:-1,className:"od-Share-screenReaderOnly od-Share-screenreaderCharCount","aria-live":"assertive",role:"status"},g||h||""))};var aK=c(189);(0,h.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Footer-button{border-radius:4px;font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif!important}@supports (font:-apple-system-body){.Footer-button{font:-apple-system-body}}.Footer-button.Send-button{min-width:5.9375rem!important;min-height:2rem;height:100%}.Footer-button.Send-button.v2{margin-left:12px}.Footer-button.Send-button .ms-Button-flexContainer{height:100%}.Footer-button.Send-button .flexContainer{height:2rem}@supports (font:-apple-system-body){.Footer-button.Send-button .flexContainer{height:1rem}}.Footer-button.Footer-button-settings{border-radius:0 4px 4px 0;border-right:1px solid '},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";border-top:1px solid "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";border-bottom:1px solid "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";height:100%}.Footer-button.Footer-button-settings:hover{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.Footer-button.Footer-button-settings i{font-size:.9375rem!important}@supports (font:-apple-system-body){.Footer-button.Footer-button-settings i{font:-apple-system-body;font-size:unset!important}}.Footer-button.Footer-button-settings .flexContainer{height:2rem}@supports (font:-apple-system-body){.Footer-button.Footer-button-settings .flexContainer{height:1rem}}.Footer-button.Footer-button-copy{font-size:.875rem;font-weight:600;white-space:nowrap;min-width:5.9375rem!important;min-height:2rem;height:100%}.Footer-button.Footer-button-copy .ms-Button-flexContainer{height:100%}.Footer-button.Footer-button-copy.v1{margin-right:12px}.Footer-button.Footer-button-copy.v2.v2.v2.v2.v2{border-radius:4px 0 0 4px}.Footer-button.Footer-button-copy.v2.v2.v2.v2.v2.disabled{border-right:1px solid "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}[dir=rtl] .Footer-button.Footer-button-copy{margin-left:12px;margin-right:0}.Footer-button.Footer-button-copy.enabled{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";border-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.Footer-button.Footer-button-copy.enabled:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.Footer-button.Footer-button-copy .flexContainer{height:2rem}@supports (font:-apple-system-body){.Footer-button.Footer-button-copy .flexContainer{height:1rem}}@supports (font:-apple-system-body){.Footer-button.Footer-button-copy{font:-apple-system-body}}.Footer-button .Footer-button-icon{font-size:1rem;padding:2px 0!important;visibility:visible;min-height:1rem;height:unset}[dir=rtl] .Footer-button .Footer-button-icon{transform:scale(-1,1)}.Footer-button .Footer-button-icon.Footer-button-icon-hidden{visibility:hidden}.Footer-button .Footer-button-label{padding-bottom:2px!important}.Footer-button .Footer-button-label.Footer-button-label-hidden{visibility:hidden}.Footer-button .Footer-send-button-spinner{top:15%;left:50%;right:50%;visibility:hidden}.Footer-button .Footer-copy-button-spinner{top:15%;left:45%;visibility:hidden}.Footer-button .Footer-copy-button-spinner.Footer-button-spinner-visible{visibility:visible}.Footer-button .Footer-button-text{font-size:.875rem;font-weight:600;visibility:visible;padding-bottom:2px!important}@supports (font:-apple-system-body){.Footer-button .Footer-button-text{font:-apple-system-body}}.Footer-button .visible{visibility:visible}.Footer-button .invisible{visibility:hidden}.Footer-tooltip{display:flex!important;max-width:250px;font-size:.75rem}@supports (font:-apple-system-footnote){.Footer-tooltip{font:-apple-system-footnote}}.Footer-tooltip-copy{height:100%;display:flex!important;max-width:250px;font-size:.75rem}.Footer-tooltip-copy.largeText{max-width:unset}@supports (font:-apple-system-footnote){.Footer-tooltip-copy{font:-apple-system-footnote}}.Footer-tooltip-copy{height:100%;display:flex!important;max-width:250px;font-size:.75rem}.Footer-tooltip-copy.largeText{max-width:unset}@supports (font:-apple-system-footnote){.Footer-tooltip-copy{font:-apple-system-footnote}}.Footer-copyLinkTooltip{display:flex}.Footer-copyLinkTooltip span{display:flex;align-items:center;padding-left:8px}.Footer-copyLinkTooltipIcon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex!important;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}.Footer-copyLinkTooltipIcon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.Footer-copyLinkTooltipIcon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.Footer-copyLinkTooltipIcon.icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939}.Footer-copyLinkTooltipIcon.icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}"}]);var aL=c(329),aM=c(540);function aN({buttonRef:a,copyLinkToastStatus:b,copyMessageBarStatus:c,currentSettings:d,isSharingByCopyDisabled:e,permissionsLabel:f,focusCopyBtn:h,handlerForShareTargetClicked:i,onShareTargetClicked:k,setCopyMessageBarStatus:l,setCopyToastStatus:m,setIsDisabled:n,setShareTargetClicked:o},{clientId:p,sharingStore:q}){let[r,x]=w.useState(null),y=(0,E.ab)(p,q);w.useEffect(()=>{!(0,O.Vb)()&&y&&(c===g.success||c===g.error)&&h()},[c]);let z=(0,aj.a)(()=>{o(E.f.copy),!i(E.f.copy)&&(n(!0),l(g.inProgress),k(j.a.copy,!0),y||x(setTimeout(()=>{m(aM.a.closed),h()},3e3)))}),A=(0,aj.a)(()=>{m(aM.a.closed),r&&(clearInterval(r),x(null))}),B={iconName:"Link",className:"Footer-button-icon"},C="Footer-button-label",D="Footer-copy-button-spinner";(y&&c===g.inProgress||!y&&b===aM.a.inProgress)&&(B.className+=" Footer-button-icon-hidden",C+=" Footer-button-label-hidden",D+=" Footer-button-spinner-visible");let G={hidden:b===aM.a.success,styles:{root:{borderRadius:"4px"},beakCurtain:{borderRadius:"4px",...!(0,O.X)()?{maxWidth:"unset"}:{}}}};return w.createElement("div",null,w.createElement(u.a,{id:"Copy-button-tooltip-description",calloutProps:G,content:!y&&F.lc,styles:aO,delay:aL.a.long,directionalHint:af.a.topCenter,tooltipProps:y&&{onRenderContent:()=>{let a=aQ(d.sharingScope);return w.createElement("div",{className:"Footer-copyLinkTooltip",role:"alert","aria-label":f},w.createElement(v.a,{iconName:a,className:`Footer-copyLinkTooltipIcon icon-${a}`}),w.createElement("span",null,f))}},"aria-label":f},w.createElement(ah.a,{componentRef:a,id:aR,className:`Footer-button Footer-button-copy ${y?"v2 ":"v1 "}${e?"disabled ":"enabled "}`,iconProps:B,onClick:z,disabled:e,styles:aP,ariaLabel:`${F.uc}`},w.createElement("span",{className:C},F.uc),w.createElement(s.a,{className:D,size:t.a.medium}))),w.createElement(w.Suspense,{fallback:null},w.createElement(_.r,{target:`#${aR}`,onDismiss:A,status:b})))}aN.contextTypes={clientId:(0,O.z)()?x.object.isRequired:x.number.isRequired,sharingStore:x.object.isRequired};let aO={root:["Footer-tooltip-copy largeText"]},aP={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},label:{fontSize:"0.875rem",paddingBottom:"2px"}},aQ=a=>{switch(a){case o.a.organization:return"Work";case o.a.anyone:return"Globe";case o.a.existing:return"ReminderPerson";case o.a.specificPeople:return"AddFriend";default:return"Settings"}},aR="copy-button";function aS({engagementExtraData:a,errorMessage:b,isDisabled:c,messageText:d,showSendButtonSpinner:e,handlerForShareTargetClicked:f,onSendLinkClicked:g,setIsDisabled:h,setShareTargetClicked:i},{clientId:j,sharingStore:k}){let l=(0,E.ab)(j,k),m=(0,aj.a)(()=>{i(E.f.send),f(E.f.send)||(h(!0),g(d)),k.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",a)}),n="Footer-button-icon",o="Footer-button-text",p="Footer-send-button-spinner";e&&(n+=" invisible",o+=" invisible",p+=" visible");let q={iconName:"Send",className:n},r=l?`${F.ek}`:`${F.Xj}`,v=F.Gi;return w.createElement(u.a,{id:"Send-button-tooltip-description",content:r,styles:aU,delay:aL.a.long,directionalHint:af.a.topRightEdge},w.createElement(ah.a,{primary:!0,className:`Footer-button Send-button ${l?"v2":"v1"}`,iconProps:q,disabled:c,onClick:m,ariaLabel:v,"aria-describedby":"Send-button-tooltip-description",id:"Send-button",styles:aT},w.createElement("div",{className:`Footer-button-text ${o}`},v),w.createElement(s.a,{className:`Footer-send-button-spinner ${p}`,size:t.a.medium})))}aS.contextTypes={clientId:(0,O.z)()?x.object.isRequired:x.number.isRequired,sharingStore:x.object.isRequired};let aT={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},label:{fontSize:"0.875rem",paddingBottom:"2px"}},aU={root:["Footer-tooltip"]};var aV=c(220),aW=c(345),aX=c(157),aY=c(103),aZ=c(152),a$=c(355),a_=c(339),a0=c(340);let a1=P.e();(0,J.K)({icons:{outlookSVG:w.createElement("img",{src:a_.a}),teamsSVG:w.createElement("img",{src:a0.a})}});var a2=c(541);(0,h.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.AttachACopy-center{width:100%;text-align:center}.AttachACopy-button{font-size:.875rem;font-weight:600;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.AttachACopy-button :active{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.AttachACopy-container{padding-top:6px}"}]);var a3=c(341);function a4({engagementExtraData:a,sharingStore:b}){return w.createElement("div",{className:"AttachACopy-container"},w.createElement(a3.a,null),w.createElement("div",{className:"AttachACopy-center"},w.createElement(ao.a,{className:"AttachACopy-button",iconProps:a5,onClick:()=>{a6(a,b)}},F.cb)))}let a5={iconName:"ShareiOS"},a6=(a,b)=>{b&&b.getEngagementHelper().sendACopyClicked(a);try{window.external.SendCopy()}catch(a){}};(0,h.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.CopyMessageBar-container{height:0;transition:height .2s cubic-bezier(.33, 0, .1, 1);overflow:hidden}.CopyMessageBar-icon{padding-top:1px;margin:8px 0 8px 12px}.CopyMessageBar-bar{display:flex;flex-direction:row;border-radius:6px!important;margin-top:12px!important;min-height:auto!important;font-size:.75rem!important;color:#000}@supports (font:-apple-system-body){.CopyMessageBar-bar{font:-apple-system-body}}.CopyMessageBar-message{margin:8px 12px 8px 8px}.CopyMessageBar-message .CopyMessageBar-message-statusIcons{font-size:.75rem;padding-left:8px}.CopyMessageBar-moreDetails{display:flex;flex-direction:row;border:none!important;padding:0!important;font-weight:400!important;font-size:.75rem!important;background-color:transparent!important;color:#000!important}.CopyMessageBar-moreDetails:hover{background-color:transparent!important}.CopyMessageBar-moreDetailsTitle:hover{text-decoration:underline}.CopyMessageBar-moreDetailsText{word-break:break-word}.CopyMessageBar-toggleIcon{padding-left:5px}"}]);var a7=c(153);function a8({copyMessageBarStatus:a,messageBarError:b,permissionsLabel:c,shareMainContainerRef:d,sharingInformation:e,sharingStore:f,setCopyMessageBarStatus:h,setShareTargetClicked:i},{resize:j}){let[k,l]=w.useState(null),[m,n]=w.useState(0),[o,p]=w.useState(!1),q=w.useRef(null),r=()=>{h(g.closed),i(E.f.none),d?.current&&d.current.removeEventListener("click",r,!1)};return(w.useEffect(()=>{switch(a){case g.success:ba({copyMessageBarStatus:a,messageBarRef:q,permissionsLabel:c,sharingStore:f,setMessageBar:l}),d?.current&&d.current.addEventListener("click",r,!1);break;case g.error:bb({copyMessageBarStatus:a,messageBarError:b,messageBarRef:q,sharingInformation:e,showDetails:o,setShowDetails:p,setMessageBar:l});break;case g.closed:bc({setMessageBar:l,setMessageBarHeight:n})}},[a,o]),w.useEffect(()=>{setTimeout(()=>{j()},200)},[m]),w.useEffect(()=>{q?.current?.clientHeight&&n(q.current.clientHeight+12)},[k,q?.current?.clientHeight]),k)?w.createElement("div",{className:"CopyMessageBar-container",style:{height:m},"aria-live":"assertive",role:"alert"},k):w.createElement(w.Fragment,null)}a8.contextTypes={resize:x.func.isRequired};let a9=(0,J.C)(),ba=({copyMessageBarStatus:a,messageBarRef:b,permissionsLabel:c,sharingStore:d,setMessageBar:e})=>{let f={iconName:"CompletedSolid",styles:{root:{fontSize:"14px",height:"14px",color:a9.semanticColors.successIcon}}},g=be(d),h=w.createElement("div",null,w.createElement("b",null,F.Cf)," ",c," ",g);e(w.createElement(bd,{iconProps:f,message:h,messageBarRef:b,messageBarStatus:a}))},bb=({copyMessageBarStatus:a,messageBarError:b,messageBarRef:c,sharingInformation:d,showDetails:e,setShowDetails:f,setMessageBar:g})=>{let h,i,j,k={iconName:"CompletedSolid",styles:{root:{fontSize:"14px",height:"14px",color:a9.semanticColors.errorIcon}}};if(d.error&&d.error.message&&(i=w.createElement("span",null,d.error.message.value)),d.errorCategory===n.a.shareLink){let a=()=>{f(!e)},b=w.createElement("div",null,w.createElement(ah.a,{className:"CopyMessageBar-moreDetails",onClick:a},w.createElement("div",{className:"CopyMessageBar-moreDetailsText"},F.Ye),w.createElement(v.a,{className:"CopyMessageBar-toggleIcon",iconName:"ChevronDown"}))),c=w.createElement("div",null,w.createElement(ah.a,{className:"CopyMessageBar-moreDetails",onClick:a},w.createElement("div",{className:"CopyMessageBar-moreDetailsTitle"},F.Xd),w.createElement(v.a,{className:"CopyMessageBar-toggleIcon",iconName:"ChevronUp"})),w.createElement("div",{className:"CopyMessageBar-moreDetailsText"},i));h=e?c:b}j=d.errorCategory!==n.a.shareLink&&b?b:d.errorMessage?w.createElement("div",null,d.errorMessage):w.createElement("div",null,w.createElement("div",null,w.createElement("b",null,`${F.Wk} ${F.zk}`)),i&&h),g(w.createElement(bd,{iconProps:k,message:j,messageBarRef:c,messageBarStatus:a}))},bc=({setMessageBar:a,setMessageBarHeight:b})=>{a(null),b(0)},bd=({iconProps:a,message:b,messageBarRef:c,messageBarStatus:d})=>{let e,f;switch(d){case g.success:e=a9.semanticColors.successBackground,f="success";break;case g.error:e=a9.semanticColors.errorBackground,f="error"}return w.createElement("div",{ref:c,className:`CopyMessageBar-bar ${f}`,style:{backgroundColor:e}},w.createElement(v.a,{className:"CopyMessageBar-icon",...a}),w.createElement("div",{className:"CopyMessageBar-message","aria-live":"assertive"},b))},be=a=>{let b=a?.getSharingLinkCreated();if(!b)return null;let{expiration:c,hasPassword:d}=b,e=[];return c&&c.getTime()!==new Date(0).getTime()&&e.push({icon:"Calendar",tooltip:`${(0,ai.b)(F.yd,(0,a7.d)(c))}`}),d&&e.push({icon:"Lock",tooltip:F.sj}),e.map(a=>w.createElement(u.a,{key:a.icon,id:a.icon,tooltipProps:{onRenderContent:()=>w.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},a.tooltip)}},w.createElement(v.a,{iconName:a.icon,"aria-label":a.tooltip,styles:{root:["CopyMessageBar-message-statusIcons"]}})))};var bf=c(84),bg=c(542),bh=c(544);let bi=O.pb()?40:12,bj=O.pb()?28:12,bk=(0,ag.b)(),bl=w.lazy(()=>c.e(21).then(c.bind(c,613)));function bm({clientId:a,companyName:b,copyButtonRef:c,copyLinkToastStatus:d,correlationId:e,createPeopleSharingLinks:f,currentSettings:h,engagementExtraData:k,groupsMemberCount:m,hostOptions:n,isFREAbandoned:o,index:p,item:r,linkRecipients:s,messageText:t,summaryState:u,permissionsMap:v,permissionsLabel:x,sharingInformation:z,outlookAvailability:B,fullscreenIframeMode:C,copyMessageBarStatus:D,sharingInfoBarMessageTypeId:G,showSendButtonSpinner:I,scenarioId:J,renderBackButton:K,focusCopyButton:L,getGraphToken:M,onAudienceChange:N,onRoleChange:Q,onShareTargetClicked:R,onSelectedPeopleChange:S,onSendLinkClicked:T,onSendLinkMessageChange:U,onSendLinkSummaryStateChange:V,onViewPolicyTipClicked:W,showLinkSettings:X,showPermissionsList:Y,setCopyToastStatus:Z,setCopyMessageBarStatus:$,setIndex:_,generateSummary:aa,getStatusIcons:ab,renderSharingInfoBar:ac,returnToPreviousView:ad},{campaignKey:ae,platformDetection:ag,shareClickTime:ah,sharingClientMessenger:ai,sharingStore:ak,loadTeachingBubbleCampaigns:am,markTeachingBubbleAsDismissed:an,onDismiss:ao,onTeachingBubbleSeen:ap,shouldTeachingBubbleBeShown:aq}){let[ar,as]=w.useState([]),[at,au]=w.useState(null),[aw,ax]=w.useState([]),[ay,az]=w.useState(null),[aA,aB]=w.useState(!1),[aC,aD]=w.useState(E.c.unseen),[aE,aF]=w.useState(!1),[aG,aH]=w.useState(!1),[aI,aJ]=w.useState(!1),[aL,aM]=w.useState(""),[aO,aP]=w.useState(""),[aQ,aR]=w.useState(0),[aT,aU]=w.useState(E.f.none),[aV,aW]=w.useState({showMarker:!1,teachingBubbleCampaigns:void 0}),[aX,a_]=w.useState(o),a0=w.useRef(null);w.useEffect(()=>{let a=setTimeout(async()=>{Promise.all([am(),aq(ae)]).then(([a,b])=>{aW({teachingBubbleCampaigns:a,showMarker:b}),aJ(b||aX&&p>1&&p<bg.a.length-1)})},50);return()=>clearTimeout(a)},[aW]),w.useEffect(()=>{ai?ai.sendShareReady():H.r(ah,a,i.a.share,J,e)},[]),w.useEffect(()=>{let a=bE(z,aT,bK);(0,E.V)(z)||a?(a&&au(a),aH(!0),aF(!0)):ba()},[z]),w.useEffect(()=>{if(!bK&&h.audience===l.a.existing&&s)for(let a of s)void 0===v[a.email]&&void 0===v[a.userId]&&aF(!0)},[h,s,v]),w.useEffect(()=>{aA||at?.props?.children!==F.Zk||(au(null),aH(!1),aF(!1))},[aA]),w.useEffect(()=>{at||0!==s.length||aU(E.f.none)},[at,s]),w.useEffect(()=>{aT===E.f.send&&($(g.closed),az(null))},[aT]),w.useEffect(()=>{bE(z,aT,bK)||ba()},[h,s,v,t,aC]),w.useEffect(()=>{ax(bc())},[D]),w.useEffect(()=>{aL&&aP(aL)},[aL]);let a3=(0,aj.a)(a=>{S(a)}),a4=(0,aj.a)(a=>bA(a,aB)),a5=(0,aj.a)(a=>bB(a,U)),a6=(0,aj.a)(a=>bC(a,V)),a7=()=>{X()},a8=(0,aj.a)((a,b)=>bF(aO,!!aa,k,ak,T,a,b)),a9=a=>bD(f,h,s,aA,a,bK,bd,be,$,az,au,aH,aF),ba=()=>{let a,b,c=bb(),d=bc();bK&&aT!==E.f.copy||(a=bd()),bK&&aT===E.f.send&&(b=be()),au(c.peoplePickerError||a?.peoplePickerError||b?.peoplePickerError),ax(d),az(a?.messageBarError),a?.messageBarError||D!==g.error||$(g.closed),aH(c.copyDisabled||a?.copyDisabled),aF(c.sendDisabled||!bK&&a?.sendDisabled||b?.sendDisabled)},bb=()=>{let a=y.l({selectedItems:s,canAddExternalPrincipal:z.canAddExternalPrincipal,sharingInformation:z,audience:h.audience,viewPolicyTipCallback:W}),b=bv(h,k,s,z,ak,aC,as,aD),c=bz(t,!!aL);return{copyDisabled:(O.q()||h.audience!==l.a.existing)&&(!!a||b),sendDisabled:!!a||b||c,peoplePickerError:a,messageBarError:void 0}},bc=()=>{let a=[],b=y.a(h,v);return(!bK||D===g.success)&&b&&a.push(b),a.push(...bu([bL,bM])),a},bd=()=>{let a=y.a(h,v),b=y.b({scope:h.sharingScope,selectedItems:s,sharingInformation:z,simplifiedV2:bK}),c=!bK&&(a||b),d=bK&&(a||b),e=!bK&&(!!b||!!a);return{copyDisabled:!!b,sendDisabled:e,peoplePickerError:c,messageBarError:d}},be=()=>{let a=y.c({sharingInformation:z,selectedItems:s});return{copyDisabled:void 0,sendDisabled:!!a,peoplePickerError:a,messageBarError:void 0}},bh=((a,b,c,d,e,f,g,h,i,k)=>{let l,m=[],n=(l=A.s(c)&&d===aZ.a.available,(O.sb()||(l=(A.s(c)||A.q(c))&&d===aZ.a.available),l)?aZ.a.available:(0,H.e)());(0,aY.a)()&&window.sessionStorage.setItem("outlookAvailability",d.toString());let o={root:["SimplifiedShareTargets icon-width"]},p=O.Wb()?{}:{root:{width:"auto",fontSize:"initial"}},r={height:"100%",minHeight:"2rem",lineHeight:"unset","ms-ContextualMenu-itemText":{whiteSpace:"prewrap"}};if(n===aZ.a.available){let a=`${F.Ki} ${F.eg}`;m.push({key:"outlook",text:a,iconProps:{iconName:"outlookSVG",styles:o},id:"od-ShareTargets-outlookButton",style:r,onClick:()=>k(j.a.outlook)})}else if(d===aZ.a.other){let a=`${F.Ki} ${F.Sf}`;m.push({key:"nonOutlook",text:a,iconProps:{iconName:"font:Mail"},id:"od-ShareTargets-nonOutlookButton",style:r,onClick:()=>k(j.a.nonOutlook)})}if((0,H.n)()){let a=`${F.Ki} ${F.Nk}`;m.push({key:"outlook",text:a,iconProps:{iconName:"teamsSVG",styles:o},id:"od-ShareTargets-mobileTeamsButton",style:r,onClick:()=>k(j.a.mobileShareToTeams)})}else if(b&&a1&&!a.isIE){let a=`${F.Ki} ${F.Nk}`;m.push({key:"webTeams",text:a,iconProps:{iconName:"teamsSVG"},id:"od-ShareTargets-webTeamsButton",style:r,onClick:()=>k(j.a.webShareToTeams)})}if((0,H.k)()){let a=`${F.qe}`;m.push({key:"moreApps",text:a,iconProps:{iconName:"AppIconDefault",styles:p},id:"od-ShareTargets-moreAppsButton",style:r,onClick:()=>k(j.a.moreApps)})}if(A.i(c)){let a=a$.a.getAttachAsCopyOptions(c,e,g,f,h,i);1===a.length&&"pdf"!==a[0].key?m.push({key:"attachcopy",alignTargetEdge:!1,directionalHintFixed:!0,text:`${F.cb}`,iconProps:{iconName:"MailAttached",styles:p},id:"od-ShareTargets-attachACopyButton",style:r,onClick:()=>{a[0].onClick}}):a.length>0&&m.push({key:"attachcopy",text:`${F.cb}`,iconProps:{iconName:"MailAttached"},subMenuProps:{items:a,styles:p},id:"od-ShareTargets-attachACopyButton",style:r})}else(H.l()||h)&&c===q.a.ngsc&&m.push({key:"attachcopy",alignTargetEdge:!1,directionalHintFixed:!0,text:`${F.cb}`,iconProps:{iconName:"MailAttached",styles:p},id:"od-ShareTargets-attachACopyButton",style:r,onClick:()=>{g.getEngagementHelper().sendACopyClicked(f);try{window.external.SendCopy()}catch(a){}}});return{items:m,directionalHint:af.a.bottomRightEdge,className:`SimplifiedShareTargets ${a.isIE?"ie":""}`,...!O.Wb()?{onRestoreFocus:a=>{a.originalElement?.focus()}}:{}}})(ag,C,a,B,r,k,ak,n?.isSendCopyEnabled,n?.isSendPdfEnabled,R),bi=n?.showCloseButton??A.r(a),bj=at;aC===E.c.seeing&&(bj=null);let bl=z.item.itemType===bf.a.Folder?F.Nd:F.Fd,bm=22,bt=(0,P.c)()&&z.requiresAccessApproval;bt&&(bm=10);let bJ=(0,E.rb)(r.name,bm),bK=(0,E.ab)(a,ak),bL=w.useMemo(()=>y.f(s),[s]),bM=w.useMemo(()=>y.g(s,m,bK),[s,m]),bN=bK&&ak&&ak.isSharingLimitedOnSite(),bO=w.createElement(aK.a,{className:"Footer-button Footer-button-settings",iconProps:{iconName:"Settings"},ariaLabel:F.Ce,onClick:a7,tooltipContent:F.Ce,tooltipStyles:bp(),directionalHint:af.a.topAutoEdge,automationId:"Footer-button-settings",styles:bo(ag)});return w.createElement("div",{className:"ShareMain"},w.createElement("div",{ref:a0},w.createElement("div",{className:"ShareMain-header"},w.createElement(al.a,{actions:br(an,ao,aW,aJ,_,a7,ae,aV,bi,bh,ak,aI,bK),mainHeaderText:bq(bJ,bt),fullHeaderText:bq(r.name,bt),isFilenameTruncated:bJ.length>bm,renderBackButton:K,onBackButtonClicked:ad,itemTypePrefix:bl}),z.sensitivityLabelInformation&&w.createElement(a2.a,{sensitivityLabelInformation:z.sensitivityLabelInformation,getGraphToken:M,engagementExtraData:k})),ac(bn(G)),bs(z)&&w.createElement(av,{clientId:a,copyMessageBarStatus:D,currentSettings:h,engagementExtraData:k,errorMessage:bj,linkRecipients:s,messageText:t,summaryState:u,oversharingExternalsWarning:bL,oversharingGroupsWarning:bM,permissionsMap:v,permissionsLabel:x,shareTargetClicked:aT,sharingInformation:z,sharingByCopyIsDisabled:aG,sharingBySendIsDisabled:bN||aE,showExternalSharingConfirmationDialog:aC,warningMessages:aw,onInputChange:a4,onRoleChange:Q,onSelectedPeopleChange:a3,onSendLinkMessageChange:a5,onSendLinkSummaryStateChange:a6,getStatusIcons:ab,generateSummary:aa,updateSummaryData:aM,handlerForOnLinkSettingsClicked:a7}),bx(b,z,ak,Y),w.createElement("div",{className:"ShareMain-flex-row"},w.createElement("div",{className:"ShareMain-flex-grow space-between"},by(z,ak,Y)),w.createElement("div",{className:"ShareMain-action-footer flex-end"},w.createElement("div",{className:"ShareMain-copy-button-container"},!O.Y()&&bK&&bk&&w.createElement("div",null,bO),w.createElement(aN,{buttonRef:c,copyLinkToastStatus:d,copyMessageBarStatus:D,currentSettings:h,isSharingByCopyDisabled:aG,permissionsLabel:x,shareTargetClicked:aT,unresolvedPeoplePickerText:aA,handlerForShareTargetClicked:a9,focusCopyBtn:L,onShareTargetClicked:R,setCopyMessageBarStatus:$,setCopyToastStatus:Z,setIsDisabled:aH,setShareTargetClicked:aU}),O.Y()?bK&&w.createElement("div",null,bO):bK&&!bk&&w.createElement("div",null,bO)),w.createElement(aS,{engagementExtraData:k,errorMessage:at,messageText:aL?JSON.stringify({isAiGenerated:!!aL,sensitivtyLabelInfo:{id:z?.sensitivityLabelInformation?.id,displayName:z?.sensitivityLabelInformation?.displayName,hasIrmProtection:z?.sensitivityLabelInformation?.hasIRMProtection,color:null},messageText:t}):t,isDisabled:bN||aE,linkRecipients:s,showSendButtonSpinner:I,handlerForShareTargetClicked:a9,onSendLinkClicked:a8,setIsDisabled:aF,setShareTargetClicked:aU})))),bK&&bI(D,ay,x,a0,z,ak,$,aU),bw(ar,aC,N,aD),bG(a,k,ak),bK&&!(0,aY.a)()&&bH(ae,aQ,aI,p,ap,_,a_,aR,aW,aJ))}bm.contextTypes={platformDetection:x.object.isRequired,shareClickTime:x.number,sharingClientMessenger:x.object,sharingStore:x.object.isRequired,loadTeachingBubbleCampaigns:x.func.isRequired,markTeachingBubbleAsDismissed:x.func.isRequired,onDismiss:x.func.isRequired,onTeachingBubbleSeen:x.func.isRequired,shouldTeachingBubbleBeShown:x.func.isRequired,campaignKey:(0,O.z)()?x.object:x.number};let bn=a=>{let b;switch(a){case ae.a.PageSharingAssetWarning:b=12;break;case ae.a.LimitedSharing:b=bi;break;case ae.a.LinkReShare:b=bj;break;default:b=0}return{extraHeight:b,parentCssClass:"SimplifiedShare",isSimplifiedDialog:!0}},bo=a=>({root:{height:"2rem",padding:a.isIE?"0":"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:["flexContainer"],label:{fontSize:"0.875rem",paddingBottom:"2px"}}),bp=()=>({root:{height:"100%",display:"flex !important",maxWidth:"250px",fontSize:"12px"}}),bq=(a,b)=>{let c=F.Zj;return b&&(c=F.$j),(0,ai.b)(c,a)},br=(a,b,c,d,e,f,g,h,i,j,k,l,m)=>{let n=bt(g,a,c,d,e);return w.createElement(w.Fragment,null,!m&&w.createElement(aK.a,{className:"ShareMain-sharingSettings",iconProps:{iconName:"Settings"},ariaLabel:F.Ej,onClick:f,tooltipContent:F.Ej,directionalHint:af.a.bottomAutoEdge}),j.items.length>0&&w.createElement(aK.a,{className:"ShareMain-moreApps",menuIconProps:{iconName:"More"},ariaLabel:F.Qe,tooltipContent:F.Qe,menuProps:j,directionalHint:af.a.bottomAutoEdge}),m&&w.createElement(w.Fragment,null,h.showMarker&&h.teachingBubbleCampaigns&&w.createElement("div",{className:"ShareMain-firstTimeUserMarker"}),w.createElement(aK.a,{className:"ShareMain-helpMenu",menuIconProps:{iconName:"Unknown"},ariaLabel:F.Jd,menuProps:n,tooltipContent:F.Jd,directionalHint:af.a.bottomAutoEdge,automationId:"ShareMain-helpMenu"})),i&&w.createElement(aK.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:F.Vb,onClick:a=>{a.stopPropagation(),a.preventDefault(),b(),l&&k.getEngagementHelper().simplifiedV2TeachingBubbleAbandoned()},tooltipContent:F.Vb,directionalHint:af.a.bottomAutoEdge}))},bs=a=>!a.blockPeoplePickerAndSharing||(0,E.V)(a),bt=(a,b,c,d,e)=>({items:[{key:"viewUpdate",text:F.ll,onClick:()=>{d(!0),e(1)},onRender:(a,b)=>w.createElement(ah.a,{className:"ShareMain-contextualMenu-link",onClick:()=>{a.onClick(),b()},role:"menuitem"},w.createElement("div",{className:"ShareMain-contextualMenu-linkContent"},w.createElement("span",{className:"ms-ContextualMenu-itemText"},a.text),w.createElement("div",{className:"ShareMain-badge"},F.df)))},{key:"learnMore",text:F.fe,onClick:()=>{window.open("https://go.microsoft.com/fwlink/?linkid=2247024","_blank")}}],directionalHint:af.a.bottomAutoEdge,className:"ShareMain-helpMenu",onMenuOpened:()=>{b(a),c({teachingBubbleCampaigns:void 0,showMarker:!1})}}),bu=a=>{let b=[];return a.map(a=>{a&&b.push(w.createElement("div",null,w.createElement("span",{role:"alert","aria-live":"assertive"},a)))}),b},bv=(a,b,c,d,e,f,g,h)=>{let i=c.filter(a=>a.isExternal),j=!1;if(O.fc()){let b=a.audience===l.a.organization||a.audience===l.a.existing,c=e.isPeopleSharingLinksEnabled(),f=i.filter(a=>y.h(a));j=(d.canAddExternalPrincipal||f.length)&&b&&i.length&&c}else{let b=a.sharingScope===o.a.organization,c=d.canAddExternalPrincipal;j=b&&c&&!!i.length}return(j=j&&f!==E.c.dismissed)&&h(E.c.seeing),g(i),e.getEngagementHelper().externalSharingCslError(b),j},bw=(a,b,c,d)=>b===E.c.seeing&&a.length?w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.d,{confirmationCode:aV.a.shareDialogExternalSharing,participant:null,participants:a,onApply:()=>{d(E.c.dismissed),c(l.a.specificPeopleFlex,k.a.flexible,o.a.specificPeople)},onCancel:()=>{d(E.c.dismissed)}})):null,bx=(a,b,c,d)=>{if(O.G()&&!O.H()&&c.isCOB&&!c.isCOB())return(0,E.nb)(b)&&w.createElement(w.Suspense,{fallback:w.createElement(w.Fragment,null)},w.createElement(_.f,{sharingStore:c,companyName:(0,bh.a)(a,F.zb),onClick:d}))},by=(a,b,c)=>{let{shared:d,activeLinks:e,sharingPrincipals:f}=(0,E.H)(a,b.isConsumer()),g=b&&!b.isConsumer(),h=()=>{b&&b.isBundleShare()||c()},i=!1,j=!1;O.G()&&!O.H()&&b.isCOB&&!b.isCOB()&&(i=!!(b.getAllOrgSG&&b.getAllOrgSG()),j=!!(b.getEEEU&&b.getEEEU()));let k=d?w.createElement("div",{className:"ShareMain-sharedWithSection"},w.createElement(aW.a,{getPhotoUrl:(0,aX.b)(a.webUrl),onClick:h,sharingLinks:e,sharingPrincipals:f,personaSizeInPixels:20,renderOverlap:!0,isNotification:!1,isDiscoverable:i||j})):w.createElement("div",{className:"ShareMain-notShared"},w.createElement(u.a,{content:F.If},w.createElement(D.a,{className:"ShareMain-notShared-button",iconProps:{iconName:"Lock"},ariaLabel:F.If,onClick:h})));return g?k:null},bz=(a,b)=>(0,E.s)(a)>(b?1e3:500),bA=(a,b)=>{b(""!==a)},bB=(a,b)=>{b(a)},bC=(a,b)=>{b(a)},bD=(a,b,c,d,e,f,h,i,j,k,m,n,p)=>{let q,r=!1,s=!1;0===c.length&&(b.sharingScope===o.a.specificPeople?(r=!0,s=!0,q=w.createElement("span",{role:"alert","aria-live":"assertive"},F.Jg)):e===E.f.send&&(s=!0,q=w.createElement("span",{role:"alert","aria-live":"assertive"},F.Yg)));let t=d&&b.sharingScope===o.a.specificPeople;if(r=r||t,s=s||d,(t||d&&e===E.f.send)&&(q=w.createElement("span",{role:"alert","aria-live":"assertive"},F.Zk)),e===E.f.copy&&!a&&b.audience===l.a.specificPeople){let a=!1,b=!1;for(let d of c)a||(a=d.isExternal&&!d.providerName),b||(b=!d.isExternal||d.isExternal&&!!d.providerName);a&&b&&(q=w.createElement("span",{role:"alert","aria-live":"assertive"},F.Ve),r=!0)}if(f){if(e===E.f.copy){let a=h();r=r||a.copyDisabled,s=s||a.sendDisabled,a.peoplePickerError&&(q=a.peoplePickerError),a?.messageBarError&&(k(a.messageBarError),j(g.error))}else if(e===E.f.send){let a=i();s=s||a.sendDisabled,a.peoplePickerError&&(q=a.peoplePickerError)}}return(m(q),n(r),p(s),e===E.f.copy)?r:e===E.f.send?s:void 0},bE=(a,b,c)=>{if(a.errorCategory===n.a.shareLink||a.errorCategory===n.a.shareObject)return c?b===E.f.copy?w.createElement("div",null,`${F.pc} ${F.zk}`):b!==E.f.send?w.createElement("div",null,`${F.zd}`):a.errorMessage?w.createElement("div",null,a.errorMessage):w.createElement("div",null,`${F.mc} ${F.zk}`):w.createElement("div",null,`${F.Wk} ${F.zk}`)},bF=(a,b,c,d,e,f,g)=>{b&&d.getEngagementHelper().summarizationEnabled(c,"SendLink"),-1!==f.indexOf(a)&&""!==a?d.getEngagementHelper().summarizationSent(c,"exactMatch"):""!==a&&(((a,b)=>{let c,d=new ak.a({name:"LevenshteinDistanceMeasuringEvent"}),e=[];for(let a=0;a<=b.length;a++)e[a]=a;for(let d=0;d<a.length;d++){c=e[0],e[0]=d+1;for(let f=1;f<=b.length;f++)a[d]===b[f-1]?[e[f],c]=[Math.min(e[f-1]+1,e[f]+1,c),e[f]]:[e[f],c]=[Math.min(e[f-1],e[f],c)+1,e[f]]}return d.end({resultType:ak.b.Success}),e[e.length-1]})(f,a)/a.length*100<=50?d.getEngagementHelper().summarizationSent(c,"substantialMatch"):d.getEngagementHelper().summarizationSent(c,"marginalMatch")),e(f,g)},bG=(a,b,c)=>H.l()&&A.g(a)?w.createElement(a4,{engagementExtraData:b,sharingStore:c}):w.createElement(w.Fragment,null),bH=(a,b,c,d,e,f,g,h,i,j)=>(c&&e(a),w.createElement("div",{className:"od-FirstRunExperienceMessageBar-container",style:{height:b}},c&&w.createElement(w.Suspense,{fallback:w.createElement(w.Fragment,null)},w.createElement(bl,{freHeight:b,index:d,setIndex:f,setFREIsAbandoned:g,setFreHeight:h,setMarkerInfo:i,setShowFirstRunExperience:j})))),bI=(a,b,c,d,e,f,g,h)=>w.createElement(w.Suspense,{fallback:w.createElement(w.Fragment,null)},w.createElement(a8,{copyMessageBarStatus:a,messageBarError:b,permissionsLabel:c,shareMainContainerRef:d,sharingInformation:e,sharingStore:f,setCopyMessageBarStatus:g,setShareTargetClicked:h}));var bJ=c(641),bK=c(627),bL=c(519),bM=c(15),bN=c(278);(0,J.K)({icons:{BlockDownloadIcon:w.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},w.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L10.9993 12.0602L10.999 16.4329L7.27997 12.7192L7.1958 12.6467C6.90204 12.429 6.48539 12.4535 6.21931 12.72C5.92661 13.0131 5.92694 13.4879 6.22003 13.7806L11.2235 18.7772L11.3076 18.8498C11.6012 19.0673 12.0176 19.043 12.2837 18.7769L15.0001 16.0611L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM13.9393 15.0002L12.499 16.4399L12.4992 13.5601L13.9393 15.0002ZM17.1218 13.9399L16.0611 12.8792L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L17.1218 13.9399ZM10.9996 7.81764L12.4995 9.31756L12.5 2.75488L12.4932 2.65311C12.4435 2.28704 12.1297 2.00488 11.75 2.00488L11.6482 2.01173C11.2822 2.06139 11 2.37519 11 2.75488L10.9996 7.81764ZM18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999Z",fill:"currentColor"}))}}),(0,J.K)({icons:{Shield16RegularIcon:w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},w.createElement("path",{d:"M7.64728 2.14638C7.84268 1.95105 8.15946 1.95123 8.35464 2.14678C9.5947 3.38913 10.9689 4 12.5 4C12.7761 4 13 4.22386 13 4.5V7.50126C13 10.7196 11.3587 12.9075 8.15811 13.9743C8.05548 14.0086 7.94452 14.0086 7.84189 13.9743C4.64126 12.9075 3 10.7196 3 7.50126V4.5C3 4.22386 3.22386 4 3.5 4C5.02923 4 6.40416 3.38902 7.64728 2.14638ZM8.00042 3.18917C6.81393 4.25491 5.47941 4.86879 4 4.98118V7.50126C4 8.9349 4.36269 10.0655 5.02127 10.9453C5.65858 11.7967 6.62953 12.4885 8 12.9715C9.37047 12.4885 10.3414 11.7967 10.9787 10.9453C11.6373 10.0655 12 8.9349 12 7.50126V4.98121C10.5195 4.86895 9.18521 4.25528 8.00042 3.18917Z",fill:"#242424"})),ShieldLock16RegularIcon:w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},w.createElement("path",{d:"M7.64728 2.14638C7.84268 1.95105 8.15946 1.95123 8.35464 2.14678C9.5947 3.38913 10.9689 4 12.5 4C12.7761 4 13 4.22386 13 4.5V5.40135C12.6963 5.22567 12.359 5.1017 12 5.04148V4.98121C10.5195 4.86895 9.18521 4.25528 8.00042 3.18917C6.81393 4.25491 5.47941 4.86879 4 4.98118V7.50126C4 8.9349 4.36269 10.0655 5.02127 10.9453C5.49089 11.5727 6.14168 12.1134 7 12.5478V13.6523C4.35378 12.4971 3 10.4242 3 7.50126V4.5C3 4.22386 3.22386 4 3.5 4C5.02923 4 6.40416 3.38902 7.64728 2.14638ZM9.5 8V9H9C8.44772 9 8 9.44772 8 10V14C8 14.5523 8.44771 15 9 15H14C14.5523 15 15 14.5523 15 14V10C15 9.44772 14.5523 9 14 9H13.5V8C13.5 6.89543 12.6046 6 11.5 6C10.3954 6 9.5 6.89543 9.5 8ZM10.5 9V8C10.5 7.44772 10.9477 7 11.5 7C12.0523 7 12.5 7.44772 12.5 8V9H10.5ZM11.5 11.25C11.9142 11.25 12.25 11.5858 12.25 12C12.25 12.4142 11.9142 12.75 11.5 12.75C11.0858 12.75 10.75 12.4142 10.75 12C10.75 11.5858 11.0858 11.25 11.5 11.25Z",fill:"#242424"}))}});class bO extends w.Component{getChildContext(){return O.z()?{}:{sharingStore:this._store,campaignKey:bN.a.SimplifiedV2,clientId:this.props.clientId}}componentWillUnmount(){this._store.removeListeners&&this._store.removeListeners(),this._showAnimation&&this._dialogHeightRef?.current&&this._dialogHeightRef.current.disconnect()}componentDidMount(){try{let a,b=this._store;try{a=(0,S.a)((0,S.c)(b.getAuthToken())),this._engagementExtraData.appId=a}catch(a){}if(!this._isOpenEventLogged){let a={...this._engagementExtraData},b=this._store.getNavId();b&&(a.isNavIdBase64Url=(0,bK.c)(b),a.navIdLength=b.length),this._store.getEngagementHelper().log(N.d.Opened,a),this._isOpenEventLogged=!0}if(new I.a(this).on(window,"keydown",a=>{a&&a.keyCode===M.a.escape&&this._handleEscKeyPress(a)}),this._shareComponentRenderedTime=Date.now(),b.addListener(this._sharingStoreListener.bind(this)),!this.props.copyLinkShortcut||!this.state.sharingInformation||!this.state.currentSettings||this.props.shareId||this.state.sharingInformation.error||this._copyLinkShortcutInvoked||this.state.sharingLinkCreated||(this._copyLinkShortcutInvoked=!0,this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:this.state.currentSettings,shareTargetClicked:!1})),b.fetchSuiteNavInformation(),b.fetchPolicyTipInformation(),this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===i.a.copy&&!this.props.shareId&&A.n(this.props.clientId)&&(this._copyLinkShortcutInvoked=!0,this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0}),this.setState({shareType:j.a.copy,shareTargetClicked:!0})),this._resizeIfNeeded(),this.state.sharingInformation){let a=this.props.mode,b=this.state.viewState;(this.state.viewState===$.a.default||this.state.viewState===$.a.linkSettings&&this.props.mode===i.a.linkSettings)&&(setTimeout(()=>{this._writeShareDataToRumoneLogger({mode:a,viewState:b})},0),this._isInitialPageLoadDataLogged=!0),this.state.viewState===$.a.linkSuccess&&this.props.mode===i.a.copy&&(this._isInitialPageLoadDataLogged=!0),this.props.shareLoadingCustomerPromise?.forEach(a=>(0,ab.f)({customerPromise:a,engagementExtraData:this._engagementExtraData,sharingStore:this._store}))}let c=b.getSharingInformation();c.peoplePickerSettings||(c.peoplePickerSettings={}),(O.E()&&(!O.jb()||this.props.sharingContextInfo?.additionalTokens?.substrateToken)||this._isWordFileEnabledFor3S(c)||this._isXPFileEnabledFor3S(c))&&(c.peoplePickerSettings.useNew3Ssearch=!0)}catch(a){this._setGenericErrorState(ab.a.generic,a)}if(this._showAnimation){this._dialogHeightRef={current:new ResizeObserver(a=>{for(let b of a)if(b.contentBoxSize){let a=b.contentBoxSize[0].blockSize;0!==a&&a!==this.state.height&&this.setState({...this.state,height:a})}})};let a=document.getElementById("share-dialog-container");a&&this._dialogHeightRef?.current&&this._dialogHeightRef.current.observe(a)}}componentDidUpdate(a,b){if(this._resizeIfNeeded(),this.state.sharingInformation&&this._logRumone(),this._showSimplifiedDialogV2&&this.state.currentSettings!==b.currentSettings&&b.viewState===$.a.modifyPermissions&&this._focusCopyButton(),b.viewState===$.a.permissionsPivot&&this.state.viewState===$.a.default){let a=ae.a.LimitedSharing;this.state.sharingInformation?.requiresAccessApproval&&(a=ae.a.LinkReShare),this._sharingInfoBarInformation={sharingInfoBarMessageTypeId:a}}if(b.viewState===$.a.linkSuccess&&this.state.viewState===$.a.modifyPermissions){let a=ae.a.LimitedSharingExisting;this.state.sharingInformation?.requiresAccessApproval&&(a=ae.a.LinkReShare),this._sharingInfoBarInformation={sharingInfoBarMessageTypeId:a}}}render(){let a,b,{copyLinkShortcut:c}=this.props,{sharingInformation:d,currentSettings:e,showActivityIndicator:f,sharingLinkCreated:g}=this.state,h=`od-Share ${this.props.fullScreenIframeMode?"not-IE":""} ${this._useSimplifiedDialog&&"od-SimplifiedShare"}`,j=!1;if(!O.Z()&&d&&e&&c&&g&&this.state.viewState!==$.a.error&&this.state.viewState!==$.a.policyDetails)j=!0,a=this._renderPostCopyShortcutView();else switch(this.state.viewState){case $.a.error:a=this._renderError(d);let m="generic share link failure";H.A(this.state.shareType,this.state.sharingInformation.rawError||this.state.sharingInformation.error||m,this.state.sharingInformation.errorCategory,this.state.sharingInformation.errorMessage),this._shareCustomerPromise?.forEach(a=>(0,ab.e)({customerPromise:a,rawErrorMessage:d.rawError||this.state.sharingInformation.error||m,engagementExtraData:this._engagementExtraData,errorType:d.rawError?ab.a.api:ab.a.generic,sharingStore:this._store})),this._shareCustomerPromise=void 0;break;case $.a.default:case $.a.shareToTeams:h+=f?" od-Share--hasActivity":"",j=!0,a=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case $.a.modifyPermissions:j=!0,a=w.createElement(w.Fragment,null,this._renderModifyPermissions($.a.modifyPermissions),this._renderActivityIndicator());break;case $.a.linkSuccess:this._shareCustomerPromise?.forEach(a=>(0,ab.f)({customerPromise:a,engagementExtraData:this._engagementExtraData,sharingStore:this._store})),this._shareCustomerPromise=void 0,a=this._renderNotification();break;case $.a.permissionsList:j=!0,a=this._renderPermissionsList();break;case $.a.permissionsPivot:j=!0,a=this._renderPermissionsPivot();break;case $.a.policyDetails:a=w.createElement(w.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case $.a.atMention:h="",a=this._renderAtMention();break;case $.a.linkSettings:h+=f?" od-Share--hasActivity":"",j=!0,a=w.createElement(w.Fragment,null,this._renderModifyPermissions($.a.linkSettings));break;case $.a.notify:e.sharingLinkKind=k.a.direct,e.audience=l.a.existing,this._engagementExtraData={...this._engagementExtraData,appMap:d.item.appmap},h="",a=w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.l,{...this._baseProps,currentSettings:e,sharingInformation:d,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));break;case $.a.addPeople:j=!0,a=this._renderAddPeople();break;case $.a.spinner:default:if(!O.r()&&this.props.hostOptions?.allowHostToHandleLoading&&this.props.mode===i.a.copy)break;a=w.createElement("div",{className:"od-Share-spinnerHolder"},w.createElement(s.a,{className:"od-Share-spinner",label:F.Gb,size:t.a.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}if(j||h){let c=j?this._sizeConstraints:{};this._showAnimation?(c={...c,height:this.state.height},h+=" animation",b=w.createElement("div",{className:h,style:c},w.createElement("div",{id:"share-dialog-container"},a))):b=w.createElement("div",{className:h,style:c},a)}else b=a;let n=A.n(this.props.clientId)?" teams":"";return w.createElement(B.a,null,w.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:n+" isFluent"},b))}_sharingStoreListener(a){let b=this._store;try{if(this.state.viewState===$.a.error||this.props.mode===i.a.copy&&a&&a.type===U.b.UnshareLink)return;this._useSimplifiedDialog&&b.parsePermissions&&void 0!==b.getSharingInformation()&&b.parsePermissions();let c=b.getSharingInformation(),d=b.getSharingLinkCreated(),e=b.getCompanyName(),f=b.getGroupsMemberCount(),h=b.getPolicyTipInformation(),k=b.getPermissionsMap(),l=b.getDefaultRecipients();if(this._outlookAvailability=b.getOutlookAvailability()||this.props.hostOptions?.outlookAvailability,this._isPeopleSharingLinksEnabled=b.isPeopleSharingLinksEnabled(),!c)return;this._setEngagementExtraData({webTemplateId:c.webTemplateId,itemUniqueId:c.itemUniqueId,isPremium:!!c.isPremium,requiresAccessApproval:!!c.requiresAccessApproval,userRole:m.a[c.userRole],hasInheritedLinks:!!c.hasInheritedLinks}),c.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),b.fetchSharingInformation(!0,!0));let{itemType:o,extension:p}=this._store.getItemInformationForLogging();this._engagementExtraData.itemType=o,this._engagementExtraData.extension=p,this._sanitizeSharingContextInfo(c);let q=this._getSettings(c),r={...this.state};this.state.viewState===$.a.spinner&&(r.viewState=this._getInitialViewState(c,q,d),r.viewState!==$.a.spinner&&(O.Z()&&this.props.mode===i.a.copy?this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.r(this._shareClickTime,this.props.clientId,i.a.copy,this.props.scenarioId,this.props.correlationId):this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():H.D()));let s=!!d;if(O.Z()&&this.props.shareId&&(s=a?.type===U.b.ShareLink),(a?.type===U.b.ShareLink||a?.type===U.b.GrantAccess)&&(r.showSendButtonSpinner=!1),c&&c.error||c?.isStubFile)c.error&&(c.errorCategory===n.a.shareLink||c.errorCategory===n.a.shareObject||c.errorCategory===n.a.createLink||c.errorCategory===n.a.invite)?(this._shareCustomerPromise?.forEach(a=>(0,ab.e)({customerPromise:a,rawErrorMessage:c.error,engagementExtraData:this._engagementExtraData,errorType:c.error||c.errorMessage?ab.a.api:ab.a.generic,sharingStore:this._store})),this._shareCustomerPromise=void 0,a?.type!==U.b.GrantAccess&&this.state.shareType!==j.a.grantAccess&&(r.copyLinkToastStatus=aM.a.error,this._showSimplifiedDialogV2&&(r.copyMessageBarStatus=g.error))):this.props.shareLoadingCustomerPromise?.forEach(a=>(0,ab.e)({customerPromise:a,rawErrorMessage:c.isStubFile?Error("Is stub file"):c.error,engagementExtraData:this._engagementExtraData,errorType:ab.a.api,sharingStore:this._store})),this._flushAriaAndReportError(c),c.errorCategory===n.a.shareLink&&(O.tb()?this.props.mode===i.a.share:this.props.mode!==i.a.copy)?(r.viewState=$.a.default,r.copyLinkToastStatus=aM.a.error,this._showSimplifiedDialogV2&&(r.copyMessageBarStatus=g.error)):c.errorCategory===n.a.shareObject?r.viewState=$.a.default:(this._engagementExtraData.errorCategory=c.errorCategory,this._engagementExtraData.errorMessage=c.errorMessage,this._engagementExtraData.isStubFile=c.isStubFile,r.viewState=$.a.error),O.db()&&y.i(c.error)&&c.errorCategory===n.a.invite&&(r.viewState=this.state.viewState),r.sharingInformation=c;else if((a&&a.type===U.b.ShareLink||this.props.shareId)&&s&&(this.state.shareTargetClicked||this.props.copyLinkShortcut||this.state.applyLinkSettingsClicked)){let a=this._handleCreatedShareLink({settings:q,sharingInformation:c,sharingLinkCreated:d,viewState:r.viewState});r={...r,...a}}else a&&a.type===U.b.GrantAccess?r={...r,viewState:this._store.getGrantAccessResult()?$.a.linkSuccess:this.state.viewState}:(O.I()||a?.type!==U.b.AtMention)&&(!this.props.copyLinkShortcut||!c||this.props.shareId||c.error||this._copyLinkShortcutInvoked||(this._copyLinkShortcutInvoked=!0,this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:q,shareTargetClicked:!1})),r={...r,sharingInformation:c,companyName:e,groupsMemberCount:f,currentSettings:q,policyTipInformation:h,isLoadingDefaultRecipients:b.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:k},l&&!l.isConsumed&&(r.linkRecipients=l.recipients,this._store.consumeDefaultRecipients()));if(this.props.shouldWaitForSharingInfoBarInformation&&O.rc()&&!this.state.sharingInfoBarInformation&&!r.sharingInfoBarInformation&&!this._showSharingBanner){let a=b.getSharingInfoBarInformation();a&&a.sharingInfoBarMessageTypeId&&(r={...r,sharingInfoBarInformation:a})}this.setState(r)}catch(a){this._setGenericErrorState(ab.a.generic,a)}}_handleCreatedShareLink(a){let{sharingInformation:b,settings:c,sharingLinkCreated:d,initialState:e,viewState:f}=a,g=this._store.getCompanyName(),h=e||this.state,j={...h};this._modifiedSharingLinkUrl=(0,E.C)(d,h.shareType,this._store);let k=h.shareType,l=h.currentSettings,m=l?l.isEdit:c.isEdit,n=l?l.isReview:c.isReview,o=l?l.preventDownload:c.preventDownload,p=l?l.audience:c.audience,q=G.l(p,b.sharingAbilities,b.fileExtension),r=G.o(p,b.sharingAbilities,b.fileExtension),s={audience:d.audience,isEdit:m,isReview:r&&n,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(d),sharingLinkKind:d.sharingLinkKind,isDefaultLink:b.defaultSharingLink.sharingLinkKind===d.sharingLinkKind,linkBlocksDownload:!!o,linkWithOfficeReviewMode:q&&n,sharingAudienceChanged:b.defaultSharingLink.audience!==d.audience,shareViewState:f,shareType:h.shareType};this._setEngagementExtraData(s),A.t(this.props.clientId)&&(this._engagementExtraData.sharedToFamilyGroup=h.linkRecipients.some(function(a){return a.familySharingTargetType===L.a.Family}),this._engagementExtraData.sharedToFamilyMember=h.linkRecipients.some(function(a){return a.familySharingTargetType===L.a.FamilyMember}));let t=this._store.getEngagementHelper();t.shareCompleted(this._engagementExtraData),t.logShareLinkGeneration(d,this._engagementExtraData);let u=(0,E.O)(d.sharingLinkKind);return this._sharingClientMessenger?this._sharingClientMessenger.sendShareCompleted():H.z(h.shareType,u),j={...j,...this._handleCreatedShareLinkForShareTypes(d,e)},this.props.mode===i.a.linkSettings?H.o(d,g,this.props.customLabeledAudienceConfig,this.state.sharingInformation.sharedObjectType===V.a.list,this.props.clientId):j={...j,viewState:this._getViewStateFromShareTypeOnLinkSuccess(k,f),sharingLinkCreated:d,companyName:g,showActivityIndicator:!1,sharingInformation:b,currentSettings:this._getSettings(b)},j={...j,showSendButtonSpinner:!1}}_getViewStateFromShareTypeOnLinkSuccess(a,b){switch(a){case j.a.webShareToTeams:return $.a.shareToTeams;case j.a.moreApps:return $.a.default;case j.a.copy:if(this._useSimplifiedDialog&&this.props.mode!==i.a.copy&&a===j.a.copy||P.c()&&b==$.a.default)return $.a.default;return $.a.linkSuccess;default:return $.a.linkSuccess}}_handleCreatedShareLinkForShareTypes(a,b){let c=b||this.state,d={...c},e=c.shareType,f=this._store.getCompanyName();if(this._shareCustomerPromise?.forEach(a=>(0,ab.f)({customerPromise:a,engagementExtraData:this._engagementExtraData,sharingStore:this._store})),this._shareCustomerPromise=void 0,e===j.a.outlook||e===j.a.nonOutlook)A.s(this.props.clientId)?(this._store.navigateToOwa(this._getRecipientEmails(c.linkRecipients),this._modifiedSharingLinkUrl),this._sharingClientMessenger?this._sharingClientMessenger.sendOutlookClicked():H.p(),this._dismiss()):H.x(this._getRecipientEmails(this.state.linkRecipients),this.state.linkRecipients.length,this.state.messageText,this._modifiedSharingLinkUrl);else if(e===j.a.mobileShareToTeams)this._dismiss(),this._sharingClientMessenger?this._sharingClientMessenger.sendTeamsClicked(a,this._getRecipientEmails(c.linkRecipients),c.messageText):H.C(a,this._getRecipientEmails(c.linkRecipients),c.messageText);else if(e===j.a.moreApps)try{d={...d,viewState:$.a.linkSuccess,companyName:f,sharingLinkCreated:a,showActivityIndicator:!1},window.external.SendLinkViaMoreApps(a.url)}catch(a){}else if(e===j.a.webShareToTeams){if(this._modifiedSharingLinkUrl){let a=this._modifiedSharingLinkUrl;this._teamsUrl="https://teams.microsoft.com/share?href="+a+"&referrer=SharePoint.com",d={...d,showTeamsDialog:!0}}}else if(this._useSimplifiedDialog&&e===j.a.copy&&(this.props.mode!==i.a.copy||P.c()&&c.viewState===$.a.default)){d={...d,companyName:f,sharingLinkCreated:a,showActivityIndicator:!1};let b={clientId:this.props.clientId,textField:null,linkUrl:this._modifiedSharingLinkUrl,itemName:this.state.sharingInformation.item.name,extraQosData:this._engagementExtraData};(0,E.m)(b).then(()=>{this._showSimplifiedDialogV2?this.setCopyMessageBarStatus(g.success):this.setCopyToastStatus(aM.a.success)}).catch(a=>{this._showSimplifiedDialogV2&&this.setCopyMessageBarStatus(g.error)})}return d}_generateInitialStateFromStore(){let a=this._store;this._useSimplifiedDialog&&a.parsePermissions&&void 0!==a.getSharingInformation()&&a.parsePermissions();let b=a.getSharingInformation(),c=a.getSharingLinkCreated(),d=a.getCompanyName(),e=a.getGroupsMemberCount(),f=a.getPolicyTipInformation(),h=a.getPermissionsMap(),k=a.getDefaultRecipients();if(this._outlookAvailability=a.getOutlookAvailability(),this._isPeopleSharingLinksEnabled=a.isPeopleSharingLinksEnabled(),!b)return null;{this._engagementExtraData.webTemplateId=b.webTemplateId,this._engagementExtraData.itemUniqueId=b.itemUniqueId;let{itemType:l,extension:m}=this._store.getItemInformationForLogging();this._engagementExtraData.itemType=l,this._engagementExtraData.extension=m,b.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),a.fetchSharingInformation(!0,!0));let n=this._getSettings(b);this._engagementExtraData.defaultAudience=n?.audience;let o=a.getUnhealthyLinks&&a.getUnhealthyLinks()?.length;this._engagementExtraData.numUnhealthyLinks=o,this._store.getEngagementHelper().logNumberOfUnhealthyLinks(o);let p=[];k&&!k.isConsumed&&(p=k.recipients||[],this._store.consumeDefaultRecipients());let q=this._getInitialViewState(b,n,c);q!==$.a.spinner&&(O.Z()&&this.props.mode===i.a.copy?this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.r(this._shareClickTime,this.props.clientId,i.a.copy,this.props.scenarioId,this.props.correlationId):this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():H.D());let r=j.a.share;O.Z()&&this.props.mode===i.a.copy&&(r=j.a.copy);let s={companyName:d,currentSettings:n,sharingInformation:b,sharingLinkCreated:c,readyToCopy:!1,shareType:r,viewState:q,groupsMemberCount:e,policyTipInformation:f,linkRecipients:p,shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:h,messageText:this.props.messageText||"",summaryText:this.props.summaryText||"",summaryState:0,subjectText:this.props.subjectText||"",index:0,isLoadingDefaultRecipients:this._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1,copyLinkToastStatus:aM.a.closed,copyMessageBarStatus:g.closed,showSendButtonSpinner:!1,height:this._showAnimation?0:"auto",sharingInfoBarState:this._getInitialSharingInfoBarState()};if(this._sharingInfoBarInformation=this._showSharingBanner&&this._getInitialSharingInfoBarInformation(q),b.error)return this.props.shareLoadingCustomerPromise?.forEach(a=>(0,ab.e)({customerPromise:a,rawErrorMessage:b.rawError||b.error,engagementExtraData:this._engagementExtraData,errorType:ab.a.api,sharingStore:this._store})),this._flushAriaAndReportError(b),{...s,viewState:$.a.error,sharingInformation:b,height:"auto"};{let c=a.getSharingLinkCreated();if(c){let a=this._handleCreatedShareLink({settings:n,sharingInformation:b,sharingLinkCreated:c,initialState:s,viewState:q});s={...s,...a}}return s}}}_getInitialViewState(a,b,c){switch(this.props.mode){case i.a.share:if(a&&b)return $.a.default;break;case i.a.atMention:if(a&&b)return $.a.atMention;break;case i.a.linkSettings:if(b)return $.a.linkSettings;break;case i.a.manageAccess:if(b)if(this._usePermissionsPivot)return $.a.permissionsPivot;else return $.a.permissionsList;break;case i.a.copy:if(a&&b&&c)return $.a.linkSuccess;break;case i.a.notify:if(a)return $.a.notify;break;case i.a.addPeople:if(a)return $.a.addPeople;break;default:throw Error("Mode not implemented: "+this.props.mode)}return $.a.spinner}_renderAtMention(){let a=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.a,{...this._baseProps,engagementExtraData:this._engagementExtraData,currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,canGrantEditPermissions:this.props.hostOptions?.canGrantEditPermissions,onComplete:a}))}_renderPostCopyShortcutView(){let{sharingInformation:a,currentSettings:b,companyName:c,sharingLinkCreated:d,viewState:e,groupsMemberCount:f}=this.state,g=d&&d.createdViaCopyLinkCommand||this._copyLinkShortcutInvoked;return this._shareCustomerPromise&&e===$.a.linkSuccess&&(this._shareCustomerPromise?.forEach(a=>(0,ab.f)({customerPromise:a,engagementExtraData:this._engagementExtraData,sharingStore:this._store})),this._shareCustomerPromise=void 0),w.createElement(aa,{...this._baseProps,mode:this.props.mode,shareId:this.props.shareId,companyName:c,currentSettings:b,item:a.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClick:this._getNotificationHintClickHandler(g),sharingInformation:a,showExistingAccessOption:this.props.showExistingAccessOption,viewState:e,groupsMemberCount:f,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,hostOptions:this.props.hostOptions,onShareNotificationRenderComplete:d&&(()=>{this._writeShareDataToRumoneLogger({mode:this.props.mode,viewState:this.state.viewState})}),shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:this.state.sharingInfoBarInformation?.sharingInfoBarMessageTypeId,onShowPermissionsListClicked:this._showPermissionsList})}_renderError(a){return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.g,{...this._baseProps,theme:this.props.theme,viewState:$.a.error,sharingInformation:a,showReportProblem:this._store.isReportProblemSupported()}))}_getSettings(a){let b=this.state?.currentSettings,c=a&&a.error,d=a.sharingLinks&&a.sharingLinks.length&&this.props.shareId,e=G.f(a.sharingAbilities,a.sharingLinkTemplates),f=!1;if(!b&&!c){let c=a.defaultSharingLink;if(d){let b=a.sharingLinks.filter(a=>a.shareId===this.props.shareId&&a.isActive)[0];b&&(c=b,f=!0)}if(void 0!==e&&e.length>0){let b=e.filter(b=>b.sharingLinkKind===a.defaultSharingLink.sharingLinkKind)[0];c=b||(b=e.filter(b=>b.audience===a.defaultSharingLink.audience)[0])?b:e[0],f=!0}b=this._initializeCurrentSettings(c,a,this.props.copyLinkShortcut,f),e.length>0&&(b.shareId=c.shareId,b.fetchLinkOnly=!0,b.audience=c.audience,b.expiration=c.expiration,b.isEdit=c.isEdit,b.isReview=c.isReview,b.sharingRole=c.isEdit?(0,E.r)(this.props.clientId,a):c.isReview?m.a.review:m.a.view,b.trackLinkUsers=c.trackLinkUsers,b.preventDownload=c.blockDownload,b.sharingLinkKind=c.sharingLinkKind,this._engagementExtraData.isRedeemedUserResharing=!0,this._engagementExtraData.redeemedLinksCount=e.length)}return b}_getRecipientEmails(a){let b=[];for(let c of a){let a=c.email;a&&b.push(a)}return b}_getNumberOfDaysUntilExpiry(a){let b=a.expiration&&new Date(a.expiration),c=new Date;if(b)return Math.floor((b.getTime()-c.getTime())/864e5)}_handleEscKeyPress(a){this._viewStates.length>0?this._returnToPreviousView():this._dismiss(),a.stopImmediatePropagation()}_initializeCurrentSettings(a,b,c,d){if(this._store.isConsumer())return this._store.getInitialLinkSettings(a);if(P.c()){let a=this._store.getReShareLink(l.a.organization)||this._store.getReShareLink(l.a.anyone);if(b.requiresAccessApproval&&a)return{allowEditing:!1,audience:a.audience,expiration:a.expiration||null,isEdit:!1,sharingRole:(0,E.K)(a,this.props.clientId,b),sharingLinkKind:a.sharingLinkKind,specificPeople:[],updatePassword:!1,password:"",preventDownload:a.blockDownload,shareId:"",trackLinkUsers:!1,sharingScope:a.sharingScope}}if(b.requiresAccessApproval&&c){let c=(0,E.r)(this.props.clientId,b),d=!0;return P.c()&&(c=b.userRole||c,d=!1),{allowEditing:d,audience:l.a.existing,expiration:null,isEdit:!0,sharingRole:c,sharingLinkKind:k.a.direct,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:a.sharingScope}}if(b.defaultSharingLink===a&&b.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(a,b,c,!!O.ac()&&!!this.props.overrideDefaultPermission);if(a.audience===l.a.specificPeople){if(!b.canManagePermissions||b.blockPeoplePickerAndSharing)a.audience=l.a.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:l.a.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:(0,E.r)(this.props.clientId,b),sharingLinkKind:k.a.flexible,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:a.sharingScope}}a.audience===l.a.specificPeopleFlex&&c&&!d&&(a.audience=l.a.existing,a.sharingLinkKind=k.a.direct);let e=a.sharingLinkKind,f=e===k.a.anonymousEdit||e===k.a.organizationEdit||e===k.a.direct||e===k.a.flexible,g=a.isEdit&&2===b.defaultShareLinkPermission,h=[];this.props.shareId&&a.principals&&(h=(0,E.B)(a));let i=O.Dc()?m.a.view:(0,E.K)(a,this.props.clientId,b);return{allowEditing:f,audience:(this.props.preferCustomLabeledAudience||(0,E.S)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig))&&a.audience===l.a.specificPeopleFlex?l.a.customLabeledSpecificPeople:a.audience,expiration:a.expiration||null,isEdit:g,sharingRole:g?(0,E.r)(this.props.clientId,b):i,sharingLinkKind:a.sharingLinkKind,specificPeople:h,updatePassword:!1,password:"",preventDownload:a.blockDownload,shareId:"",trackLinkUsers:b.anyoneLinkTrackUsers,sharingScope:a.sharingScope}}_initializeCurrentSettingsWithSharingAbilities(a,b,c,d){let e,f=b.sharingAbilities,g="00000000-0000-0000-0000-000000000000"===this.props.shareId,h=g?k.a.direct:b.defaultSharingLink.sharingLinkKind,i=g?o.a.existing:b.defaultSharingLink.sharingScope,j=(0,E.S)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?l.a.customLabeledSpecificPeople:l.a.specificPeople;if(b.defaultShareLinkToExistingAccess)j=l.a.existing,h=k.a.direct;else if(null!=i)switch(i){case o.a.anyone:j=l.a.anyone;break;case o.a.organization:j=l.a.organization;break;case o.a.specificPeople:j!==l.a.customLabeledSpecificPeople&&(j=l.a.specificPeopleFlex);break;case o.a.existing:default:g||!b.canManagePermissions||b.blockPeoplePickerAndSharing?j=l.a.existing:this._isPeopleSharingLinksEnabled?(j!==l.a.customLabeledSpecificPeople&&(j=l.a.specificPeopleFlex),h=k.a.flexible):j=l.a.existing}else switch(h){case k.a.anonymousEdit:case k.a.anonymousView:j=l.a.anyone;break;case k.a.organizationEdit:case k.a.organizationView:j=l.a.organization;break;case k.a.direct:default:g||!b.canManagePermissions||b.blockPeoplePickerAndSharing?j=l.a.existing:this._isPeopleSharingLinksEnabled?(j!==l.a.customLabeledSpecificPeople&&(j=l.a.specificPeopleFlex),h=k.a.flexible):j=l.a.existing}j===l.a.specificPeopleFlex&&c&&(j=l.a.existing,h=k.a.direct);let n=G.e(j,f),q=null,r=n.linkExpiration;(r?r.defaultExpirationInDays:null)>0&&(q=new Date(new Date().toDateString())).setDate(q.getDate()+r.defaultExpirationInDays);let s=6===b.defaultShareLinkPermission,t=!G.h(l.a.specificPeople,f,p.a.forceCheckoutEditLink),u=this._showSimplifiedDialogV2?t:G.i(j,f);O.ac()&&(this._engagementExtraData.didOverrideTenantDefaultPermission=!1);let v=u&&this._allowEditBasedOnDefaultShareLinkPermission(b,n)&&(!O.ac()||!this._shouldOverrideIsEditToFalse(d,a.audience,b.sharingAbilities,b)),w=v?(0,E.r)(this.props.clientId,b):s?m.a.review:m.a.view;(e=7===b.defaultShareLinkPermission)&&(O.s()?w=this._isVideo&&this._showSimplifiedDialogV2?m.a.restrictedview:m.a.view:G.g(b.sharedObjectType,b.fileExtension,b.userRole,this._store.isPreventDownloadAllowed?.(),f.directSharingAbilities)&&(w=m.a.restrictedview));let x=this.props?.hostOptions?.hiddenAudienceOptions||[],y=this.props?.hostOptions?.disabledAudienceOptions||[];j=-1===x.indexOf(j)&&-1===y.indexOf(j)?j:l.a.existing,G.j(j,f)&&(j=l.a.existing);let z=j===l.a.existing?k.a.direct:O.ac()?this._getSharingLinkKindAfterReadOverrideCheck(d,h,a.audience,b.sharingAbilities):h;return{allowEditing:u,audience:j,expiration:q,isEdit:v,sharingRole:w,isReview:s,preventDownload:e,sharingLinkKind:z,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:b.anyoneLinkTrackUsers,sharingScope:a.sharingScope}}_allowEditBasedOnDefaultShareLinkPermission(a,b){let c=0===a.defaultShareLinkPermission&&b.supportsEditPermission.enabled&&(0,E.k)(a.userRole,m.a.edit);return 2===a.defaultShareLinkPermission||c}_setEngagementExtraData(a){let b=this.state,c=this.props,d=b?.currentSettings,e=(0,ac.a)(location.search.substring(1)),f=e.cookieexpirationreload&&"true"===e.cookieexpirationreload.toLowerCase();this._engagementExtraData={...this._engagementExtraData,scenarioId:c.scenarioId,correlationId:this._correlationId,hostSessionId:c.hostSessionId||"",mode:c.mode||(c.copyLinkShortcut?i.a.copy:i.a.share),withSummary:!!c.summaryText,withSummaryFailed:!!c.summaryText&&-1!==c.summaryText.indexOf("Something went wrong with retrieving a summary"),audience:d?.audience,isEdit:d?.isEdit,isReview:d?.isReview,sharingRole:m.a[d?.sharingRole],recipientsCount:b?.linkRecipients?.length,externalRecipientsCount:b?.externalRecipientsCount,linkedinRecipientsCount:b?.linkedinRecipientsCount,hasMessage:!!b?.hasMessage,hasSubject:!!b?.hasSubject,messageLength:b?.messageLength,shareViewState:b?.viewState,hasNavId:!!this._store.getNavId(),hasTargetDocId:!!this._store.getTargetDocId(),groupRecipientCount:b?.linkRecipients?.filter(a=>a.entityType===z.a.group&&null==a.familySharingTargetType).length,isSimplifiedShareDialog:this._showSimplifiedDialog,isSimplifiedShareDialogV2:this._showSimplifiedDialogV2,isWebview2:!O.n()&&(0,bL.b)(c.scenarioId),timeToShareDuration:Date.now()-this._shareComponentRenderedTime,shareType:b?.shareType,...a,isCrossFarm:this._isCrossFarm,disableAutoCopy:!!c.hostOptions?.disableAutoCopy,cookieExpirationReload:!!f}}_shouldOverrideIsEditToFalse(a,b,c,d){let e=this.props.scenarioId,f=a&&G.m(b,d,c,d.requiresAccessApproval,e),g=a&&G.n(b,c,e);return(g||f)&&(this._engagementExtraData.didOverrideTenantDefaultPermission=!0),!O.Ic()&&this._showSimplifiedDialogV2?f:g}_getSharingLinkKindAfterReadOverrideCheck(a,b,c,d){if(!a||!G.n(c,d,this.props.scenarioId))return b;let e=this._getOverriddenSharingLinkKind(b);return e!==b&&(this._engagementExtraData.didOverrideTenantDefaultPermission=!0),e}_getOverriddenSharingLinkKind(a){switch(a){case k.a.organizationEdit:return k.a.organizationView;case k.a.anonymousEdit:return k.a.anonymousView;default:return a}}_loadTheme(a){try{(0,J.F)(a)}catch(a){}}_onRedirectTeamsClicked(){this._store.getEngagementHelper().webShareToTeamsTargetClicked(this._engagementExtraData),this._store.getEngagementHelper().shareCompleted(this._engagementExtraData),this.setState({shareType:j.a.webShareToTeams,shareTargetClicked:!0,viewState:$.a.shareToTeams},()=>{this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!1,shareType:j.a.webShareToTeams}),this._viewStates.push(this.state.viewState)})}async _onCopyLinkClicked(a){let{copyLinkShortcut:b,initializedSettings:c,shareTargetClicked:d=!0}=a,e={sendInvitation:!1,...c,...this.state?.currentSettings};this._copyTargetClickTime=Date.now();let f=new X.a({scenario:(0,W.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}}),g=(0,ab.c)(this.props.clientId);if(g){let a=new X.a({scenario:`${g}-ShareDialog.shareLink`,perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}});this._shareCustomerPromise=[f,a]}else this._shareCustomerPromise=[f];if(this.props.mode!==i.a.copy&&await this._store.shouldInterruptCopyLink(e.isEdit))this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData),this.setState({showCopyLinkInterrupt:!0});else{let a=this.state.copyLinkToastStatus;this._showSimplifiedDialog&&(a=aM.a.inProgress),this.setState({shareType:j.a.copy,shareTargetClicked:d,copyLinkToastStatus:a},()=>{let a=this.state.linkRecipients;this._store.isConsumer()&&e?.audience!==l.a.specificPeople&&(a=[]),this._store.shareLink({settings:e,recipients:a,copyLinkCommand:b,shareType:j.a.copy})})}}_onSelectedPermissionsChange(a){let b=this.state.permissionsMap;a.audience===l.a.existing?this._store.checkPermissions(this.state.linkRecipients):b={};let c=$.a.default;this.props.mode===i.a.linkSettings?c=this.state.viewState:this._viewStates&&this._viewStates.length>0&&(c=this._viewStates.pop());let d=this.state.linkRecipients;O.ib()&&this.props.mode!==i.a.share&&(d=a.specificPeople),this.setState({viewState:c,currentSettings:{allowEditing:a.allowEditing,trackLinkUsers:a.trackLinkUsers,audience:a.audience,expiration:a.expiration,isEdit:a.isEdit,isReview:a.isReview,sharingRole:a.sharingRole,sharingLinkKind:a.sharingLinkKind,specificPeople:a.specificPeople,updatePassword:a.updatePassword,password:a.password,hasPassword:a.hasPassword,preventDownload:a.preventDownload,shareId:a.shareId,fetchLinkOnly:a.fetchLinkOnly,requireSignIn:a.audience===l.a.specificPeople,sharingScope:a.sharingScope},permissionsMap:b,linkRecipients:d})}_renderBackButtonForPriorView(){if(this._viewStates.length>0)return K.b(w.createElement(D.a,{className:"od-Share-backButton absolute priorView",id:"od-Share-prevView-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:F.ub}),F.ub,{tooltipId:"od-Share-backButton-tooltip",position:af.a.bottomCenter,targetElementId:"od-Share-prevView-backButton"})}_renderBackButtonForPolicyDetails(){if(this.state.viewState===$.a.policyDetails)return K.b(w.createElement(D.a,{className:"od-Share-backButton absolute",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:F.ub}),F.ub)}_renderShareMain(a,b){let c=this._checkShouldRenderInfoBar(),d=this._showSharingBanner?this._sharingInfoBarInformation?.sharingInfoBarMessageTypeId:this.state.sharingInfoBarInformation?.sharingInfoBarMessageTypeId;return w.createElement("div",{className:"od-Share-shareMainDiv",style:{maxHeight:this._maxHeight}},!this._useSimplifiedDialog&&this._renderBackButtonForPriorView(),this._useSimplifiedDialog?w.createElement(bm,{...this._baseProps,key:"simplified-share",companyName:this.state.companyName,copyButtonRef:this._copyBtnRef,copyLinkToastStatus:this.state.copyLinkToastStatus,copyMessageBarStatus:this.state.copyMessageBarStatus,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,currentSettings:b,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this._engagementExtraData,focusCopyButton:this._focusCopyButton,groupsMemberCount:this.state.groupsMemberCount,isFREAbandoned:this._isFREAbandoned,index:this.state.index,item:a.item,linkRecipients:this.state.linkRecipients,messageText:this.state.messageText,summaryState:this.state.summaryState,permissionsMap:this.state.permissionsMap,permissionsLabel:this._getPermissionsLabel((0,E.w)(this._getLabelProps())),sharingInformation:a,outlookAvailability:this._outlookAvailability,fullscreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,onAudienceChange:this._onAudienceChange,onRoleChange:this._onRoleChange,onShareTargetClicked:this._onShareTargetClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._showSimplifiedDialogV2?this._onGrantDirectAccess:this._onSendLinkClicked,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSummaryStateChange:this._onSendLinkSummaryStateChange,onViewPolicyTipClicked:this._onViewPolicyTipClicked,shouldRenderSharingInfoBar:c,showLinkSettings:this._showModifyPermissions,showPermissionsList:this._showPermissionsList,setCopyToastStatus:this.setCopyToastStatus,setCopyMessageBarStatus:this.setCopyMessageBarStatus,setIndex:this._setFREIndex,sharingInfoBarMessageTypeId:d,showSendButtonSpinner:this.state.showSendButtonSpinner,renderSharingInfoBar:this._renderSharingInfoBar,returnToPreviousView:this._returnToPreviousView,getStatusIcons:this._getStatusIcons,renderBackButton:this._viewStates.length>0,generateSummary:this.props.generateSummary}):w.createElement(r.b,{...this._baseProps,key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:b,item:a.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClick:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:a,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,summaryText:this.state.summaryText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this._onRoleChange,onAudienceChange:this._onAudienceChange,fullScreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,hasBackButton:this.props.mode===i.a.manageAccess,onBackButtonClicked:this._returnToPreviousView,showItemInsights:this.props.showItemInsights,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:d}),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!b.password}),this.state.showTeamsDialog&&this._renderTeamsDialog())}_renderTeamsDialog(){return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.o,{url:this._teamsUrl,onDismiss:this._dismiss,height:this.props.calculatedIframeHeight,onBackButtonClicked:this._returnToPreviousView.bind(this)}))}_renderPolicyDetails(){return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.n,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation,onBackButtonClicked:this._returnToPreviousView}))}_renderCopyLinkInterrupt(a){let{updatePassword:b}=a;return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.d,{confirmationCode:b?12:13,participant:null,onApply:b?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:b?this._onInterruptUseExisting:this._onInterruptUseNew}))}_renderModifyPermissions(a){let b=this._checkShouldRenderInfoBar();return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.i,{...this._baseProps,shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this.state.copyLinkShortcut?this._copyLinkOnApplyClicked:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:this.state.copyLinkShortcut,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onShowPermissionsListClicked:this._showPermissionsList,fullScreenIframeMode:this.props.fullScreenIframeMode,maxHeight:this._maxHeight,renderBackButton:this._viewStates.length>0,renderSharingInfoBar:this._renderSharingInfoBar,shouldRenderSharingInfoBar:b,shouldAnnounceModeChange:this._viewStates.length>0,onLinkSettingsInfoMessageClick:this._onLinkSettingsInfoMessageClick}),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!this.state.currentSettings.password}))}_renderNotification(){let a=this.state,b=a.sharingInformation,c=a.sharingLinkCreated,d=a.shareType===j.a.share?this.state.linkRecipients:null;this._showSimplifiedDialogV2&&(d=a.shareType===j.a.share||a.shareType===j.a.grantAccess?this.state.linkRecipients:null),O.sc()&&(d=this.state.linkRecipients);let e={companyName:a.companyName,currentSettings:a.currentSettings,sharingInformation:b,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(c&&c.createdViaCopyLinkCommand),linkRecipients:d,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig},f=!O.zb()||a.shareType===j.a.copy,g=w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.q,{...this._baseProps,permissionsLabel:this._getPermissionsLabel((0,E.w)(this._getLabelProps())),sharingHintProps:e,onSharedWithClick:this._showPermissionsList,loadFloodgateDataSource:this.context.loadFloodgateDataSource,shareType:a.shareType,getStatusIcons:this._getStatusIcons,maxHeight:this._maxHeight}));if(this._useSimplifiedDialog)switch(this.props.mode){case i.a.share:case i.a.manageAccess:case i.a.linkSettings:return g;case i.a.copy:if(!O.sc())break;if(this._store.getEngagementHelper().setEngagementExtraData(this._engagementExtraData),P.c()&&a.shareType===j.a.grantAccess)return g;return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.e,{...(0,T.a)(this.props),linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:e,permissionsLabel:this._getPermissionsLabel((0,E.w)(this._getLabelProps())),onSharedWithClick:this._showPermissionsList,onRenderComplete:()=>{this._writeShareDataToRumoneLogger({mode:this.props.mode,viewState:this.state.viewState})},renderSharingInfoBar:this._renderSharingInfoBar,shouldRenderSharingInfoBar:this._checkShouldRenderInfoBar(),shouldWaitForSharingInfoBarInformation:f&&this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:f?this.state.sharingInfoBarInformation?.sharingInfoBarMessageTypeId:void 0,rumoneLogger:this._rumoneLogger}))}return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.m,{...(0,T.a)(this.props),shareType:a.shareType,itemName:b.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:e,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,generatedFromTargetClick:a.shareTargetClicked,shouldWaitForSharingInfoBarInformation:f&&this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:f?this.state.sharingInfoBarInformation?.sharingInfoBarMessageTypeId:void 0,engagementExtraData:this._engagementExtraData,onRenderComplete:c&&this.props.mode===i.a.copy&&(()=>{this._writeShareDataToRumoneLogger({mode:this.props.mode,viewState:this.state.viewState})})}))}_getInitialSharingInfoBarInformation(a){if(this._showSharingBanner)switch(a){case $.a.default:if(P.c()){let a=this._store.getReShareLink(l.a.organization)||this._store.getReShareLink(l.a.anyone);if(this._store.getSharingInformation().requiresAccessApproval&&a)return{sharingInfoBarMessageTypeId:ae.a.LinkReShare}}return{sharingInfoBarMessageTypeId:ae.a.LimitedSharing};case $.a.modifyPermissions:return{sharingInfoBarMessageTypeId:ae.a.LimitedSharingExisting}}}_getInitialSharingInfoBarState(){return this._showSharingBanner?bJ.a.Visible:this.props.shouldWaitForSharingInfoBarInformation?bJ.a.WaitingForSharingInfoBarInformation:bJ.a.None}_getNotificationHintClickHandler(a){return a?this._showModifyPermissions.bind(this,N.b.CopyLinkSettingsHint,a):null}_renderPermissionsPivot(){let a=O.f&&!this.state.sharingInformation.addressBarLinkSettings,b=this.props.hostOptions?.showCloseButton??A.r(this.props.clientId);return this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&!a||this._store.fetchSharingInformation(!0,a),w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.k,{...this._baseProps,engagementExtraData:this._engagementExtraData,sharingInformation:this.state.sharingInformation,clientId:this.props.clientId,onDefaultShare:()=>this._showShare(),showCloseButton:b,onDismiss:this._dismiss,store:this._store,companyName:this.state.companyName,onStopSharingClicked:this.props.onStopSharingClicked,pageContext:this.props.pageContext,advancedUrl:this.props.advancedUrl,mode:this.props.mode,backButtonClicked:this._returnToPreviousView,getGraphToken:this.props.getGraphToken,sensitivityLabelInformation:this.state.sharingInformation.sensitivityLabelInformation,grantAccessClicked:this._enterGrantAccessView,maxHeight:this._maxHeight}))}_showShare(){this._viewStates.push(this.state.viewState),this.setState({viewState:$.a.default})}_renderPermissionsList(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);let a=!1;return G.k(this.state.currentSettings.audience,this.state.sharingInformation.sharingAbilities)&&(a=!0),this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===V.a.list&&O.Q(),w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.j,{...this._baseProps,onStopSharingClicked:this.props.onStopSharingClicked,centeredManageAccessEnabled:!0,grantAccessClicked:this._enterGrantAccessView,shareButtonClicked:this._enterShareView,showHeader:!0,advancedUrl:this.props.advancedUrl,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData,isInfectedFile:a}))}_renderAddPeople(){let a=!this.props.hideShareDialogOverflowButton;return w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.h,{...this._baseProps,backButtonClicked:this._enterManageAccessView,centeredManageAccessEnabled:!0,onManageExistingAccessClick:a?()=>this._showPermissionsList():void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked,maxHeight:this._maxHeight,mode:this.props.mode}))}_renderActivityIndicator(){if(this.state.showActivityIndicator)return w.createElement(C.a,{message:F._})}_resizeIfNeeded(){(!P.e()||this.state.viewState!==$.a.shareToTeams)&&this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)}_setGenericErrorState(a,b,c){let d=(0,ab.b)(this.state.sharingInformation,a,b,c);this.props.shareLoadingCustomerPromise?.forEach(c=>(0,ab.e)({customerPromise:c,rawErrorMessage:d.rawError||b,engagementExtraData:this._engagementExtraData,errorType:a,sharingStore:this._store})),this.setState({sharingInformation:d,viewState:$.a.error}),window.parent.postMessage(JSON.stringify({name:"share_resetMakeVisible"}),"*")}_sanitizeSharingContextInfo(a){if(a&&(this._isSanitizedUrl(a.customizedExternalSharingServiceUrl)||(a.customizedExternalSharingServiceUrl=""),this._isSanitizedUrl(a.fixItUrl)||(a.fixItUrl=""),a.defaultSharingLink&&!this._isSanitizedUrl(a.defaultSharingLink.url)&&(a.defaultSharingLink.url=""),a.directLink&&!this._isSanitizedUrl(a.directLink.url)&&(a.directLink.url=""),a.sharingLinks))for(let b=0;b<a.sharingLinks.length;b++)a.sharingLinks[b]&&!this._isSanitizedUrl(a.sharingLinks[b].url)&&(a.sharingLinks[b].url="")}_isSanitizedUrl(a){return!a||0===a.length||0===a.toLowerCase().indexOf("http://")||0===a.toLowerCase().indexOf("https://")}_logRumone(){let a=()=>{this._isInitialPageLoadDataLogged=!0;let a=this.props.mode,b=this.state.viewState;setTimeout(()=>{this._writeShareDataToRumoneLogger({mode:a,viewState:b})},0)},b=()=>{let a=this.props.mode,b=this.state.viewState;setTimeout(()=>{this._writeCopyLinkTargetDataToRumoneLogger({mode:a,viewState:b,clickTime:this._copyTargetClickTime})})},c=this.state.viewState===$.a.linkSuccess;if(this._showSimplifiedDialog&&this.state.copyLinkToastStatus===aM.a.success&&(c=!0),this._showSimplifiedDialogV2&&this.state.copyMessageBarStatus===g.success&&(c=!0),(this.props.mode===i.a.share||this.props.mode===i.a.copy)&&this.state.shareTargetClicked&&c)b();else if(this.state.viewState===$.a.linkSuccess&&this.props.mode===i.a.copy)O.sc()||(this._isInitialPageLoadDataLogged=!0);else if(!this._isInitialPageLoadDataLogged)switch(this.props.mode){case i.a.share:this.state.viewState!==$.a.default||this.state.shareTargetClicked||a();break;case i.a.copy:this.state.viewState!==$.a.linkSuccess||this.state.shareTargetClicked||a();break;case i.a.manageAccess:(this.state.viewState===$.a.permissionsList||this.state.viewState===$.a.permissionsPivot)&&a();break;case i.a.linkSettings:this.state.viewState===$.a.linkSettings&&a();break;case i.a.atMention:this.state.linkRecipients.length>0&&a()}}_writeShareDataToRumoneLogger(a){let{mode:b,viewState:c}=a,d=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart,e=this._store.getWebView2Times();this._writePerfData({pageTransitionType:Z.a.fullPageLoad,startTime:d,mode:this.props.mode,originalMode:b,viewState:this.state.viewState,originalViewState:c,audience:this.state.currentSettings.audience,webView2Times:e})}_writeCopyLinkTargetDataToRumoneLogger(a){if(this._rumoneLogger.resetRumOne()){let{mode:b,viewState:c,clickTime:d}=a;this._writePerfData({pageTransitionType:Z.a.onePageAppNavigation,startTime:d,mode:i.a.copy,originalMode:b,viewState:this.state.viewState,originalViewState:c,audience:this.state.currentSettings.audience})}}_writePerfData(a){let{pageTransitionType:b,startTime:c,mode:d,originalMode:e,viewState:f,originalViewState:g,audience:h,webView2Times:j}=a;if(this.props&&c&&this.props.clientId){let a=Object.keys(i.a).filter(a=>i.a[a]===d)[0],k=Object.keys(i.a).filter(a=>i.a[a]===e)[0],l=Object.keys(q.a).filter(a=>q.a[a]===this.props.clientId)[0],m=this._store.getSharingInformationAPIStats(),n=this._store.getShareLinkAPIStats(),o=this._store.getWaitSharingAPIsDuration?this._store.getWaitSharingAPIsDuration():null,p=this._rumoneLogger.breakdownData,r={modeName:a,startTime:c,endTime:Date.now(),breakDownData:{sharingClientId:p(l),mode:p(a),audience:p(h),originalMode:p(k),viewState:p(f),originalViewState:p(g),getSharingInformationAPIStats:m?p(m):null,shareLinkAPIStats:n?p(n):null,realUserClickTime:p(c!==performance.timing.navigationStart),beforeNavigation:p(c<performance.timing.navigationStart?performance.timing.navigationStart-c:0),isInstantSecondLoad:!!this.props.isInstantSecondLoad,isLightSpeed:!0,waitSharingAPIsDuration:o,clickTime:c,navigationStart:performance.timing.navigationStart,isWebview2:!O.n()&&(0,bL.b)(this.props.scenarioId),isUsingPreloadedWebview2:this._store.getIsUsingPreloadedWebview2(),...j?{webView2Times:j}:{},isCrossFarm:this._isCrossFarm,disableAutoCopy:!!this.props.hostOptions?.disableAutoCopy}};this._rumoneLogger.logSharingPerformance(r,b)}}_flushAriaAndReportError(a){let b=Promise.resolve();this.props.flushTelemetry&&(b=this.props.flushTelemetry()),b.then(()=>{setTimeout(()=>{this._sharingClientMessenger?this._sharingClientMessenger.sendShareError(a):H.q(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,a,this._correlationId)},0)})}_isWordFileEnabledFor3S(a){return O.Tb()&&(this.props.clientId===q.a.wac||this.props.clientId===q.a.word||this.props.clientId===q.a.odcWac)&&(0,ad.e)(a.fileExtension)}_isXPFileEnabledFor3S(a){return O.Ub()&&(this.props.clientId===q.a.wac||this.props.clientId===q.a.odcWac||this.props.clientId===q.a.excel||this.props.clientId===q.a.powerpoint)&&((0,ad.c)(a.fileExtension)||(0,ad.d)(a.fileExtension))}_calculateIsCrossFarm(a,b){let c=b.multiGeoInfo||[],d=a+"/";if(!a)return!1;for(let a of c)if(a.MySiteHostUrl===d||a.PortalUrl===d||a.RootSiteUrl===d){let c=new bM.a(b.webAbsoluteUrl).authority+"/";if(a.MySiteHostUrl===c||a.PortalUrl===c||a.RootSiteUrl===c)return!1;return!0}return!1}constructor(a,b){super(a),this._viewStates=[],this._shareMainControl=(0,w.createRef)(),this._topLevelDivRef=w.createRef(),this._dialogHeightRef=w.createRef(),this._copyBtnRef=w.createRef(),this._isFREAbandoned=!1,this._setFREIndex=a=>{this.setState({index:a})},this._copyLinkOnCancelClicked=()=>{this._returnToPreviousView()},this._copyLinkOnApplyClicked=(a,b)=>{let c={currentSettings:a,linkRecipients:a.specificPeople,viewState:this.state.viewState};this.setState(c,()=>{this._store.getEngagementHelper().linkSettingsApplyClicked(this._engagementExtraData),this._onCopyLinkClicked({copyLinkShortcut:!0})})},this._closeButtonOnBlur=()=>{this.setState({isCloseButtonOnFocus:!1})},this._closeButtonOnFocus=()=>{this.setState({isCloseButtonOnFocus:!0})},this._onAudienceChange=(a,b,c)=>{this.setState({currentSettings:{...this.state.currentSettings,audience:a,sharingLinkKind:b,sharingScope:c}})},this._onRoleChange=a=>{let b=(0,E.T)(a),c=a===m.a.view,d=a===m.a.review,e=a==m.a.manageList,f=a===m.a.restrictedview;if(!b&&!c&&!d&&!e&&!f)throw Error("Role not implemented: "+m.a[a]);let g=this.state.currentSettings,h=d||e||f?k.a.flexible:(0,E.z)(g.audience,b);g.sharingRole!==a&&this._store.getEngagementHelper().SharingRoleChangedFromCompactRoleSelector({sharingRole:m.a[a],isEdit:b,isReview:d,blockDownload:f,isManageList:e});let i=g.preventDownload;(this._isVideo||this._showSimplifiedDialogV2)&&(i=f),this.setState({...this.state,currentSettings:{...g,sharingRole:a,isEdit:b,isReview:d,isManageList:e,sharingLinkKind:h,preventDownload:i}})},this._onShareTargetClicked=(a,b)=>{let c;switch(H.y(a),a){case j.a.outlook:c="outlookClicked";break;case j.a.webShareToTeams:c="webShareToTeamsClicked";break;case j.a.mobileShareToTeams:c="mobileShareToTeamsClicked";break;case j.a.nonOutlook:c="nonOutlookClicked";break;case j.a.copy:c="copyButtonClicked";break;case j.a.moreApps:c="moreAppsClicked"}if(a!==j.a.copy){let a=new X.a({scenario:(0,W.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:c}}),b=(0,ab.c)(this.props.clientId);if(b){let d=new X.a({scenario:`${b}-ShareDialog.shareLink`,perfGoalInMs:3e4,extraData:{sharingScenario:c}});this._shareCustomerPromise=[a,d]}else this._shareCustomerPromise=[a]}if(this._store.getEngagementHelper().log("ShareV3.shareTargetClicked",{...this._engagementExtraData,shareType:a}),a!==j.a.share){if(a===j.a.copy){this._sharingClientMessenger?this._sharingClientMessenger.sendCopyLinkShareTargetClicked():H.c(),this._onCopyLinkClicked({copyLinkShortcut:b});return}if(a===j.a.webShareToTeams)return void this._onRedirectTeamsClicked();this.setState({shareType:a,shareTargetClicked:!0},()=>{this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!1,shareType:a})})}},this._onLinkPermissionsApplyClicked=a=>{if(this._store.getEngagementHelper().linkSettingsApplyClicked(this._engagementExtraData),this._onSelectedPermissionsChange(a),this.props.mode===i.a.linkSettings){let a=new X.a({scenario:(0,W.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}}),b=(0,ab.c)(this.props.clientId);if(b){let c=new X.a({scenario:`${b}-ShareDialog.shareLink`,perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});this._shareCustomerPromise=[a,c]}else this._shareCustomerPromise=[a];this.setState({shareType:j.a.share,applyLinkSettingsClicked:!0},()=>{let a=this.state.linkRecipients;if(A.n(this.props.clientId)){let b=this.state.currentSettings.sharingLinkKind;(b===k.a.organizationEdit||b===k.a.organizationView)&&(a=a.filter(a=>!a.isExternal))}this._store.shareLink({settings:this.state.currentSettings,recipients:a,copyLinkCommand:!1})})}},this._focusCopyButton=()=>{this._copyBtnRef&&this._copyBtnRef.current&&this._copyBtnRef.current.focus()},this.setCopyToastStatus=a=>{this.setState({copyLinkToastStatus:a})},this.setCopyMessageBarStatus=a=>{this.setState({copyMessageBarStatus:a})},this._onLinkPermissionsCancelClicked=()=>{this.props.mode===i.a.linkSettings&&(this._sharingClientMessenger?this._sharingClientMessenger.sendDismiss():H.f()),this._returnToPreviousView()},this._returnToPreviousView=()=>{this._viewStates&&this._viewStates.length&&(this.setState({viewState:this._viewStates.pop(),showTeamsDialog:!1},()=>{this._shareMainControl?.current?.shouldShowActivityIndicator(!1)}),this.state.viewState===$.a.modifyPermissions&&this._store.getEngagementHelper().linkSettingsCancelClicked(this._engagementExtraData))},this._hideElementsInManageAccess=a=>{this.props.hideElementsInManageAccess&&this.props.hideElementsInManageAccess(a)},this._onLinkSettingsInfoMessageClick=()=>{this._store.getEngagementHelper().linkSettingsInfoMessageClick(),this._viewStates=[],this.setState({viewState:$.a.default})},this._onSelectedPeopleChange=a=>{let b=this.state.permissionsMap;this.state.currentSettings.audience===l.a.existing&&this._store.checkPermissions(a),this._store.resetPeoplePickerError();let c={recipientsCount:a.length,externalRecipientsCount:y.d(a),linkedinRecipientsCount:y.e(a)};this.setState({linkRecipients:a,permissionsMap:b,...c},()=>{this._setEngagementExtraData(),this._store.fetchGroupsMemberCount(a)})},this._onGrantDirectAccess=(a,b)=>{let c;O.m()||(this._sharingClientMessenger?this._sharingClientMessenger.sendShareSendClicked():H.y(j.a.grantAccess));let d=this.state,e=d.linkRecipients,f=d.currentSettings.sharingRole;try{let b=JSON.parse(a);c=b?.isAiGenerated??!1}catch(a){}let g={hasMessage:!!a,hasSubject:!!b,messageLength:a?a.length:0,shareType:j.a.grantAccess,debugErrorMessage:(0,E._)(this.state.sharingInformation?.error?.message),withSummary:c};this._setEngagementExtraData(g);let h=new X.a({scenario:(0,W.a)("ShareDialog.shareObject"),perfGoalInMs:3e4,extraData:{sharingScenario:"shareObject",...this._engagementExtraData}}),i=(0,ab.c)(this.props.clientId);if(i){let a=new X.a({scenario:`${i}-ShareDialog.shareObject`,perfGoalInMs:3e4,extraData:{sharingScenario:"shareObject"}});this._shareCustomerPromise=[h,a]}else this._shareCustomerPromise=[h];this.setState({shareType:j.a.grantAccess,hasMessage:!!a,hasSubject:!!b,messageLength:a?a.length:0,shareTargetClicked:!0,showSendButtonSpinner:!0},()=>{if(this._store.grantAccessV2({recipients:e,role:f,subject:b,message:a}),this._store.getEngagementHelper().shareCompleted(this._engagementExtraData),!O.m())if(this._sharingClientMessenger)this._sharingClientMessenger.sendShareCompleted(void 0!==c?{withAISummary:c}:void 0);else{let a=O.ub()?j.a.grantAccess:j.a.share;H.z(a,void 0,!!c)}})},this._onSendLinkClicked=(a,b)=>{H.y(j.a.share);let c=this.state.linkRecipients,d={shareType:j.a.share,hasMessage:!!a,hasSubject:!!b,messageLength:a?a.length:0};this._setEngagementExtraData(d);let e=new X.a({scenario:(0,W.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink",...this._engagementExtraData}}),f=(0,ab.c)(this.props.clientId);if(f){let a=new X.a({scenario:`${f}-ShareDialog.shareLink`,perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});this._shareCustomerPromise=[e,a]}else this._shareCustomerPromise=[e];this.setState({shareType:j.a.share,hasMessage:!!a,hasSubject:!!b,messageLength:a?a.length:0,shareTargetClicked:!0,showSendButtonSpinner:!0},()=>{this._sharingClientMessenger?this._sharingClientMessenger.sendShareSendClicked():H.v(),this._store.shareLink({settings:this.state.currentSettings,recipients:c,emailMessage:a,emailSubject:b})})},this._onViewPolicyTipClicked=()=>{this._viewStates.push(this.state.viewState),this.state.viewState!==$.a.policyDetails&&this.setState({viewState:$.a.policyDetails})},this._onSendLinkMessageChange=a=>{this.state.messageText!==a&&this.setState({messageText:a})},this._onSendLinkSummaryStateChange=a=>{this.state.summaryState!==a&&this.setState({summaryState:a})},this._onSendLinkSubjectChange=a=>{this.state.subjectText!==a&&this.setState({subjectText:a})},this._getStatusIcons=()=>{let a=(0,E.N)(this.props.clientId,this.state.sharingInformation,this.state.currentSettings),b={root:["SendLink-statusIcon"]};return a.map((a,c)=>w.createElement("i",{className:this._useSimplifiedDialog?"SendLink-statusIconContainer":"SendLink-statusIconItem"},w.createElement(u.a,{id:a.icon,tooltipProps:{onRenderContent:()=>w.createElement("div",{className:"SendLink-statusIconTooltip"},a.tooltip)},styles:this._useSimplifiedDialog&&{root:{display:"flex",height:"100%",alignItems:"center"}}},w.createElement(v.a,{iconName:a.icon,"aria-describedby":a.icon,styles:!this._useSimplifiedDialog&&b,tabIndex:0,"data-is-focusable":!0,role:"note","aria-label":a.tooltip}))))},this._renderSharingInfoBar=a=>{let b=this._checkShouldRenderInfoBar(),c=this._showSharingBanner?this._sharingInfoBarInformation?.sharingInfoBarMessageTypeId:this.state.sharingInfoBarInformation?.sharingInfoBarMessageTypeId;return b&&this._store.getEngagementHelper().renderSharingInfoBar({...this._engagementExtraData,sharingInfoBarMessageTypeId:ae.a[c]}),b&&w.createElement(w.Suspense,{fallback:w.createElement(s.a,null)},w.createElement(_.p,{...a,sharingInfoBarMessageTypeId:c,sharingInfoBarState:this.state.sharingInfoBarState,onUpdateSharingInfoBarState:this._onUpdateSharingInfoBarState,sharingRole:this.state.currentSettings.sharingRole}))},this._getPermissionsLabel=a=>a&&"."!==a[a.length-1]?`${a}.`:a,this._getLabelProps=()=>({clientId:this.props.clientId,companyName:this.state.companyName,currentSettings:this.state.currentSettings,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,sharingInformation:this.state.sharingInformation,sharingStore:this._store}),this._onInterruptUseNew=()=>{this._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(this._engagementExtraData),this.setState({shareType:j.a.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:{...this.state.currentSettings,updatePassword:!0}},()=>{this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!1})})},this._onInterruptUseExisting=()=>{this._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(this._engagementExtraData),this.setState({shareType:j.a.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:{...this.state.currentSettings,updatePassword:!1,password:null}},()=>{this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0})})},this._onInterruptCancel=()=>{this._store.getEngagementHelper().copyLinkInterruptCancelled(this._engagementExtraData),this.setState({showCopyLinkInterrupt:!1}),this._shareMainControl.current.shouldShowActivityIndicator(!1)},this._checkShouldRenderInfoBar=()=>{let a=this.props.shouldWaitForSharingInfoBarInformation;switch(this._showSharingBanner?this._sharingInfoBarInformation?.sharingInfoBarMessageTypeId:this.state.sharingInfoBarInformation?.sharingInfoBarMessageTypeId){case ae.a.PageSharingAssetWarning:return O.xc()&&a&&this.state.viewState!==$.a.modifyPermissions;case ae.a.LimitedSharing:case ae.a.LinkReShare:return this._showSharingBanner&&this.state.viewState===$.a.default;case ae.a.LimitedSharingExisting:return this._showSharingBanner&&this.state.viewState===$.a.modifyPermissions&&this.props.mode===i.a.copy;default:return!1}},this._onUpdateSharingInfoBarState=a=>{this.setState({sharingInfoBarState:a})},this._enterManageAccessView=()=>{this._usePermissionsPivot?this.setState({viewState:$.a.permissionsPivot}):this.setState({viewState:$.a.permissionsList})},this._enterShareView=()=>{this._store.getEngagementHelper().manageAccessLinkSectionShareClicked(this._engagementExtraData),this._viewStates.push(this.state.viewState),this.setState({viewState:$.a.default})},this._enterGrantAccessView=()=>{this._usePermissionsPivot?this._store.getEngagementHelper().manageAccessV3GrantAccessClicked(this._engagementExtraData):this._store.getEngagementHelper().manageAccessGrantAccessClicked(this._engagementExtraData),this.setState({viewState:$.a.addPeople})},this._showModifyPermissions=(a,b)=>{this._viewStates.push(this.state.viewState),this._isFREAbandoned=!0,this.setState({viewState:$.a.modifyPermissions,copyLinkShortcut:b},()=>{this._store.getEngagementHelper().linkSettingsOpened(this._engagementExtraData,a)})},this._showPermissionsList=()=>{this._viewStates.push(this.state.viewState),this._isFREAbandoned=!0,this._store.getEngagementHelper().manageAccessOpened(this._engagementExtraData);let{invokeManageAccess:a,onManageAccessClicked:b}=this.props;a?this._sharingClientMessenger?this._sharingClientMessenger.sendShareManageAccessClicked():H.i():b&&!a?b():this.setState({viewState:this._usePermissionsPivot||this._useSimplifiedDialog?$.a.permissionsPivot:$.a.permissionsList,showHeaderInManagedAccess:!0})},this._dismiss=b.onDismiss,this._resize=b.resize,this._store=b.sharingStore,this._shareClickTime=b.shareClickTime,this._sharingClientMessenger=b.sharingClientMessenger,this._isPeopleSharingLinksEnabled=!1,this._rumoneLogger=new Y.a,this._platformDetection=b.platformDetection,this._showSimplifiedDialog=(0,E.ib)(this.props.clientId,this._store)&&!this.props.showItemInsights,this._showSimplifiedDialogV2=(0,E.ab)(this.props.clientId,this._store),this._useSimplifiedDialog=this._showSimplifiedDialog||this._showSimplifiedDialogV2,this._usePermissionsPivot=this._store.isConsumer()||this._showSimplifiedDialog||this._showSimplifiedDialogV2,this._showSharingBanner=this._showSimplifiedDialogV2&&this._store.isSharingLimitedOnSite()||P.c()&&this._store.getSharingInformation().requiresAccessApproval,this._isVideo="video"===(0,ad.a)(this._store.getSharingInformation()?.fileExtension),this.props.clientId===q.a.ngsc||this._platformDetection.isIE?this._maxHeight=void 0:this._maxHeight=this.props.maxHeight;const c=H.j()||this.props.hostOptions?.isDarkMode;let d=a.theme;d||(d=H.g()),(d&&this.props.clientId!==q.a.wac||c)&&this._loadTheme(c?(0,E.p)():d),this._sizeConstraints={maxHeight:A.g(this.props.clientId)?"none":this._maxHeight||"none",maxWidth:this.props.maxWidth||"none",overflowY:this._useSimplifiedDialog?"hidden":"auto",overflowX:"hidden"};const e=(0,ac.a)(location.search.substring(1)),f=e.migratedhosting&&"true"===e.migratedhosting.toLowerCase();this._isCrossFarm=this._calculateIsCrossFarm(e.origin,this.props.pageContext),this._setEngagementExtraData({isMigratedHosting:f});const g=this._generateInitialStateFromStore();if(this.state=g,this.state.sharingInformation){const a=this.state.sharingInformation;this._setEngagementExtraData({webTemplateId:a.webTemplateId,itemUniqueId:a.itemUniqueId,isPremium:!!a.isPremium,requiresAccessApproval:!!a.requiresAccessApproval,userRole:m.a[a.userRole],hasInheritedLinks:!!a.hasInheritedLinks})}if(O.l()){const{listId:a,listItemId:b,uniqueId:c}=window.PageContext?.scenarioContext?.odbshare||e||{};this._engagementExtraData={...this._engagementExtraData,hasSharingContextFromServer:!!a||!!b||!!c}}this._baseProps=(0,T.a)(a),this._correlationId=this.props.correlationId||R.a.generate(),this._baseProps.correlationId=this._correlationId,this._resizeTracker=new Q.a(b.resize),this._showAnimation=void 0!==window.ResizeObserver&&this.props.fullScreenIframeMode,this._store.getEngagementHelper().log(N.d.Opening,this._engagementExtraData)}}bO.childContextTypes={hasTeamsLicense:x.bool,sharingStore:x.object.isRequired,campaignKey:x.number,clientId:x.number},bO.contextTypes={resize:x.func.isRequired,onDismiss:x.func.isRequired,sharingStore:x.object.isRequired,shareClickTime:x.number,shouldTeachingBubbleBeShown:x.func,onTeachingBubbleSeen:x.func,markTeachingBubbleAsDismissed:x.func,sharingClientMessenger:x.object,loadFloodgateDataSource:x.func,platformDetection:x.object.isRequired}}
,function(a,b,c){c.d(b,{a:function(){return af},b:function(){return ag}});var d=c(10);(0,d.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ShareMain.wide{min-width:480px}@media (max-width:480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:16px 16px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:12px}.od-ShareMain-section.new{padding:24px;padding-top:14px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{align-self:stretch;padding-bottom:20px;height:2.25rem}.od-ShareMain-section .od-ShareMain-ShareHint.animation{animation:highlight 2s ease-in-out}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-targets-newPadding{clear:both;padding:10px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:flex!important;align-items:center;justify-content:flex-start;padding:0 16px!important;width:100%;height:44px!important;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer!important;border:none!important;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:'!important;font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after,.od-ShareMain-footer[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast:active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-ShareMain-section-body{margin-bottom:0}}.od-ShareMain-copyLink.shareType-section{display:flex;align-items:center;justify-content:space-between}[dir=ltr] .od-ShareMain-Header-backBtnAdjust{margin-left:16px}[dir=rtl] .od-ShareMain-Header-backBtnAdjust{margin-right:16px}@keyframes highlight{from{background:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}35%{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}to{background:0 0}}"}]);var e=c(286),f=c(37),g=c(36),h=c(118),i=c(32),j=c(85),k=c(45),l=c(86);(0,d.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-method{display:flex;justify-content:space-between;align-items:center}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:.375rem 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}[dir=ltr] div.od-SendLink-emailButtons-left{text-align:right}[dir=rtl] div.od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}[dir=ltr] .od-SendLink-emailButtons-roleSelector{float:right}[dir=rtl] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:4.0625rem;padding-bottom:30px;font-size:.75rem}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:.875rem;height:2rem;width:100%}@supports (font:-apple-system-footnote){.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-sendContainer{justify-content:flex-end}.od-SendLink-characterCounter{font-size:.75rem}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:flex;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;flex-grow:2;width:100%}.SendLink-statusIconContainer{height:100%;margin-bottom:0;font-size:.625rem}[dir=ltr] .SendLink-statusIconContainer{margin-left:4px}[dir=rtl] .SendLink-statusIconContainer{margin-right:4px}[dir=ltr] .SendLink-statusIconContainer{margin-right:4px}[dir=rtl] .SendLink-statusIconContainer{margin-left:4px}.SendLink-statusIconContainer .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconContainer .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}"}]);var m=c(342),n=c(150),o=c("react-lib"),p=c("prop-types-lib"),q=c(320),r=c(516),s=c(336),t=c(20),u=c(26),v=c(105),w=c(106),x=c(47),y=c(207),z=c(337),A=c(338);(0,d.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item.new{margin:0}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:3rem;margin-bottom:8px;width:3rem}.od-ShareTargets-itemImage.new{height:2rem;width:2rem;margin-bottom:0;display:flex;align-items:center;justify-content:center}.od-ShareTargets-icon{font-size:1.625rem;padding-top:.6875rem}.od-ShareTargets-icon.new{padding:0;height:24px;width:24px;font-size:24px}.od-ShareTargets-itemImage--border{border:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font:-apple-system-short-caption2;font-size:.625rem}.od-ShareTargets-target{outline:transparent;position:relative;background:0 0;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after,.od-ShareTargets-target[data-fui-focus-visible]:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareTargets-target.new{padding:0 8px 0 0}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:.0625rem solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:.125rem solid highlight}}"}]);var B=c(152),C=c(12),D=c(63),E=c(18),F=c(92);function G(a,b){let[d,e]=o.useState({showCoachmark:!1,teachingBubbleCampaigns:void 0}),f=o.lazy(async()=>(await new Promise(b=>setTimeout(b,a.delayTimeInMilliseconds)),c.e(16).then(c.bind(c,597))));return o.useEffect(()=>{let c=setTimeout(async()=>{Promise.all([b.loadTeachingBubbleCampaigns(),b.shouldTeachingBubbleBeShown(b.campaignKey)]).then(([a,b])=>{e({teachingBubbleCampaigns:a,showCoachmark:b})})},a.delayTimeInMilliseconds);return()=>clearTimeout(c)},[e]),d.showCoachmark&&d.teachingBubbleCampaigns&&o.createElement(o.Suspense,{fallback:o.createElement(o.Fragment,null)},o.createElement(f,{componentRef:a.componentRef,delayTimeInMilliseconds:a.delayTimeInMilliseconds,target:a.target,teachingBubbleCampaign:d.teachingBubbleCampaigns[b.campaignKey],dismissCallback:()=>{b.markTeachingBubbleAsDismissed(b.campaignKey),e({showCoachmark:!1,teachingBubbleCampaigns:void 0})},onTeachingBubbleSeen:a.onTeachingBubbleSeen,onPrimaryButtonClicked:a.onPrimaryButtonClicked}))}G.contextTypes={shouldTeachingBubbleBeShown:p.func,markTeachingBubbleAsDismissed:p.func,loadTeachingBubbleCampaigns:p.func,campaignKey:p.number};var H=c(74),I=c(103),J=c(339),K=c(340);class L extends o.Component{componentDidMount(){this._shareToTeamsExperiment&&this.context.canUseTeams().then(a=>{this._showTeams=a,this.setState({areTargetsReady:!0})}).catch(()=>{this.setState({areTargetsReady:!0})})}render(){let a=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==i.a.existing&&this.props.currentSettings.audience!==i.a.anyone&&this.props.currentSettings.audience!==i.a.organization;return this._shareToTeamsExperiment?(this._shareTargetsData=this.state.areTargetsReady&&this._getShareTargetsData(),a?o.createElement(D.a,{content:t.f,calloutProps:{calloutWidth:300,directionalHint:E.a.topCenter}},o.createElement("ul",{className:"od-ShareTargets-items","aria-label":t.Zf},this.state.areTargetsReady&&this._renderTargets())):o.createElement("ul",{className:"od-ShareTargets-items","aria-label":t.Zf},this.state.areTargetsReady&&this._renderTargets())):(this._shareTargetsData=this._getShareTargetsData(),a?o.createElement(D.a,{content:t.f,calloutProps:{calloutWidth:300,directionalHint:E.a.topCenter}},o.createElement("ul",{className:"od-ShareTargets-items","aria-label":t.Zf},this._renderTargets())):o.createElement("ul",{className:"od-ShareTargets-items","aria-label":t.Zf},this._renderTargets()))}_renderTargets(){let a=[],b=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==i.a.existing&&this.props.currentSettings.audience!==i.a.anyone&&this.props.currentSettings.audience!==i.a.organization,c=this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==i.a.existing;for(let d of this._shareTargetsData){let e,f=d.icon,g=f.split(":",2)[1],i=b||c||(0,u.V)(this.props.sharingInformation),j=`od-ShareTargets-icon ${i?"od-ShareTargets-disabled":""} new`;e=f.indexOf("font:")>-1?o.createElement(C.a,{iconName:g,className:j}):o.createElement("img",{src:f,className:j});let k={root:{display:"inline-block"}};a.push(o.createElement("li",{key:d.shareType,className:"od-ShareTargets-item new"},o.createElement(D.a,{content:d.label,styles:k},o.createElement("button",{className:"od-ShareTargets-target new","aria-label":d.label,disabled:i,onClick:d.action,id:d.id,ref:d.shareType===h.a.webShareToTeams?this._shareToTeamsCoachmarkTarget:null},d.shareType===h.a.webShareToTeams?this._renderCoachmark():o.createElement(o.Fragment,null),o.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage new"},e)))))}return a}_renderCoachmark(){return o.createElement(G,{componentRef:this._coachmarkRef,delayTimeInMilliseconds:200,target:this._shareToTeamsCoachmarkTarget,onTeachingBubbleSeen:this.context.onTeachingBubbleSeen(this.context.campaignKey),onPrimaryButtonClicked:this._onClick.bind(this,h.a.webShareToTeams)})}_getShareTargetsData(){let a=[],b=this._determineMailShareTarget(this.props.clientId);if((0,I.a)()&&window.sessionStorage.setItem("outlookAvailability",b.toString()),b===B.a.available){let b=x.g(this.props.clientId)?"font:OutlookLogo":J.a,c=`${t.dj} ${t.$f}`;a.push({label:c,icon:b,bgColor:"ms-bgColor-themePrimary",shareType:h.a.outlook,action:this._onClick.bind(this,h.a.outlook),id:"od-ShareTarget-outlookButton"})}else if(b===B.a.other){let b=`${t.dj} ${t.Sf}`;a.push({label:b,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:h.a.nonOutlook,action:this._onClick.bind(this,h.a.nonOutlook),id:"od-ShareTarget-nonOutlookButton"})}if((0,H.n)()){let b=`${t.dj} ${t.Nk}`;a.push({label:b,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:h.a.mobileShareToTeams,action:this._onClick.bind(this,h.a.mobileShareToTeams),id:"od-ShareTarget-mobileTeamsButton"})}else if(this.props.fullscreenIframeMode&&this._shareToTeamsExperiment&&!this.context.platformDetection.isIE&&this._showTeams){let b=`${t.dj} ${t.Nk}`;a.push({label:b,icon:K.a,bgColor:"ms-bgColor-themePrimary",shareType:h.a.webShareToTeams,action:this._onClick.bind(this,h.a.webShareToTeams),id:"od-ShareTarget-webTeamsButton"})}if((0,H.k)()){let b=`${t.dj} ${t.qe}`;a.push({label:b,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:h.a.moreApps,action:this._onClick.bind(this,h.a.moreApps),id:"od-ShareTarget-moreAppsButton"})}return a}_onClick(a){a===h.a.webShareToTeams&&this._coachmarkRef.current?.dismiss(),this.props.onShareTargetClicked(a)}_determineMailShareTarget(a){return x.s(this.props.clientId)&&this.props.outlookAvailability===B.a.available?B.a.available:(0,H.e)()}constructor(a){super(a),this._shareToTeamsExperiment=F.e(),this._shareToTeamsCoachmarkTarget=o.createRef(),this._coachmarkRef=o.createRef(),this._showTeams=!1,this.state={areTargetsReady:!1}}}L.contextTypes={platformDetection:p.object.isRequired,shouldTeachingBubbleBeShown:p.func,onTeachingBubbleSeen:p.func,markTeachingBubbleAsDismissed:p.func,campaignKey:p.number,canUseTeams:p.func},(0,d.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SummaryBox-header-Area{display:flex;justify-content:space-between;align-items:center;min-height:24px}.od-SummaryBox-header-TextField{display:flex;font-weight:600;font-size:.625rem;align-self:center}.od-SummaryBox-summary-Main{margin:auto;padding-top:0}.od-SummaryBox-header-sparkle{height:15%;width:15%;align-self:center}[dir=ltr] .od-SummaryBox-header-sparkle{margin-right:3px}[dir=rtl] .od-SummaryBox-header-sparkle{margin-left:3px}.od-Summary-tooltipIcon{vertical-align:middle}[dir=ltr] .od-Summary-tooltipIcon{margin-left:calc(50% - 5px + 5px)}[dir=rtl] .od-Summary-tooltipIcon{margin-right:calc(50% - 5px + 5px)}.od-SummaryBox-buttonsContainer{display:flex}.od-SummaryBox-header-closeButton{height:16px;width:16px}.od-SummaryBox-header-closeButtonIcon{font-size:.625rem}.od-SummaryBox-summary-Main::-webkit-scrollbar{width:5px;height:27px}.od-SummaryBox-summary-Main::-webkit-scrollbar-thumb{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:38px}.od-SummaryBox-summary-Main::-webkit-scrollbar-track{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:38px}.od-SummaryBox-footer-CharacterCount{text-align:right;font-size:.625rem;margin-top:5px;align-self:center}"}]);var M=c(64),N=c(341),O=c(69).a("images/photostream/sparklepreviewcolor.svg");let P=({summaryText:a,onSave:b,renderSeparator:c})=>{let[d,e]=(0,o.useState)(!1),[f,g]=(0,o.useState)(a),[h,i]=(0,o.useState)(!1),j=`(${f.length}/500)`;return o.createElement(o.Fragment,null,!d&&o.createElement(o.Fragment,null,c&&o.createElement(N.a,null),o.createElement("div",{className:"od-SummaryBox-Entire"},o.createElement("div",{className:"od-SummaryBox-header-Area"},o.createElement("div",{className:"od-SummaryBox-header-TextField"},o.createElement("img",{role:"presentation",src:O,className:"od-SummaryBox-header-sparkle"}),t.fj,o.createElement(D.a,{content:t.pj},o.createElement(C.a,{iconName:"Error",className:"od-Summary-tooltipIcon"}))),o.createElement(M.a,{className:"od-SummaryBox-header-closeButton",onClick:()=>{e(!0),b("")},iconProps:{iconName:"Cancel",className:"od-SummaryBox-header-closeButtonIcon"},title:t.mi})),o.createElement("div",{className:"od-SummaryBox-summary-TextArea"},o.createElement(m.a,{className:"od-SummaryBox-summary-Main",borderless:!0,ariaLabel:t.lj,placeholder:t.uj,defaultValue:f,value:f,styles:{fieldGroup:{border:"none",borderRadius:"0px"}},multiline:!0,resizable:!1,onChange:(a,b)=>{g(b||""),i(!0)},onBlur:()=>{h&&(b(f),i(!1))}}),f.length>250&&o.createElement("div",{className:"od-SummaryBox-footer-CharacterCount"},j)))))};P.propTypes={summaryText:p.string.isRequired,onSave:p.func.isRequired};class Q extends o.Component{UNSAFE_componentWillReceiveProps(a){n.k({selectedItems:a.linkRecipients,sharingLinkKind:a.currentSettings.sharingLinkKind,canAddExternalPrincipal:a.sharingInformation.canAddExternalPrincipal,sharingInformation:a.sharingInformation,viewPolicyTipCallback:a.onViewPolicyTipClicked,onShareHintClick:(0,u.h)(a.sharingInformation)?a.onShareHintClick:void 0,permissionsMap:a.permissionsMap}),this.setState({...this.state})}componentDidMount(){this._resizeIfNeeded()}componentDidUpdate(a){this._resizeIfNeeded(),a.summaryText!==this.props.summaryText&&this.props.showItemInsights&&this.props.summaryText&&this.updateSummaryContent(this.props.summaryText)}render(){let a=this.props,b=a.currentSettings,c=a.linkRecipients,d=n.f(c),e=n.g(c,a.groupsMemberCount),f=this._platformDetection.isIOS||x.f(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||x.c(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";f+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";let g=o.createElement(L,{fullscreenIframeMode:this.props.fullscreenIframeMode,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this.props.onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}),h=this.props.showSendButton?o.createElement("div",{className:f},o.createElement(r.a,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:""===this.props.summaryText?this.props.messageText:this.props.messageText+"\n"+this.state.summaryContent,subjectText:this.props.subjectText,onSendLinkClicked:this._onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:s.a.button,sharingInformation:this.props.sharingInformation})):"",i=a.isLoadingDefaultRecipients?o.createElement("div",null,o.createElement(v.a,{className:"od-SendLink-spinner",label:t.Me,size:w.a.small})):o.createElement(q.a,{defaultSelectedItems:c,error:a.errorMessage,onChange:a.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:d,oversharingGroupsWarning:e,pickerSettings:a.sharingInformation.peoplePickerSettings,sharingLinkKind:b.sharingLinkKind,sharingInformation:a.sharingInformation,permissionsMap:a.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:a.clientId,onInputChange:a.onPeoplePickerInputChange||null,renderRoleSelector:this._shouldRenderRoleSelector(),roleSelectorProps:this._getRoleSelectorProps()});return o.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},o.createElement("div",{className:"od-SendLink-email"},o.createElement("div",{className:"od-SendLink-peoplePicker"},i),o.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),o.createElement("div",{className:"od-SendLink-method"},g,h))))}_shouldRenderRoleSelector(){return this.props.currentSettings.audience!==i.a.existing}_getRoleSelectorProps(){let a=(0,u.V)(this.props.sharingInformation),b=(0,z.c)({clientId:this.props.clientId,sharingStore:this.context.sharingStore,sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:f.a.share,isPreventDownloadAllowed:this.context.sharingStore.isPreventDownloadAllowed()}),c=(0,z.l)(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension);return{shimmer:a,menuPermissionOptions:b,sharingRole:this.props.currentSettings.sharingRole,mode:f.a.share,clientId:this.props.clientId,ariaLabel:t.Se,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings,roleSelectorAs:A.a,showDropdownWithOfficeReview:c}}_resizeIfNeeded(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)}_onManageExistingAccessClick(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData),this.props.onManageExistingAccessClick()}updateSummaryContent(a){this.setState({summaryContent:a})}_renderTextArea(){if(this.props.showTextArea){let a=this.props.showItemInsights&&!!this.props.summaryText,b=this.props.summaryText;return o.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&o.createElement(m.a,{borderless:!0,underlined:!0,placeholder:t.vk,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),o.createElement(m.a,{borderless:!0,placeholder:t.je,ariaLabel:t.Ne,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}),a&&o.createElement(P,{summaryText:b,onSave:a=>{b=a,this.updateSummaryContent(a)},renderSeparator:!0}))}}_renderCharacterCounter(){let a=this.state.messageLength,b=a>this.props.maximumMessageLength,c=`od-SendLink-characterCounter ${b?"od-SendLink-characterCounter--error":""}`;if(a>this.props.maximumMessageLength/2)if(b)return o.createElement("div",{className:"od-SendLink-characterCounterWrapper"},o.createElement("span",{"aria-label":t.Rb,role:"alert",className:c},a,"/",this.props.maximumMessageLength));else return o.createElement("div",{className:"od-SendLink-characterCounterWrapper"},o.createElement("span",{className:c},a,"/",this.props.maximumMessageLength))}constructor(a,b){super(a),this._topLevelDivRef=o.createRef(),this._validateMessage=a=>{this.props.onSendLinkMessageChange(a);let b=(0,u.s)(a);return this.setState({...this.state,messageLength:b}),""},this._validateSubject=a=>{this.props.onSendLinkSubjectChange(a);let b=(0,u.s)(a);return this.setState({...this.state,subjectLength:b}),a.length<=this.props.maximumSubjectLength?"":a.length+"/"+this.props.maximumSubjectLength},this._onResolvedSuggestions=a=>(this.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(this.props.engagementExtraData,a),a),this._onSendLinkClicked=(a,b)=>{if(this.props.summaryText){let a={...this.props.engagementExtraData,summaryTextRemoved:""===this.state.summaryContent,summaryTextEdited:""!==this.state.summaryContent&&this.state.summaryContent!==this.props.summaryText,summaryTextFailed:!!this.props.summaryText&&-1!==this.props.summaryText.indexOf("Something went wrong with retrieving a summary")};this.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked.WithSummary",a)}this.props.onSendLinkClicked(a,b)},this._platformDetection=b.platformDetection,this.state={messageLength:0,summaryContent:this.props.summaryText,subjectLength:0},this._onManageExistingAccessClick=this._onManageExistingAccessClick.bind(this),this._resizeTracker=new y.a(b.resize)}}Q.contextTypes={platformDetection:p.object.isRequired,sharingStore:p.object.isRequired,resize:p.func.isRequired};var R=c(345),S=c(526),T=c(355),U=c(356),V=c(119),W=c(157),X=c(112),Y=c(16),Z=c(214),$=c(537),_=c(358),aa=c(189);let ab=(a,b)=>{ab.contextTypes={onDismiss:p.func};let c={hideItemName:!a.singleComponent,doNotrenderHeaderButtons:!a.singleComponent,titleIsSubLevel:!0,sendButtonType:a.singleComponent?s.a.button:s.a.copyLink,shouldBeFocused:a.singleComponent,hostOptions:a.hostOptions};return o.createElement("div",{className:"od-ShareMain-section new"},ac(a,b.onDismiss),o.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},o.createElement(S.a,{clientId:a.clientId,companyName:a.companyName,currentSettings:a.currentSettings,onShareHintClick:()=>{a.onShareHintClick(Z.b.CopyLinkSettingsHint,!0)},sharingInformation:a.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:a.customLabeledAudienceConfig}),o.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},o.createElement(r.a,{ctaLabel:t.dc,currentSettings:a.currentSettings,linkRecipients:null,onSendLinkClicked:a.onSendLinkClicked,permissionsMap:null,sharingInformation:a.sharingInformation,sendButtonType:c.sendButtonType,shouldBeFocused:c.shouldBeFocused}))))},ac=(a,b)=>{let c={hideItemName:!a.singleComponent,doNotrenderHeaderButtons:!a.singleComponent,titleIsSubLevel:!0,sendButtonType:a.singleComponent?s.a.button:s.a.copyLink,shouldBeFocused:a.singleComponent,hostOptions:a.hostOptions},d=a.sharingInformation?.item?.name;return o.createElement(e.a,{...(0,_.a)(a),actions:c.doNotrenderHeaderButtons?void 0:(a?.hostOptions?.showCloseButton??x.r(a.clientId))&&o.createElement(aa.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:t.Vb,onClick:a=>{a.stopPropagation(),a.preventDefault(),b()},tooltipContent:t.Vb,directionalHint:E.a.bottomAutoEdge}),mainHeaderText:t.uc,subHeaderText:c.hideItemName?"":d})};var ad=c(220),ae=c(213);let af=500;class ag extends o.Component{componentDidMount(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.r(this._shareClickTime,this.props.clientId,f.a.share,this.props.scenarioId,this.props.correlationId),this._updatePeoplePickerError(this.props)}UNSAFE_componentWillReceiveProps(a){this._updatePeoplePickerError(a)}render(){let a=this.props,b=this.state.showActivityIndicator?this._getActivityMessage():"",c=this._renderFooter();return o.createElement("div",{className:`od-ShareMain ${this.state.showActivityIndicator?" blocker":""}`},o.createElement("div",{className:"od-ShareMain-section new"},this._renderHeader(),o.createElement("div",{className:`od-ShareMain-ShareHint ${this.state.showShareHintAnimation?"animation":""}`},o.createElement(S.a,{clientId:a.clientId,companyName:a.companyName,currentSettings:a.currentSettings,onShareHintClick:a.onShareHintClick.bind(this,Z.b.MainLinkSettingsHint),sharingInformation:a.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:a.customLabeledAudienceConfig})),this._renderSendLink(),this.props.shouldWaitForSharingInfoBarInformation&&this._renderSharingInfoBar()),this._renderCopyLinkSection(!0),this._renderSharedWith(),c,this._renderActivityIndicator(),this._renderConfirmationDialogExternalSharing(),X.a(b,"assertive","alert",!0))}_getHeaderActions(){let a=a=>{a.stopPropagation(),a.preventDefault(),this._dismiss()};return(this.props?.hostOptions?.showCloseButton??x.r(this.props.clientId))&&o.createElement(aa.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:t.Vb,onClick:a,tooltipContent:t.Vb,directionalHint:E.a.bottomAutoEdge})}_renderHeader(){return o.createElement(e.a,{actions:this._getHeaderActions(),mainHeaderText:t.rj,subHeaderText:this.props.item?.name,renderBackButton:this.props.hasBackButton,onBackButtonClicked:this.props.onBackButtonClicked})}_renderSharingInfoBar(){return o.createElement(o.Suspense,{fallback:o.createElement(v.a,null)},o.createElement(ae.p,{sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,parentCssClass:"ShareMain"}))}_renderCopyLinkSection(a){return o.createElement(o.Fragment,null,o.createElement($.a,null),o.createElement(ab,{singleComponent:!1,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked}))}_renderFooter(){let a=this.props,b=a.clientId,c=a.hostOptions?.isSendCopyEnabled,d=a.hostOptions?.isSendPdfEnabled;if(x.i(b)){let e=T.a.getAttachAsCopyOptions(b,a.item,this.context.sharingStore,this._engagementExtraData,c,d);if(1===e.length&&"pdf"!==e[0].key)return o.createElement("div",null,o.createElement("button",{className:"od-ShareMain-footer",onClick:e[0].onClick},o.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},o.createElement(C.a,{iconName:"Copy"})),o.createElement("span",null,t.cb)));if(e.length>0)return o.createElement("div",null,o.createElement(V.a,{className:"od-ShareMain-footer",text:t.cb,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:e},styles:{label:{marginLeft:"0px"}}}))}else if((b===g.a.ngsc||x.g(b))&&this._isSendCopyEnabled())return o.createElement("div",null,o.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},o.createElement("div",{className:"od-ShareMain-attachIcon"},o.createElement(C.a,{iconName:"Copy"})),o.createElement("span",null,t.cb)))}_renderSendLink(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||(0,u.V)(this.props.sharingInformation)){let a=this.props;return o.createElement(Q,{fullscreenIframeMode:this.props.fullScreenIframeMode,ctaLabel:t.Gi,showTextArea:!0,sharingInformation:a.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:a.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:a.groupsMemberCount,onViewPolicyTipClicked:a.onViewPolicyTipClicked,linkRecipients:a.linkRecipients,permissionsMap:a.permissionsMap,messageText:a.messageText,summaryText:a.summaryText,subjectText:a.subjectText,onSendLinkMessageChange:a.onSendLinkMessageChange,onSendLinkSubjectChange:a.onSendLinkSubjectChange,createPeopleSharingLinks:a.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:a.clientId,showSendButton:!0,maximumMessageLength:af,maximumSubjectLength:100,isLoadingDefaultRecipients:a.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClick:this.props.onShareHintClick,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:a.onShareHintClick.bind(this,Z.b.RoleSelector),onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,showItemInsights:this.props.showItemInsights})}}_renderSharedWith(){let{shared:a,activeLinks:b,sharingPrincipals:c}=(0,u.H)(this.props.sharingInformation,this.context.sharingStore.isConsumer());return a?o.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith new separator-top"},o.createElement(R.a,{ariaLabel:t.Ue,label:t._j,getPhotoUrl:(0,W.b)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:b,sharingPrincipals:c})):null}_renderActivityIndicator(){if(this.state.showActivityIndicator)return o.createElement(U.a,{message:this._getActivityMessage(),ariaHidden:!0})}_renderConfirmationDialogExternalSharing(){if(!F.b()||!this.state.showConfirmationDialog||!this.state.externalSharingPerson)return null;let a=this.state.externalSharingPerson;return o.createElement(o.Suspense,{fallback:o.createElement(v.a,null)},o.createElement(ae.d,{confirmationCode:ad.a.shareDialogExternalSharing,participant:a,onApply:this._onConfirmationExternalSharingApply,onCancel:this._onConfirmationExternalSharingCancel}))}_getActivityMessage(){switch(this.state.shareType){case h.a.share:return t.p;case h.a.mobileShareToTeams:case h.a.webShareToTeams:return t.n;case h.a.outlook:return t.m;case h.a.copy:case h.a.nonOutlook:case h.a.moreApps:default:return t.o}}_isSendCopyEnabled(){return H.l()}_isPeoplePickerValid(a){if(this.state.peoplePickerErrorMessage)return;if(a!==h.a.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===i.a.specificPeople){let a=!1,b=!1;for(let c of this.props.linkRecipients)a||(a=c.isExternal&&!c.providerName),b||(b=!c.isExternal||c.isExternal&&!!c.providerName);if(a&&b)return this.setState({peoplePickerErrorMessage:o.createElement("span",{role:"alert","aria-live":"assertive"},t.Ve)}),!1}let b=this.props.currentSettings.audience===i.a.specificPeopleFlex||this.props.currentSettings.audience===i.a.specificPeople||a===h.a.share;return this._peoplePickerHasUnresolvedText?(this.setState({peoplePickerErrorMessage:o.createElement("span",{role:"alert","aria-live":"assertive"},t.Zk)}),!1):0!==this.props.linkRecipients.length||!b||(this.setState({peoplePickerErrorMessage:o.createElement("span",{role:"alert","aria-live":"assertive"},t.pi)}),!1)}_updatePeoplePickerError(a){let b;if((0,u.h)(a.sharingInformation)&&(b=a.onShareHintClick,Y.nb()&&(b=a.onShareHintClick.bind(this,Z.b.PeoplePickerErrorLinkSettingsHint))),a.linkRecipients||a.sharingInformation.errorCategory==j.a.shareLink){let c=n.k({selectedItems:a.linkRecipients,sharingLinkKind:a.currentSettings.sharingLinkKind,canAddExternalPrincipal:a.sharingInformation.canAddExternalPrincipal,sharingInformation:a.sharingInformation,viewPolicyTipCallback:a.onViewPolicyTipClicked,onShareHintClick:b,permissionsMap:a.permissionsMap,audience:a.currentSettings.audience,scope:a.currentSettings.sharingScope});c||a.sharingInformation.errorCategory!=j.a.shareLink||(c=o.createElement("span",null,a.sharingInformation.errorMessage)),this.setState({peoplePickerErrorMessage:c,showActivityIndicator:!c&&this.state.showActivityIndicator})}}shouldShowActivityIndicator(a){this.setState({showActivityIndicator:a})}constructor(a,b){super(a),this._peoplePickerHasUnresolvedText=!1,this._onSharedWithClicked=()=>{this.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(this._engagementExtraData),this.props.onShowPermissionsListClicked()},this._onConfirmationExternalSharingApply=()=>{this.setState({showConfirmationDialog:!1,showShareHintAnimation:!0},()=>{this.props.onAudienceChange(i.a.specificPeopleFlex,k.a.flexible,l.a.specificPeople)})},this._onConfirmationExternalSharingCancel=()=>{this.setState({showConfirmationDialog:!1})},this._onSelectedPeopleChange=a=>{let b,c=this.props;(0,u.h)(c.sharingInformation)&&(b=c.onShareHintClick,Y.nb()&&(b=c.onShareHintClick.bind(this,Z.b.PeoplePickerErrorLinkSettingsHint)));let d=n.k({selectedItems:a,sharingLinkKind:c.currentSettings.sharingLinkKind,canAddExternalPrincipal:c.sharingInformation.canAddExternalPrincipal,sharingInformation:c.sharingInformation,viewPolicyTipCallback:c.onViewPolicyTipClicked,onShareHintClick:b,permissionsMap:c.permissionsMap,audience:c.currentSettings.audience,scope:c.currentSettings.sharingScope}),e=!1,f=!1,g=null;if(d){let b=c.currentSettings.sharingScope===l.a.organization;for(let c of a)if(c.isExternal&&b){e=!0,F.b()&&(f=!0,g=c);break}e&&this.context.sharingStore.getEngagementHelper().externalSharingCslError(this._engagementExtraData)}this.setState({peoplePickerErrorMessage:d,showConfirmationDialog:f,externalSharingPerson:g},()=>{c.onSelectedPeopleChange(a)})},this._onPeoplePickerInputChange=a=>{this._peoplePickerHasUnresolvedText=""!==a},this._onShareTargetClicked=(a,b)=>{(this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==i.a.specificPeople||this._isPeoplePickerValid(a)||this.props.currentSettings.audience!==i.a.specificPeopleFlex&&this.props.currentSettings.audience!==i.a.specificPeople&&!(this.props.linkRecipients.length>0))&&this.setState({showActivityIndicator:!0,shareType:a},()=>{this.props.onShareTargetClicked(a,b)})},this._onCopyLinkSectionCopyButtonClicked=()=>{this.context.sharingStore.getEngagementHelper().log("ShareV3.copyLinkSectionCopyButtonClicked",this.props.engagementExtraData),this._onShareTargetClicked(h.a.copy,!0)},this._onSendLinkClicked=(a,b)=>{this.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",this.props.engagementExtraData),this._isPeoplePickerValid(h.a.share)&&this.setState({showActivityIndicator:!0,shareType:h.a.share},()=>{this.props.onSendLinkClicked(a,b)})},this._onAttachAsCopyClicked=()=>{let a=this.props.clientId;if(this.context.sharingStore.getEngagementHelper().sendACopyClicked(this._engagementExtraData),x.i(a)){let a=!this.state.isAttachAsCopyContextualMenuVisible;this.setState({isAttachAsCopyContextualMenuVisible:a},()=>{})}else if(a===g.a.ngsc||x.g(a))try{window.external.SendCopy()}catch(a){}},this._shareClickTime=b.shareClickTime,this._engagementExtraData=a.engagementExtraData,this._sharingClientMessenger=b.sharingClientMessenger,this._dismiss=b.onDismiss,this.state={isAttachAsCopyContextualMenuVisible:!1,shareType:h.a.share,showActivityIndicator:!1,peoplePickerErrorMessage:null,showConfirmationDialog:!1,externalSharingPerson:null,showShareHintAnimation:!1}}}ag.contextTypes={shareClickTime:p.number,sharingStore:p.object.isRequired,sharingClientMessenger:p.object,onDismiss:p.func.isRequired}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return S}});var d,e,f={};c.r(f),c.d(f,{indexedDB:function(){return i},localStorage:function(){return h},none:function(){return j}});var g=c(7);let h=0,i=1,j=2;var k=c(31),l=c(130);let m="undefined"==typeof window?self:window;var n=c(3),o=c(0);let p=o.a.isActivated("18a3d374-cced-4d7f-be15-3b0a8dda8152"),q=o.a.isActivated("9ed80e27-f0bc-4d9b-ad35-6407121dbfbb"),r=o.a.isActivated("88402522-C263-48C2-92B6-3A314BA00F90");(d=e||(e={})).success="success",d.error="error";let s="app_lastRead",t="ODSP_DB",u="ODSP_DB_TABLE",v="lastModified",w="lastRead",x="ODSP_DB_METADATA_TABLE",y="database_metadata",z="parentKey",A="reads",B=new k.a().isFirefox,C="indexedDB is not supported";class D{async freeSpace(a,b){let c=D._db=D._db||await D._openDBPromise;return new Promise((d,e)=>{let f=c.transaction([u],"readwrite").objectStore(u).index(s).openCursor();f.onsuccess=c=>{let e=f.result;e?(e.value.app===a&&b>0&&(b-=e.value.size,e.delete()),b>0?e.continue():d()):d()},f.onerror=a=>{this._errorHandling(a,e)}})}async read(a){return this._readInternal(u,b=>b.get(a))}async rangeQuery(a){let b={},c=(D._db=D._db||await D._openDBPromise).transaction([u],"readonly").objectStore(u),d=[],{index:e,range:f,direction:g,count:h}=a,i=c.index(e).openKeyCursor(f,g);return i.onerror=a=>{this._errorHandling(a,b.reject)},i.onsuccess=a=>{let c=a.target.result;c?(d.push(c.primaryKey),d.length>=h?b.resolve(d):c.continue()):b.resolve(d)},new Promise((a,c)=>{b.resolve=a,b.reject=c})}async write(a){let{key:b,data:c}=a;return void 0!==c?this._writeInternal({tableName:u,key:b,row:{...a,lastModified:Date.now()}}):void 0!==a.parentKey?this._deleteDataRows(a.parentKey):this._writeInternal({tableName:u,key:b,row:void 0})}async statistics(){if(!this._dbMetaData){let a=await this._readAndSetMetadataDB();this._dbMetaData=a}let a=await this._iterate(u,a=>a.size);return{metaData:this._dbMetaData,count:a.length,totalBytes:a.reduce((a,b)=>a+b,0)}}_openIndexedDB(){return new Promise((a,b)=>{if(D._db)a(D._db);else{let c=q&&B?indexedDB.open(t,{version:4,storage:"temporary"}):indexedDB.open(t,4);c.onerror=a=>{this._errorHandling(a,b)},c.onsuccess=b=>{a(D._db=c.result)},c.onupgradeneeded=a=>{let d=a.target.result;d.onerror=a=>{this._errorHandling(a,b)};let{oldVersion:e}=a;this._handleDBUpgrade(c,d,e)}}})}_handleDBUpgrade(a,b,c){let d;c<1&&((d=b.createObjectStore(u,{keyPath:"key"})).createIndex(v,v,{unique:!1}),d.createIndex(A,A,{unique:!1}),b.createObjectStore(x,{keyPath:"key"})),c<2&&((d=d||a.transaction.objectStore(u)).createIndex("app","app",{unique:!1}),d.createIndex(w,w,{unique:!1}),d.createIndex(s,["app",w],{unique:!1})),c<3&&((d=d||a.transaction.objectStore(u)).createIndex("app_lastModified",["app",v],{unique:!1}),d.createIndex("app_reads",["app",A],{unique:!1})),c<4&&((d=d||a.transaction.objectStore(u)).createIndex(z,z,{unique:!1}),d.createIndex("parentKey_app",[z,"app"],{unique:!1}),d.createIndex("parentKey_app_lastModified",[z,"app",v],{unique:!1}),d.createIndex("parentKey_app_lastRead",[z,"app",w],{unique:!1}),d.createIndex("parentKey_app_reads",[z,"app",A],{unique:!1}))}_readAndSetMetadataDB(){return this._readInternal(x,a=>a.get(y)).then(a=>{if(a)return a.data;{let a={id:l.generate(),created:Date.now(),cacheType:f.indexedDB};return this._writeInternal({tableName:x,key:y,row:{key:y,data:a}}).then(()=>a)}})}async _readInternal(a,b){let c=D._db=D._db||await D._openDBPromise;return new Promise((d,e)=>{let f=this._logger({name:"PersistentCacheIDB.readInternal"}),g=Date.now(),h=b(c.transaction([a],"readonly").objectStore(a));h.onsuccess=a=>{r&&f({resultType:n.b.Success,extraData:{io:Math.round(Date.now()-g)}}),d(h.result)},h.onerror=a=>{f({resultType:n.b.Failure,extraData:{io:Math.round(Date.now()-g)}}),this._errorHandling(a,e)}})}async _iterate(a,b){let c=D._db=D._db||await D._openDBPromise,d=[];return new Promise((e,f)=>{let g=c.transaction([a],"readonly").objectStore(a).openCursor();g.onsuccess=a=>{let c=g.result;c?(d.push(b(c.value)),c.continue()):e(d)},g.onerror=a=>{this._errorHandling(a,f)}})}async _writeInternal(a){let{tableName:b,key:c,row:d}=a,e=D._db=D._db||await D._openDBPromise;return new Promise((a,f)=>{try{let g=e.transaction([b],"readwrite"),h=g.objectStore(b);g.oncomplete=()=>{},g.onerror=a=>{this._errorHandling(a,f)};let i=d?h.put(d):h.delete(c);i.onsuccess=b=>{a()},i.onerror=a=>{this._errorHandling(a,f)}}catch(a){throw a}})}async _deleteDataRows(a){let b=a.slice(0,a.length-1)+String.fromCharCode(a.charCodeAt(a.length-1)+1);return this.rangeQuery({index:z,range:IDBKeyRange.bound(a,b,!1,!0),direction:"next"}).then(a=>Promise.all(a.map(a=>this._writeInternal({tableName:u,key:a,row:void 0})))).then(()=>{})}_errorHandling(a,b){if("error"===a.type){let{name:c,message:d,code:e}=a.target.error;b({name:c,message:d,code:e})}}constructor(a){if("indexedDB"in m&&m.indexedDB){if(this._logger=a,!D._openDBPromise){let a,b;p||(a=this._logger({name:"PersistentCacheIDB.openDB"}),b=Date.now()),D._openDBPromise=this._openIndexedDB().then(c=>(!p&&a&&a({resultType:n.b.Success,extraData:{dbOpen:Math.round(Date.now()-b)}}),D._db=c,c)).catch(b=>{throw!p&&a&&a({resultType:n.b.Failure,error:b.message?b.message:b.toString()}),b})}}else throw Error(C)}}let E="PersistentCache",F="PersistentCache_metadata";class G{freeSpace(a,b){throw Error("Method not implemented.")}read(a){return JSON.parse(this._localStorage.getItem(this._cacheKey(a)))}write(a){let{key:b,data:c}=a;if(void 0!==c){let c={...a,lastModified:Date.now()};this._localStorage.setItem(this._cacheKey(b),JSON.stringify(c))}else this._localStorage.removeItem(this._cacheKey(b))}statistics(){let a=[];for(let b in this._localStorage)if(0===b.indexOf(E)){let c=this._localStorage.getItem(b);a.push(c?c.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(F)),count:a.length,totalBytes:a.reduce((a,b)=>a+b,0)}}async rangeQuery(a){}_cacheKey(a){return`${E}_${a}`}constructor(){try{if("localStorage"in m&&m.localStorage&&(this._localStorage=m.localStorage,!this._localStorage.getItem(F))){const a={id:l.generate(),created:Date.now(),cacheType:f.localStorage};this._localStorage.setItem(F,JSON.stringify(a))}}catch(a){}if(!this._localStorage)throw Error("localStorage is not supported")}}let H=0;class I{enqueue(a,b){let c=this._queue[a]=this._queue[a]||[],d=!0,e=[];c.length>0&&(c[0].schedule?(e=c.slice(1),this._queue[a]=[c[0]],d=!1):(e=this._queue[a],this._queue[a]=[]));let f=this._createUpateTask(a,b);return e.length>0&&(f.signal=e[0].signal),this._queue[a].push(f),d&&this._scheduleTask(a),f}_createUpateTask(a,b){let c={};c.promise=new Promise((a,b)=>{c.resolve=a,c.reject=b});let d={execute:async()=>{try{await b()}catch(a){d.error=a}finally{this._completeTask(d)}},schedule:0,id:H++,key:a,signal:c};return d}_scheduleTask(a){let b=this._queue[a];if(b&&b.length>0){let a=b[0];a.schedule=m.setTimeout(a.execute,5)}}_completeTask(a){let{id:b,key:c}=a,[d,...e]=this._queue[c];if(d.id!==b)throw Error("this should not happen, currently running task must be the top of the queue");this._queue[c]=e,this._scheduleTask(c),a.error?a.signal.reject(a.error):a.signal.resolve()}constructor(){this._queue={}}}function J(){return m.performance&&performance.now?Math.round(performance.now()):Date.now()}var K=c(35);let L=o.a.isActivated("2A0E7367-E6F7-4540-87A3-F3F5C5981CF3"),M="_odspcache_",N="_____",O={cacheType:f.indexedDB};class P{get configuration(){return this._config}async read(a){let b,{cacheKey:c,validBufferTime:d}=a,e=this._logQos({name:"PersistentCache.read"}),f=J();Date.now();try{let a=this._getStorageKey(c);a&&(b=await this._getData({cacheKey:c,storageKey:a,validBufferTime:d})),b=b||{key:{original:c,encoded:a},app:this._app,data:void 0,cacheStats:{lastModified:NaN,lastRead:NaN,reads:0},cacheType:this._cacheType,performance:{total:Math.round(J()-f)}}}catch(a){throw e({resultType:K.a.Failure,error:a.message?a.message:a.toString(),extraData:{cacheResult:"miss"}}),a}return L&&e({resultType:K.a.Success,extraData:{cacheResult:`${void 0!==b.data?"hit":"miss"}`}}),Promise.resolve(b)}async rangeQuery(a){let b;if(this._cacheType!==f.indexedDB)throw Error("Only indexedDB supports range query, your storage does not support!");let c=this._logQos({name:"PersistentCache.rangeQuery"}),d=0,e=J(),g={lastModified:NaN,lastRead:Date.now(),reads:1};try{let c=J();b=this._storage.rangeQuery(a).then(a=>{d=Math.round(J()-c);let b=a.map(a=>({original:this._getOriginalKeyFromCacheKey(a),encoded:a}));return{key:void 0,app:void 0,data:b,cacheStats:g,cacheType:this._cacheType,performance:{io:d,total:Math.round(J()-e)}}})}catch(a){throw c({resultType:K.a.Failure,error:a.message?a.message:a.toString()}),a}return c({resultType:K.a.Success}),b||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:g,cacheType:this._cacheType,performance:{io:d,total:Math.round(J()-e)}})}async update(a){let{cacheKey:b,data:c}=a,d=this._getStorageKey(b),e=this._cacheUpdateTaskManager.enqueue(d,()=>this._doCacheUpdate(b,c));await e.signal.promise,this._logCacheStats()}async remove({cacheKey:a}){return this.update({cacheKey:a,data:void 0})}async freeSpace(a,b){return this._storage.freeSpace(a,b)}async readAndUpdate(a){let b,{cacheKey:c,getData:d}=a,e=J(),g=Date.now(),h=this._logQos({name:"PersistentCache.readAndUpdate"}),i=d().then(a=>{let b={app:this._app,key:{original:c,encoded:this._getStorageKey(c)},data:a,cacheType:f.none,cacheStats:{lastModified:void 0,lastRead:g,reads:1},performance:{total:Math.round(J()-e)}};return this.update({cacheKey:c,data:a}),b});try{try{b=await Promise.race([this.read(a),i])}catch(a){}b&&(b.cacheType===f.none||void 0!==b.data)||(b=await i)}catch(a){throw h({resultType:K.a.Failure,error:a.message?a.message:a.toString()}),a}return h({resultType:K.a.Success}),b}_initLocalStorage(a){switch(a){case f.localStorage:this._storage=new G;break;case f.indexedDB:default:try{this._storage=new D(this._logQos.bind(this))}catch(a){a.message===C&&(this._storage=new G,this._cacheType=f.localStorage)}}}_getStorageKey(a){let b=encodeURIComponent(`${a.key}${a.user?N+a.user:""}`);return`${M}${this._dataIsEncrypted?btoa(b):b}`}_getOriginalKeyFromCacheKey(a){let b=a.replace(M,""),c=decodeURIComponent(this._dataIsEncrypted?atob(b):b);if(c.indexOf(N)>=0){let[a,b]=c.split(N);return{key:a,user:b}}return{key:c}}async _getData(a){let b,c,{cacheKey:d,storageKey:e,validBufferTime:f}=a,g=J(),h=P._buffer[e];if(h&&f&&g-h.readTime<f)return h.data;let i=J(),j=Date.now(),k=await this._storage.read(e),l=Math.round(J()-i),m={lastModified:k?.lastModified||NaN,lastRead:j,reads:(k?.reads||0)+1},n=a=>{let b={cacheStats:m,cacheType:this._cacheType,app:k?.app||this._app,key:{original:d,encoded:k?.key||e},performance:{io:l,crypto:c,total:Math.round(J()-g)},...a};return P._buffer[e]={data:b,readTime:i},b};if(!k)return n({data:void 0});if(k.lastModified&&h?.data?.cacheStats?.lastModified===k.lastModified)return n(h.data);let{data:o}=k;if(void 0===o)return n({data:void 0});if(!this._dataIsEncrypted)return n({data:o});let{CurrentKey:{Key:p},PreviousKey:{Key:q}}=this._cacheSecret,r=J();try{b=await this._crypto.decrypt({encryptedData:o,encryptionSecret:p})}catch(a){if(a&&a.message&&a.message.indexOf("wrong secret or signature.")>=0&&void 0!==(b=await this._crypto.decrypt({encryptedData:o,encryptionSecret:q}))&&this.update({cacheKey:d,data:b}),void 0===b)throw a}return c=Math.round(J()-r),n({data:b})}async _doCacheUpdate(a,b){let c=this._logQos({name:"PersistentCache.update"});try{let c=this._getStorageKey(a);if(void 0!==b){let d={...{cacheStats:{lastModified:NaN,lastRead:J(),reads:1}},...P._buffer[c]?.data,...{data:b,app:this._app,cacheType:this._cacheType,key:{original:a,encoded:c}}};P._buffer[c]={data:d,readTime:J()};let e=b,g=NaN;if(this._dataIsEncrypted){let{CurrentKey:{Key:a}}=this._cacheSecret;g=(e=await this._crypto.encrypt({encryptionSecret:a,data:b,doSerialize:this._cacheType===f.localStorage})).cipherText?e.cipherText.byteLength:0}else try{g="string"==typeof b?b.length:JSON.stringify(b).length}catch(a){}await this._storage.write({app:this._app,key:c,data:e,lastRead:d.cacheStats.lastRead,parentKey:a.parentKey,reads:d.cacheStats.reads,size:g})}else delete P._buffer[c],await this._storage.write({key:c,app:void 0,data:void 0,lastRead:void 0,parentKey:a.parentKey,reads:void 0,size:void 0})}catch(a){throw c({resultType:K.a.Failure,error:a.message?a.message:a.toString()}),a}c({resultType:K.a.Success})}async _logCacheStats(){this._logStatsTimer||(this._logStatsTimer=setTimeout(async()=>{await this._storage.statistics()},3e4))}_logQos(a){if(this._qos){let b=this._app;a.extraData||(a.extraData={}),a.extraData.alias=a.extraData.alias||b;let c=new this._qos(a);return a=>{a.extraData||(a.extraData={}),a.extraData.alias=a.extraData.alias||b,c.end(a)}}return a=>{}}constructor(a){const{cacheType:b=O.cacheType,...c}=a;if(this._config={...c,cacheType:b},this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=a.app,this._cacheUpdateTaskManager=new I,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}}P._buffer={};var Q=c(323),R=c(497);class S{getDataUtilizingCache(a){let{cacheRequestKey:b,cachingStrategy:c=Q.a.useCacheAndUpdateInTheBackground,cacheTimeoutTime:d=R.c,getData:e,returnStatistics:f=!1,cacheRequestParentKey:h,callback:i}=a,j={key:b,user:this._userId,parentKey:h},k=()=>{let a=this._getDataPromises[b];if(!a){let c=e();this._getDataPromises[b]=c,a=c.then(a=>(this._cache.update({cacheKey:j,data:a}).catch(()=>{}),delete this._getDataPromises[b],a)).catch(a=>{throw delete this._getDataPromises[b],a})}return a.then(a=>f?{data:a,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1,dataSourceType:this._isDistinguishDataSourcesKSActivated?void 0:R.d.request}}:a)};return c===Q.a.onlyCache?g.c.resolve(this._cache.read({cacheKey:j})).then(a=>{let{data:b,cacheStats:c}=a||{};return null==b?null:f?{data:b,cacheStats:c}:b}).catch(()=>null):g.c.resolve(this._cache.read({cacheKey:j})).then(a=>{let{data:b,cacheStats:e}=a||{};if(null==b)return k();!this._isDistinguishDataSourcesKSActivated&&e&&(e.dataSourceType=R.d.cache);let g=f?{data:b,cacheStats:e}:b,h=this._isCacheExpired(e.lastModified,d);switch(c){case Q.a.useCacheAndNoUpdate:return g;case Q.a.useCacheAndUpdateInTheBackground:return h&&k(),g;case Q.a.useCacheIfNotExpired:if(h)return k();return g;case Q.a.useCacheIfNotExpiredOrOnFailure:if(h)return k().catch(()=>g);return g;case Q.a.useCacheAndImmediatelyUpdate:return k().then(i),g;case Q.a.bypassCache:default:return k()}},()=>k())}getRequestKey(a,b,c){let d=[];return d.push(a),d.push(b),c&&d.push(c.toString()),d.join(",")}get cacheId(){return this._id}get cacheVersionId(){return this._id+"-version"}flushCache(a,b){let c={key:a,user:this._userId,parentKey:b};delete this._cache[a],this._cache.remove({cacheKey:c})}updateCache(a,b){let c={key:a,user:this._userId};this._cache.update({cacheKey:c,data:b})}_isCacheExpired(a,b){return a<=new Date().valueOf()-b}constructor(a,b){this._getDataPromises={},this._isDistinguishDataSourcesKSActivated=o.a.isActivated("6f03f183-611a-404f-8e80-e7b6f3abdfcb");const{id:c,dataSourceName:d,cacheType:e=f.indexedDB}=a,{pageContext:g}=b,{aadUserId:h}=g||{};this._id=c,this._userId=h;const i=d||c,j=n.a.withData(a=>a.name&&i&&!a.name.startsWith(i)?{...a,name:`${i}.${a.name}`}:a);this._cache=new P({cacheType:e,telemetry:{qos:j}})}}}
,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return d},c:function(){return e},d:function(){return g}});let d=3e5,e=864e5,f="odsp-ds-",g={cache:"cache",request:"request"}}
,,,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return D}});var d=c(510),e=c("react-lib"),f=c(51),g=c(511),h=c(4),i=c(512),j=c(513),k=c(514),l=c(334),m=c(333),n=c(9),o=c(2),p=c(12),q=c(48);let r=new Set(["componentRef","messageBarType","actions","ariaLabel","onDismiss","isMultiline","dismissButtonAriaLabel","truncated"]),s={[m.a.info]:"info",[m.a.warning]:"warning",[m.a.error]:"error",[m.a.severeWarning]:"error",[m.a.success]:"success",[m.a.blocked]:"error"},t={[m.a.info]:"",[m.a.warning]:"ms-MessageBar--warning",[m.a.error]:"ms-MessageBar--error",[m.a.severeWarning]:"ms-MessageBar--severeWarning",[m.a.success]:"ms-MessageBar--success",[m.a.blocked]:"ms-MessageBar--blocked"},u=[m.a.warning,m.a.error,m.a.severeWarning,m.a.blocked];var v=c(61);let w=(0,f.a)({infoBackground:{backgroundColor:"#f3f2f1"},warningBackground:{backgroundColor:"#FFF4CE"},errorBackground:{backgroundColor:"#FDE7E9"},severeWarningBackground:{backgroundColor:"#FED9CC"},successBackground:{backgroundColor:"#DFF6DD"},infoIcon:{color:"#605e5c"},warningIcon:{color:"#797775"},errorIcon:{color:"#A80000"},severeWarningIcon:{color:"#D83B01"},successIcon:{color:"#107C10"},infoBackgroundInverted:{backgroundColor:"#323130"},warningBackgroundInverted:{backgroundColor:"#433519"},errorBackgroundInverted:{backgroundColor:"#442726"},severeWarningBackgroundInverted:{backgroundColor:"#4F2A0F"},successBackgroundInverted:{backgroundColor:"#393D1B"},infoIconInverted:{color:"#C8C6C4"},warningIconInverted:{color:"#C8C6C4"},errorIconInverted:{color:"#F1707B"},severeWarningIconInverted:{color:"#FCE100"},successIconInverted:{color:"#92C353"},body:{"& a:last-child":{paddingLeft:"4px"}},actions:{"& button:nth-child(n+2)":{marginLeft:"8px"}},noActions:{display:"none"}}),x={[m.a.info]:"infoBackground",[m.a.warning]:"warningBackground",[m.a.error]:"errorBackground",[m.a.severeWarning]:"severeWarningBackground",[m.a.success]:"successBackground",[m.a.blocked]:"errorBackground"},y={[m.a.info]:"infoIcon",[m.a.warning]:"warningIcon",[m.a.error]:"errorIcon",[m.a.severeWarning]:"severeWarningIcon",[m.a.success]:"successIcon",[m.a.blocked]:"errorIcon"},z=(0,n.a)(),A=a=>{let b,c,d,f=w(),[n,A]=e.useState(!0),B=z(a.styles,{theme:a.theme}),C=(0,o.C)().isInverted,D=a.messageBarType||m.a.info,E=f[`${x[D]}${C?"Inverted":""}`],F=f[`${y[D]}${C?"Inverted":""}`],G=(b="info",c="polite",d="auto",a.messageBarType&&(b=s[a.messageBarType],u.includes(a.messageBarType)&&(c="assertive")),(a.isMultiline||a.truncated)&&(d="multiline"),{...{intent:b,politeness:c,layout:d,"aria-label":a.ariaLabel||a["aria-label"],"aria-live":a["aria-live"],icon:{className:(0,h.a)("ms-MessageBar-icon",B?.icon),...a.messageBarIconProps?.iconName?{children:e.createElement(p.a,{...a.messageBarIconProps,className:B?.icon})}:{}}},...(0,q.d)(a,r)});return n?e.createElement(g.a,{...G,className:(0,h.a)("ms-MessageBar",t[D],G.className,(0,v.t)()&&E,B.root),icon:{className:(0,h.a)("ms-MessageBar-icon",(0,v.t)()&&F,B.icon)}},e.createElement(i.a,{className:(0,h.a)("ms-MessageBar-content","ms-MessageBar-text","ms-MessageBar-innerText",f.body,B.content)},a.children),a.actions||a.onDismiss?e.createElement(j.a,{containerAction:a.onDismiss?e.createElement(k.a,{onClick:()=>{a.onDismiss?.(),A(!1)},"aria-label":a.dismissButtonAriaLabel?a.dismissButtonAriaLabel:"dismiss",appearance:"transparent",icon:e.createElement(l.f,null),className:(0,h.a)("ms-MessageBar-dismissal",B.dismissal)}):void 0,className:(0,h.a)("ms-MessageBar-actions",f.actions,B.actions,a.actions?void 0:f.noActions)},a.actions):void 0):e.createElement(e.Fragment,null)};A.displayName="MessageBarShim";var B=c(156),C=c(121);let D=a=>(0,B.a)(d.a,A,a,C.a.FluentUIV9ShimMessageBar)}
,,,,,,,function(a,b,c){c.d(b,{a:function(){return m}}),(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton{font-size:.875rem;font:-apple-system-title1;margin:0;padding:0;border-radius:.25rem;min-height:2rem;height:fit-content}.od-SendButton .ms-Button-label{font:-apple-system-body}@media screen and (-ms-high-contrast:active){.od-SendButton.send:focus,.od-SendButton.send:hover{background:highlight}}"}]);var d=c("react-lib"),e=c(517),f=c(119),g=c(316),h=c(32),i=c(336),j=c(26),k=c("prop-types-lib"),l=c(2);class m extends d.Component{componentDidMount(){this._buttonRef&&this.props.shouldBeFocused&&this._buttonRef.current.focus()}render(){if(!this.props.ctaLabel)return null;let a=!1;if(this.props.currentSettings.audience===h.a.existing&&this.props.linkRecipients){for(let b of this.props.linkRecipients)if(void 0===this.props.permissionsMap[b.email]&&void 0===this.props.permissionsMap[b.userId]){a=!0;break}}let b=!!this.props.errorMessage||(0,j.V)(this.props.sharingInformation)||a||(0,j.s)(this.props.messageText)>this.props.maximumMessageLength||(0,j.s)(this.props.subjectText)>this.props.maximumSubjectLength;switch(this.props.sendButtonType){case i.a.button:return d.createElement(e.a,{className:"od-SendButton send",disabled:b,onClick:this._onSendLinkClicked,componentRef:this._buttonRef},this.props.ctaLabel);case i.a.link:return d.createElement("div",{className:"od-SendButton link"},d.createElement(g.a,{disabled:b,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel));case i.a.copyLink:let c=(0,l.C)(),k={color:c.palette.themeDarker,backgroundColor:c.palette.neutralLighter,borderColor:c.palette.neutralSecondary},m={root:{color:c.palette.themePrimary,backgroundColor:c.palette.white,borderColor:c.palette.neutralTertiary},rootHovered:k,rootFocused:k,rootDisabled:{color:c.palette.themeTertiary,backgroundColor:c.palette.white,borderColor:c.palette.neutralTertiary}};return this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==h.a.specificPeople&&(b=(0,j.V)(this.props.sharingInformation)),d.createElement(f.a,{className:"od-SendButton copy",onClick:this._onSendLinkClicked,styles:m,disabled:b},this.props.ctaLabel)}}constructor(a,b){super(a),this._buttonRef=d.createRef(),this._onSendLinkClicked=()=>{this.props.onSendLinkClicked(this.props.messageText,this.props.subjectText)},this._platformDetection=b.platformDetection}}m.contextTypes={platformDetection:k.object.isRequired,sharingStore:k.object.isRequired}}
,,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return h}});let d={"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bmp:1,cbl:1,cfg:1,cool:1,cr2:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,dwg:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},e={"3fr":1,"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,ari:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mef:1,mkv:1,mos:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mpeg:1,mpg:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1};var f=c(0);let g={None:0,AllowMediaTA:1,OfficeOnly:2};function h(a,b){return!!a&&((a=("."===a[0]?a.slice(1):a).toLowerCase(),f.a.isActivated("3B12E0BA-483A-4E92-B6EC-89DC316832D6","01/25/2022","Update BlockDownloadSupported"))?d[a]>=b:e[a]>=b)}}
,function(a,b,c){var d,e;function f(a){return!!a?.match("-WV2$")}c.d(b,{a:function(){return d},b:function(){return f}}),(e=d||(d={})).SharePrivateDraft="SharePrivateDraft",e.ShareSitePage="ShareSitePage",e.ShareSitePageDraft="ShareSitePageDraft",e.ShareSitePageDraftFromLibrary="ShareSitePageDraftFromLibrary",e.ShareSitePageFromLibrary="ShareSitePageFromLibrary"}
,,,,,,,function(a,b,c){c.d(b,{a:function(){return x}});var d=c(10);(0,d.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:0 16px;position:relative}.od-ShareHint.new{margin:0;padding:0;flex:1}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;display:none}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:flex;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:0 0;padding:10px 10px 10px 0;margin:0;opacity:0;transition:opacity .2s;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:0}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint-data.copyLinkNotification{padding:0}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}]),(0,d.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail-status{padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{display:inline-block;font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";word-break:break-word}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusText.accessSummaryLink{font-size:.75rem}.od-ShareHintDetail-statusText.unHealthy{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-statusText:hover{cursor:default}.od-ShareHintDetail-statusText:hover.clickable{cursor:pointer}.od-ShareHintDetail-statusText i{vertical-align:middle;padding:5px 6px 7px 6px}@supports (font:-apple-system-body){.od-ShareHintDetail-statusText{font:-apple-system-body}}.od-ShareHintDetail{height:100%;background-color:transparent;border:none}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover{cursor:pointer}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{text-decoration:underline}.od-ShareHintDetail.copyLinkNotification{padding:0}.od-ShareHintDetail.copyLinkNotification .od-ShareHintDetail-status{padding:0}.od-ShareHintDetail--hover:hover{border:none}.od-ShareHintDetail--hover:hover:active{border:none}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.75rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir=ltr] .od-ShareHintDetail-item{margin-left:4px}[dir=rtl] .od-ShareHintDetail-item{margin-right:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{margin-left:4px;font-size:.5rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}@media screen and (-ms-high-contrast:active){.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{color:highlight}}"}]);var e=c(12),f=c(32),g=c(45),h=c(46),i=c(63),j=c("react-lib"),k=c(39),l=c(16),m=c(20),n=c(153),o=c(26),p=c(204),q=c(47),r=c(138),s=c(209),t=c("prop-types-lib");class u extends j.Component{render(){let a=this._getLabel(this.props.currentSettings);(0,l.K)()&&this.props.isCopyLinkNotification&&(a=(0,o.w)({clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,currentSettings:this.props.currentSettings,companyName:this.props.companyName,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,sharingStore:this.context.sharingStore}));let b=`od-ShareHintDetail ${(0,l.yb)()?"od-ShareHintDetail--hover":""} ${this.props.isClickable?"od-ShareHintDetail--clickable":""} ${this.props.isCopyLinkNotification?"copyLinkNotification":""}`,c=a+", "+m.aj;return j.createElement(s.a,{className:b,onClick:this.props.isClickable?this.props.onClickCallback:void 0,"aria-label":c},j.createElement("div",{className:"od-ShareHintDetail-description"},j.createElement("div",{className:"od-ShareHintDetail-status"},j.createElement("span",{className:`od-ShareHintDetail-statusText ${this.props.isClickable?"clickable":""}`},a,this._renderStatusIcons(),this._renderChevron(this.props.isClickable)))))}_renderStatusIcons(){if(!this.props.currentSettings)return;let a=this.props.currentSettings.expiration,b=this.props.currentSettings.hasPassword;this.props.currentSettings.preventDownload;let c=[];a&&a.getTime()!==new Date(0).getTime()&&c.push({icon:"Calendar",tooltip:`${k.b(m.yd,(0,n.d)(a))}`}),b&&c.push({icon:"Lock",tooltip:m.sj}),this.props.currentSettings.audience!==f.a.existing&&this.props.currentSettings.isReview&&p.a[this.props.sharingInformation.fileExtension]&&c.push({icon:"Feedback",tooltip:m.qf}),this.props.currentSettings.audience===f.a.anyone&&this.props.currentSettings.trackLinkUsers&&c.push({icon:"ReminderPerson",tooltip:q.d(this.props.clientId)?m.ki:m.Pi});let d=c.map((a,b)=>j.createElement("span",{className:"od-ShareHintDetail-item"},j.createElement(i.a,{id:a.icon,tooltipProps:{onRenderContent:()=>j.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},a.tooltip)}},j.createElement(e.a,{iconName:a.icon,"tab-index":0,"data-is-focusable":!0,role:"button","aria-label":a.tooltip,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75",padding:"7px"}}}))));return j.createElement("div",{className:"od-ShareHintDetail-iconsList"},d)}_renderChevron(a){if(a)return j.createElement(e.a,{iconName:r.a.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})}_getLabel(a){let b=this.props.companyName,c=this.props.sharingInformation.addressBarLinkSettings,d=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&c)if(c.linkDisabled||!(0,o.i)(d))return m._h;else return k.b(m.Cc,b);if(!a)return"";if(a.preventDownload){if(a.audience===f.a.anyone)return m.W;else if(a.audience===f.a.organization)return k.b(m.Ec,b);else if(a.audience===f.a.specificPeopleFlex)return m.fk}switch(a.sharingLinkKind){case g.a.direct:if(a.audience===f.a.specificPeople){if(this.props.sharingInformation.requiresAccessApproval)return m.Si;if(!a.sharingRole)return a.isEdit?m.rk:m.uk;if((0,o.T)(a.sharingRole))return m.rk;if(a.sharingRole===h.a.review){if(p.a[this.props.sharingInformation.fileExtension])return m.dk;return m.lk}return m.uk}return m.dd;case g.a.organizationView:return k.b(m.Cc,b);case g.a.organizationEdit:return k.b(m.hc,b);case g.a.anonymousView:return m.V;case g.a.anonymousEdit:return m.L;case g.a.flexible:return this._getFlexibleLabel(a,b);default:return""}}_getFlexibleLabel(a,b){return a.audience===f.a.existing?m.dd:a.audience===f.a.specificPeopleFlex?a.sharingRole?a.sharingRole==h.a.manageList?m.ck:(0,o.T)(a.sharingRole)?m.rk:a.sharingRole===h.a.review?p.a[this.props.sharingInformation.fileExtension]?m.dk:m.lk:m.uk:a.isEdit?m.rk:m.uk:a.audience===f.a.customLabeledSpecificPeople?a.sharingRole===h.a.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?k.b(m.Mc,this.props.customLabeledAudienceConfig.entityName):(0,o.o)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):a.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?k.b(m.Lc,this.props.customLabeledAudienceConfig.entityName):(0,o.o)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?k.b(m.Pc,this.props.customLabeledAudienceConfig.entityName):(0,o.o)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):a.audience===f.a.organization?a.sharingRole===h.a.review?p.a[this.props.sharingInformation.fileExtension]?k.b(m.Dc,b):k.b(m.xc,b):a.sharingRole==h.a.manageList?k.b(m.yc,b):a.isEdit?k.b(m.hc,b):k.b(m.Cc,b):a.audience===f.a.anyone?a.sharingRole===h.a.review?p.a[this.props.sharingInformation.fileExtension]?m.P:m.U:a.sharingRole==h.a.manageList?m.O:a.isEdit?m.L:m.V:""}constructor(a,b){super(a),this._renderStatusIcons=this._renderStatusIcons.bind(this)}}u.contextTypes={sharingStore:t.object.isRequired};var v=c(527),w=c(346);function x(a){let b,c,{clientId:d,companyName:g,currentSettings:h,onShareHintClick:i,sharingInformation:l,linkRecipients:n,customLabeledAudienceConfig:p,isAddressBarLinkHint:q,addressBarLink:s,isCopyLinkNotification:t}=a,x=j.useRef(),y=(0,j.createRef)();j.useCallback(a=>{if(a)return j.createElement("div",{ref:y},j.createElement(e.a,{iconName:r.a.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))},[]);let z=j.useCallback(()=>{i&&i()},[i]),A=j.useCallback(()=>{let a=h.audience;return a===f.a.anyone?w.a.anyone:a===f.a.organization?w.a.workGroup:a===f.a.existing?w.a.existing:a===f.a.customLabeledSpecificPeople?w.a.chat:w.a.specificPeople},[h]),B=j.useCallback(a=>a===w.a.anyone?m.oh:a===w.a.workGroup?k.b(m.uh,g):a===w.a.existing?m._h:a===w.a.specificPeople?m.Fh:void 0,[g]),C=!!i,D=`od-ShareHint ${!(0,o.V)(a.sharingInformation)?"od-ShareHint--shimmerFadeout od-ShareHint--loaded":""} new`,E=`od-ShareHint-data ${C?"od-ShareHint--clickable":""} ${t?"copyLinkNotification":""}`;if(b=j.createElement("div",{className:"od-ShareHint-shimmer"},!t&&j.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},j.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},j.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),j.createElement("div",{className:"od-ShareHint-text-shimmer"})),q){let a=l.addressBarLinkSettings,b=l.sharingAbilities,e=a.linkDisabled||!(0,o.i)(b)?w.a.existing:w.a.workGroup,f=e===w.a.existing?m._h:k.b(m.uh,g);c=j.createElement("div",{className:E,ref:x},!t&&j.createElement("div",{className:"od-ShareHint-iconHolder"},j.createElement(v.a,{label:f,permissionsType:e,showLabel:!1})),j.createElement(u,{clientId:d,companyName:g,currentSettings:null,sharingInformation:l,linkRecipients:n,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:s,isClickable:C,onClickCallback:z,isCopyLinkNotification:t}))}else{let b=A(),e=B(b),k=h.audience===f.a.customLabeledSpecificPeople&&p&&p.iconUrl;c=i?j.createElement("div",{className:E,ref:x},!t&&j.createElement("div",{className:"od-ShareHint-iconHolder"},j.createElement(v.a,{label:e,permissionsType:b,iconUrl:k,showLabel:!1})),j.createElement(u,{clientId:d,companyName:g,currentSettings:h,sharingInformation:l,linkRecipients:n,customLabeledAudienceConfig:p,isClickable:C,onClickCallback:z})):j.createElement("div",{className:E,autoFocus:!0},!t&&j.createElement("div",{className:"od-ShareHint-iconHolder"},j.createElement(v.a,{label:e,permissionsType:b,iconUrl:k,showLabel:!1})),j.createElement(u,{clientId:d,companyName:g,currentSettings:h,sharingInformation:l,linkRecipients:n,customLabeledAudienceConfig:p,isClickable:C,isCopyLinkNotification:a.isCopyLinkNotification}))}return j.createElement("div",{"aria-label":m.Ke,className:D},c,b)}}
,function(a,b,c){c.d(b,{a:function(){return i}});var d=c("react-lib"),e=c("prop-types-lib");(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{align-items:top;display:flex;padding:0;width:100%}.od-ShareLinkDescription .od-ShareLinkDescription-label-section{width:80%;text-align:left}[dir=ltr] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-left:16px}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-right:16px}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{text-align:right}@supports (font:-apple-system-body){.od-ShareLinkDescription .od-ShareLinkDescription-label-section{font:-apple-system-body}}.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font-size:.75rem;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@supports (font:-apple-system-caption1){.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font:-apple-system-caption1}}.od-ShareLinkDescription-label{font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;top:2px;position:relative;margin:0;width:100%}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}@supports (font:-apple-system-body){.od-ShareLinkDescription-label{font:-apple-system-body}}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}@supports (height:-apple-system-body){.od-ShareLinkDescription-icon{height:-apple-system-body;width:-apple-system-body}}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--AddFriend{top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--AddFriend{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--AddFriend{padding-left:10px}.od-ShareLinkDescription-IELabel{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-ShareLinkDescription-InfoBtn i{vertical-align:middle;padding:5px 6px 7px 6px}"}]);var f=c(528),g=c(529),h=c(12);class i extends d.Component{render(){let a=f.a[this.props.permissionsType],b=this.props.iconUrl?d.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):d.createElement(h.a,{"aria-hidden":"true",iconName:a,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return d.createElement("div",{className:"od-ShareLinkDescription"},!1!==this.props.renderIcon&&d.createElement("div",{className:`od-ShareLinkDescription-icon icon-${a}`,"aria-hidden":"true"},b),this._renderLabel())}_renderLabel(){let a=this.props.infoButtonMessage,b=a?d.createElement(g.a,{className:"od-ShareLinkDescription-InfoBtn",message:a,disableKeyboard:!0}):"";if(this.props.showLabel){let a=this.props.isSelected||this.props.showDetailText;b=a?null:b;let c=d.createElement("div",{className:"od-ShareLinkDescription-label"},d.createElement("div",{className:`${this._platformDetection.isIE?"od-ShareLinkDescription-IELabel":""}`},this.props.label),b);return d.createElement("div",{className:"od-ShareLinkDescription-label-section"},c,a&&d.createElement("span",{className:"od-ShareLinkDescription-detailText"},this.props.detailText))}}constructor(a,b){super(a),this._platformDetection=b.platformDetection}}i.contextTypes={platformDetection:e.object.isRequired}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(346);let e={[d.a.anyone]:"Globe",[d.a.onlyYou]:"Lock",[d.a.specificPeople]:"AddFriend",[d.a.workGroup]:"Work",[d.a.existing]:"ReminderPerson",[d.a.chat]:"Chat",[d.a.mail]:"Mail"}}
,function(a,b,c){c.d(b,{a:function(){return i}}),(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}@supports (font:-apple-system-body){.od-InfoButton-infoIcon{font-size:inherit}}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:flex;flex-direction:column;padding:10px;width:250px}@supports (font:-apple-system-caption1){.od-InfoButton-content{font:-apple-system-caption1}}"}]);var d=c(530),e=c(18),f=c(12),g=c("react-lib"),h=c("prop-types-lib");class i extends g.Component{render(){let a=this.props,b=this.state;return g.createElement("div",{style:{display:"inline"}},g.createElement("div",{className:`od-InfoButton-button ${a.className}`,onClick:this._onShowCallout,ref:this._onInfoButton,onFocus:a.disableKeyboard?void 0:this._onShowCallout,onBlur:a.disableKeyboard?void 0:this._onDismissCallout,role:"button",tabIndex:a.disableKeyboard?-1:0,"aria-label":a.ariaLabel||a.message},g.createElement(f.a,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),b.isCalloutVisible&&g.createElement(d.a,{directionalHint:e.a.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},g.createElement("div",{className:"od-InfoButton-content"},g.createElement("span",{className:"od-InfoButton-message"},a.message))))}constructor(a,b){super(a),this._onShowCallout=()=>{this.setState({...this.state,isCalloutVisible:!0})},this._onDismissCallout=()=>{this.setState({...this.state,isCalloutVisible:!1})},this._onInfoButton=a=>{this._infoButton=a},this.state={isCalloutVisible:!1}}}i.contextTypes={strings:h.object.isRequired}}
,function(a,b,c){c.d(b,{a:function(){return E}});var d=c(147),e=c("react-lib"),f=c(531),g=c(535),h=c(18),i=c(142),j=c(347),k=c(48),l=c(61);let m=new Set(["target","directionalHint","directionalHintForRTL","gapSpace","beakWidth","calloutWidth","calloutMaxWidth","calloutMinWidth","backgroundColor","bounds","minPagePadding","isBeakVisible","preventDismissOnScroll","preventDismissOnResize","preventDismissOnLostFocus","dismissOnTargetClick","preventDismissOnEvent","shouldDismissOnWindowFocus","coverTarget","alignTargetEdge","role","ariaLabel","ariaLabelledBy","ariaDescribedBy","className","style","onLayerMounted","layerProps","popupProps","onPositioned","onDismiss","doNotLayer","directionalHintFixed","finalHeight","hideOverflow","setInitialFocus","calloutMaxHeight","onScroll","theme","styles","hidden","shouldUpdateWhenHidden","shouldRestoreFocus","onRestoreFocus"]),n=new Set(["role","ariaLabel","ariaLabelledBy","ariaDescribedBy","onDismiss","className","shouldRestoreFocus","onRestoreFocus","enableAriaHiddenSiblings"]),o=(a=0,b=0)=>()=>({width:0,height:0,top:b,right:a,bottom:b,left:a,x:a,y:b}),p=a=>{let b=(0,l.a)();return a instanceof HTMLElement?a:"string"==typeof a?document.querySelector(a):a&&"current"in a?a.current:!b&&a&&"preventDefault"in a?{getBoundingClientRect:o(a.clientX,a.clientY)}:!b&&a&&("top"in a||"left"in a)?"bottom"in a&&"right"in a?{getBoundingClientRect:()=>({x:a.left,y:a.top,top:a.top,left:a.left,bottom:a.bottom,right:a.right,width:a.width,height:a.height})}:{getBoundingClientRect:o(a.left||a.x,a.top||a.y)}:void 0};var q=c(9),r=c(51),s=c(111),t=c(4);let u=(0,q.a)(),v="--lengthCalloutWidth",w="--lengthCalloutMaxWidth",x="--lengthCalloutMinWidth",y="--lengthCalloutMaxHeight",z=(0,r.a)({calloutRoot:{...s.a.padding(0),boxSizing:"border-box",display:"flex"},calloutMain:{overflowX:"hidden",overflowY:"auto",position:"relative",width:"100%"},overflowYHidden:{overflowY:"hidden"},calloutWidth:{width:`var(${v})`},calloutMaxWidth:{maxWidth:`var(${w})`},calloutMinWidth:{minWidth:`var(${x})`},calloutMaxHeight:{maxHeight:`var(${y})`}});var A=c(343);let B=e.forwardRef(function(a,b){let{onClick:c}=a,d=(0,A.a)("CalloutContent",a),{popoverProps:o,popoverSurfaceProps:q,popoverSurfaceMainProps:r,focusTrapZoneProps:s}=(a=>{let b,{target:c,trapFocus:d,doNotLayer:e,isBeakVisible:f=!0,hidden:g=!1}=a,h={open:!g,withArrow:f,onOpenChange:(b=p(c),(c,d)=>{if(!0===d.open)return;let e=a.popupProps?.onDismiss||a.onDismiss;if("keydown"===c.type&&"Escape"===c.key)return void e?.(c);if("click"===c.type||"focus"===c.type){if("focus"===c.type&&a.preventDismissOnLostFocus||a.preventDismissOnEvent?.(c))return;b&&!a.dismissOnTargetClick&&c.target instanceof Node&&b.contains(c.target)||e?.(c);return}if("wheel"===c.type){if(a.preventDismissOnScroll)return;let b=new Event("scroll");e?.(b);return}}),closeOnScroll:!0,trapFocus:d,inline:e},i=(0,k.d)(a,m);return delete i["aria-roledescription"],{popoverProps:h,popoverSurfaceProps:i,popoverSurfaceMainProps:{role:a.popupProps?.role||a.role,"aria-roledescription":a["aria-roledescription"],"aria-describedby":a.popupProps?.ariaDescribedBy||a.ariaDescribedBy,"aria-label":a.popupProps?.ariaLabel||a.ariaLabel,"aria-labelledby":a.popupProps?.ariaLabelledBy||a.ariaLabelledBy,...(0,k.d)(a.popupProps||{},n)},focusTrapZoneProps:a.trapFocus&&a.focusTrapProps&&(0,j.a)(a.focusTrapProps)||{}}})(d),B=e.useCallback(a=>{a.stopPropagation(),c?.(a)},[c]),{classNames:C,styles:D}=(a=>{let{backgroundColor:b,className:c,calloutWidth:d,calloutMaxWidth:f,calloutMinWidth:g,calloutMaxHeight:h,hideOverflow:i,styles:j,theme:k}=a,m=z(),n=u(j,{theme:k}),o={root:(0,t.a)("ms-Callout",c,m.calloutRoot,n.root,!!d&&m.calloutWidth,!!f&&m.calloutMaxWidth,!!g&&m.calloutMinWidth,!!h&&m.calloutMaxHeight),main:(0,t.a)("ms-Callout-main",a.popupProps?.className,m.calloutMain,n.calloutMain,!!h&&m.calloutMaxHeight,i&&m.overflowYHidden)},p=e.useMemo(()=>({[v]:!!d&&`${d}px`||void 0,[w]:!!f&&`${f}px`||void 0,[x]:!!g&&`${g}px`||void 0,[y]:!!h&&`${h}px`||void 0,backgroundColor:(0,l.G)()?void 0:b}),[d,f,g,h,b]),q=e.useMemo(()=>({[y]:!!h&&`${h}px`||void 0}),[h]);return{classNames:o,styles:e.useMemo(()=>{let a={};return Object.keys(p).some(a=>void 0!==a)&&(a.root=p),Object.keys(q).some(a=>void 0!==a)&&(a.main=q),a},[p,q])}})(d),E=(a=>{let b,{target:c,coverTarget:d,gapSpace:f,directionalHint:g=h.a.bottomAutoEdge}=a,j=e.useRef(null);e.useEffect(()=>{let a=p(c);a&&j.current?.setTarget(a)},[c]);let m=(b=!(0,l.s)()&&d?(0,i.a)(k.a[g]):(0,i.a)(k.b[g]),(0,l.r)()?b:{...b});return m.positioningRef=j,void 0!==d&&(m.coverTarget=d),void 0!==f&&(m.offset={mainAxis:f}),m})(d);return e.createElement(f.a,{...o,positioning:E},e.createElement(g.a,{...q,className:C.root,style:D.root,ref:b,...!(0,l.b)()?{onClick:B}:{}},e.createElement("div",{...r,className:C.main,style:D.main},a.trapFocus?e.createElement("div",s,a.children):a.children)))});B.displayName="CalloutShim";var C=c(156),D=c(121);let E=a=>(0,C.a)(d.a,B,a,D.a.FluentUIV9ShimCallout)}
,,,,,,,function(a,b,c){c.d(b,{a:function(){return e}});var d=c("react-lib");function e(){return d.createElement("div",{className:"separator"})}(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.separator{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}"}])}
,function(a,b){var c,d;(d=c||(c={}))[d.None=0]="None",d[d.PageSharingAssetWarning=1]="PageSharingAssetWarning",d[d.LimitedSharing=2]="LimitedSharing",d[d.LimitedSharingExisting=3]="LimitedSharingExisting",d[d.LinkReShare=4]="LinkReShare",b.a=c}
,function(a,b,c){var d,e,f,g,h,i,j,k,l,m;function n(a){return"spdf"===a?"DOGFOOD":"PRODUCTION"}c.d(b,{a:function(){return g},b:function(){return h},c:function(){return e},d:function(){return d},e:function(){return n}}),(i=d||(d={}))[i.Default=0]="Default",i[i.InProgress=1]="InProgress",i[i.Succeeded=2]="Succeeded",i[i.Failed=3]="Failed",(j=e||(e={})).AuthTokenUnavailable="AuthTokenUnavailable",j.BlockedByLanguage="BlockedByLanguage",j.BlockedByPostfilter="BlockedByPostfilter",j.BlockedByQualityCheck="BlockedByQualityCheck",j.CatchAll="CatchAll",j.DocumentContentUnavailable="DocumentContentUnavailable",j.DocumentEncrypted="DocumentEncrypted",j.DocumentLengthTooShort="DocumentLengthTooShort",j.ResourceUnavailable="ResourceUnavailable",j.Timeout="Timeout",j.UserNotAuthorized="UserNotAuthorized",(k=f||(f={}))[k.Icon=0]="Icon",k[k.Text=1]="Text",k[k.AriaLabel=2]="AriaLabel",(l=g||(g={})).DEV="DEV",l.DOGFOOD="DOGFOOD",l.PRODUCTION="PRODUCTION",(m=h||(h={}))[m.LIKE=0]="LIKE",m[m.DISLIKE=1]="DISLIKE"}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={})).success="success",e.error="error",e.inProgress="inProgress",e.closed="closed"}
,function(a,b,c){c.d(b,{a:function(){return k}});var d=c("react-lib"),e=c("prop-types-lib");(0,c(10).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-sensitivity-label-left-align{display:flex!important;border-radius:4px;padding:1px 8px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";margin:1px;overflow:hidden;align-items:center}.od-sensitivity-label-left-align:focus-visible{outline:1px solid}.od-sensitivity-label{border-radius:4px;padding:2px 6px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex;margin:1px;overflow:hidden}[dir=ltr] .od-sensitivity-label{margin-left:8px}[dir=rtl] .od-sensitivity-label{margin-right:8px}.od-sensitivity-label:focus-visible{outline:1px solid}.od-sensitivity-text{font-size:.75rem;font-weight:400;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}@supports (font:-apple-system-body){.od-sensitivity-text{font:-apple-system-body}}.od-sensitivity-tooltip-text{font-size:.75rem;font-weight:600;margin:0;margin-bottom:2px}.od-sensitivity-tooltip-information{font-size:.75rem;margin:0}.od-sensitivity-label-container{display:flex}.od-sensitivity-aria-label{visibility:hidden}.od-sensitivity-shieldIcon{display:flex}[dir=ltr] .od-sensitivity-shieldIcon{margin-left:-4px}[dir=rtl] .od-sensitivity-shieldIcon{margin-right:-4px}[dir=ltr] .od-sensitivity-shieldIcon{margin-right:3px}[dir=rtl] .od-sensitivity-shieldIcon{margin-left:3px}.od-sensitivity-shieldIcon svg path{fill:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-sensitivity-shieldIcon svg path{filter:invert(100%)}.od-sensitivity-label-left-align{border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-sensitivity-shieldIcon svg path{filter:invert(0%)}}"}]);var f=c(63),g=c(18),h=c(20),i=c(26),j=c(12);function k(a,b){let[c,e]=d.useState(null),k=((0,i.ib)(b.clientId,b.sharingStore)||(0,i.ab)(b.clientId,b.sharingStore))&&h.Qi;return a.sensitivityLabelInformation.displayName&&b.sharingStore.getEngagementHelper().showSensitivityLabel(a.engagementExtraData),d.createElement("div",{className:"od-sensitivity-label-container"},d.createElement(f.a,{tooltipProps:{directionalHint:g.a.bottomAutoEdge,onRenderContent:()=>(b.sharingStore.getEngagementHelper().hoverOverSensitivityLabel(a.engagementExtraData),d.createElement("div",{className:"od-sensitivity-tooltip"},d.createElement("p",{className:"od-sensitivity-tooltip-text"},k,a.sensitivityLabelInformation.displayName),d.createElement("p",{className:"od-sensitivity-tooltip-information"},c))),calloutProps:{hidden:null===c||0===c.length}},onTooltipToggle:d=>d?(()=>{if(null===c){let c,d;b.sharingStore.getSensitivityLabels(a.getGraphToken).then(b=>{if(c=!1,b){let f=b.filter(b=>b.id===a.sensitivityLabelInformation.id);if(0!==f.length){e(f[0].tooltip),c=!0;let a=f[0].applicableTo;d=!!a&&-1!==a.toLowerCase().indexOf("file")&&-1===a.toLowerCase().indexOf("email")}else e("")}else e("")}).catch(()=>{e("")}).finally(()=>{b.sharingStore.getEngagementHelper().getSensitivityLabel({...a.engagementExtraData,labelExists:c,isFileOnlyLabel:d,isFileEncrypted:a.sensitivityLabelInformation?.hasIRMProtection??!1})})}})():null,styles:{root:{display:"flex",overflow:"hidden",width:"min-content"}},id:"sensitivity-label"},d.createElement("span",{className:a.filename&&0!==a.filename.length?"od-sensitivity-label":"od-sensitivity-label-left-align",tabIndex:0,role:"note","aria-label":c?k+a.sensitivityLabelInformation.displayName+", "+c:a.sensitivityLabelInformation.displayName},a.sensitivityLabelInformation?.hasIRMProtection===void 0?null:a.sensitivityLabelInformation?.hasIRMProtection?d.createElement(j.a,{iconName:"ShieldLock16RegularIcon",className:"od-sensitivity-shieldIcon"}):d.createElement(j.a,{iconName:"Shield16RegularIcon",className:"od-sensitivity-shieldIcon"}),d.createElement("p",{className:"od-sensitivity-text"},a.sensitivityLabelInformation.displayName))))}k.contextTypes={sharingStore:e.object.isRequired,clientId:e.number.isRequired}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(543);let e=[{targetElementId:void 0,title:d.t,bodyText:d.s,bodyAria:"",primaryButtonText:d.i,secondaryButtonText:void 0},{targetElementId:"SendLink-roleSelectorCompact",title:d.o,bodyText:d.n,bodyAria:d.m,primaryButtonText:d.l,secondaryButtonText:d.b},{targetElementId:"Send-button",title:d.r,bodyText:d.q,bodyAria:d.p,primaryButtonText:d.l,secondaryButtonText:d.b},{targetElementId:"copy-button",title:d.f,bodyText:d.e,bodyAria:d.d,primaryButtonText:d.l,secondaryButtonText:d.b},{targetElementId:"Footer-button-settings",title:d.w,bodyText:d.v,bodyAria:d.u,primaryButtonText:d.l,secondaryButtonText:d.b},{targetElementId:"od-SharedWith-List",title:d.z,bodyText:d.y,bodyAria:d.x,primaryButtonText:d.h,secondaryButtonText:d.b}]}
,,function(a,b,c){c.d(b,{a:function(){return d}});function d(a,b){return a.length>b.length?b:a}}
,function(a,b,c){let d;c.d(b,{a:function(){return t}});var e=c(546),f=c("react-lib"),g=c(547),h=c(351),i=c(21),j=c(4),k=c(38),l=c(349),m=c(348),n=c(53),o=c(347),p=c(61);let q=f.forwardRef(function(a,b){let c=(0,g.a)({tabBehavior:"limited-trap-focus"}),e=a.disabled?{}:c,q=f.useRef(null),r=(0,n.a)(q,b),{findFirstFocusable:s}=(0,h.a)(),{targetDocument:t}=(0,i.b)();f.useImperativeHandle(a.componentRef,()=>({focus:v})),f.useLayoutEffect(()=>{a.disabled||a.disableFirstFocus||((0,p.p)()?a.forceFocusInsideTrap:!1===a.forceFocusInsideTrap)||v();let b=a.elementToFocusOnDismiss||t.activeElement;return()=>u(b)},[a.disabled,a.disableFirstFocus,a.forceFocusInsideTrap]);let u=(0,k.a)(b=>{if(!t)return;let c=t.activeElement;!a.disableRestoreFocus&&"function"==typeof b?.focus&&((0,l.a)(q.current,c)||c===t.body)&&b.focus()});(0,m.a)({contains:l.a,element:window,disabled:a.disabled||a.isClickableOutsideFocusTrap,callback:a=>{a.stopPropagation(),a.preventDefault(),v()},refs:[q]});let v=f.useCallback(()=>{if(!q.current)return;let b=null;if("string"==typeof a.firstFocusableTarget)b=q.current.querySelector(a.firstFocusableTarget);else if(a.firstFocusableTarget)b=a.firstFocusableTarget(q.current);else if(a.firstFocusableSelector){let c="string"==typeof a.firstFocusableSelector?a.firstFocusableSelector:a.firstFocusableSelector();b=q.current.querySelector("."+c)}if(!(b=b||s(q.current)||null))return;let c=window;c&&(void 0!==d&&c.cancelAnimationFrame(d),d=c.requestAnimationFrame(()=>{b&&b.focus(),d=void 0}))},[a.firstFocusableTarget,a.firstFocusableSelector,q.current]),w=(0,k.a)(b=>{!1!==a.forceFocusInsideTrap&&!a.disabled&&((0,l.a)(q.current,b.target)||v())});f.useEffect(()=>(t?.addEventListener("focus",w,!0),()=>{t?.removeEventListener("focus",w,!0)}),[]);let x=(0,o.a)(a);return f.createElement("div",{ref:r,...x,...e,className:(0,j.a)("fui-FocusTrapZoneShim",a.className)},a.children)});var r=c(156),s=c(121);let t=a=>(0,r.a)(e.a,q,a,s.a.FluentUIV9ShimFocusTrapZone)}
,,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(104),e=c(44);let f=c(0).a.isActivated("77387d2b-5c80-4bec-8d0c-30b8358fc3b0","2/13/2024","Checks isListSharing to determine if listItemId should be appended");class g{getAdvancedUrl(){let a=[this._webAbsoluteUrl];if(a.push("/_layouts/15/user.aspx"),a.push("?List="+d.a.encodeURIComponent(this._listId)),!this._isListSharing||f)if(!this._listId||!this._listItemId)return;else a.push("&obj=",d.a.encodeURIComponent(this._listId),",",d.a.encodeURIComponent(this._listItemId),",LISTITEM");return Number(this._pageContext.webTemplate)===e.b.group&&a.push("&noredirect=true"),a.join("")}constructor(a){this._pageContext=a.pageContext,this._listId=a.listId,this._listItemId=a.listItemId,this._webAbsoluteUrl=a.webAbsoluteUrl,this._isListSharing=a.isListSharing}}}
,function(a,b,c){c.d(b,{a:function(){return ac}});var d,e,f,g,h,i,j=c(37),k=c(32),l=c(45),m=c(118),n=c(85),o=c(46);(d=g||(g={}))[d.NONE=0]="NONE",d[d.VIEW=1]="VIEW",d[d.EDIT=2]="EDIT",d[d.OWNER=3]="OWNER",d[d.REVIEW=6]="REVIEW",d[d.RESTRICTED_VIEW=7]="RESTRICTED_VIEW";var p=c(319);(e=h||(h={}))[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",e[e.QuotaExceeded=-10]="QuotaExceeded",e[e.InvalidValue=-11]="InvalidValue",e[e.UserDoesNotExist=-12]="UserDoesNotExist",e[e.TooManyChildItemsWithUniqueScopes=-13]="TooManyChildItemsWithUniqueScopes",e[e.OperationCancelled=-14]="OperationCancelled",e[e.SharingBufferExceeded=-15]="SharingBufferExceeded",e[e.InvalidObjectStatus=-16]="InvalidObjectStatus",e[e.MountPointSharingNotAllowed=-17]="MountPointSharingNotAllowed",e[e.RequestThrottled=-18]="RequestThrottled",e[e.FileNotFound=-19]="FileNotFound",e[e.ForceCheckoutEditLink=-20]="ForceCheckoutEditLink",e[e.ShareByLinkDisabled=-21]="ShareByLinkDisabled",e[e.NotSupportedByWOPI=-22]="NotSupportedByWOPI",e[e.ListItemNotFound=-23]="ListItemNotFound",e[e.ParentListIsPrivate=-24]="ParentListIsPrivate",e[e.DocLibIsCatalog=-25]="DocLibIsCatalog",e[e.IRMIsEnabled=-26]="IRMIsEnabled",e[e.NonClaimsWebapp=-27]="NonClaimsWebapp",e[e.ParentListIsNull=28]="ParentListIsNull",e[e.RoledefinitionNotFound=-29]="RoledefinitionNotFound",e[e.ObjectNotShareableByLink=-30]="ObjectNotShareableByLink",e[e.AccessDeniedToAnonGuest=-31]="AccessDeniedToAnonGuest",e[e.AccessDeniedNotEnoughPermissions=-32]="AccessDeniedNotEnoughPermissions",e[e.DocumentIsProtectedByDLP=-33]="DocumentIsProtectedByDLP",e[e.AnonymousEditLinkNotAllowedByTenant=-34]="AnonymousEditLinkNotAllowedByTenant",e[e.UserBlockedByWhoCanShareSettings=-35]="UserBlockedByWhoCanShareSettings",e[e.ShareDoesNotExist=-36]="ShareDoesNotExist",e[e.ExternalInviteeNotAllowed=-37]="ExternalInviteeNotAllowed",e[e.SecurableNotFound=-38]="SecurableNotFound",e[e.UserIsInBlockedSecurityGroupForODB=-39]="UserIsInBlockedSecurityGroupForODB",e[e.ExternalInvitationFailed=-40]="ExternalInvitationFailed",e[e.DuplicateValuesInSharingList=-41]="DuplicateValuesInSharingList",e[e.LimitedAccessLockdownModeEnabled=-42]="LimitedAccessLockdownModeEnabled",e[e.AddressBarLinkNotUpdateable=-43]="AddressBarLinkNotUpdateable",e[e.AnonymousLinkBlockedBySiteIB=-44]="AnonymousLinkBlockedBySiteIB",e[e.ListNotFound=-45]="ListNotFound",e[e.WebNotFound=-46]="WebNotFound",e[e.ListNotShareableByLink=-47]="ListNotShareableByLink",e[e.WebNotShareableByLink=-48]="WebNotShareableByLink",e[e.AnonymousLinkDisallowedFileType=-49]="AnonymousLinkDisallowedFileType",e[e.ExternalInvitationFailedUnexpected=-50]="ExternalInvitationFailedUnexpected",e[e.AnyoneLinkDisabledForFileType=-51]="AnyoneLinkDisabledForFileType",e[e.StubFileSharingNotAllowed=-52]="StubFileSharingNotAllowed",e[e.SharingBlockedBySiteIBMode=-53]="SharingBlockedBySiteIBMode",e[e.SharingBlockedByVirusCheckStatus=-54]="SharingBlockedByVirusCheckStatus",e[e.UpdateSPShareFailed=-55]="UpdateSPShareFailed",e[e.InvitationNotSent=-56]="InvitationNotSent",e[e.ClaimNotAllowed=-57]="ClaimNotAllowed",e[e.SharingAnonymousLink=-58]="SharingAnonymousLink",e[e.SharingToBlockedDomain=-59]="SharingToBlockedDomain",e[e.SharingToInvalidEmail=-60]="SharingToInvalidEmail",e[e.SharingToUnresolvedEntity=-61]="SharingToUnresolvedEntity",e[e.SharingToBlockedUserOnODB=-62]="SharingToBlockedUserOnODB",e[e.InvalidPermissionLevel=-63]="InvalidPermissionLevel",e[e.MembersCannotShareNonListItem=-66]="MembersCannotShareNonListItem",e[e.SharingWebBlockedForChannelSite=-67]="SharingWebBlockedForChannelSite",e[e.ExternalInviteeNotAllowedForFluidComponent=-68]="ExternalInviteeNotAllowedForFluidComponent",e[e.NumInvitationsOverlimit=-69]="NumInvitationsOverlimit",e[e.NumUsersOverlimit=-70]="NumUsersOverlimit",e[e.ObjectLocked=-71]="ObjectLocked",e[e.NavParameterExceedsLengthLimit=-72]="NavParameterExceedsLengthLimit",e[e.NavParameterIsNotBase64UrlEncoded=-73]="NavParameterIsNotBase64UrlEncoded",e[e.SharingBlockedBySiteLockDown=-74]="SharingBlockedBySiteLockDown",e[e.SharingUnsupportedCspContainerSite=-75]="SharingUnsupportedCspContainerSite",e[e.SharingToNonOIdRecipient=-76]="SharingToNonOIdRecipient",e[e.AllRecipientsFailed=-77]="AllRecipientsFailed",e[e.PartialSuccess=-78]="PartialSuccess",e[e.ExternalSharingNotAllowedViaAMSRCT=-79]="ExternalSharingNotAllowedViaAMSRCT",e[e.LinkTypeNotAllowedViaAMSRCT=-80]="LinkTypeNotAllowedViaAMSRCT",e[e.SharingToGuestUserNotCurrentlyOnSharedChannelNotAllowed=-81]="SharingToGuestUserNotCurrentlyOnSharedChannelNotAllowed",e[e.InvitationBlockedByAADB2BCollaborationSettings=-82]="InvitationBlockedByAADB2BCollaborationSettings",e[e.SharingToBlockedUser=-83]="SharingToBlockedUser",e[e.SharingToBlockedBySiteRAC=-84]="SharingToBlockedBySiteRAC";var q=c(36),r=c(86),s=c(359),t=c(206),u=c(152),v=c(631),w=c(460),x=c(139),y=c(82),z=c(83),A=c(630),B=c(34),C=c(7),D=c(39),E=c(153),F=c(174),G=c(59),H=c(20),I=c(550),J=c(0),K=c(3),L=c(26),M=c(157),N=c(134),O=c(47),P=c(214),Q=c(151),R=c(84),S=c(154),T=c(16),U=c(92),V=c(135),W=c(179),X=c(103),Y=c(438),Z=c(19),$=c(74);(f=i||(i={}))[f.Undefined=0]="Undefined",f[f.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",f[f.MinorWithParentalConsent=2]="MinorWithParentalConsent",f[f.Adult=3]="Adult",f[f.NotAdult=4]="NotAdult",f[f.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired";var _=c(31),aa=c(627),ab=c(640);class ac{getWaitSharingAPIsDuration(){return this._waitSharingAPIsDuration}getAuthToken(){return this._sharingContextInformation?.authToken}getScenarioId(){return this._sharingContextInformation?.scenarioId}isConsumer(){return!1}isCOB(){return(0,x.d)()}isConsumerLists(){return!!window&&!!window._spPageContextInfo&&!!window._spPageContextInfo.isSiteListsHost}isListItem(){return this._isListItem}getCopilotHelper(){return this._copilotHelper}setCopilotHelper(a){this._copilotHelper=a}getEngagementHelper(){return this._engagementHelper}addListener(a){this._listeners.push(a)}removeListeners(){this._listeners=[]}getInitialLinkSettings(a){return null}getSharingInformation(){return this._storeContents.sharingInformation}shouldDisableGraphForPeopleSearch(){return this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||this._storeContents.sharingInformation.enforceSPOSearch)}isPeopleSharingLinksEnabled(){if(this._storeContents.sharingInformation){let a=this._storeContents.sharingInformation.sharingAbilities;return!!a&&!!a.peopleSharingLinkAbilities&&!!a&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)}return!1}showManageAccess(){return!0}fetchSharingInformation(a,b){return new Promise(c=>{if(this._storeContents.sharingInformation&&!this._sharingInformationInvalidated&&(!a||this._storeContents.sharingInformation.hasPermissionsInformation)&&!b){this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:K.b.Success,duration:0},this._configureLinkIfShareId(),this._emitChange({type:s.b.FetchSharingInformation}),c();return}let d=new Date().getTime(),e=!!this._sharingContextInformation||a;this._prefetchGSI&&this._checkPrefetchSupportExpansion(e,b)?this._raceGSI(e,b,d):this._sharingProvider.getSharingInformation(this._item,e,!0,null,b).then(a=>{this._setGSIResponse(a,d)},a=>{this._setGSIError(a,d)}),c()})}fetchMemberCount(a){this._groupMembersCountHash[a.email]||this._peoplePickerProvider.getPickerEntityInformation(a).then(b=>{let c=b.totalMemberCount;this._groupMembersCountHash[a.email]=c,this._emitChange()}).catch(b=>{this._groupMembersCountHash[a.email]=null,this._emitChange()})}getMembersCounts(){return this._groupMembersCountHash}shareLink(a){let b=new K.a({name:"shareLinkInvestigation"}),c=this._firstShareLinkRequest;this._firstShareLinkRequest=!1,(0,V.f)("sharelink.start");let{settings:d,recipients:e,emailMessage:f,emailSubject:g,copyLinkCommand:h,allRecipientsHaveAccess:i,shareId:o,inviteesToRemove:p,shareType:q}=a;if(a.copyLinkCommand&&O.n(this._clientId)&&this._mode===j.a.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&c){this._getDefaultLink(),b.end({resultType:K.b.Success,extraData:{sharingLinkPath:0,...this._telemetryExtraData}});return}let r=0,u=0,v=!1,z=(e=e||[]).map(a=>(a.entityType===y.a.externalUser?u++:r++,a.rawPersonData&&a.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===a.rawPersonData.EntityData.PrincipalType&&(v=!0),(0,x.d)()&&T.R()?{userId:a.userId,name:a.name,email:a.email,rawPersonData:a.rawPersonData??(a.entityType===y.a.group?{Key:a.userId,EntityData:{PermissionIdentityType:"Group"},isResolved:!1}:{Key:a.email,isResolved:!1})}:{userId:a.userId,name:a.name,email:a.email,rawPersonData:a.rawPersonData}));if(z=this._dedupeRecipients(z),o&&o.length>0||d.shareId&&d.shareId.length>0)b.end({resultType:K.b.Success,extraData:{sharingLinkPath:1,...this._telemetryExtraData}}),this._shareLink(d,z,f,g,h,c,o,p);else{if(this.isPeopleSharingLinksEnabled()&&(this._doesPSLSupportNewExternalUsers()||!v)&&d.audience!==k.a.existing&&!this._storeContents.sharingInformation.requiresAccessApproval)b.end({resultType:K.b.Success,extraData:{sharingLinkPath:2,settings:d,...this._telemetryExtraData}}),this.isBundleShare()?this._sharingService.createBundle(this._multiShareIds,D.b(H.Dj,E.a(new Date))).then(a=>{a.properties={ItemChildCount:""+a.childCount},this._item=a;let b=a.parentReference.sharepointIds;if(b){let e=a?.id?.match(/^[0-9a-fA-F]{1,16}!s([0-9a-fA-F]{8}[0-9a-fA-F]{4}[0-9a-fA-F]{4}[0-9a-fA-F]{4}[0-9a-fA-F]{12})$/);e&&((0,F.a)(this._sharingContextInformation,{listId:b.listId,listItemId:a.id,uniqueId:e[1],itemName:a.name}),this._shareLink(d,z,f,g,h,c,o,p),this._multiShareIds=[],(0,F.a)(this._sharingContextInformation,{multiShareIds:[]}))}}).catch(a=>{this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:a,errorMessage:a.message}}):this._shareLink(d,z,f,g,h,c,o,p);else{let a=!U.c()||this._storeContents.sharingInformation.requiresAccessApproval&&h;if(a=d.sharingLinkKind!==l.a.direct&&d.sharingLinkKind!==l.a.flexible&&a,T.Cc()&&U.c()&&(a=this._storeContents.sharingInformation.requiresAccessApproval&&h&&(d.audience===k.a.anyone||d.audience===k.a.organization),T.Nb()&&a&&(z=[])),a)b.end({resultType:K.b.Success,extraData:{sharingLinkPath:3,settings:d,...this._telemetryExtraData}}),this._shareLink(d,z,f,g,h,c,o,p);else{let a;a=d.sharingRole?this._getRoleString(d.sharingRole):this._getRoleValue(d.isEdit);let c={items:[this._item],roleValue:a,sendEmail:void 0!==f,message:f,subject:g,requireSignIn:!0,propagateSharing:!0},l=this._storeContents.sharingInformation.directLink,o=d?.audience==k.a.existing&&(q===m.a.copy||q===m.a.outlook||q===m.a.mobileShareToTeams||q===m.a.nonOutlook||q===m.a.moreApps||q===m.a.webShareToTeams);if(0===e.length||d.audience==k.a.existing&&(this._mode===j.a.copy||this._mode==j.a.linkSettings)||o)b.end({resultType:K.b.Success,extraData:{sharingLinkPath:4,useDirectLinkForShareTarget:o,recipientsLength:e.length,...this._telemetryExtraData}}),this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:K.b.Success}),(0,V.f)("sharelink.existing"),this._handleSharedLink(l,h);else{let a=!0;for(let b of e)this._storeContents.permissionsMap[b.email]!==t.a.hasAccess&&this._storeContents.permissionsMap[b.userId]!==t.a.hasAccess&&(a=!1);if(a||i){b.end({resultType:K.b.Success,extraData:{sharingLinkPath:5,useDirectLinkForShareTarget:o,recipientsLength:e.length,allUsersArePermissioned:a,allRecipientsHaveAccess:i,...this._telemetryExtraData}});let c=new Date().getTime();(0,V.f)("sharelink.emailWithoutPermissioning.start"),this._sharingProvider.emailWithoutPermissioning(z,this._item,f,g).done(a=>{(0,V.f)("sharelink.emailWithoutPermissioning.end");let b=a.statusCode;if(b===w.a.CompletedSuccessfully)this._invokeShareStatsEvent({name:"ForwardObjectLink",duration:new Date().getTime()-c,resultType:K.b.Success}),this._handleSharedLink(l,h);else{let d=n.b.generic,e=H.zd;b===w.a.ObjectNotSupported?(d=n.b.objectNotSupported,e=H.wj):b===w.a.TooManyChildItemsWithUniqueScopes?(d=n.b.invalidEmail,e=D.b(H.ie,a.invalidEmails.join(", "))):b===w.a.CapabilityDisabled?(d=n.b.generic,e=a.errorMessage):b&&(e=(0,W.d)(b)||e),this._invokeShareStatsEvent({name:"ForwardObjectLink",duration:new Date().getTime()-c,resultType:K.b.Failure,error:d}),this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:d,errorCategory:n.a.shareLink,errorMessage:e},this._emitChange({type:s.b.ShareLink})}})}else{let f=new Date().getTime();(0,V.f)("sharelink.share.start"),b.end({resultType:K.b.Success,extraData:{sharingLinkPath:6,useDirectLinkForShareTarget:o,recipientsLength:e.length,allUsersArePermissioned:a,allRecipientsHaveAccess:i,...this._telemetryExtraData}}),this._sharingProvider.share(z,c,!0).done(a=>{(0,V.f)("sharelink.share.end");let b=a.statusCode;if(b===w.a.CompletedSuccessfully){let b=l;0===r&&1===u&&a.invitationLink?b={...l,url:a.invitationLink}:0===r&&u>1&&a.invitationLink&&(b={...l,url:this._removeEmailQueryParamFromInvitationLink(a.invitationLink)}),d.audience===k.a.customLabeledSpecificPeople&&(b={...b,audience:k.a.customLabeledSpecificPeople}),this._invokeShareStatsEvent({name:"ShareObject",resultType:K.b.Success,duration:new Date().getTime()-f}),this._handleSharedLink(b,h)}else if(b===w.a.AccessRequestsQueued)this._storeContents.accessRequestCreated=!0,this._invokeShareStatsEvent({name:"ShareObject",resultType:K.b.Success,duration:new Date().getTime()-f}),this._handleSharedLink(l,h);else{let c=n.b.generic,d=H.zd;b===w.a.ObjectNotSupported?(c=n.b.objectNotSupported,d=H.wj):b===w.a.TooManyChildItemsWithUniqueScopes?(c=n.b.invalidEmail,d=D.b(H.ie,a.invalidEmails.join(", "))):b===w.a.CapabilityDisabled?(c=n.b.generic,d=a.errorMessage):b&&(d=(0,W.d)(b)||d),this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:c,errorCategory:n.a.shareObject,errorMessage:d},this._invokeShareStatsEvent({name:"ShareObject",resultType:K.b.Failure,duration:new Date().getTime()-f,error:c}),this._emitChange({type:s.b.ShareLink})}})}}}}!T.gb()&&h&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==d.audience&&this._cleanupDefaultLink()}}unshareLink(a,b){let c={item:this._item,kind:a,shareId:b};if((0,x.d)()){let a=this._getInheritedFromItem(b);a&&(c={...c,item:a})}this._sharingProvider.unshareLink(c).then(a=>{!0===a&&(this._removeLinkByShareId(b),this.updatePermissionsInfoOnLinkChange(b,o.a.none),this._updateIsShared(),this._emitChange({type:s.b.UnshareLink}))}).then(()=>{this._sharingInformationInvalidated=!0,this.fetchSharingInformation(!0,!0)})}getSharingLinkCreated(){return this._storeContents.sharingLinkCreated}getLinksCount(){return this.getActiveLinks().length}getAllPrincipals(){let a=this.getSharingInformation().sharingPrincipals,b=this.getActiveLinks();for(let c of(this._addPrincipals(a),b))(c.principals.length||c.invitees.length)&&this._addPrincipals(c.principals);return this._storeContents.filteredPrincipals}parsePermissions(){let a=[],b=[],c=[],d=this.getSharingInformation(),e=d.permissionsInformation;if(e){let f=e.links.results,g=e.principals.results,h=e.siteAdmins.results,i=d.webUrl;for(let e of f){let f;for(let g of e.linkMembers.results){let h=g.role||this._getRoleFromLink(e);f={...g,primaryText:g.name,secondaryText:g.jobTitle,type:g.principalType,imageUrl:g.imageUrl||g.loginName?(0,M.b)(i)(g.loginName):"",role:h},(h!==o.a.submit||d.sharedObjectType===Q.a.folder)&&(c.push(g.loginName),this._buildPrincipalAccessMap({addedIds:a,principals:b,sharingPrincipal:f,link:e,...(0,x.d)()&&e.isInherited&&e.inheritedFrom?{inheritedFrom:e.inheritedFrom}:{}}))}}for(let d of g){let e={...d.principal,primaryText:d.principal.name,secondaryText:d.principal.jobTitle,type:d.principal.principalType,imageUrl:d.principal.loginName?(0,M.b)(i)(d.principal.loginName):"",role:d.role};c.push(d.principal.loginName),this._buildPrincipalAccessMap({addedIds:a,principals:b,sharingPrincipal:e,link:void 0,isDirectAccess:!0,...(0,x.d)()&&d.isInherited&&d.inheritedFrom?{inheritedFrom:d.inheritedFrom}:{}})}for(let d of h)if(-1===c.indexOf(d.principal.loginName)){let c={...d.principal,primaryText:d.principal.name,secondaryText:d.principal.jobTitle,type:d.principal.principalType,imageUrl:d.principal.loginName?(0,M.b)(i)(d.principal.loginName):"",role:d.role};this._buildPrincipalAccessMap({addedIds:a,principals:b,sharingPrincipal:c})}else{let a=b.filter(a=>a.loginName===d.principal.loginName)[0];if(a){a.role=d.role;let b=a.accessMap?.get(d.principal.id.toString());a?.accessMap?.set(d.principal.id.toString(),{...b,role:d.role})}}this._storeContents.sharingInformation={...this._storeContents.sharingInformation,sharingPrincipals:b}}}getSensitivityLabels(a){let b=new K.a({name:"Sharing.sensitivityLabelGraphAPI"});return c.e(13).then(c.bind(c,619)).then(c=>new c.SensitivityLabelsDataSource({getOAuthToken:a},{pageContext:window._spPageContextInfo}).getSensitivityLabels().then(a=>(b.end({resultType:K.b.Success}),a)).catch(a=>(b.end({resultType:K.b.Failure,resultCode:(0,Y.d)(a),extraData:(0,Y.c)(a)}),Promise.resolve(null))))}getOptInSendNavIdInShareLink(){return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink}onReceivingShareCopySharingLinkToClipboardCommand(a){T.C()&&this._shareCopySharingLinkToClipboardClickTimePromiseResolve(a)}getShareCopySharingLinkToClipboardClickTimePromise(){if(T.C())return this._storeContents.shareCopySharingLinkToClipboardClickTimePromise}onDocumentInformation(a){this._storeContents.documentInformation=a,this._emitChange()}getDocumentInformation(){return this._storeContents.documentInformation}onReceivingSharingInfoBarInformation(a){a&&(this._storeContents.sharingInfoBarInformation=a),this._emitChange()}getSharingInfoBarInformation(){return this._storeContents.sharingInfoBarInformation}_getInheritedFromItem(a){let b=this._storeContents.sharingInformation.sharingLinks.filter(b=>{if(b.shareId===a&&b.inheritedLinkInfo)return b}),c=b&&b.length>0?b[0].inheritedLinkInfo:null;if(c)return{...this._item,type:R.a.Folder,name:c.name,properties:{...this._item.properties,uniqueId:c.sharepointIds.listItemUniqueId}}}_buildPrincipalAccessMap(a){let b,c,d,{addedIds:e,principals:f,sharingPrincipal:g,link:h,isDirectAccess:i,inheritedFrom:j}=a;h?(d=h.linkDetails.ShareId,c=this._getRoleFromLink(h),b=h.linkDetails.ShareId):i?(d=g.id.toString(),c=this._getRoleForPrincipal(g)||g.role,b=g.id.toString()):(d=g.id.toString(),c=this._getRoleForPrincipal(g)||g.role,b=g.loginName);let k={id:d,role:c,isSPO:!0,rawPermission:{shareId:d,scope:h?.linkDetails?.Scope,...j?{inheritedFrom:j}:{}}};if(-1===e.indexOf(g.id)){let a=new Map;a.set(b,k),g={...g,accessMap:a}}else f.filter(a=>a.id===g.id)[0].accessMap.set(b,k);g&&(f.push(g),e.push(g.id))}_getRoleFromLink(a){switch(a.linkDetails.LinkKind){case l.a.organizationEdit:case l.a.anonymousEdit:return o.a.edit;case l.a.organizationView:case l.a.anonymousView:return o.a.view;case l.a.flexible:default:return this._getRoleFromLinkDetails(a.linkDetails)}}_getRoleForPrincipal(a){switch(a.sharingLinkKind){case l.a.organizationEdit:case l.a.anonymousEdit:return o.a.edit;case l.a.organizationView:case l.a.anonymousView:return o.a.view;default:return o.a.none}}_getRoleFromLinkDetails(a){if(a.IsCreateOnlyLink&&!a.allowsAnonymousAccess)return o.a.submit;if(a.IsManageListLink)return o.a.manageList;if(a.IsReviewLink)return o.a.review;let b="video"===(0,S.a)(this.getSharingInformation().fileExtension);return a.IsEditLink?o.a.edit:a.BlocksDownload&&(b||(0,L.ab)(this._clientId,this))?o.a.restrictedview:o.a.view}parsePrincipals(){let a=this.getAllPrincipals(),b=[],c=[],d=[];for(let e in a){let f=a[e],g=f.role===o.a.owner;f.accessMap&&(f.type===z.a.user?(g?b.unshift(f):b.push(f),d.push({alias:e})):(f.type===z.a.securityGroup||f.type===z.a.sharePointGroup||(0,x.d)()&&T.R()&&f.type===z.a.ConsumerGroup)&&(g?c.unshift(f):c.push(f)))}return this._engagementHelper.manageAccessV3NumberOfSharingPrincipals({numberOfUsers:b.length,numberOfGroups:c.length}),{users:b,groups:c}}getAddressBarLink(){return this._storeContents.sharingInformation.sharingLinks.filter(a=>a.isAddressBarLink&&!a.isUnhealthy&&a.isActive)[0]}getActiveLinks(){return this._storeContents.sharingInformation.sharingLinks.filter(a=>!T.hb()&&a.isAddressBarLink?!a.isUnhealthy&&a.isActive&&T.Cb()&&(0,L.ab)(this._clientId,this):a.isActive&&a.sharingLinkKind!==l.a.direct&&(this._useSimplifiedSharingDialog?!1===a.isUnhealthy:!(a.isAddressBarLink&&!0===a.isUnhealthy)))}getReShareLink(a){return this.getActiveLinks().filter(b=>b.audience===a&&b.enabled)[0]}getUnhealthyLinks(){let a=this._storeContents.sharingInformation?.sharingLinks;return a?.filter(a=>a.isUnhealthy)}getAvailableReShareLink(a){return a.settings.updatePassword||a.recipients?.length||a.settings.sendEmail?[]:this.getActiveLinks().filter(b=>{var c,d;return b.enabled&&b.expiration===a.settings.expiration&&b.sharingScope===a.settings.scope&&b.allowsAnonymousAccess===a.settings.allowAnonymousAccess&&b.sharingLinkKind===a.settings.sharingLinkKind&&(c=b.password,d=a.settings.password,!c&&!d||c===d)&&a.settings.role===(0,L.K)(b,this._clientId,this._storeContents.sharingInformation)&&b.audience===(0,x.c)(a.settings.sharingLinkKind,a.settings.allowAnonymousAccess,a.settings.restrictShareMembership)&&(!(!T.V()&&(0,x.d)())||!b.inheritedLinkInfo)})}updatePermissions(a,b){let c=this._item;if((0,x.d)()){let a=this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(a=>{if(a.isInherited&&a.inheritedFrom)return a}),b=a&&a.length>0?a[0].inheritedFrom:null;b&&(c={...this._item,type:R.a.Folder,name:b.name,properties:{...this._item.properties,uniqueId:b.sharepointIds.listItemUniqueId}})}this._sharingProvider.updatePermissions2(a,c,b).done(b=>{let c=this._storeContents.sharingInformation.sharingPrincipals;if(b.role===g.NONE){if(this._useSimplifiedSharingDialog){let b=this._storeContents.sharingInformation.permissionsInformation.principals.results;this._storeContents.sharingInformation.permissionsInformation.principals.results=b.filter(b=>b.principal.id!==a.id),this._storeContents.sharingInformation.sharingPrincipals=c.map(b=>{if(b.id===a.id)if(b.accessMap){let a=b.id.toString();b.accessMap?.delete(a),b.role=(0,L.v)(b),this._removePrincipalById(b.loginName)}else c.pop();return b}),this._updateIsShared(),this._studyEmitChangeUsage("updatePermissions0"),this._emitChange()}else this._storeContents.sharingInformation.sharingPrincipals=c.filter(b=>(b.id===a.id&&this._removePrincipalById(b.loginName),b.id!==a.id));this._updateIsShared(),this._studyEmitChangeUsage("updatePermissions0"),this._emitChange()}else if(this._useSimplifiedSharingDialog)this._storeContents.sharingInformation.sharingPrincipals=c.map(c=>{if(c.id===a.id){let a,d;switch((a=c.accessMap?.get(c.loginName))?d=c.loginName:(a=c.accessMap?.get(c.id.toString()))&&(d=c.id.toString()),b.role){case g.VIEW:c.role=o.a.view,c.accessMap?.set(d,{...a,role:o.a.view});break;case g.EDIT:c.role=o.a.edit,c.accessMap?.set(d,{...a,role:o.a.edit});break;case g.OWNER:c.role=o.a.owner,c.accessMap?.set(d,{...a,role:o.a.owner});break;case g.REVIEW:c.role=o.a.review,c.accessMap?.set(d,{...a,role:o.a.review});break;case g.RESTRICTED_VIEW:c.role=o.a.restrictedview,c.accessMap?.set(d,{...a,role:o.a.restrictedview})}c.accessMap&&this._updatePrincipal(c)}return this._updateIsShared(),this._studyEmitChangeUsage("updatePermissions0"),this._emitChange(),c}),this._storeContents.sharingInformation.permissionsInformation.principals.results.map(c=>{if(c.principal.id===a.id)switch(b.role){case g.VIEW:c.role=o.a.view;break;case g.EDIT:c.role=o.a.edit;break;case g.OWNER:c.role=o.a.owner;break;case g.REVIEW:c.role=o.a.review;break;case g.RESTRICTED_VIEW:c.role=o.a.restrictedview}return c}),this._studyEmitChangeUsage("updatePermissions1"),this._emitChange();else for(let d of c)if(d.id===a.id){switch(b.role){case g.VIEW:d.role=o.a.view;break;case g.EDIT:d.role=o.a.edit;break;case g.OWNER:d.role=o.a.owner;break;case g.REVIEW:d.role=o.a.review}this._studyEmitChangeUsage("updatePermissions1"),this._emitChange()}})}grantDirectAccess(a,b){let c=this._storeContents.sharingInformation.sharingPrincipals.filter(b=>b.id===parseInt(a))[0],d=this._getRoleString(b),e={items:[this._item],roleValue:d,requireSignIn:!0,propagateSharing:!0},f={...c,userId:c.email,name:c.loginName,email:c.email,rawData:{Key:c.email,isResolved:!1},rawPersonData:{Key:c.email,isResolved:!1},isResolved:!1};this._sharingProvider.share([f],e,!0).then(d=>{switch(d.statusCode){case 0:let e=this._storeContents.sharingInformation.sharingPrincipals;this._storeContents.addPeopleResult=s.a.CompletedSuccessfully,this._storeContents.sharingInformation.permissionsInformation.principals.results.push({role:b,principal:{...c,isActive:!0,principalType:c.type,userId:"",jobTitle:c.secondaryText,name:c.primaryText,email:c.email,id:parseInt(a)},inheritedFrom:void 0,isInherited:!1}),c.accessMap.set(a,{id:a,role:b,isSPO:!0,rawPermission:{scope:void 0}}),this._updatePrincipal(c),this._storeContents.sharingInformation.sharingPrincipals=e.map(b=>b.id===parseInt(a)?c:b);break;case 1:this._storeContents.addPeopleResult=s.a.AccessRequestsQueued;break;default:this._storeContents.addPeopleResult=s.a.Error}this._emitChange()},()=>{this._storeContents.addPeopleResult=!1,this._emitChange()})}updatePermissionsInfoOnLinkChange(a,b){let c=this._storeContents.sharingInformation.permissionsInformation.links.results;switch(b){case o.a.none:this._storeContents.sharingInformation.permissionsInformation.links.results=c.filter(b=>b.linkDetails.ShareId!==a);break;case o.a.view:this._storeContents.sharingInformation.permissionsInformation.links.results=c.map(b=>(b.linkDetails.ShareId===a&&(b.linkDetails.IsEditLink=!1),b));break;case o.a.edit:this._storeContents.sharingInformation.permissionsInformation.links.results=c.map(b=>(b.linkDetails.ShareId===a&&(b.linkDetails.IsEditLink=!0),b));break;case o.a.review:this._storeContents.sharingInformation.permissionsInformation.links.results=c.map(b=>(b.linkDetails.ShareId===a&&(b.linkDetails.IsReviewLink=!0),b))}b!==o.a.none&&this._updateAccessMap(a,b),this._updateIsShared(),this._emitChange()}updatePermissionById(a,b){let c=this.getSharingInformation().sharingPrincipals.filter(b=>b.id===parseInt(a))[0];return this.updatePermissions(c,b),C.a.resolve()}addPeople(a,b,c,d){let e=this._getRoleString(b),f={items:[this._item],roleValue:e,sendEmail:c,message:d,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(a,f,!0).then(a=>{switch(a.statusCode){case 0:this._storeContents.addPeopleResult=s.a.CompletedSuccessfully;break;case 1:this._storeContents.addPeopleResult=s.a.AccessRequestsQueued;break;default:this._storeContents.addPeopleResult=s.a.Error}this._emitChange()},()=>{this._storeContents.addPeopleResult=!1,this._emitChange()})}fetchSuiteNavInformation(){this._suiteNavProvider?this._suiteNavProvider.loadData().then(a=>{let b=a.CompanyDisplayName||this._storeContents.companyName,c=a?JSON.parse(a.ClientData):{HasEXOLicense:!1};this._storeContents.companyName=b,this._storeContents.outlookAvailability=c.HasEXOLicense?u.a.available:u.a.none,this._emitChange()}):(this._storeContents.outlookAvailability=u.a.none,this._emitChange())}getCompanyName(){return this._storeContents.companyName}getOutlookAvailability(){return this._storeContents.outlookAvailability}navigateToOwa(a,b){(0,X.a)()?window.sessionStorage.setItem("OWA_sharingLinkUrl",this._getOwaUrl(a,b)):window.open(this._getOwaUrl(a,b),"_blank")}getNavId(){return this._sharingContextInformation&&this._sharingContextInformation.navId}getTargetDocId(){return this._sharingContextInformation&&this._sharingContextInformation.targetDocId}getContextualSharingInformation(){return this._sharingContextInformation&&this._sharingContextInformation.contextualSharingInformation}getInvitationId(){return this._sharingContextInformation?.invitationId??""}fetchGroupsMemberCount(a){let b=0;for(let c of a){let a={userId:c.userId,name:c.name,email:c.email,rawPersonData:c.rawPersonData,principalType:c.principalType};if(c.principalType===z.a.securityGroup){let d=this._groupsMemberCountCache[c.userId];void 0!==d?b+=d:this._peoplePickerProvider.getPickerEntityInformation(a).then(a=>{let d=a.totalMemberCount;this._groupsMemberCountCache[c.userId]=d,b+=d,this._storeContents.groupsMemberCount=b,this._emitChange()}).catch(a=>{this._groupsMemberCountCache[c.userId]=null,this._emitChange()})}}this._storeContents.groupsMemberCount=b,this._emitChange()}getGroupsMemberCount(){return this._storeContents.groupsMemberCount}fetchPolicyTipInformation(){if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info)return void this._emitChange();let a=this._storeContents.sharingInformation;if(!a||!this._item)return;let b=!this._isPolicyTipFlagSet(this._item.policyTip,A.a.blockSharing),c=a.sharingAbilities;if(c){if((c&&c.directSharingAbilities&&c.directSharingAbilities.canAddExternalPrincipal.disabledReason)!==p.a.documentIsProtectedByDlp&&b)return}else if(b)return;this._policyTipProvider.getPolicyTip(this._item).then(a=>{a&&(this._storeContents.policyTipInfo.info=a,this._emitChange())})}}getPolicyTipInformation(){return this._storeContents.policyTipInfo}updatePolicy(a,b){if(this._policyTipProvider){let c={item:this._item,action:a};b&&(c.justification=b),this._policyTipProvider.updatePolicy(c).then(a=>{this._storeContents.policyTipInfo.actionResult=a,this._sharingInformationInvalidated=!0,this.fetchSharingInformation(!0),this._emitChange()})}}checkUserAccess(a){let b=new K.a({name:"Sharing.checkUserAccessAPI"});if(0===a.length)return;let c=[];for(let b of a)c.push(b);if(T.v())return this._sharingProvider.checkPermissions(c,this._item).then(a=>{for(let b of a){let a=this._storeContents.sharingInformation.sharingPrincipals.filter(a=>a.loginName===b.inputEntity)[0],c=this._storeContents.sharingInformation.sharingPrincipals.filter(a=>a.role===o.a.owner).length>=1;if((0,L.k)(b.role,a.role,L.d.GREATERTHAN)){let d=c&&b.role===o.a.owner?a.role:b.role,e={id:b.inputEntity,role:d,isSPO:!0,rawPermission:{shareId:b.inputEntity}};a.role=d,a.accessMap.set(e.id,e),a.hasGSIAndCheckAccessPerms=!0,this._updatePrincipal(a)}}b.end({resultType:K.b.Success})}).catch(a=>{this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:a,errorMessage:H.Bb},b.end({resultType:K.b.Failure,extraData:a})});let d=[];for(let a=0;a<c.length/30;a++){let e=c.slice(30*a,30*a+30);d.push(this._sharingProvider.checkPermissions(e,this._item).then(a=>{for(let b of a){let a=this._storeContents.sharingInformation.sharingPrincipals.filter(a=>a.loginName===b.inputEntity)[0],c=this._storeContents.sharingInformation.sharingPrincipals.filter(a=>a.role===o.a.owner).length>=1;if((0,L.k)(b.role,a.role,L.d.GREATERTHAN)){let d=c&&b.role===o.a.owner?a.role:b.role,e={id:b.inputEntity,role:d,isSPO:!0,rawPermission:{shareId:b.inputEntity}};a.role=d,a.accessMap.set(e.id,e),a.hasGSIAndCheckAccessPerms=!0,this._updatePrincipal(a)}}b.end({resultType:K.b.Success})}).catch(a=>{this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:a,errorMessage:H.Bb},b.end({resultType:K.b.Failure,extraData:a})}))}return Promise.all(d).then(()=>{})}checkPermissions(a,b){if(0===a.length){this._storeContents.permissionsMap={},this._emitChange();return}let c=[];for(let b of(this._recipients=[],a))c.push({alias:!J.a.isActivated("ba652ed0-8100-47c6-b371-c07eb7a30db8")&&(b.aadObjectId||b.rawData.Key)?b.aadObjectId||b.rawData.Key:!J.a.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")&&b.userId||b.email}),this._recipients.push(b.email);for(let a of(b=b||this._storeContents.invitedUsers,this._invitedUsers=[],b))c.push({alias:a.email}),this._invitedUsers.push(a.email);let d=c.map(a=>a.alias);this._sharingProvider.checkPermissions(c,this._item).then(a=>{for(let b of(this._storeContents.permissionsMap={},a))this._invitedUsers.indexOf(b.inputEntity)>-1?this._storeContents.permissionsMap[b.inputEntity]=b.hasAccess?t.a.hasAccess:t.a.pending:this._recipients.indexOf(b.inputEntity)>-1?this._storeContents.permissionsMap[b.inputEntity]=b.hasAccess?t.a.hasAccess:t.a.none:d.indexOf(b.inputEntity)>-1&&(this._storeContents.permissionsMap[b.inputEntity]=b.hasAccess?t.a.hasAccess:t.a.none);this._emitChange()})}getPermissionsMap(){return this._storeContents.permissionsMap}getDefaultRecipients(){return this._storeContents.defaultRecipients}consumeDefaultRecipients(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}}getAllOrgSG(){let a=this._storeContents.sharingInformation.allOrganizationSecurityGroupId,b=this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(b=>{if(-1!==b.principal.loginName.indexOf(a))return b});if(1===b.length)return b[0]}getEEEU(){let a=this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(a=>{if(-1!==a.principal.loginName.indexOf(L.a))return a});if(1===a.length)return a[0]}doesSPGroupContainAllOrgSGOrEEEU(){let a=this._storeContents.sharingInformation.allOrganizationSecurityGroupId;return this._storeContents.sharingInformation.permissionsInformation.principals.results.filter(b=>b.principal.principalType===z.a.sharePointGroup&&b.members.results.filter(b=>-1!==b.loginName.indexOf(L.a)||-1!==b.loginName.indexOf(a)).length>0).length>0}removeAccessToAllOrgSGAndEEEU(){let a=new K.a({name:"SimplifiedSharingV2.AllOrgSG.RemoveAccess"}),b=new K.a({name:"SimplifiedSharingV2.EEEU.RemoveAccess"}),c=this.getAllOrgSG(),d=this.getEEEU();return Promise.all([this._removeAccess(c?.principal,a),this._removeAccess(d?.principal,b)])}grantAccessToAllOrgSG(){let a=this._storeContents.sharingInformation.allOrganizationSecurityGroupId,b=new K.a({name:"SimplifiedSharingV2.AllOrgSG.GrantAccess"}),c={principalSource:15,principalType:z.a.securityGroup,forceResolve:!0,maximumEntitySuggestions:1};return this._peoplePickerProvider.resolve(a,c).then(a=>{let c={items:[this._item],roleValue:this._getRoleString(o.a.restrictedview),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};return this._sharingProvider.share([a],c,!0).done(a=>{a.statusCode===w.a.CompletedSuccessfully?(b.end({resultType:K.b.Success,extraData:{...this._telemetryExtraData,result:a}}),this._sharingInformationInvalidated=!0,this.fetchSharingInformation(!0),this._emitChange({type:s.b.GrantAccess})):this._handleGrantAccessError(a,b)})}).catch(a=>{b.end({resultType:K.b.Failure,extraData:{...this._telemetryExtraData,...(0,Y.c)(a)}})})}grantAccessV2(a){let{recipients:b,role:c,subject:d,message:e}=a,f=new K.a({name:"SimplifiedSharingV2.ShareObject"}),g=(b=b||[]).map(a=>({userId:a.userId,name:a.name,email:a.email,rawPersonData:a.rawPersonData}));g=this._dedupeRecipients(g),this._engagementHelper.logShareObject(g,c);let h={items:[this._item],roleValue:this._getRoleString(c),sendEmail:!0,requireSignIn:!0,propagateSharing:!0,subject:d,message:e};this._sharingProvider.share(g,h,!0).done(b=>{if(this._storeContents={...this._storeContents,grantAccessResult:b.statusCode===w.a.CompletedSuccessfully||b.statusCode===w.a.AccessRequestsQueued},b.error||b.statusCode!==w.a.CompletedSuccessfully&&b.statusCode!==w.a.AccessRequestsQueued)this._handleGrantAccessError(b,f);else{let{role:c,recipients:d,subject:e,message:g}=a;f.end({resultType:K.b.Success,extraData:{...this._telemetryExtraData,role:c,recipientsCount:d?.length,hasSubject:!!e,hasMessage:!!g,result:b}})}this._sharingInformationInvalidated=b.statusCode===w.a.CompletedSuccessfully,this.fetchSharingInformation(!0),this._emitChange({type:s.b.GrantAccess})})}grantAccess(a,b=!0,c){let d=(a=a||[]).map(a=>({userId:a.userId,name:a.name,email:a.email,rawPersonData:a.rawPersonData}));d=this._dedupeRecipients(d);let e={items:[this._item],roleValue:this._getRoleValue(b),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(d,e,!0).done(a=>{this._storeContents={...this._storeContents,grantAccessResult:a.statusCode===w.a.CompletedSuccessfully||a.statusCode===w.a.AccessRequestsQueued},0!==a.statusCode&&1!==a.statusCode&&$.A(m.a.grantAccess,this._storeContents.sharingInformation.rawError||"grant access failure",this._storeContents.sharingInformation.errorCategory,this._storeContents.sharingInformation.debugErrorMessage||this._storeContents.sharingInformation.errorMessage),this._emitChange({type:!T.I()&&c?s.b.AtMention:s.b.GrantAccess})})}getGrantAccessResult(){return this._storeContents.grantAccessResult}getAddPeopleResult(){return this._storeContents.addPeopleResult}dispose(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)}hasAccessRequestBeenCreated(){return this._storeContents.accessRequestCreated}isValidatingDefaultRecipients(){return this._storeContents.isValidatingDefaultRecipients}setAddressBarLinkCapability(a){return new Promise(b=>{this._sharingProvider.setAddressBarLinkCapability(this._item,a).done(a=>{a&&T.Oc()&&this.fetchSharingInformation(!0,!0),b(a)})})}_handleGrantAccessError(a,b){let c,d,e;if(a.error){let b=JSON.parse(a.debugErrorMessage);d=(c=b.status)+" "+b.code,e=a.debugErrorMessage}a.statusCode!==w.a.CompletedSuccessfully&&a.statusCode!==w.a.AccessRequestsQueued&&(c=a.statusCode,d=a.errorMessage,d=(0,W.d)(c)||d),b.end({resultType:K.b.Failure,resultCode:c,extraData:{...this._telemetryExtraData,result:a},error:d}),$.A(m.a.grantAccess,this._storeContents.sharingInformation.rawError||"grant access failure",this._storeContents.sharingInformation.errorCategory,this._storeContents.sharingInformation.debugErrorMessage||this._storeContents.sharingInformation.errorMessage);let f="",g="";try{let a=JSON.parse(e);g=`${a?.status}`,f=`${a?.status} ${a?.code} ${a?.message?.value??""}`}catch(a){}this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:{name:h[a.statusCode]||g||"Unknown",message:`Status Code: ${a.statusCode??""} ${a.errorMessage??""} ${f}`,stack:a.debugErrorMessage},errorCategory:n.a.shareObject,debugErrorMessage:e,errorMessage:d}}_addPrincipals(a){for(let b of a){let a=b.loginName||b.email;this._storeContents.filteredPrincipals[a]||(this._storeContents.filteredPrincipals[a]=b)}}_updatePrincipal(a){let b=a.loginName||a.email;this._storeContents.filteredPrincipals[b]&&this._storeContents.filteredPrincipals[b].accessMap&&(this._storeContents.filteredPrincipals[b]=a)}_removePrincipals(a){for(let b of a){let a=b.loginName||b.email;this._removePrincipalById(a)}}_removePrincipalById(a){this._storeContents.filteredPrincipals[a]&&delete this._storeContents.filteredPrincipals[a]}_doesPSLSupportNewExternalUsers(){if(this._storeContents.sharingInformation){let a=this._storeContents.sharingInformation.sharingAbilities;return!!a&&!!a.peopleSharingLinkAbilities&&a.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1}resetPeoplePickerError(){this._storeContents.sharingInformation.peoplePickerError&&(this._storeContents.sharingInformation.peoplePickerError=void 0,this._emitChange())}getSharingClickTime(){return this._sharingContextInformation?.clickTime}getWebView2Times(){return this._sharingContextInformation.webView2Times}getIsUsingPreloadedWebview2(){return this._sharingContextInformation.isUsingPreloadedWebview2}isPasswordModificationAllowed(){return!0}isExpirationDateModificationAllowed(){return!0}isPremiumExperienceAllowed(){if((0,x.d)()){let a=this._storeContents.sharingInformation.sharingAbilities;if(!(a&&a.anyoneLinkAbilities.linkExpiration.enabled&&a.anyoneLinkAbilities.passwordProtected.enabled))return!1}return!0}disablePremiumUpsell(){if((0,x.d)()){let a=this._storeContents.sharingInformation.ageGroup;if(a)switch(a){case i.NotAdult:case i.MinorWithParentalConsent:case i.MinorWithoutParentalConsent:return!0;case i.Adult:case i.MinorNoParentalConsentRequired:}}return!1}isReportProblemSupported(){return!1}shouldInterruptCopyLink(a){return new Promise((a,b)=>{a(!1)})}isPreventDownloadAllowed(){return!(0,x.d)()}isBundleShare(){return!T.dc()&&(0,x.d)()&&this._multiShareIds&&this._multiShareIds.length>1}isSharingLimitedOnSite(){let a=this._storeContents.sharingInformation;return!T.qb()&&!a?.canAddInternalPrincipal&&!a?.canAddExternalPrincipal&&!a?.canRequestAccessForGrantAccess}getSupportedAudienceOptions(){return this.isBundleShare()?[k.a.anyone,k.a.organization,k.a.customLabeledSpecificPeople,k.a.specificPeople,k.a.specificPeopleFlex]:[k.a.anyone,k.a.organization,k.a.customLabeledSpecificPeople,k.a.existing,k.a.specificPeople,k.a.specificPeopleFlex]}isOwner(){return(0,x.d)()?this._storeContents.sharingInformation.userRole===o.a.owner||this._storeContents.sharingInformation.userRole===o.a.edit&&this._storeContents.sharingInformation.sharingPrincipals.filter(a=>a.role===o.a.owner&&!!a.email&&!!window._spPageContextInfo&&!!window._spPageContextInfo.userEmail&&a.email.toLocaleLowerCase()===window._spPageContextInfo.userEmail.toLocaleLowerCase()).length>=1:this._storeContents.sharingInformation.userRole===o.a.owner}isSpecificPeopleExpirationAllowed(){return!!((0,L.ab)(this._clientId,this)&&T.K())}showAudienceLearnMore(){return!0}showEmailsInSuggestions(){return(0,x.d)()}getFamily(){return(0,x.d)()&&T.R()?this._family:null}getFamilyMembers(){return(0,x.d)()&&T.R()?this._familyMembers:null}getCurrentUserId(){return null}getCanStopSharing(){return this.getSharingInformation().sharingAbilities.canStopSharing}isShared(){return this.getSharingInformation().isShared}getSharedObjectType(){return this.getSharingInformation().sharedObjectType}getItem(){return this._item}getItemInformationForLogging(){let a,b,c=!0,d=this.getSharingInformation();return d.fileExtension?(this._itemType=(0,S.a)(d.fileExtension),a=d.fileExtension):d.sharedObjectType?this._itemType=Q.a[d.sharedObjectType]:d.item&&(this._itemType=(0,S.b)(d.item),a=d.item.extension,c=d.item.itemType===R.a.File),c&&this._itemType&&"other"!==this._itemType&&(b=a),{itemType:this._itemType,extension:b}}getSharingInformationAPIStats(){return this._getSharingInformationStats}getShareLinkAPIStats(){return this._getShareLinkStats}_cleanupDefaultLink(){let a=this._storeContents.defaultLink;a&&(this.unshareLink(a.sharingLinkKind,a.shareId),this._storeContents.defaultLink=void 0)}_emitChange(a){if(this._storeContents&&this._storeContents.sharingInformation){let a=this._storeContents.sharingInformation,{itemType:b,extension:c}=this.getItemInformationForLogging();this._engagementHelper.setEngagementExtraData({webTemplateId:a.webTemplateId,itemUniqueId:a.itemUniqueId,itemType:b,extension:c})}for(let b of this._listeners)b(a)}_studyEmitChangeUsage(a){new K.a({name:"emitChangeInvestigation"}).end({resultType:K.b.Success,extraData:{emitChangePath:a,...this._telemetryExtraData}})}shareLinkExpress(){let a=this._sharingContextInformation;return new Promise(b=>{this._sharingProvider.shareLinkExpress(a.listId,a.listItemId).then(a=>{if(a.error){let b=a.error;this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:b,errorCategory:n.a.shareLink,debugErrorMessage:b.message&&b.message.value,errorMessage:H.ij}}this._updateIsShared(),b()})})}getPermissionsViewSettings(){return{groupPivotHeader:(0,x.d)()&&T.R()?I.K:I.J,manageGroupLink:(0,x.d)()&&T.R()?"https://go.microsoft.com/fwlink/?linkid=2198883":"",manageUnknownUserLink:(0,x.d)()?"https://go.microsoft.com/fwlink/?linkid=2207620":"",itemStopSharingSupported:!(0,x.d)(),supportedGroupTypes:(0,x.d)()&&T.R()?[z.a.securityGroup,z.a.sharePointGroup,z.a.ConsumerGroup]:[z.a.securityGroup,z.a.sharePointGroup]}}init3s(){this._fetchSubstrateToken()}resetSharingInformationError(){this._storeContents.sharingInformation.error=null,this._storeContents.sharingInformation.errorCategory=null,this._storeContents.sharingInformation.errorMessage=null,this._storeContents.sharingInformation.rawError=null,this._storeContents.sharingInformation.debugErrorMessage=null,this._emitChange()}_fetchGraphToken(){let a=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph()&&(T.Xb()||!T.E());a?this._graphPeoplePickerHelper.getGraphToken().then(b=>{a=!!b,this._storeContents.sharingInformation.isGraphAvailable=a}):this._storeContents.sharingInformation.isGraphAvailable=!1}_fetchSubstrateToken(){let a=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();a?this._substratePeoplePickerHelper.getSubstrateToken().then(b=>{this._substratePeoplePickerHelper.init(b),a=!!b,this._storeContents.sharingInformation.isTsAvailable=a}):this._storeContents.sharingInformation.isTsAvailable=!1}_fetchAdditionalAuthenticationTokens(){this._storeContents.sharingInformation&&(this._fetchGraphToken(),this._fetchSubstrateToken())}_handleSharedLink(a,b,c){a.createdViaCopyLinkCommand=b||!1;let d=new Z.a(a.url);this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink&&!d.getQueryParameter("nav")&&(this._sharingContextInformation.navIdSendLinkOverride?d.setQueryParameter("nav",this._sharingContextInformation.navIdSendLinkOverride):this._sharingContextInformation.navId&&d.setQueryParameter("nav",this._sharingContextInformation.navId),a.url=d.toString()),this._sharingInformationInvalidated=!0,U.c()&&c||(this._storeContents.sharingLinkCreated=a,this.fetchSharingInformation(!0).then(()=>{T.fb()||(this._updateIsShared(),this._studyEmitChangeUsage("handleSharedLink"),this._emitChange({type:s.b.ShareLink}))})),T.fb()&&(this._storeContents.sharingLinkCreated=a,this._updateIsShared(),this._studyEmitChangeUsage("handleSharedLink"),this._emitChange({type:s.b.ShareLink}))}_getRoleValue(a){return a?v.a:v.e}_getRoleString(a){switch(a){case o.a.owner:return v.c;case o.a.manageList:return v.b;case o.a.edit:return v.a;case o.a.view:return v.e;case o.a.review:return"roletype:Reviewer";case o.a.restrictedview:return v.d}}_configureLinkIfShareId(){let a=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(a&&this._mode===j.a.copy&&this._storeContents.sharingInformation&&!this._storeContents.sharingInformation.error){if("00000000-0000-0000-0000-000000000000"===a)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{let a=this._storeContents.sharingInformation.sharingLinks.filter(a=>a.isActive&&a.shareId===this._sharingContextInformation.shareId)[0];a?this._storeContents.sharingLinkCreated=a:this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}}_removeLinkByShareId(a){this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(b=>(a===b.shareId&&(b.expiration=null,b.isActive=!1,b.shareId=B.a.Empty,b.url=null,this._removePrincipals(b.principals),this._removePrincipals(b.invitees),b.principals=[]),b))}_updateIsShared(){let a=this._storeContents.sharingInformation;if(!a)return;let{sharingLinks:b,sharingPrincipals:c}=a,d=(0,x.a)(b,c);this._storeContents.sharingInformation.isShared=d}_getOwaUrl(a,b){let c="https://outlook.office.com/owa/",d=this._storeContents?.sharingInformation?.outlookEndpointHostUrl;d&&(c=`https://${d}/owa/`);let e=encodeURIComponent(b);return`${c}?body=${e}&to=${a.join(";")}&path=/mail/action/compose`}_resolveDefaultRecipients(a,b,c){let d=a||[],e=Promise.resolve();if(this._storeContents.isValidatingDefaultRecipients=a.length>0,!b){d=[];let b=[];for(let c of a)b.push({alias:c});e=this._sharingProvider.checkPermissions(b,this._item).then(a=>{for(let b of a)b.hasAccess||d.push(b.inputEntity)})}e.then(()=>{if(0===d.length){c===j.a.atMention&&(this._storeContents={...this._storeContents,grantAccessResult:!0},this._studyEmitChangeUsage("resolveDefaultRecipients0"),this._emitChange());return}let a=[],b=[],e={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0};for(let c of d)a.push(this._peoplePickerProvider.resolve(c,e).then(a=>{b.push(a)}));Promise.all(a).then(()=>{this._storeContents.defaultRecipients={isConsumed:!1,recipients:b},this._storeContents.isValidatingDefaultRecipients=!1,this._studyEmitChangeUsage("resolveDefaultRecipients1"),this._emitChange()},()=>{this._storeContents.defaultRecipients={isConsumed:!1,recipients:[]},this._storeContents.isValidatingDefaultRecipients=!1,this._emitChange()})})}_removeEmailQueryParamFromInvitationLink(a){let b=a.split("?");if(!(b.length>1))return a;{let a=b[1].split("&"),c=[];for(let b of a)-1===b.indexOf("email=")&&c.push(b);let d=c.join("&");return`${b[0]}?${d}`}}_shareLink(a,b,c,d,e,f,g,h){(0,V.f)("sharelink._shareLink.start");let i=this._item;if((0,x.d)()){let a=this._getInheritedFromItem(g);a&&(i=a)}let p={emailData:c,emailSubject:d,items:[i],recipients:b,settings:{createLink:!0,sharingLinkKind:a.sharingLinkKind,expiration:a.expiration,updatePassword:a.updatePassword,password:a.password,shareId:g,inviteesToRemove:h,role:a.sharingRole}};p.settings.role||(p.settings.role=a.isEdit?o.a.edit:o.a.view),a.shareId&&a.shareId.length>0&&(p.settings.shareId=a.shareId,a.fetchLinkOnly&&(p.settings.createLink=!1));let t=new Date().getTime(),u=new K.a({name:`SharingShareLink.${j.a[this._mode]}.${q.a[this._clientId]||"unknown"}`});this._getShareLinkStats={name:"ShareLinkInit",resultType:K.b.Success,duration:0},(a.updatePassword||a.hasPassword&&a.shareId&&a.shareId.length>0)&&a.audience===k.a.anyone&&(p.settings.sharingLinkKind=l.a.flexible,p.settings.allowAnonymousAccess=!0),a.audience===k.a.anyone?a.trackLinkUsers?(p.settings.allowAnonymousAccess=!1,p.settings.restrictShareMembership=!1,p.settings.trackLinkUsers=!0,p.settings.scope=r.a.anyone,p.settings.sharingLinkKind=l.a.flexible):(p.settings.allowAnonymousAccess=!0,p.settings.restrictShareMembership=!1,p.settings.trackLinkUsers=!1,p.settings.scope=r.a.anyone):a.audience===k.a.organization&&(p.settings.allowAnonymousAccess=!1,p.settings.restrictShareMembership=!1,p.settings.scope=r.a.organization),"video"===(0,S.a)(this.getSharingInformation()?.fileExtension)||(0,L.ab)(this._clientId,this)?a.sharingRole===o.a.restrictedview&&(p.settings.role=o.a.restrictedview,p.settings.sharingLinkKind=l.a.flexible):a.preventDownload&&(p.settings.role=o.a.restrictedview,a.sharingRole=o.a.restrictedview,p.settings.sharingLinkKind=l.a.flexible),(a.audience===k.a.specificPeopleFlex||a.audience===k.a.customLabeledSpecificPeople)&&(p.settings.restrictShareMembership=!0,p.settings.scope=r.a.specificPeople);let v=this.getDefaultRecipients();a.audience===k.a.customLabeledSpecificPeople&&v&&(p.recipients=v.recipients),a.isCreateOnlyLink&&(p.settings.role=o.a.submit,p.settings.description=a.description),(a.sharingRole===o.a.manageList||a.sharingRole===o.a.submit||a.sharingRole===o.a.review||a.sharingRole===o.a.restrictedview)&&(p.settings.sharingLinkKind=l.a.flexible);let w=this._sharingContextInformation?.navId&&(0,aa.c)(this._sharingContextInformation.navId),y=!this._sharingContextInformation?.navId||w&&this._sharingContextInformation.navId.length<=1024,z=this._sharingContextInformation?.navIdSendLinkOverride&&(0,aa.c)(this._sharingContextInformation.navIdSendLinkOverride),A=!this._sharingContextInformation?.navIdSendLinkOverride||z&&this._sharingContextInformation.navIdSendLinkOverride.length<=1024;if(!y||!A){this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:n.b.invalidItem,errorCategory:n.a.shareLink,errorMessage:y?H.rf:H.if},u.end({resultType:K.b.Failure}),this._getShareLinkStats={name:"ShareLink",resultType:K.b.Failure,duration:new Date().getTime()-t,error:n.b.invalidItem},this._invokeShareStatsEvent(this._getShareLinkStats),this._emitChange({type:s.b.ShareLink});return}let B=null,D=null,E=this.getAvailableReShareLink(p),F=U.c()&&!!E.length;if(T.F()&&this.isBundleShare()&&(F=!1),F?(B=new C.a((a,b)=>{a({link:E[0]})}),D=a=>((0,V.f)("sharelink._shareLink.end"),u.end({resultType:K.b.Success}),this._getShareLinkStats={name:"ShareLink",resultType:K.b.Success,duration:new Date().getTime()-t},this._invokeShareStatsEvent(this._getShareLinkStats,!0),this._handleSharedLink(a.link,e,!0),a.link),this._engagementHelper.setEngagementExtraData({isReShare:!0})):(B=this._sharingProvider.shareLink(p),D=b=>{if((0,V.f)("sharelink._shareLink.end"),b.error){this._engagementHelper.setEngagementExtraData({shareLinkSettings:a});let c=b.error;this._storeContents.sharingInformation={...this._storeContents.sharingInformation,error:c,errorCategory:n.a.shareLink,debugErrorMessage:c.message&&c.message.value};try{let a=c.status;429===a&&(this._storeContents.sharingInformation.errorMessage=H.oj)}catch{}try{let a,c=b?.error,d=c?.code;try{d&&(a=parseInt(d.match(/-?\d+/g)[0],10))}catch{}let e=(0,W.d)(a);e&&(this._storeContents.sharingInformation.errorMessage=e)}catch{}u.end({resultType:K.b.Failure}),this._getShareLinkStats={name:"ShareLink",resultType:K.b.Failure,duration:new Date().getTime()-t,error:b.error},this._invokeShareStatsEvent(this._getShareLinkStats),this._emitChange({type:s.b.ShareLink});return}u.end({resultType:K.b.Success}),this._getShareLinkStats={name:"ShareLink",resultType:K.b.Success,duration:new Date().getTime()-t},this._invokeShareStatsEvent(this._getShareLinkStats);let c=b.link;return a.audience===k.a.customLabeledSpecificPeople&&(c.audience=k.a.customLabeledSpecificPeople),c.sharingLinkKind===this._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&f&&e&&0===this._storeContents.sharingInformation.sharingLinks.filter(a=>a.shareId===c.shareId).length&&(this._storeContents.defaultLink=c),g?(this._sharingInformationInvalidated=!0,this.fetchSharingInformation(!0).then(()=>{h&&this._removePrincipals(h)})):(this._updateAccessMap(c.shareId,a.sharingRole),this._handleSharedLink(c,e)),c}),e&&this._platformDetection.isSafari){let a=new ClipboardItem({"text/plain":B.then(D).then(a=>new Blob([(0,L.C)(a,m.a.copy,this)],{type:"text/plain"}))});window.navigator.clipboard.write([a])}else B.done(D)}_removeAccess(a,b){return new Promise((c,d)=>{try{this.updatePermissions(a,o.a.none),b.end({resultType:K.b.Success,...this._telemetryExtraData}),c()}catch(a){b.end({resultType:K.b.Failure,extraData:{...this._telemetryExtraData,...(0,Y.c)(a)}}),d(a)}})}_invokeShareStatsEvent(a,b){let c=new K.a,d=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;a&&(d=a.resultType);let e={mode:j.a[this._mode],clientId:q.a[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify({...a,isReShare:b})};c.end({name:"SharingStats",resultType:d,extraData:e})}_isPolicyTipFlagSet(a,b){return a&&(a&b)===b}_getDefaultLink(){let a=new K.a({name:"SharingGetDefaultLink"}),b=this._sharingContextInformation.itemUrl;if(!b&&this._sharingContextInformation.serverRelativeItemUrl){let a=new N.a(this._sharingContextInformation.webAbsoluteUrl);b=`${a.authority}${this._sharingContextInformation.serverRelativeItemUrl}`}let c=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(c=this._sharingContextInformation.defaultRecipients.map(a=>({email:a})));let d=this._sharingContextInformation.uniqueId;d||(d=this._storeContents?.sharingInformation?.itemUniqueId);let e=this._permissions?C.a.resolve(this._permissions):d?this._sharingService.getDefaultLinkByUniqueId(d||"",c,!0):this._sharingService.getDefaultLink(b,c,!0);(0,V.f)("sharelink.getDefaultLink.start"),e.then(b=>{(0,V.f)("sharelink.getDefaultLink.end");let c=b[0],d=c.link,e=c.roles&&c.roles.indexOf("write")>=0;a.end({resultType:K.b.Success});let f=(0,L.I)(d.scope),g=(0,L.M)(f);this._handleSharedLink({allowsAnonymousAccess:"anonymous"===d.scope,audience:f,expiration:c.expirationDateTime,isActive:!0,isEdit:e,principals:[],shareId:c.id,sharingLinkKind:(0,L.J)(d.scope,e),sharingScope:g,url:d.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},b=>{a.end({resultType:K.b.Failure,extraData:{error:b}});let c="";try{c=JSON.stringify(b)}catch(a){}this._storeContents.sharingInformation={error:b,errorCategory:n.a.invite,errorMessage:H.zd,debugErrorMessage:c,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0},this._emitChange()})}_dedupeRecipients(a){let b=[],c={};return a.forEach(a=>{c[a.userId]=a}),Object.keys(c).forEach(a=>{b.push(c[a])}),b}_raceGSI(a,b,c){let d=this._sharingProvider.getSharingInformation(this._item,a,!0,null,b);Promise.race([this._prefetchGSI,d]).then(a=>{this._setGSIResponse(a,c)},a=>{this._setGSIError(a,c)})}_checkPrefetchSupportExpansion(a,b){let c=window.g_expand;return!(!c||c.length<1||0>c.indexOf("pickerSettings")||0>c.indexOf("sharingLinkTemplates")||a&&0>c.indexOf("permissionsInformation")||b&&0>c.indexOf("addressBarLinkSettings"))}_setGSIResponse(a,b){this._getSharingInformationStats={name:"GetSharingInformation",resultType:K.b.Success,duration:new Date().getTime()-b,GSIsource:a.getSharingInformationSources},this._storeContents.sharingInformation&&this._storeContents.sharingInformation.error||(this._storeContents.sharingInformation=a,this._useSimplifiedSharingDialog&&void 0!==this.getSharingInformation()&&this.parsePermissions(),this._fetchAdditionalAuthenticationTokens(),this.fetchPolicyTipInformation(),this._configureLinkIfShareId(),(0,M.a)(a.userPhotoCdnBaseUrl),this._emitChange({type:s.b.FetchSharingInformation}))}_setGSIError(a,b){let c=(0,W.b)(null,W.a.api,a);this._getSharingInformationStats={name:"GetSharingInformation",resultType:K.b.Failure,duration:new Date().getTime()-b,error:c.error},this._invokeShareStatsEvent(),this._storeContents.sharingInformation=c,this._emitChange({type:s.b.FetchSharingInformation})}_updateAccessMap(a,b){let c=this._storeContents.sharingInformation.sharingPrincipals;this._storeContents.sharingInformation.sharingPrincipals=c.map(c=>(c.accessMap?.get(a)&&(c.accessMap?.set(a,{...c.accessMap?.get(a),role:b}),this._updatePrincipal(c)),c))}_parseFamilyInfo(a,b){let c=b.map(a=>({userId:a.id,name:a.firstName+" "+a.lastName,email:a.userPrincipalName,isResolved:!0,familySharingTargetType:ab.a.FamilyMember})),d=b[0].firstName;return b.forEach((a,b)=>{0!==b&&(d+=`, ${a.firstName}`)}),{family:{userId:a,name:H.kd,email:d,isExternal:!1,isResolved:!0,entityType:y.a.group,familySharingTargetType:ab.a.Family,detailedGroupInfo:y.c.family},familyMembers:c}}async _toTuple(a){try{return{value:await a}}catch(a){return{error:a}}}_isError(a){return!!a.error}constructor(a,b){this._listeners=null,this.stopSharing=()=>{this._storeContents.filteredPrincipals={},this._sharingInformationInvalidated=!0,this.fetchSharingInformation(!0),this._updateIsShared()};const{item:c,sharingInformation:d,policyTipInfo:e,outlookAvailability:f,companyName:g,defaultRecipients:h,accessChecked:i=!0,mode:j,isListItem:k,prefetchGSI:l,waitSharingAPIsDuration:m,copilotHelper:n}=a;this._item=c,this._multiShareIds=a.sharingContextInformation?.multiShareIds||[],this._mode=j,this._sharingContextInformation=a.sharingContextInformation,this._clientId=this._sharingContextInformation&&(0,q.c)(this._sharingContextInformation.clientId),this._sharingProvider=b.sharingProvider,this._suiteNavProvider=b.suiteNavProvider||void 0,this._graphPeoplePickerHelper=b.graphPeoplePickerHelper,this._substratePeoplePickerHelper=b.substratePeoplePickerHelper,this._peoplePickerProvider=b.peoplePickerProvider,this._policyTipProvider=b.policyTipProvider||void 0,this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value,this._sharingService=a.sharingService,this._firstShareLinkRequest=!0,this._listeners=[],this._groupsMemberCountCache=[],this._sharingInformationInvalidated=!1,this._groupMembersCountHash={},this._isListItem=k,this._prefetchGSI=l,this._waitSharingAPIsDuration=m,this._copilotHelper=n,this._family=void 0,this._familyMembers=[],this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&(0,U.a)(this._sharingContextInformation.experimentContext),this._useSimplifiedSharingDialog=(0,L.ab)(this._clientId,this),this._platformDetection=new _.a;const o=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"";if(this._telemetryExtraData={mode:this._mode,clientId:this._clientId,scenarioId:o},this._engagementHelper=new P.a(a.telemetryManager,this._telemetryExtraData),this._storeContents={sharingInformation:d,sharingLinkCreated:null,companyName:g||this._sharingContextInformation&&this._sharingContextInformation.organizationName||H.zb,groupsMemberCount:0,policyTipInfo:e||{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:f||u.a.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1,filteredPrincipals:{},documentInformation:null,sharingInfoBarInformation:null,copilotHelper:null,shareCopySharingLinkToClipboardClickTimePromise:new Promise(a=>{this._shareCopySharingLinkToClipboardClickTimePromiseResolve=a})},d&&d.userPhotoCdnBaseUrl&&(0,M.a)(d.userPhotoCdnBaseUrl),h&&0!==h.length?this._resolveDefaultRecipients(h,i,j):(this._eventGroup=new G.a(this),this._eventGroup.on(window,"message",a=>{if(a&&a.data)try{let b=JSON.parse(a.data);if("atMention_defaultRecipients"===b.name){let a=b.recipientIds;this._resolveDefaultRecipients(a,i,j)}}catch(a){}})),this._configureLinkIfShareId(),(0,x.d)()&&T.R()){const a=O.t(this._clientId),b=a?this._sharingService.getFamily():Promise.resolve(),c=a?this._sharingService.getFamilyMembers():Promise.resolve();Promise.all([this._toTuple(b),this._toTuple(c)]).then(([b,c])=>{if(a&&!this._isError(b)&&!this._isError(c)&&b.value){let{family:a,familyMembers:d}=this._parseFamilyInfo(b.value.id,c.value.value);this._family=a,this._familyMembers=d}})}}}}
,,function(a,b,c){c.d(b,{a:function(){return q}});var d=c(131);class e{on(a,b,c){let d;if(f(a))d=a;else{let b=this._targetMap.get(a);b?d=b:(d=new EventTarget,this._targetMap.set(a,d))}d.addEventListener(b,c);let e=this._disposableMap.get(a);e||(e=new Map,this._disposableMap.set(a,e));let g=this._scope.attach({dispose:()=>{d.removeEventListener(b,c)}});e.set(b,g)}off(a,b,c){let d;if(f(a))d=a;else{let b=this._targetMap.get(a);b&&(d=b)}let e=this._disposableMap.get(a);if(e){let c=e.get(b);c&&(c.dispose(),e.delete(b)),0===e.size&&this._disposableMap.delete(a)}d&&d.removeEventListener(b,c)}dispose(){this._scope.dispose()}constructor(a){this._scope=new d.a,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}}function f(a){return!!a.addEventListener}class g{setTimeout(a,b){let c=setTimeout(()=>{this._timeoutMap.delete(c),a()},b),d=this._scope.attach({dispose:()=>{clearTimeout(c)}});return this._timeoutMap.set(c,d),c}clearTimeout(a){let b=this._timeoutMap.get(a);b&&(this._timeoutMap.delete(a),b.dispose())}dispose(){this._scope.dispose()}constructor(a){this._scope=new d.a,this._timeoutMap=new Map}}let h="handlerRejection",i="canceled",j=0;class k{dispose(){this._scope.dispose(),this._signals.forEach(a=>{a.resolve({result:"error",isExpected:!0,error:{code:i,message:"Messenger disposed"}})}),this._signals.clear()}sendCommand(a,b={}){if(this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});let c=++j,{timeoutDelayMs:d=this._resultTimeoutMs,acknowledgeTimeoutMs:e=this._ackTimeoutMs,transfer:f}=b;return this._port.then(b=>{let g=this._async,h=new Promise(a=>{this._signals.set(c,{acknowledgeTimeout:g.setTimeout(()=>{this._onResult(l(c,"acknowledgeTimeout"))},e),resultTimeout:g.setTimeout(()=>{this._onResult(l(c,"resultTimeout"))},d),resolve:a})});return b.postMessage({type:"command",id:c,data:a},f||[]),h})}sendNotification(a){this._scope.isDisposed||this._port.then(b=>{b.postMessage({type:"notification",data:a})})}_onAcknowledge(a){let b=this._signals.get(a.id);b&&this._async.clearTimeout(b.acknowledgeTimeout)}_onCommand(a,b){let c=b.id;a.postMessage({type:"acknowledge",id:c}),this._invokeCommandHandler(b.data).then(b=>{a.postMessage({type:"result",data:b,id:c})}).catch(a=>{})}_onNotification(a){this._invokeNotificationHandler(a.data)}_onResult(a){let b=a.id,c=this._async,d=this._signals,e=d.get(b);e&&(c.clearTimeout(e.acknowledgeTimeout),c.clearTimeout(e.resultTimeout),e.resolve(a.data)),d.delete(b)}constructor(a,b={}){let c;const f=new Map,j={onCommand:a.onCommand,onNotification:a.onNotification},{initResources:k,initTimeoutMs:l=1e4,ackTimeoutMs:m=1e3,resultTimeoutMs:n=1e4}=a,{asyncType:o=g,eventGroupType:p=e}=b,q=this._scope=new d.a;q.attach(k);const r=this._async=q.attach(new o(this)),s=q.attach(new p(this));this._ackTimeoutMs=m,this._resultTimeoutMs=n,this._invokeCommandHandler=a=>{try{let b=j.onCommand&&j.onCommand(a);if(!b)return Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:a.command},isExpected:!0});return Promise.resolve(b).catch(a=>(a=a||{name:h,isExpected:!1,message:"Unknown error"},{result:"error",error:{code:a.code||a.name||h,message:a.message||`${a}`},isExpected:!!a.isExpected}))}catch(a){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:a&&`Name: ${a.name}; Message: ${a.message||a}`}})}},this._invokeNotificationHandler=a=>{try{j.onNotification&&j.onNotification(a)}catch{}};const t=this._port=new Promise((b,d)=>{q.attach({dispose:()=>{let a=Error("Initialization canceled.");a.code=i,d(a)}}),c=r.setTimeout(()=>{let a=Error(`Initialization timed out after ${l}ms`);a.code="setupTimeout",d(a)},l),a.init(a=>{r.clearTimeout(c),q.attach({dispose:()=>{a.close()}});let d=b=>{let c=b.data;if(c&&"object"==typeof c){if("acknowledge"===c.type)return this._onAcknowledge(c);if("command"===c.type)return this._onCommand(a,c);if("notification"===c.type)return this._onNotification(c);if("result"===c.type)return this._onResult(c)}};s.on(a,"message",d),a.start(),b(a)},d)});this.ready=t.then(()=>{},a=>(this.dispose(),Promise.reject(a))),this._signals=f}}function l(a,b){return{id:a,data:{result:"error",error:{code:b,message:"Timed out"},isExpected:!1}}}function m(a){if(a.channelId&&a.origin)return a;let b=window.location.hash;if(!b)return a;let c={channelId:"",origin:""};for(let a of b.slice(1).split("&")){let[b,d]=a.split("=",3);c.hasOwnProperty(b)&&(c[b]=decodeURIComponent(d))}return{...c,...a}}class n{get ready(){return this._messenger.ready}sendCommand(a,b){return this._messenger.sendCommand(a,b)}sendNotification(a){return this._messenger.sendNotification(a)}addCommandHandler(a){return this._commandHandlers.push(a),{dispose:()=>{let b=this._commandHandlers.indexOf(a);b>-1&&this._commandHandlers.splice(b,1)}}}addNotificationHandler(a){return this._notificationHandlers.push(a),{dispose:()=>{let b=this._notificationHandlers.indexOf(a);b>-1&&this._notificationHandlers.splice(b,1)}}}dispose(){this._messenger.dispose()}_onCommand(a){for(let b of this._commandHandlers){let c=b(a);if(c)return c}}_onNotificiation(a){for(let b of this._notificationHandlers)b(a)}constructor(){this._commandHandlers=[],this._notificationHandlers=[]}}var o=c(3),p=c(361);class q extends n{sendScriptLoaded(){return this._send({command:"shareCommand",name:p.a.ScriptLoaded})}sendCopyLinkShareTargetClicked(){return this._send({command:"shareCommand",name:p.a.CopyLinkClicked})}sendShareReady(){return this._isPageLoaded?this._send({command:"shareCommand",name:p.a.InstantLoadReady}):(this._isPageLoaded=!0,this._send({command:"shareCommand",name:p.a.Ready}))}sendShareStarted(){return this._send({command:"shareCommand",name:p.a.Started})}sendDismiss(){return this._send({command:"shareCommand",name:p.a.Dismiss})}sendShareSendClicked(){return this._send({command:"shareCommand",name:p.a.ShareSendClicked})}sendShareManageAccessClicked(){return this._send({command:"shareCommand",name:p.a.ManageAccessClicked})}sendShareUIReady(){return this._send({command:"shareCommand",name:p.a.UIReady})}sendShareError(a){let b={command:"shareCommand",name:p.a.Error,error:a.error?.toString()||"",errorCategory:a.errorCategory?.toString()||"",errorMessage:a.errorMessage?.toString()||"",debugErrorMessage:a.debugErrorMessage?.toString()||""};return this._send(b)}sendShareCompleted(a){return this._send({command:"shareCommand",name:p.a.ShareCompleted,...a})}sendOutlookClicked(){return this._send({command:"shareCommand",name:p.a.OutlookClicked})}sendTeamsClicked(a,b,c){let d={command:"shareCommand",name:p.a.ShareTeamsClickedWithContext,sharingLink:a.url,recipients:b,numRecipients:b?b.length:0,body:c};return this._send(d)}sendShareAddPeopleCompleted(a,b=""){let c={command:"shareCommand",name:p.a.ShareAddPeopleCompleted,successful:a,completionMessage:b};return this._send(c)}sendShareReadyForRecipients(){return this._send({command:"shareCommand",name:p.a.ReadyForRecipients})}sendGrantAccessCompleted(a){let b={command:"shareCommand",name:p.a.GrantAccessCompleted,successful:a};return this._send(b)}sendPeoplePickerFocused(){return this._send({command:"shareCommand",name:p.a.PeoplePickerFocused})}sendResize(a){return a.command="shareCommand",this._send(a)}sendShareLoadResult(a){let b={command:"shareCommand",name:p.a.ShareLoadResult,result:a};return this._send(b)}async sendGetToken(a){let b={command:"shareCommand",name:p.a.GetToken,...a};return this._messenger.sendCommand(b).then(a=>{if("success"===a.result&&"token"in a)return a.token;throw Error("error"===a.result?a.error?.message:"Unexpected result format")})}async sendRefreshCookies(a){let b={command:"shareCommand",name:p.a.ShareRefreshCookies,getFormDigestOptions:a};return this._messenger.sendCommand(b).then(a=>{if("success"!==a.result)throw Error("error"===a.result?a.error?.message:"Unexpected result format")})}sendGetShareAppsConfig(){let a={command:"shareCommand",name:p.a.GetShareAppsConfig};return this._send(a)}sendShareAppClicked(a,b){let c={command:"shareCommand",name:p.a.ShareAppClicked,app:a,payload:b};return this._send(c)}sendGetPreviewData(){let a={command:"shareCommand",name:p.a.GetPreviewData};return this._send(a)}sendGetShareAsAttachmentData(){let a={command:"shareCommand",name:p.a.GetShareAsAttachmentData};return this._send(a)}_send(a){return this._messenger.sendCommand(a).then(a=>!!a).catch(b=>(this._customerPromiseLogger?.end({resultType:o.b.Failure,errorCode:`SharingClientMessenger - send ${a.name} failed`,extraData:{errorMessage:b.toString()}}),!1))}constructor({initTimeoutMs:a=4e4,overridePort:b,...c}){super(),this._isPageLoaded=!1,this._customerPromiseLogger=c.customerPromiseLogger,this._messenger=function(a,b={}){if(a.isRestartable)return function(a,b={}){let{channelId:c,origin:f=location.origin,host:g,overridePort:h,receiver:i=window}=m(a),j=void 0===g?window.parent!==window&&window.parent||("*"!==f?window.opener:void 0):g,{channelType:l=MessageChannel,eventGroupType:n=e,messengerType:o=k}=b,p=new d.a,q=p.attach(new n(null));return new o({onCommand:a.onCommand,onNotification:a.onNotification,init:(a,b)=>{let{port1:d,port2:e}=h?{port1:h,port2:void 0}:new l,g=!1;p.attach({dispose(){d.close()}});let k=!1,m=a=>{let b=a.data,d=a.source;if(k||!b||"object"!=typeof b||"identify-parent"!==b.type||b.channelId!==c||"*"===f&&d!==j);else{q.off(i,"message",m);let a=e;if(!h&&g){let b=new l,c=b.port1;a=b.port2,q.on(c,"message",n.bind(null,c)),c.start()}g=!0;let b={type:"initialize",channelId:c,replyTo:a};d.postMessage(b,f,a?[a]:void 0),k=!0}},n=(c,d)=>{let e=d.data;e&&"object"==typeof e&&"activate"===e.type?(q.dispose(),a(c)):b(Error("Unexpected message during messenger initialization")),q.off(i,"message",m)};q.on(d,"message",n.bind(null,d)),d.start();let o={type:"initialize",channelId:c,replyTo:e};h?(g=!0,h.postMessage(o,[e])):j&&(g=!0,j.postMessage(o,f,[e]),q.on(i,"message",m))},initResources:p,initTimeoutMs:a.initTimeoutMs,ackTimeoutMs:a.ackTimeoutMs})}(a,b);let{channelId:c,origin:f=location.origin,host:g,overridePort:h,receiver:i=window}=m(a),j=void 0===g?window.parent!==window&&window.parent||("*"!==f?window.opener:void 0):g,{channelType:l=MessageChannel,eventGroupType:n=e,messengerType:o=k}=b,p=new d.a,q=p.attach(new n(null));return new o({onCommand:a.onCommand,onNotification:a.onNotification,init:(a,b)=>{let{port1:d,port2:e}=h?{port1:h,port2:void 0}:new l;p.attach({dispose(){d.close()}}),q.on(d,"message",c=>{let e=c.data;e&&"object"==typeof e&&"activate"===e.type?(q.dispose(),a(d)):b(Error("Unexpected message during messenger initialization"))}),d.start();let g={type:"initialize",channelId:c,replyTo:e};if(h)h.postMessage(g,[e]);else if(j)j.postMessage(g,f,[e]);else{let a=b=>{let d=b.data,h=b.source;d&&"object"==typeof d&&"identify-parent"===d.type&&d.channelId===c&&("*"!==f||h===j)&&(q.off(i,"message",a),h.postMessage(g,f,[e]))};q.on(i,"message",a)}},initResources:p,initTimeoutMs:a.initTimeoutMs,ackTimeoutMs:a.ackTimeoutMs,resultTimeoutMs:a.resultTimeoutMs})}({...c,initTimeoutMs:a,overridePort:b,onCommand:this._onCommand.bind(this),onNotification:this._onNotificiation.bind(this)})}}}
,function(a,b,c){c.d(b,{a:function(){return f}});var d=c(7);let e=()=>null;class f{search(a,b){let c,e={cached:null,promise:null};return e.promise=new d.c((d,e)=>{c=this._dataSource.search(a,b).then(a=>{a&&d(a)},a=>{e(a)})},()=>{c&&c.cancel()}),e}resolve(a,b){return this._dataSource.resolve(a,b).then(a=>a)}constructor(a){this.getPersonaDetails=e,this.subscribePresence=e,this.getPickerEntityInformation=e,this.addToMruCache=e,this._dataSource=a,this.MaxCacheSuggestions=0}}}
,function(a,b,c){c.d(b,{a:function(){return i}});var d=c(7),e=c(629),f=c(0),g=c(6);let h=f.a.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","Killswitch for new Share Dialog for COB")||g.a.isFeatureEnabled({ECS:1131341});class i{getCapabilities(){return{supportsMruCaching:!1}}search(a,b){if(b.useNew3Ssearch&&this._service.isSubstrateTokenAvailabe())try{return this._service.searchPeople3S(a).then(c=>{if(!c||!c.length)return this._getContact(a,b);{let d=[],f=e.a.isValidEmailSyntax(a,!1);if(!1!==b.resolveEmailIfNoResults&&0===d.length&&f){let b={Key:a,IsResolved:!1};d.push({email:a,name:a,userId:a,isResolved:!0,...!h?{rawData:b,rawPersonData:b}:{}})}for(let a of c){let b=a.EmailAddresses&&a.EmailAddresses.length?a.EmailAddresses[0]:"",c="";if(b)try{(c=btoa(a.Id)).indexOf(b)>-1&&(c=c.substring(0,c.indexOf(b)))}catch(a){c=""}let e={Key:b,IsResolved:!1};d.push({email:b,name:a.DisplayName,userId:c,isResolved:!0,...!h?{rawData:e,rawPersonData:e}:{}})}return d}})}catch(a){}else if(this._supportsPeople)try{return this._service.searchPeople(a).then(c=>{let d=[],f=e.a.isValidEmailSyntax(a,!1);if(!1!==b.resolveEmailIfNoResults&&0===d.length&&f){let b={Key:a,IsResolved:!1};d.push({email:a,name:a,userId:a,isResolved:!0,...!h?{rawData:b,rawPersonData:b}:{}})}if(c&&c.length>0)for(let a of c){let b=a?.emailAddresses?.[0]?.address,c="";if(b)try{(c=btoa(a.id)).indexOf(b)>-1&&(c=c.substring(0,c.indexOf(b)))}catch(a){c=""}let e={Key:b,IsResolved:!1};d.push({email:b,name:a.displayName,userId:c,isResolved:!0,...!h?{rawData:e,rawPersonData:e}:{}})}return d})}catch(a){}return this._getContact(a,b)}_getContact(a,b){return this._service.getContacts(a).then(c=>{let d=e.a.isValidEmailSyntax(a,!1);if(!1!==b.resolveEmailIfNoResults&&0===c.length&&d){let b={Key:a,IsResolved:!1};return[{email:a,name:a,userId:a,isResolved:!0,...!h?{rawData:b,rawPersonData:b}:{}}]}let f=a.toLowerCase();return c.map(a=>{let b="",c="",e=a.emailAddresses;if(e&&e.length>0){for(let a of e)if(a&&a.address&&a.address.length>0&&(c||(c=a.address),d&&0===a.address.toLowerCase().indexOf(f))){b=a.address;break}}let g="";g=d&&b||a.displayName;let i=d?b:c,j={Key:i,IsResolved:!1};return{userId:g,name:a.displayName,email:i,isResolved:!0,...!h?{rawData:j,rawPersonData:j}:{}}}).filter(a=>a.email)})}resolve(a,b){let c,e=()=>{c&&(c.cancel(),c=void 0)};return new d.c((f,g)=>{let h=a=>{e(),f(a)};c=d.c.timeout(2e3).then(()=>{h(this._getPersonFromQuery(a))}),this.search(a,b).then(b=>{0===b.length?h(this._getPersonFromQuery(a)):h(b[0])},b=>{h(this._getPersonFromQuery(a))})},e)}getPersonaDetails(a){return null}subscribePresence(a,b){return{dispose:()=>{}}}getPickerEntityInformation(a){return null}_getPersonFromQuery(a){let b=new e.a(a),c={};return b.getEmail()?(c.name=b.getName()||"",c.image="",c.sharingInfo={type:0},c.isResolved=!0):c.name=c.name||a,c.email=b.getEmail()||a,c}constructor(a,b){this._service=a,this._supportsPeople=b||!1}}}
,function(a,b,c){c.d(b,{a:function(){return l}});var d=c(10),e=c(7),f=c(275),g=c(2),h=c(308),i=c(178),j=c(3);async function k(a,b="Unknown"){let c=new j.a({name:`Theming.LoadAllFonts.${b}`}),d=[];for(let b of a){let a=!1;if(document.fonts.forEach(c=>{c.family===b.fontFamily&&(a=!0)}),!a){let a=new FontFace(b.fontFamily,function(a){let{remappedPaths:b}=a;return b?b.map(a=>`url(${a})`).join(","):`url(${a.path})`}(b));a.display="swap",document.fonts.add(a),d.push(a.load())}}return Promise.all(d).then(()=>{c.end({resultType:j.b.Success})},a=>{c.end({resultType:j.b.Failure,error:a?.message})})}(0,h.e)("body");class l{static initializeTheme(a,b,c,h,j){window.__loadTheme=g.F,(window.FabricConfig=window.FabricConfig||{}).fontBaseUrl="";let m=window._spModuleLink;if(m&&m.libraries&&m.libraries.length>0&&(0,d.a)(1),l._useOverrideTheme)return e.c.resolve((0,g.C)());let n=(0,f.a)(a,b);return n?(l._themePromise=n.loadFullFormattedThemeData(c).then(a=>{let c=a||{};if((0,i.b)(b)&&c.fontFaces)try{k(c.fontFaces,c.fontPackageSource)}catch{}return(0,i.e)(c,b,h,j),a}),l._themePromise):e.c.resolve((0,i.e)({},b,h))}static overrideTheming(a,b){a&&(0,i.e)(a,b,!0),l._useOverrideTheme=!0,l._themePromise&&l._themePromise.cancel()}static overrideThemingWithFonts(a,b,c){a.loadFullFormattedThemeData().then(a=>{let d={...b};if(a?.fontFaces&&(0,i.b)(c))try{d.fontFaces=a.fontFaces,d.fontSlots=a.fontSlots,d.fontPackageSource=a.fontPackageSource,k(a.fontFaces,a.fontPackageSource)}catch{}l.overrideTheming(d,c)}).catch(a=>{l.overrideTheming(b,c)})}}l._useOverrideTheme=!1,window.FabricConfig&&window.FabricConfig.legacyTheme&&l.overrideTheming()}
,function(a,b,c){function d(a){return a&&"object"==typeof a&&"default"in a?a.default:a}c.d(b,{a:function(){return d}})}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return h}});var d=c(362),e=c(0);let f=e.a.isActivated("648CEEB2-700E-415E-A13B-73AC6B2DADD5")?e.a.isActivated("78ca8746-93f0-43aa-a2b8-c77ba4fbd019")?"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044":"af7114704a204580909f08c904c5ac6f-b3ae09c2-296c-4bf3-81c0-7c7f59f4644d-7161":"af7114704a204580909f08c904c5ac6f-57579cfd-1741-4e07-9f63-8f5c227f3b20-6813";function g(a,b={}){(0,d.a)({oAuthToken:a,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:f},context:b.context,initOneDS:b.initOneDS})}function h(a,b={}){(0,d.c)({oAuthToken:a,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:f},context:b.context})}}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(){}}
,function(a,b,c){c.d(b,{a:function(){return m}});var d=c(34),e=c(0),f=c(40),g=c(19),h=c(365),i=(c(368),c(31),c(79)),j=c(93);h.a;let k=!e.a.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),l=!e.a.isActivated("D3B20610-CED8-4AAF-958B-8EC166C0A3D4","02/20/2024","build as experiment context");function m(a,b){let c,h,m,n,o,{CorrelationId:p,systemUserKey:q,userLoginName:r,farmName:s,farmLabel:t,siteSubscriptionId:u,homeTenantId:v,aadTenantId:w,SideBySideToken:x}=a;if(e.a.isActivated("0d905643-decb-4b91-8c6d-87348745d166"))c=p;else{let a=new g.a(window.location.href).getQueryParameter("sessionId");c=d.a.isValidGuid(a)?a:p}if(k){let b=function(a){let b,c=window.ODSP_EXPERIMENTS||{};for(let a in c)if(c.hasOwnProperty(a)){b=b||{};let d=c[a];d&&d._serverTime&&Date.now()-new Date(d._serverTime).getTime()<1296e6&&(b[a]=c[a])}return window.ODSP_EXPERIMENT_TAGS||(0,i.d)(a),{experiments:b,experimentTags:window.ODSP_EXPERIMENT_TAGS}}(a)||{};h=JSON.stringify(b.experiments),m=JSON.stringify(b.experimentTags),n=function(a){let b,{ExpFeatures:c}=a;if(c)for(let a of(b="",c))b+=(function(a){let b=(a>>>0).toString(2);return`${Array(32-b.length+1).join("0")}${b}`})(a).split("").reverse().join("");if(!e.a.isActivated("f00a10d6-c80d-49a2-9636-1b349f88c198")){let c=function(a){let{ECSClientFeatures:b}=a;return Object.keys(j.a.EcsClientFlightInfo).map(a=>`ECS_${String(a)}_${(0,j.c)(a,b)}`).join(",")}(a);c&&(b+=`|${c}`)}return b}(a)}return l&&(o="undefined"!=typeof window?window._spModuleLink:void 0),{UserId:q,FarmName:s,FarmLabel:t,AccountType:r?f.a[f.a.Business]:f.a[f.a.BusinessAnonymous],TenantID:u,ServerGU:x,Session:c,SessionId:c,HomeTenantId:v||w,ResourceTenantId:w,...k?{Flights:n,Experiments:h,ExperimentTags:m}:{},...l&&o?{isBuildAsExperimentRunning:o.isBuildAsExperimentRunning,buildAsExperimentTargetVersion:o.targetBuildNumber}:{},...b}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(0);let e={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:d.a.isActivated("648CEEB2-700E-415E-A13B-73AC6B2DADD5")?d.a.isActivated("78ca8746-93f0-43aa-a2b8-c77ba4fbd019")?"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044":"af7114704a204580909f08c904c5ac6f-b3ae09c2-296c-4bf3-81c0-7c7f59f4644d-7161":"af7114704a204580909f08c904c5ac6f-57579cfd-1741-4e07-9f63-8f5c227f3b20-6813"}}
,function(a,b,c){c.d(b,{a:function(){return j},b:function(){return k}}),(d=e||(e={}))[d.default=0]="default",d[d.powerpoint=1]="powerpoint",d[d.stream=2]="stream",d[d.excelRange=3]="excelRange",d[d.excelTable=4]="excelTable",d[d.excelSheet=5]="excelSheet",d[d.excelChart=6]="excelChart",d[d.excelSheetView=7]="excelSheetView",d[d.excelComment=8]="excelComment";var d,e,f=c(39),g=c(16),h=c(20),i=c(627);function j(a,b){if(a){let c="";return b&&(0,i.c)(b)&&(c=(0,i.b)(b)),{context:function(a){switch(a&&(a=a.toString()),a){case"1":return e.powerpoint;case"2":return e.stream;case"3":return e.excelRange;case"4":return e.excelTable;case"5":return e.excelSheet;case"6":return e.excelChart;case"7":return e.excelSheetView;case"8":return e.excelComment;default:return e.default}}(a),location:c}}}function k({sharingStore:a,fallback:b,copyToClipboardFailed:c}){if(g.A()&&a){let b=a.getContextualSharingInformation(),d=a.getNavId();if(b&&d){let a=`${function(a){switch(a){case e.excelRange:return h.Qb;case e.excelTable:return h.Zb;case e.excelSheet:return h.Jb;case e.excelChart:return h.Kb;case e.excelSheetView:return h.Yb;case e.excelComment:return h.Wb;case e.powerpoint:return h.Xb;case e.stream:default:return""}}(b.context)}${b.location?" "+b.location:""}`,d=c?h.xf:h.qb;return f.b(d,a)}}return b}}
,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(104),e=c(34);let f="https://outlook.office.com/search";class g{getContacts(a){let b="/me/contacts?$select=displayName,emailAddresses&$top=50";return a&&a.length>0&&(b+=`&$search="${d.a.encodeURIComponent(a)}"`),this._dataRequestor.send({path:b,apiName:"GetContacts",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value)}getPeople(a){let b="/me/people?$select=displayName,";return b=this._appendEmailAddressSelector(b)+"&$top=20",a&&a.length>0&&(b+=`&$search="${d.a.encodeURIComponent(a)}"`),this._dataRequestor.send({path:b,apiName:"GetTopCollaborators",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>{let b=a;return"1.0"===this._graphApiVersion&&(b=this._convertPersonEmails(a)),b&&b.value},a=>{})}searchPeople(a){let b="/me/people?$select=displayName,";return b=this._appendEmailAddressSelector(b)+"&$top=20",a&&a.length>0&&(b+=`&$search="${d.a.encodeURIComponent(a)}"`),this._dataRequestor.send({path:b,apiName:"SearchPeople",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>{let b=a;return"1.0"===this._graphApiVersion&&(b=this._convertPersonEmails(a)),b&&b.value},a=>{})}searchPeople3S(a){let b={Authorization:"Bearer "+this._substrateToken,"x-anchormailbox":`SMTP:${this._mailbox}`},c="";return c=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:["Mailbox"],Query:{QueryString:a},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"]}],TimeZone:"UTC",Cvid:e.a.generate(),Scenario:{Name:"documentshare"}}),this._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:"/api/v1/suggestions",endpoint:f,needsAuthorization:!1,headers:b,requestType:"POST",postData:c}).then(a=>a&&a.Groups&&a.Groups.length&&a.Groups[0].Suggestions,a=>{})}isSubstrateTokenAvailabe(){return this._substrateToken&&this._substrateToken.length>0}init3S(){if(this._substrateToken){let a={Authorization:"Bearer "+this._substrateToken,"x-anchormailbox":`SMTP:${this._mailbox}`};this._dataRequestor.send({apiName:"Substrate.PeopleSearchInit",path:"/api/v1/init?scenario=documentshare",endpoint:f,needsAuthorization:!1,headers:a,requestType:"GET"})}}_appendEmailAddressSelector(a){return"1.0"===this._graphApiVersion?a+="scoredEmailAddresses":a+="emailAddresses",a}_convertPersonEmails(a){let b=a&&a?.value;if(b&&b.length>0){for(let a=0;a<b.length;a++){let c=b[a];if(c.scoredEmailAddresses&&!c.emailAddresses){let a=[];for(let b=0;b<c.scoredEmailAddresses.length;b++){let d=c.scoredEmailAddresses[b],e={address:d.address,rank:d.relevanceScore};a.push(e)}c.emailAddresses=a}}return a}}constructor(a,b){this._dataRequestor=b.dataRequestor,this._substrateToken=a.substrateToken,this._mailbox=a.mailbox,this._graphApiVersion=a.graphApiVersion}}}
,function(a,b,c){let d,e,f,g,h,i;c.d(b,{a:function(){return m}});let j=[];async function k(){if(!h&&(h=c.e(38).then(c.bind(c,624)),i=(await h).tools,j.length)){for(let a of j)await a(i);j=[]}}function l(a){i?a(i):j.push(a)}function m(){return window.$copilot||(window.$copilot={availability:{},loadDebugTools:k,get tools(){if(!i)throw Error("Call `await $copilot.loadDebugTools()` first to load the tools");return i},context:{},get perfCounters(){return{featuresOn:d,featuresOff:e,killSwitchesOn:f,killSwitchesOff:g}},internal:{onDebugToolsLoaded:l}}),window.$copilot}}
,function(a,b,c){c.d(b,{a:function(){return h}});var d=c(7),e=c(438),f=c(28);let g={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0};class h{static getSharesPathFromItemUrl(a){let b=btoa(unescape(encodeURIComponent(a)));return`/shares/u!${b.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}/driveItem`}createBundle(a,b){let c=JSON.stringify({children:a.map(a=>({id:a})),bundle:{},name:b});return c=c.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:c,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getFamily(){let a={};return f.b.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(a.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:a,expectedErrorCodes:{...g,404:!0},qosExtraData:{graphApiVersion:"beta"}}).then(a=>a).catch(a=>{})}getFamilyMembers(){let a={};return f.b.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(a.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:a,expectedErrorCodes:{...g,404:!0},qosExtraData:{graphApiVersion:"beta"}}).then(a=>a).catch(a=>{})}isUserPremium(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>!!a.quota.storagePlanInformation&&!a.quota.storagePlanInformation.upgradeAvailable)}getDriveInfo(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}createLink(a){let{itemIds:b,type:c,scope:d,preventDownload:e,password:f,expiration:g,bundleName:h}=a;return 1===b.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(b[0]),type:c,scope:d,preventDownload:e,password:f,expiration:g}):this.createBundle(b,h||"").then(a=>this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(a.id),type:c,scope:d,preventDownload:e,password:f,expiration:g}))}createLinkFromItemUrl(a){let{itemUrl:b,type:c,scope:d,preventDownload:e,password:f,expiration:g}=a;return this.createLinkSingleItem({itemUrl:h.getSharesPathFromItemUrl(b),type:c,scope:d,preventDownload:e,password:f,expiration:g})}getCurrentUserId(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.id)}getDriveOwner(a){return this._dataRequestor.send({path:"/drives/"+a,apiName:"/drives/",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getCurrentUser(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}})}getItemInfo(a){let b=`${this.getDrivesPathFromItemId(a)}`;return this._dataRequestor.send({path:b,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getItemInfoFromItemUrl(a){let b=`${h.getSharesPathFromItemUrl(a)}`;return this._dataRequestor.send({path:b,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getPermissions(a){let b=`${this.getDrivesPathFromItemId(a)}/permissions`;return("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:b,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:"beta"}}).then(a=>a.value)}getPermissionsFromItemUrl(a){let b;b="1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor;let c=`${h.getSharesPathFromItemUrl(a)}/permissions`;return b.send({path:c,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:"beta"}}).then(a=>a.value)}invite(a){let{itemIds:b,recipients:c,message:d,requireSignIn:e,sendInvitation:f,roles:g,password:h,expiration:i,bundleName:j}=a;return 1===b.length?this.inviteSingleItem(this.getDrivesPathFromItemId(b[0]),c,d,e,f,g,h,i):this.createBundle(b,j||"").then(a=>this.inviteSingleItem(this.getDrivesPathFromItemId(a.id),c,d,e,f,g,h,i))}inviteFromItemUrl(a){let{itemUrl:b,recipients:c,message:d,requireSignIn:e,sendInvitation:f,roles:g,password:i,expiration:j}=a;return this.inviteSingleItem(h.getSharesPathFromItemUrl(b),c,d,e,f,g,i,j)}getDefaultLink(a,b,c){return b.length>0?this.inviteSingleItem(h.getSharesPathFromItemUrl(a),b,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},c):this.createLinkSingleItem({itemUrl:h.getSharesPathFromItemUrl(a),useMultiPart:c}).then(a=>d.c.wrap([a]))}getDefaultLinkByUniqueId(a,b,c){return b.length>0?this.inviteSingleItem(this.getPathFromUniqueId(a),b,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},c):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(a),useMultiPart:c}).then(a=>d.c.wrap([a]))}updatePermissions(a,b,c){let f=`${this.getDrivesPathFromItemId(a)}/permissions/${b}`;return this._dataRequestor.send({path:f,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({roles:[c]}),getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value).catch(a=>{let b=a.message||"Error updating permission",c=a.code||(0,e.d)(a)||"genericPermissionUpdateFailure",f={error:a.error,name:a.name,errorCode:c,debugErrorMessage:JSON.stringify(a),errorMessage:b,rawError:JSON.stringify(a)};return d.c.reject(f)})}updatePermissionsFromItemUrl(a,b,c){let d=`${h.getSharesPathFromItemUrl(a)}/permissions/${b}`;return this._dataRequestor.send({path:d,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({roles:[c]}),getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value)}unshareLink(a,b){let c=`${this.getDrivesPathFromItemId(a)}/permissions/${b}`;return this._dataRequestor.send({path:c,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(()=>!0)}unshareLinkFromItemUrl(a,b){let c=`${h.getSharesPathFromItemUrl(a)}/permissions/${b}`;return this._dataRequestor.send({path:c,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(()=>!0)}createLinkSingleItem(a){let{type:b,itemUrl:c,scope:d,preventDownload:e,password:f,useMultiPart:h,expiration:i}=a,j=`${c}/createLink`,k=b&&d?{type:b,scope:d,preventDownload:e}:{};return(f||""===f)&&(k.password=f),i&&(k.expirationDateTime=i),this._dataRequestor.send({path:j,apiName:"createLink",requestType:"POST",useMultiPart:h,useAuthorizationHeaders:!0,postData:JSON.stringify(k||{}),getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getPathFromUniqueId(a){return`/sites/root/items/${a}/driveItem`}getDrivesPathFromItemId(a){let b=a.split("!");return b.length>1?`/drives/${b[0]}/items/${a}`:`/drive/items/${a}`}inviteSingleItem(a,b,c,d,e,f,h,i,j,k){let l=`${a}/invite`,m={recipients:b,message:c,requireSignIn:d,sendInvitation:e,roles:f};return h&&(m.password=h),i&&(m.expirationDateTime=i),this._dataRequestor.send({path:l,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(m),useMultiPart:k,headers:j,getErrorAsMessage:!0,expectedErrorCodes:g,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value)}constructor(a,b){this._dataRequestor=b.dataRequestor,this._betaDataRequestor=b.betaDataRequestor,this._graphApiVersion=a.graphApiVersion||""}}}
,function(a,b,c){c.d(b,{a:function(){return d}});class d{getIsCopilotEnabled(){return this._isCopilotEnabled}getAppData(){return this._appData}getContextData(){return this._contextData}getCopilotFeedbackProps(){return this._copilotFeedbackProps}getCopilotSummaryDisabledReasonsMask(){return this._copilotSummaryDisabledReasonsMask}getCopilotSummaryV2Candidate(){return this._copilotSummaryV2Candidate}getCopilotSummaryV2Encrypted(){return this._copilotSummaryV2Encrypted}setAppData(a){this._appData=a}setContextData(a){this._contextData=a}setCopilotFeedbackProps(a){this._copilotFeedbackProps=a}setCopilotSummaryDisabledReasonsMask(a){this._copilotSummaryDisabledReasonsMask=a}setCopilotSummaryV2Candidate(a,b){this._copilotSummaryV2Candidate=a,this._copilotSummaryV2Encrypted=b}constructor(a){this._isCopilotEnabled=a}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(36);function e(a){switch(a){case d.a.odb:case d.a.wac:case d.a.odc:case d.a.odcWac:return"Files";case d.a.sharePoint:return"SPO DocLib";case d.a.sharePointPages:return"SPO Sites";case d.a.ngsc:return"Sync";case d.a.listPart:case d.a.listsHome:case d.a.listsIos:return"Lists";case d.a.npe:return"Photos"}return"None"}}
,function(a,b,c){c.d(b,{a:function(){return g},b:function(){return j}});var d=c(0);d.a.isActivated("73C30953-F1D9-4AA7-8CBF-3FBCA6EF8967"),d.a.isActivated("0AD73D0F-A8BF-458A-A170-85E1AE657C54"),d.a.isActivated("1730F2A0-FAF4-4982-B7C5-0C6ED7892310"),d.a.isActivated("af77d302-97ca-4db3-ad92-370bb0c32fd2"),d.a.isActivated("EA2E7878-BDA1-4976-AF51-2114EBEB14B1"),d.a.isActivated("86DEFC3E-B100-402D-A498-A1BB294C4A8D"),d.a.isActivated("C3064A1E-7D37-4075-BD67-B231550000F9"),d.a.isActivated("A28243FA-A021-4DFA-904F-D8FEA9C116F3"),d.a.isActivated("9f46d127-a10f-44e9-bdf8-16d8225b17f5"),d.a.isActivated("F39CAE90-1462-4670-A02C-B39822AADA11"),d.a.isActivated("54d50a4a-4131-4585-ad52-0e49e8c5afad"),d.a.isActivated("5143c1d2-68dd-42a2-b6d5-ae9f20ac29e8"),d.a.isActivated("26F3418F-C046-4391-9AC2-AAF4AD7CC240"),d.a.isActivated("AACD847F-9FE2-4CD2-848B-752AE11CDA75"),d.a.isActivated("95CB0BC2-9E6F-4A19-B021-CB6C0EECBEF6"),d.a.isActivated("D1041FF8-666B-4F40-94E4-A6CD50DB6012"),d.a.isActivated("8c4805cf-6e29-41a7-b6e3-947317298f2e"),d.a.isActivated("5c915908-1f02-4284-93af-e61756abd16d"),d.a.isActivated("ad3f574d-b704-4411-8e31-500fafbcdf42"),d.a.isActivated("d30c55ac-8771-4c23-984f-0f0d2e8b56e4"),d.a.isActivated("20496d14-997c-480b-955f-ec3ce65844cc"),d.a.isActivated("069CB1D3-21D0-400E-8766-09614CE9FE69"),d.a.isActivated("fc913696-f050-49e5-ac88-fb2e86f91917"),d.a.isActivated("d381f44a-069a-4e8d-b89b-09e852f90d98"),d.a.isActivated("c33c69db-7554-46fa-8cf0-945349ce1687"),d.a.isActivated("56ba9a30-707c-48c5-96ec-a1b9e7b7302f"),d.a.isActivated("2cf47be1-64ea-4edf-ae12-c886f6a1e942"),d.a.isActivated("80670016-CE96-49A4-AA11-866A510B3ECB"),d.a.isActivated("C1E0C854-768E-49D6-BDBD-2AF8EFEFFBFD"),d.a.isActivated("DB84A8AB-B82B-41F8-8E13-E0108E2E88BB");let e=d.a.isActivated("FAC4C621-2A97-4E4A-8E3C-14B3DAEAE670");d.a.isActivated("74DB16F6-854E-4FE5-BC64-2C1279E3B521"),d.a.isActivated("b6e1f3e2-2d0e-4f3b-9c8e-5f3d6e4c8f7a"),d.a.isActivated("764c911f-aabd-46f3-ac42-94b16ed3002c"),d.a.isActivated("c5fb012c-9998-4864-abc6-cbbb5a30f949"),d.a.isActivated("79fc903d-e357-4d9c-9ca6-ba9d882ffecb"),d.a.isActivated("831c2fd4-0714-49b9-813f-6658ecb6489f"),d.a.isActivated("334b365c-0196-4b43-8838-9c7aeba0f47d"),d.a.isActivated("F1ED74E9-721D-4A42-820A-0DFC1BA39F77"),d.a.isActivated("D1D238FF-1235-4807-B9DC-08B455470DBA"),d.a.isActivated("630ace56-af69-404f-b71f-c0b52c65dd69"),d.a.isActivated("4a694cdd-9590-46c7-a015-41d19fe7ba73"),d.a.isActivated("dbb9471f-134f-432b-8848-076349ef9811"),d.a.isActivated("48B2D47F-301A-4617-B2B0-0B89C1135DCB"),d.a.isActivated("8A0D74D4-8D7B-42C7-AB99-0D66B92A58E1"),d.a.isActivated("48B2D47F-301A-4617-B2B0-0B89C1135DCB"),d.a.isActivated("a1b2c3d4-e5f6-7890-abcd-ef1234567890"),d.a.isActivated("48ce2531-1d34-480e-9ac7-bf4eece8c0ec");let f=["pdf","docx","xlsx","doc","odt","ppt","pptx","odp","rtf","txt","htm","html","aspx","loop","fluid",...e?[]:["page"]],g=["bmp","dib","gif","ico","jfif","jpe","jpeg","jpg","png","svg","tif","tiff","xbm","xpm"];[...g];let h=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv","odc","ods","doc","docx","docm","dot","dotx","dotm","odt","docb","wbk","rtf","word","pptx","ppt","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","odp","powerpoint"];function i(a,b){a.forEach(a=>{b.has(a)||b.set(a,a)})}function j(a,b){let c=new Map;return i(f,c),i(h,c),i(["md","one"],c),a&&i(g,c),b&&i(["mp4"],c),{map:c,array:Array.from(c.values())}}}
,function(a,b,c){c.d(b,{a:function(){return e}});var d=c(239);function e(){return(0,d.b)(d.enableAnalyzeImageAugloopFlight)||(0,d.b)(d.a)}}
,,,function(a,b,c){c.d(b,{a:function(){return g}});var d=c(19);c(158);var e=c(274);let f=window.PageContext;function g(a){let b;if(b=new d.a(location.href),!(new d.a(location.href).getPath(!0).indexOf("/_layouts/15/sharedialog.aspx")>=0)||"true"!==b.getQueryParameter("crossdomain"))return;window._sharingStartTime=window.performance&&performance.timing.navigationStart||Date.now(),window.addEventListener("message",function(a){a.data&&a.data.clientId&&(window._sharingStartTime=Date.now(),g(a.data))});let c=window.g_shareDialogClaim;if(c)return void window.parent.postMessage(JSON.stringify({challengeClaim:c}),"*");let g=b=>{let c={};if(b)c=b;else if(f&&f.scenarioContext&&f.scenarioContext.odbshare)c=f.scenarioContext.odbshare;else try{c=window.external.GetSharingContextInformation(),c="string"==typeof c?JSON.parse(c):Object.create(c)}catch(a){}if(window._sharingContextInfo=c,c&&c.webAbsoluteUrl){try{c.webAbsoluteUrl=decodeURIComponent(c.webAbsoluteUrl)}catch(a){}let b=`${window._spModuleLink.manifestName}-${window._spModuleLink.buildNumber}`;try{window.external.PageStartedLoading(b)}catch(a){window.parent.postMessage(JSON.stringify({name:"share_started",manifest:b}),"*")}let d=c.authToken;d&&(d=d.replace("Bearer ",""),c.authToken=d),c.disableFontDownload&&(window.FabricConfig=window.FabricConfig||{},window.FabricConfig.fontBaseUrl="");let f=window._spPageContextInfo;(f={...f,...e.a()?{listId:c.listId||f.listId,webAbsoluteUrl:c.webAbsoluteUrl||f.webAbsoluteUrl}:{authToken:d,listId:c.listId||f.listId,webAbsoluteUrl:c.webAbsoluteUrl||f.webAbsoluteUrl}}).experimentData&&f.experimentDataLookup&&(c.experimentContext={aadUserId:f.aadUserId,experimentData:f.experimentData,experimentDataLookup:f.experimentDataLookup,serverTime:f.serverTime,siteId:f.siteId}),window._spPageContextInfo=f,a.initializeShareUI({spPageContext:f})}};g()}}
,function(a,b,c){c.d(b,{a:function(){return G}});var d=c(102),e=c(572),f=c(10),g=c(104),h=c(6),i=c(140),j=c(0),k=c(19),l=c(138);let m=!j.a.isActivated("E4A35A7B-6CF9-482A-B4B8-C63B7CC489F6"),n=m?"https://res-1.cdn.office.net":"https://shellprod.msocdn.com",o=m?"https://res-1-sdf.cdn.office.net":"https://shellppe.msocdn.com",p="/api/shellbootstrapper/business/oneshell";class q{getCapabilities(){return this._capabilities}getReactShellBootstrapperUrl(){return this._usePPEHost?o+p:n+p}getInitialRenderNavBarData(){return{WorkloadId:this._suiteNavContext.workloadId,CurrentMainLinkElementID:this._suiteNavContext.currentMainLinkElementID,UserID:this._parseUserID(this._pageContext.systemUserKey),UserDisplayName:this._pageContext.isSPO&&this._pageContext.isAnonymousGuestUser?void 0:this._pageContext.userDisplayName,ShellBootHost:this._usePPEHost?o:n,IsConsumer:!!this._suiteNavContext.isConsumer,Culture:g.a.escapeUrlForCallback(this._pageContext.currentUICultureName),IsRtl:l.a.isRightToLeft,AppBrandTheme:r(this._suiteNavContext),Language:this._pageContext.currentLanguage.toString()}}getCacheToken(){let a=this._pageContext.siteClientTag;return"string"==typeof a?a.substring(0,a.indexOf("$$")):""}getUserIdentifier(){return this._pageContext.systemUserKey}_getUrlQueryParam(a){try{return new k.a(window.location.href).getQueryParameter(a)}catch(a){}}_parseUserID(a){if(!a)return"";{let b=a.lastIndexOf("|");return a.substring(b+1,a.indexOf("@",b))}}constructor(a,b){this._pageContext=b.pageContext,this._usePPEHost="true"===this._getUrlQueryParam("usePPE"),this._suiteNavContext=a.suiteNavContext,this._capabilities=a.suiteNavCapabilities?a.suiteNavCapabilities:{supportsCaching:!0,supportsRealSuiteNav:!0,showO365Text:!0,disableSecondaryUserPhotoProvider:!1,collapseO365Settings:!1,enableDelayLoading:!1}}}function r(a){let b={Primary:i.c?"#0078D4":"#03787c"};return a.appBrandTheme?a.appBrandTheme:b}var s=c(137),t=c(633),u=c(44),v=c(638),w=c(3);let x=["teams","sites","personal"],y="<scrubbed>",z="unknown";var A=c(643),B=c(72);let C={ODB:60222,ODC:!1,Fallback:!1},D="88d7a955-6ccc-4b35-b8ff-342a6bb08f3b",E=j.a.isActivated("6ce35856-96fa-409e-9292-912de2e7e615"),F=j.a.isActivated("54d52105-eb9a-472b-98c2-17bc1192a994");class G extends s.a{getCapabilities(){return this._suiteNavDataSourceBasic.getCapabilities()}getReactShellBootstrapperUrl(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()}getInitialRenderNavBarData(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()}getCacheToken(){return this._suiteNavDataSourceBasic.getCacheToken()}getUserIdentifier(){return this._suiteNavDataSourceBasic.getUserIdentifier()}getWebTemplateType(){return Number(this._pageContext?.webTemplate||u.b.invalid)}setFeedbackMetadata(a,b,d){let e=this._suiteNavContext.feedbackOptions;if((i.a||i.d)&&(a.options={...a.options,...e},a.baseThemebyWorkload={baseThemeDark:"M365Dark",baseThemeLight:"M365Light"},a.colorSchemebyWorkload={colorSchemeDark:"M365Dark",colorSchemeLight:"M365Light"}),i.d&&!this.isAdditionalFeedbackKsActivated&&(a.options.isFeedbackForumEnabled=!0,a.options.isScreenRecordingEnabled=!0,a.options.isEmailCollectionEnabled=!0,(0,A.a)(this._pageContext?.siteSubscriptionId)&&(a.options.msInternalTitleTarget="SharePoint Engineering"),d&&(a.options.diagnosticsConfig={isShareContextDataEnabled:!0,getContextData:d})),e&&e.appId){a=a||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};let d=h.a.isFeatureEnabled({ODB:i.c?60887:1246,ODC:!1,Fallback:!1});if(!j.a.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost&&(d=!0),j.a.isActivated("1da070f4-d176-43bf-a6db-6b00339b819b","02/07/2024","Check stream path from serverRequestPath")?/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname):/\/stream\.aspx/i.test(this._pageContext?.serverRequestPath??"")){d=!0;let b=a?.options?.webGroup,c=new URLSearchParams(document.location.search).get("action");a.options={...a.options,...e,isEmailCollectionEnabled:!0,isFeedbackForumEnabled:!0,isScreenRecordingEnabled:!0,webGroup:{browser:b?.browser,browserVersion:b?.browserVersion,sourcePageName:`action=${c}`,sourcePageURI:b?.sourcePageURI}}}if(!j.a.isActivated("8170d83a-2aba-4307-99cc-c500e080de87")&&a.options){let b={...a.options.webGroup};b.sourcePageURI=function(){let a=new w.a({name:"FeedbackHelperFunctions.getScrubbedSourcePageUri"});try{let b,c=new URL(window.location.href),d=c.pathname,e=!1,f=!1,g=[/^\/_layouts\/15\/(sharepoint|begin)\.aspx$/i,/^\/_layouts\/15\/(viva-amplify)\.aspx$/i,/^\/(my|shared|favorites|people|meetings|media|query)$/i,/^\/$/i];if(j.a.isActivated("86692ccd-74f8-425e-b099-53bbb5620c88")){for(let a of g)if(d.match(a)){e=!0,f=!1;break}}else{for(let a of[/^microsoft.sharepoint.com$/i,/^microsoft.sharepoint-df.com$/i])if(c.hostname.match(a)){e=!0,f=!1;break}if(!e){for(let a of g)if(d.match(a)){e=!0,f=!1;break}}}if(!e)for(let a of[/^(\/.+)+\/_layouts\/15\/onedrive\.aspx$/i,/^(\/.+)+\/Forms\/([^\/]*)$/i,/^(\/.+)+\/SitePages\/([^\/]*)$/i,/^(\/.+)+\/_layouts\/15\//i,/^(\/.+)+\/Lists\/([^\/]*)\/([^\/]*)/i,/^(\/.+)+$/i]){let b=d.match(a);if(b&&b.length>=2){e=!0,b[1]&&b[1].length>0&&(d=d.replace(b[1],function(a){if("/"!==a.charAt(0))return y;{let b="",c=a.split("/");for(let a=1;a<c.length;a++){if(1===a&&x.includes(c[1].toLowerCase())){b+="/"+c[1];continue}b+="/"+y}return b}}(b[1])),f=!0);for(let a=2;a<b.length;a++)b[a].length>0&&(d=d.replace(b[a],y),f=!0);break}}return e?(b=c.origin+d,a.end({resultType:w.b.Success,extraData:{sourcePageURI:b,didUrlPathScrubbing:f}})):(b=z,a.end({resultType:w.b.Failure,error:"Unrecognized sourcePageURI.",extraData:{rawUrl:c}})),b}catch(b){return a.end({resultType:w.b.Failure,error:b}),z}}(),a.options.webGroup=b}else if(!j.a.isActivated("F119E415-6D2A-442B-AEAE-398DF04F2E1D")&&a.options){let b=a.options.webGroup;if(b){let c=b.sourcePageURI;if(c){let d=c.match(/\/personal\/(.*)\/_layouts\/15\//);if(d&&d[1]){let e={...b};e.sourcePageURI=c.replace(d[1],"{ALPHANUMERICPII}"),a.options.webGroup=e}}}}/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&(e.screenshotPolicyValue&&(d=1===e.screenshotPolicyValue),a.baseThemebyWorkload={baseThemeDark:"OneNoteLightTheme",baseThemeLight:"OneNoteLightTheme"},a.colorSchemebyWorkload={colorSchemeLight:"OneNoteLightTheme",colorSchemeDark:"OneNoteLightTheme"},j.a.isActivated("665b2b9f-a110-4b48-8a93-9b9d6602c44b","6/27/2023","Adding additional configs for clipchamp OCV")||(a.options={...a.options,...e}));let f=a.options;if(f.appId=e.appId,f.disableIncludeScreenshot=!d,f.userVoiceEnabled=e.userVoiceEnabled,f.userVoiceLink=e.userVoiceLink,f.applicationGroup||(f.applicationGroup={}),j.a.isActivated("879be614-f8ba-435e-91d0-8da728ef4fd7")){if(!f.applicationGroup.appData){let a={isListDataSyncEnabled:!!window.__isListDataSyncEnabled};f.applicationGroup.appData=JSON.stringify(a)}try{let a=JSON.parse(f.applicationGroup.appData);a.isListDataSyncEnabled=!!window.__isListDataSyncEnabled,f.applicationGroup.appData=JSON.stringify(a)}catch(a){}}else try{let a={isListDataSyncEnabled:!!window.__isListDataSyncEnabled,entryPoint:"SuiteNav",build:window._spModuleLink.buildNumber,groupId:this._pageContext?.groupId,groupType:this._pageContext?.groupType,listId:this._pageContext?.listId,listBaseTemplate:this._pageContext?.listBaseTemplate,pageItemId:this._pageContext?.pageItemId,siteId:this._pageContext?.siteId,webId:this._pageContext?.webId,viewId:this._pageContext?.viewId};if(!j.a.isActivated("14398333-EBA7-4B01-856C-7BC167DBD8AA")&&this._suiteNavContext.getAppData){let b=this._suiteNavContext.getAppData();a={...a,...b}}try{if(window.localStorage){let b=window.localStorage.getItem("nucleus.lastKnownDevice");b&&(a.nucleusDeviceId=b)}}catch(a){}f.applicationGroup.appData?f.applicationGroup.appData=JSON.stringify({...JSON.parse(f.applicationGroup.appData),...a}):f.applicationGroup.appData=JSON.stringify(a)}catch(a){}let g=f.telemetryGroup;g.audienceGroup=this._getAudienceGroup(),g.featureArea=this._getFeatureArea(e.telemetryGroup?.featureArea),g.processSessionId=this._pageContext.CorrelationId,d&&b&&c.e(41).then(c.t.bind(c,587,23)).then(a=>{let c=a.default||a;if(!j.a.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost){let a=document.body;try{window.frames.length>0&&(a=window.frames[0].document.body)}catch{}c(a).then(a=>{b(a.toDataURL("image/jpeg"))})}else c(document.body).then(a=>{b(a.toDataURL("image/jpeg"))})})}return a}loadData(a){let b;if(!a&&this._dataPromise)return this._dataPromise;let c=!j.a.isActivated("9e3ef516-dcd3-41cf-b9f7-8df81022e918"),e=g.a.escapeUrlForCallback(this._pageContext.currentUICultureName),f=(0,d.a)(this._pageContext),h=(0,d.b)(this._pageContext),i=!E&&h&&f?k.a.concatenate(g.a.escapeUrlForCallback(h),g.a.escapeUrlForCallback(f)):f?g.a.escapeUrlForCallback(f):"",l=(0,v.a)({baseUrl:i,cultureName:e}),m=`${i}/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale=${e}`,n=a=>{let b=new w.a({name:"SuiteNavProvider.ServerAPIData"}),c={suiteNavData:a.NavBarData,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext},d=this._suiteNavDataUpdater?this._suiteNavDataUpdater.updateSuiteNavData(c):a.NavBarData,e=!!(d.HasTenantBranding&&(a.TenantPrimaryColorShades||d.TenantLogoUrl));d.AppBrandTheme=r(this._suiteNavContext);let f={data:d,jsUrl:a.JsUrl,cssUrl:a.CssUrl,hasCobranding:e,userIdentifier:this.getUserIdentifier(),cacheToken:this.getCacheToken()};return F||(0,v.b)(d,b,this._pageContext),f},o=a=>(c?this.dataRequestor.getData({url:a,method:"POST",disallowSelfIssuedToken:!0,qosName:"LoadData",parseResponse:(a,b)=>{let c;if(!a)throw B.a.log({message:"SuiteNavDataSource.UndefinedResponse",extraData:{correlationId:b?.getCorrelationId()||"",tenantId:this._pageContext?.siteSubscriptionId||""}}),Error("SuiteNavDataSource: Empty response");try{c=JSON.parse(a)}catch(a){throw B.a.log({message:"SuiteNavDataSource.FailedParseReposne",extraData:{correlationId:b?.getCorrelationId()||"",tenantId:this._pageContext?.siteSubscriptionId||""}}),a}return 0===Object.keys(c).length&&B.a.log({message:"SuiteNavDataSource.EmptyResponse",extraData:{correlationId:b?.getCorrelationId()||"",tenantId:this._pageContext?.siteSubscriptionId||""}}),c},webAbsoluteUrl:this._pageContext.webAbsoluteUrl}):this.getData(()=>a,a=>JSON.parse(a),"LoadData",null,"POST",null,null,1)).then(b=>n(a===l?b:JSON.parse(b.d.GetSuiteNavData))),p=()=>o(l).catch(()=>(c&&B.a.log({name:"SuiteNavDataSource.FailedToFetchAndParseSPOData",extraData:{tenantId:this._pageContext?.siteSubscriptionId||""}}),o(m)));if(this._pageContext.isSPO){let a=!1;if(this._prefetchCache){let c=this._prefetchCache.getData({url:l,body:"",qosName:"SpoSuiteLinks"});c&&(b=c.then(n,p),a=!0)}a||(b=p())}else b=o(m);return this._dataPromise=b,b.catch(()=>{this._dataPromise=null}),b}getSuiteNavContext(){return this._suiteNavContext}onCssLoad(a){if(a.data&&a.data.ClientData)try{let b=JSON.parse(a.data.ClientData);b&&b.IsFallbackShell&&(0,f.b)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}catch(a){}}updateDataForCurrentPage(a){if(!this._suiteNavDataUpdater)return a;let b={suiteNavData:a,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(b)}_isDogfood(){let a=this._pageContext;return j.a.isActivated("5a7b54f2-bebb-4997-93a5-bb8a00ecbf56")?"prodbubble"===a.env&&"MSIT_SPDF_1_Content"===a.farmLabel:"spdf"===a.cloudType}_getAudienceGroup(){let a="Production",b=j.a.isActivated("36CCBF70-7C3E-4765-AF00-27217283B4D6"),c=j.a.isActivated("FD265261-BB69-4064-A150-24C09C9A193A"),d=this._pageContext,e=c?"":a;return this._isDogfood()?e="Dogfood":!b&&(0,A.a)(this._pageContext?.siteSubscriptionId)||b&&"prodbubble"===d.env?e="Microsoft":("prod"===d.env||"dprod"===d.env||!j.a.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&d.isSiteListsHost)&&(e=a),e}_getFeatureArea(a){if(!j.a.isActivated("a00248de-2fc2-41a8-8671-f8fec416a811","10/22/2021","Allow apps to provide own feature area")&&a)return a;if(!j.a.isActivated("c41ebe97-8fa6-4fdc-8911-15ba2d8b163e","05/16/2023","Get feature area callback")&&this._suiteNavContext.getFeatureArea)return this._suiteNavContext.getFeatureArea();let b=this._pageContext;return a=!j.a.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&b.isSiteListsHost?"Lists Freemium":b.listBaseTemplate===t.a.genericList?"List":b.listBaseTemplate===t.a.documentLibrary?"Libraries":b.listBaseTemplate===t.a.webPageLibrary?"Modern Pages and News Authoring":this.getWebTemplateType()===u.b.contentCenter?"Syntex In-product Feedback":"Site"}_useDeadTabDetection(){return!j.a.isActivated("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/21","Dead tab detection")&&h.a.isFeatureEnabled(C)}static _getCookieValue(a){let b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)");return b?.pop()||""}static _getSignInTime(){let a=G._getCookieValue("SIMI");return a?Number(JSON.parse(atob(a)).st):0}constructor(a,b){super({dataSourceName:"SuiteNavDataSource"},b),this._suiteNavContext=a.suiteNavContext,this._suiteNavDataUpdater=a.suiteNavDataUpdater,this._suiteNavDataSourceBasic=a.suiteNavDataSourceBasic?a.suiteNavDataSourceBasic:new q(a,b),this._prefetchCache=b.prefetchCache,this.isAdditionalFeedbackKsActivated=j.a.isActivated("45e4c761-cac2-442c-b789-ed37039a99bd","06/27/2023","Additional feedback metadata"),this._useDeadTabDetection()&&(this._signInTimeAtPageLoad=G._getSignInTime(),window.addEventListener("focus",()=>{if("undefined"!=typeof MastInteraction&&MastInteraction.ShowPrompt){let a=G._getSignInTime();a&&a>this._signInTimeAtPageLoad&&(MastInteraction.SignOutPage(),MastInteraction.ShowPrompt("SwitchAccount"))}}))}}G.siteSettingsPermissions=[e.a.enumeratePermissions,e.a.manageWeb,e.a.manageSubwebs,e.a.addAndCustomizePages,e.a.applyThemeAndBorder,e.a.manageAlerts,e.a.manageLists,e.a.viewUsageData]}
,function(a,b,c){c.d(b,{a:function(){return d},b:function(){return e}});class d{static hasItemPermission(a,b){return a&&a.permissions&&d.hasPermission(a.permissions,b)}static hasPermission(a,b){return!!b&&!!a&&(b.Low&a.Low)>>>0===b.Low&&(b.High&a.High)>>>0===b.High}static hasAny(a,b){return(b||[]).some(b=>d.hasPermission(a,b))}static hasIdentityPermission(a,b){return b&&a.webPermMasks&&d.hasPermission(a.webPermMasks,b)}}d.viewListItems={High:0,Low:1},d.insertListItems={High:0,Low:2},d.editListItems={High:0,Low:4},d.deleteListItems={High:0,Low:8},d.approveItems={High:0,Low:16},d.openItems={High:0,Low:32},d.viewVersions={High:0,Low:64},d.deleteVersions={High:0,Low:128},d.cancelCheckout={High:0,Low:256},d.managePersonalViews={High:0,Low:512},d.manageLists={High:0,Low:2048},d.viewFormPages={High:0,Low:4096},d.reviewListItems={High:0,Low:16384},d.submitItems={High:0,Low:32768},d.open={High:0,Low:65536},d.viewPages={High:0,Low:131072},d.layoutsPage={High:0,Low:135168},d.addAndCustomizePages={High:0,Low:262144},d.applyThemeAndBorder={High:0,Low:524288},d.viewUsageData={High:0,Low:2097152},d.createSSCSite={High:0,Low:4194304},d.manageSubwebs={High:0,Low:8388608},d.managePermissions={High:0,Low:0x2000000},d.browseDirectories={High:0,Low:0x4000000},d.browseUserInfo={High:0,Low:0x8000000},d.addDelPrivateWebParts={High:0,Low:0x10000000},d.updatePersonalWebParts={High:0,Low:0x20000000},d.manageWeb={High:0,Low:0x40000000},d.useClientIntegration={High:16,Low:0},d.manageAlerts={High:64,Low:0},d.createAlerts={High:128,Low:0},d.editMyUserInfo={High:256,Low:0},d.viewItemsRequiresOpen={High:65536,Low:0},d.enumeratePermissions={High:0x40000000,Low:0},d.useRemoteAPIs={High:32,Low:0},d.fullMaskWithoutACP={High:0x7fffffff,Low:0xfffbffff},d.fullMask={High:0x7fffffff,Low:0xffffffff};var e=d}
,function(a,b,c){let d;c.d(b,{a:function(){return d}});var e,f,g=c("react-dom-lib"),h=c("react-lib"),i=c(2),j=c(0),k=c(575),l=c(109),m=c(51),n=c(4),o=c(576),p=c(577);let q=(0,m.a)({lineHeightRemove:{lineHeight:""},backgroundRemove:{backgroundColor:""},compatStyles:{display:"contents",color:"inherit",backgroundColor:"inherit",textAlign:"inherit",fontFamily:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"}}),r=h.forwardRef(function(a,b){let c=q(),{className:d,configOverride:e,children:f,applyStylesToPortals:g,...i}=a;e?.compat===!0&&(g=g??!1);let j="";return j=h.useMemo(()=>{let a;return(0,n.a)(d,...(a=[],e?.lineHeight==="remove"&&a.push(c.lineHeightRemove),e?.background==="remove"&&a.push(c.backgroundRemove),e?.compat===!0&&a.push(c.compatStyles),a))},[e,d]),h.createElement(o.a,{...i,className:j,applyStylesToPortals:g,ref:b,...e?.compat===!0?{"data-is-visible":!0}:{}},h.createElement(p.a,null,f))});r.displayName="FluentProviderWithOverrides";var s=c(28),t=c(578),u=c(371);(e=f||(f={})).Body="body",e.Label="label",e.Heading="heading",e.Title="title";let v=a=>{let b=Number(j.a.isActivated("58fdb702-3797-4ca7-8c56-df457174a0ec")?a.fontWeight:a.fontVariationSettings?.wght);return{fontFamily:a.fontFamily,...b&&{fontWeight:b}}};var w=c(61);let x=a=>{let b,c,d,e,f,g;return{...(b=a.fontSlots&&(a=>{if(!j.a.isActivated("4e807fc2-dffa-4ac1-8555-2d7fd5b73a9e")&&(!a||0===Object.keys(a).length))return;let b={100:{fontFamily:""},200:{fontFamily:""},300:{fontFamily:""},400:{fontFamily:""},500:{fontFamily:""},600:{fontFamily:""},700:{fontFamily:""},800:{fontFamily:""},900:{fontFamily:""},1e3:{fontFamily:""},1100:{fontFamily:""},1200:{fontFamily:""},1300:{fontFamily:""},1400:{fontFamily:""},1500:{fontFamily:""},1600:{fontFamily:""},1700:{fontFamily:""}};return Object.keys(a).forEach(c=>{let d=a[c];switch(c){case"body":b[100]=v(d),b[200]=v(d),b[300]=v(d),b[700]=v(d),b[800]=v(d),b[900]=v(d);break;case"label":b[400]=v(d),b[500]=v(d),b[600]=v(d);break;case"heading":b[1e3]=v(d),b[1100]=v(d),b[1200]=v(d),b[1300]=v(d),b[1400]=v(d);break;case"title":b[1500]=v(d),b[1600]=v(d),b[1700]=v(d);break;default:console.log(`createV9MigrationTheme: ${c} is not a supported font slot.`)}}),b})(a.fontSlots),c=(0,u.a)(void 0,b),f=(0,t.a)(a,{baseThemeV9:c,mapAliasColors:(d=j.a.isActivated("f354a6c6-83eb-4e47-b1ce-485203f34877","10/09/2024","Fix theme color contrast by shifting neutrals with Fluent v9 greys and remapping tokens."),e=s.b.isFeatureEnabled({ODB:62034}),!d&&e)?t.b:void 0}),g={},j.a.isActivated("85173d7b-5726-49d6-a312-43726f103e64")?(g.colorStatusDangerBackground1=a.semanticColors.errorBackground,g.colorStatusWarningBackground1=a.semanticColors.warningBackground,g.colorStatusSuccessBackground1=a.semanticColors.successBackground):a.isInverted&&(g.colorStatusWarningBackground1="#4a1e04",g.colorStatusWarningBorder1="#f7630c",g.colorStatusWarningForeground3="#f98845",g.colorStatusDangerBackground1="#3b0509",g.colorStatusDangerBorder1="#c50f1f",g.colorStatusDangerForeground1="#dc626d",g.colorStatusSuccessBackground1="#052505",g.colorStatusSuccessBorder1="#107c10",g.colorStatusSuccessForeground1="#54b054"),j.a.isActivated("a515b31b-4c80-464e-a28d-3bcab7ecd7c5")?f:{...f,...g}),vivaConnectionsSoftBackground:a.isInverted?a.palette.themeLight:a.palette.themeLighterAlt,semanticPrimaryButtonText:a.semanticColors.primaryButtonText,semanticPrimaryButtonTextHovered:a.semanticColors.primaryButtonTextHovered,semanticPrimaryButtonBackgroundHovered:a.semanticColors.primaryButtonBackgroundHovered,semanticButtonBackgroundDisabled:a.semanticColors.buttonBackgroundDisabled,semanticPrimaryButtonBackgroundDisabled:a.semanticColors.primaryButtonBackgroundDisabled,semanticButtonTextDisabled:a.semanticColors.buttonTextDisabled,semanticDisabledBackground:a.semanticColors.disabledBackground,semanticButtonTextHovered:a.semanticColors.buttonTextHovered,semanticButtonBackgroundHovered:a.semanticColors.buttonBackgroundHovered,semanticPrimaryButtonBackgroundPressed:a.semanticColors.primaryButtonBackgroundPressed,semanticPrimaryButtonTextPressed:a.semanticColors.primaryButtonTextPressed,semanticDisabledText:a.semanticColors.disabledText,semanticActionLink:a.semanticColors.actionLink,semanticBodyText:a.semanticColors.bodyText,semanticDisabledBodyText:a.semanticColors.disabledBodyText,semanticDisabledBodySubtext:a.semanticColors.disabledBodySubtext,semanticInputBackground:a.semanticColors.inputBackground,semanticInputText:a.semanticColors.inputText,semanticPrimaryButtonTextDisabled:a.semanticColors.primaryButtonTextDisabled,semanticPrimaryButtonBackground:a.semanticColors.primaryButtonBackground,semanticButtonBackground:a.semanticColors.buttonBackground,semanticButtonBorder:a.semanticColors.buttonBorder,semanticButtonBackgroundPressed:a.semanticColors.buttonBackgroundPressed,semanticErrorText:a.semanticColors.errorText,colorNeutralForeground4:a.semanticColors.inputPlaceholderText,...(0,w.y)()?{colorStatusDangerBackground1:a.semanticColors.errorBackground,colorStatusWarningBackground1:a.semanticColors.warningBackground,colorStatusSuccessBackground1:a.semanticColors.successBackground}:{}}};var y=c(249);let z=h.forwardRef(function(a,b){let{dir:c,theme:d}=a,e=c||(document?.documentElement?.dir==="rtl"?"rtl":"ltr"),f=h.useMemo(()=>x(d),[d]),g=h.useRef(f),j=h.useRef(d),m=(0,k.a)(),n=g.current,o=a=>{a&&(0,y.a)(a,j.current)||(j.current=a,g.current=x(a),m())};return h.useMemo(()=>{(0,i.L)(o)},[]),h.useEffect(()=>()=>{(0,i.M)(o)},[]),h.createElement(l.a,{dir:e},h.createElement(r,{...a,theme:n,dir:e,ref:b},a.children))});z.displayName="FluentMigrationThemeWrapper";let A={lineHeight:"remove",background:"remove"},B={compat:!0};var C=c(332),D=c(574);let E=({children:a})=>{let b=h.useMemo(D.a,[]);return h.createElement(C.a.Provider,{value:b},a)};d=j.a.isActivated("26DDB843-862A-4916-A636-1BCE47633238")?g.render:(...a)=>{let[b,...c]=a;return((...a)=>{let[b,c,...d]=a,e=h.isValidElement(b)&&b||void 0;g.render(h.createElement(z,{theme:(0,i.C)(),configOverride:j.a.isActivated("6cda8c08-94f5-469f-8312-b4c4442d386a")?A:B},b),c,...d);try{if(e){let a=c?.children[0];if(!a||!a.classList.contains("fui-FluentProvider"))return null;let b=Object.keys(a).find(a=>a.startsWith("__reactFiber$"));if(!b)return null;let d=a[b]?.child?.child?.child;return!d||d.type!==e.type||d.stateNode instanceof Node?null:d.stateNode}}catch{}return null})(h.createElement(E,null,b),...c)}}
,,function(a,b,c){c.d(b,{a:function(){return e}});var d=c("react-lib");function e(){let[,a]=d.useReducer(a=>a+1,0);return a}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){c.d(b,{a:function(){return d}});class d{push(a){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=a}popOldest(){if(0===this._length)return null;let a=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[a]}get isFull(){return this._length>=this._size}getAll(){let a=this._head+1;return this._length<this._size?this._buffer.slice(0,a):[...this._buffer.slice(a),...this._buffer.slice(0,a)]}constructor(a){if(a<=0)throw Error("Size must be positive");this._size=a,this._buffer=Array(a),this._length=0,this._head=-1}}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}
,function(a,b,c){function d(a){return decodeURIComponent(escape(atob(a)))}function e(a){try{if(btoa(atob(a)).match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/))return!0;return!1}catch(a){return!1}}function f(a){try{let b=(a=a.replace(/-/g,"+").replace(/_/g,"/")).length%4;if(b){if(1===b)return"";a+=Array(5-b).join("=")}return a}catch(a){return""}}function g(a){let b=f(a);return(!(a.length>0)||""!==b)&&e(b)}function h(a){let b=f(a);return e(b)?d(b):""}c.d(b,{a:function(){return d},b:function(){return h},c:function(){return g}})}
,function(a,b,c){c.d(b,{a:function(){return h}});var d,e,f=c(15),g=c(261);function h(a,b,c){let d=(0,g.b)(b,void 0,c);if(!a||!d||0===d.indexOf("http"))return d;try{return new f.a(a).authority+d}catch(a){return d}}(d=e||(e={})).Small="S",d.Medium="M",d.Large="L"}
,function(a,b,c){c.d(b,{a:function(){return e}});let d=!c(0).a.isActivated("181FAB03-FF00-4ABB-A4E1-ED1F34CC3B62");class e{static isValidEmailSyntax(a,b){return!!a&&(!d||!(a.split("@").length>2))&&!!(b?e.ValidEmailRegex:e.EmailRegex).exec(a.trim())}static parse(a){if(!a)return[];let b=e._splitAddresses(a),c=[];for(let a=0,d=b.length;a<d;a++)c.push(new e(b[a]));return c}static endsWithDelimiter(a){if(!a)return!1;{let b=a.split(e.DelimiterRegex);return!b[b.length-1].trim()}}static _splitAddresses(a){let b=a.split(e.DelimiterRegex);for(let a=b.length-1;a>=0;a--)b[a]=b[a].trim(),0===b[a].length&&b.splice(a,1);return b}getEmail(){return this._email}getName(){return this._name}getRaw(){return this._raw}constructor(a){let b,c,d;if(this._raw=a,!a)return;a=(a=a.replace(/\u200e|\u200f/g,"")).trim();const f=RegExp(e.EmailRegexPattern,"gi");let g=e.EmailMatchTypes.None,h=e.EmailMatchTypes.None;for(;null!==(d=f.exec(a));){const a=d[0],b=a.charAt(0),f=a.charAt(a.length-1);if((h="<"===b&&">"===f?e.EmailMatchTypes.Bracketed:'"'===b&&'"'===f?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>g&&(c=d,g=h,h===e.EmailMatchTypes.Bracketed))break}let i=a;if(c){b=c[0];const d=c.index,f=d+b.length,g=d>0?a.substr(0,d).trim():"";let h=f<a.length?a.substr(f):"";"'"===(b=e.StripBracketsAndQuotesRegex.exec(b)[1]).charAt(0)&&h&&"'"===h.charAt(0)&&(b=b.slice(1),h=h.slice(1).trim()),i=""===g?h:g,this._email=b.trim()}(i=i.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==i.charAt(i.length-2)&&(i=i.replace(/\s*"$/,"")),""!==(i=i.replace(/\//g,""))&&i!==b&&(this._name=i)}}e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3}}
,function(a,b,c){var d,e,f,g;c.d(b,{a:function(){return h}}),(f=d||(d={}))[f.icon=16]="icon",f[f.iconMin=16]="iconMin",f[f.bigIcon=48]="bigIcon",f[f.bigIconMin=48]="bigIconMin",f[f.regularMin=90]="regularMin",f[f.regular=130]="regular",f[f.nameMin=220]="nameMin",f[f.nameODC=440]="nameODC",f[f.nameODB=280]="nameODB",f[f.originalLocation=300]="originalLocation",f[f.custom=900]="custom",f[f.sharedWith=150]="sharedWith",f[f.note=250]="note",f[f.dateModifiedMl=150]="dateModifiedMl",f[f.dotDotDot=32]="dotDotDot",f[f.ratingsMin=110]="ratingsMin";let h={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};(g=e||(e={}))[g.Auto=0]="Auto",g[g.Pinned=1]="Pinned",g[g.Removed=2]="Removed"}
,function(a,b,c){c.d(b,{a:function(){return d},b:function(){return g},c:function(){return f},d:function(){return h},e:function(){return e}});let d="role:1073741827",e="role:1073741826",f="role:1073741829",g="role:1073741830",h="role:1073741832"}
,function(a,b,c){c.d(b,{a:function(){return d}});let d={anyone:0,organization:1,specificPeople:2}}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.invalidType=-1]="invalidType",e[e.noListTemplate=0]="noListTemplate",e[e.genericList=100]="genericList",e[e.documentLibrary=101]="documentLibrary",e[e.survey=102]="survey",e[e.links=103]="links",e[e.announcements=104]="announcements",e[e.contacts=105]="contacts",e[e.events=106]="events",e[e.tasks=107]="tasks",e[e.pictureLibrary=109]="pictureLibrary",e[e.webTemplateCatalog=111]="webTemplateCatalog",e[e.webPartCatalog=113]="webPartCatalog",e[e.listTemplateCatalog=114]="listTemplateCatalog",e[e.xmlFormLibrary=115]="xmlFormLibrary",e[e.masterPageCatalog=116]="masterPageCatalog",e[e.webPageLibrary=119]="webPageLibrary",e[e.customGrid=120]="customGrid",e[e.solutionCatalog=121]="solutionCatalog",e[e.themeCatalog=123]="themeCatalog",e[e.designCatalog=124]="designCatalog",e[e.appDataCatalog=125]="appDataCatalog",e[e.ganttTasks=150]="ganttTasks",e[e.promotedLinks=170]="promotedLinks",e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy",e[e.meetings=200]="meetings",e[e.externalList=600]="externalList",e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary",e[e.publishingPageLibrary=850]="publishingPageLibrary",e[e.publishingAsset=851]="publishingAsset",e[e.issueTracking=1100]="issueTracking",e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary",e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary",e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary",e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList",e[e.contentCenterExplanationList=1332]="contentCenterExplanationList",e[e.corporateCatalog=330]="corporateCatalog",e[e.siteCollectionCorporateCatalog=336]="siteCollectionCorporateCatalog",e[e.SyntexModernTemplateLibrary=4e3]="SyntexModernTemplateLibrary",e[e.SyntexSnippetLibrary=4200]="SyntexSnippetLibrary",e[e.SyntexFieldsLibrary=4201]="SyntexFieldsLibrary"}
,,,,,function(a,b,c){c.d(b,{a:function(){return f},b:function(){return e}});var d=c(3);function e(a,b,c){if(!a||!a.ClientData)return void b.end({resultType:d.b.ExpectedFailure,error:"NoNavBarData or NoClientData",extraData:c?{systemUserKey:c?.systemUserKey}:{}});try{let e=JSON.parse(a.ClientData),f={isGuestMode:e.IsGuestMode,isDarkMode:e.IsDarkMode,puid:e.PUID,systemUserKey:c?.systemUserKey};b.end({resultType:d.b.Success,extraData:f})}catch(a){b.end({resultType:d.b.Failure,error:a,extraData:{systemUserKey:c?.systemUserKey}})}}function f(a){let{baseUrl:b,cultureName:c}=a;return`${b}/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale=${c}&v=2&msajax=1&cv=2`}}
,,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.Family=0]="Family",e[e.FamilyMember=1]="FamilyMember"}
,function(a,b,c){var d,e;c.d(b,{a:function(){return d}}),(e=d||(d={}))[e.None=0]="None",e[e.WaitingForSharingInfoBarInformation=1]="WaitingForSharingInfoBarInformation",e[e.Visible=2]="Visible",e[e.Dismissed=3]="Dismissed"}
,function(a,b,c){c.d(b,{a:function(){return d}});let d=!c(0).a.isActivated("6d2a844a-9c33-46b3-80c2-9e47560a97b7","4/26/2022")}
,function(a,b,c){c.d(b,{a:function(){return d}});function d(a){return"ec63b09b-9748-47ba-9018-beeadd405204"===a}}
]]),define("plt.odsp-common",[],{});