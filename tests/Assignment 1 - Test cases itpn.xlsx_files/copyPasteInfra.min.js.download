var copyPasteInfra;!function(){var e={593:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[o]&&(r[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[o]};const r={},o="promises"},824:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let o=!1;const n="undefined"!=typeof performance?performance:void 0;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*n.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},916:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},873:function(e,t,r){"use strict";t.TZ=t.nh=t.kp=t.Hv=t.Wp=void 0;const o=r(780);t.Wp=o;const n=r(513);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return n.LogCategory}}),r(593);const a=r(439);t.TZ=a;r(674),r(395);r(824),r(83),r(916)},513:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,n)=>t.traceTag(e,r,o,n),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,n)=>t.debugTraceTag(e,r,o,n),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,n)=>t.assertTag(e,r,o,n),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,n)=>t.shipAssertTag(e,r,o,n),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,n)=>t.dnmTraceTag(e,r,o,n)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},439:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,o){e[t]=r()-o}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),n=e,a=t,i={},s=(e,t,r)=>function(e,t,r,n,a,i){o(e,"end",r);const s={sessionName:t,result:n?"success":"failure",message:i,marks:e};a(JSON.stringify(s))}(i,n,a,e,t,r);return i.start=0,{mark:e=>(e=>o(i,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},83:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},674:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(o){let n=r(),a=o;return{reset(e){null!=e&&(a=e),n=r()},stop(o){const i=r()-n,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:o});e(s)}}}};let r=()=>Date.now()},395:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},780:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,o)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(o,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(o(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,n).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===n&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===n&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch((t=>e(o,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const n=e[o];r=r.catch((()=>t(n)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));let n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function o(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const n={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const a=Object.getPrototypeOf(e);a&&"object"==typeof a&&Object.keys(a).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const i={};return Object.keys(n).forEach((e=>{i[e]=o(n[e],t+1)})),i}const n="_",a=new RegExp("\\W+","g")},134:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},485:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let a=[];for(let e=0;e<=n.length;++e)a[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[n.length]}},494:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=i(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(485),n={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const i=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),s)<=4&&i.push(e);return i.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},454:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(533);o.__exportStar(r(494),t),o.__exportStar(r(481),t),o.__exportStar(r(134),t),o.__exportStar(r(866),t),o.__exportStar(r(174),t),o.__exportStar(r(974),t)},481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(494)},866:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(134)},174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(134);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},974:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(494);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},36:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=void 0;var o=r(117);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return o.urlOriginPolicy}})},912:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,n=o,a)=>{try{r[e]||(r[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){a?.(`${e}`)}return r[e]}},117:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=void 0;const o=r(912),n=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft"].map((e=>e.trim())),a=[/^https?:\/\/([0-9a-zA-Z]+-)?(excel)\.officeapps\.live\.com$/],i=[/^https?:\/\/([\w-]+-)?(excel)(-[\w-]+)?\.cdn\.office\.net$/],s=new RegExp("https?://((localhost|local\\.teams\\.(office|live)\\.com|cpc-[\\w-]+|[\\w-]+\\.[\\w-]+\\.corp\\.microsoft\\.com)(:\\d+)?)(:|/|$)"),c=new RegExp("^https?://[\\w-]+\\.pyxidis\\.off(:\\d+)?$");t.createUrlOriginPolicy=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let t;try{t=new URL(e,document.baseURI)?.origin}catch(r){t=new URL(e)?.origin}if(t&&(e=>n.includes(e)||a.some((t=>t.test(e)))||i.some((t=>t.test(e)))||s.test(e)||c.test(e))(t))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${t}`)}},t),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("typedWorkersUrlOriginPolicy")},194:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,n(r(712),t);var a=r(698);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return a.createWorker}})},712:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransferableWrapper=t.wrapTransferable=t.workerName=t.isWorkerThread=t.setUpTrustedTypesConfig=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var o=r(512);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return o.WorkerError}});var n=r(776);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return n.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return n.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return n.dispatchWorkerError}});var a=r(484);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return a.paramInsideDef}});var i=r(239);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return i.Endpoint}});var s=r(381);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var c=r(852);Object.defineProperty(t,"setUpTrustedTypesConfig",{enumerable:!0,get:function(){return c.setUpTrustedTypesConfig}});var l=r(625);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return l.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return l.workerName}});var d=r(332);Object.defineProperty(t,"wrapTransferable",{enumerable:!0,get:function(){return d.wrapTransferable}}),Object.defineProperty(t,"isTransferableWrapper",{enumerable:!0,get:function(){return d.isTransferableWrapper}})},776:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=s,t.setConfig=function(e){if(c)throw new TypeError("setConfig has already been called");c=e},t.getSafeParams=function(){const e=c??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??c?.createTimeout??n},t.getCreateMode=function(e){const t=e?.createMode??c?.createMode??a;return"ThreadOrLocal"===t?s()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(c?.onWorkerError??u)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(c?.onCreateWorker??p)(e)}catch(e){l(e)}};const o=r(718),n=3e5,a="Thread";var i;function s(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let c;function l(e){setTimeout((()=>{throw e}))}function d(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function u(e){const t=d();if(void 0!==t){const r={kind:i.WorkerError,error:(0,o.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function p(e){const t=d();if(void 0!==t){const r={kind:i.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(i||(t.ThreadMessageKind=i={}))},698:function(e,t,r){"use strict";var o,n=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=o(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=_;const s=r(776),c=r(239),l=r(82),d=r(484),u=r(447),p=r(590),f=r(512),m={...i(r(712)),createWorker:_};function h(e,t,r,o,n){const{port1:a,port2:i}=new MessageChannel;let s;return Promise.all([o({port:a,options:e,createMode:t}),(0,u.timePromise)(r.createOutside=(0,u.startStopwatch)(),(()=>c.Endpoint.createOutside({port:i,options:e,createMode:t},(e=>n(s=e)))))]).then((()=>s),(e=>(s?s.close("Force"):i.close(),Promise.reject(e))))}function g(e,t,r,o){return h(e,"Local",t,(e=>function(e,t,r){const{def:o,args:n}="def"in r?r:(0,d.paramInsideDef)(r);if("function"!=typeof o){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new f.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,u.timePromise)(t.insideInit=(0,u.startStopwatch)(),(()=>o({config:(0,s.getSafeParams)(),importTypedWorkers:()=>m,connection:e},...n).then((()=>{}))))))}(e,t,r)),o)}function y(e,t,r,o){let n;t.createThread=(0,u.startStopwatch)();try{n=new p.Thread(e,r)}catch(e){return(0,u.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,u.stopStopwatch)(t.createThread,"Success"),h(e,"Thread",t,(e=>n.createInside(e,t)),o).then((e=>(e.hasBeenClosed()?n.terminate():e._onClose=n.terminate.bind(n),e)),(e=>(n.terminate(),Promise.reject(e))))}function _(e,t,r=(()=>{})){const o=(0,s.getCreateMode)(e),n="local"in t?"Local"===o?t.local:t.thread:t,a="Local"===o?g:y,i={id:e.id,createMode:o,createWorker:(0,u.startStopwatch)()},d=(0,u.timePromise)(i.createWorker,(()=>a((0,c.getSafeOptions)(e),i,n,r)));return(0,l.promiseFinally)(d,(()=>{const e=(0,u.createWorkerStats)(i);e&&(0,s.dispatchCreateWorker)(e)}))}},239:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=void 0,t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries,isTrustedTypesPolicyEnabled:e.isTrustedTypesPolicyEnabled}};const o=r(776),n=r(934),a=r(718),i=r(82),s=r(512);class c{static _create(e,t,r){const{port:a,options:l,createMode:d}=t,u={type:"Endpoint",side:e,id:l?.id};let p,f;try{p=new n.EndpointState(u,a),f=new c(u,p,d)}catch(e){return Promise.reject(e)}return new Promise(((t,n)=>{p.getCallTimeout=()=>f.callTimeout,p.getOnPostMessageError=()=>f.onPostMessageError,p.onImports=(e,t)=>{Object.defineProperties(f,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),c.resolve()},p.onClose=()=>f.close("Force");const a=(0,o.getCreateTimeout)(l),c=(0,i.setCallbacksTimeout)(a,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:u,timeout:a},o=new s.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);c.reject(o)}),{resolve:t,reject:n});let d;f._closedDuringCreate=()=>{c.resolve()};try{d=r(f)}catch(e){return c.reject(e)}f._state?.setExports(d)})).then((()=>(f._closedDuringCreate=void 0,f)),(e=>(f._closedDuringCreate=void 0,f.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new s.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,a.asError)(e)};(0,o.dispatchWorkerError)(new s.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=n.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const o=t=>()=>{const r="Outside"===e.side?"inside":"outside",o={cause:"Connection",idInfo:e};throw new s.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,o)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:o("post")},call:{configurable:!0,enumerable:!1,get:o("call")}})}}t.Endpoint=c,c.createOutside=(e,t=(()=>{}))=>c._create("Outside",e,t),c.createInside=(e,t)=>c._create("Inside",e,t)},934:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=void 0,t.throwWorkerError=l;const o=r(776),n=r(718),a=r(82),i=r(332),s=r(512);var c;function l(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(c||(c={}));let d=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,a.haveNativeProxy)()?void 0:(0,a.getFunctionPropertyNames)(e),r={kind:c.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:c.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],o={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new s.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,o))}}onInvoke({callId:e,funcName:t,args:r}){const a=Promise.resolve().then((()=>{const o=this.exports[t];if(o)return o.apply(this.exports,r);const n=e>=0?"call":"post",a={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new s.WorkerError(`Exporting Endpoint received a ${n} to unknown function ${t}`,a)}));e>=0?a.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):a.catch((r=>{const a=(0,n.asError)(r),i={cause:"UnhandledError",idInfo:this.idInfo,error:a,callId:e,funcName:t};(0,o.dispatchWorkerError)(new s.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,i))}))}sendResult(e,t,r,o){let a;(0,i.isTransferableWrapper)(o)&&(a=o.transferables,delete o.transferables,delete o.__isTransferableWrapper);const s=(0,n.encodeResultValue)(o),l={kind:c.Result,callId:e,funcName:t,isFulfilled:r,resultValue:s};try{this.port.postMessage(l,a)}catch(e){this.onSendResultFailed(l,(0,n.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},n){const a=n?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,i={cause:"MessageError",idInfo:this.idInfo,error:n,callId:e,funcName:t},c=new s.WorkerError(a,i);r.isError?(0,o.dispatchWorkerError)(c):this.sendResult(e,t,!1,c)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,o){return r>a.maxTimeout?o:(0,a.setCallbacksTimeout)(r,(()=>{const o=this.takeCallbacks(e);if(o){const n={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};o.reject(new s.WorkerError(`Importing Endpoint's call to ${t} timed out`,n))}}),o)}sendCall(e,t,r,o){return new Promise(((a,i)=>{const l=d+=1,u={kind:c.Invoke,callId:l,funcName:e,args:t};this.unresolvedCalls[l]={...this.setCallTimeout(l,e,r,{resolve:a,reject:i}),funcName:e};try{this.port.postMessage(u,o)}catch(t){const r=this.takeCallbacks(l);if(r){const o=(0,n.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:l,funcName:e};r.reject(new s.WorkerError(`Importing Endpoint failed to send call to ${e}`,a))}}}))}sendPost(e,t,r,o){const a={kind:c.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,o)}catch(t){const o=(0,n.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new s.WorkerError(`Importing Endpoint failed to post to ${e}`,a))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",n={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},a=new s.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,n),i=e>=0?this.takeCallbacks(e):void 0;(i?.reject??o.dispatchWorkerError)(a)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:n}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,s.decodeResultValue)(n))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,o.dispatchWorkerError)(new s.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed)return;const n=t.onPostMessageError??this.getOnPostMessageError?.()??l;this.sendPost(e,o,n,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new s.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const n=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,o,n,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,a.createEmptyRecord)();const r=()=>this.onClose?.(),o={[c.Invoke]:this.onInvoke.bind(this),[c.Result]:this.onResult.bind(this),[c.Names]:({funcNames:e})=>{this.onImports?.((0,a.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,a.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[c.Close]:r},n={[c.Invoke]:this.onSendInvokeFailed.bind(this),[c.Result]:this.onSendResultFailed.bind(this),[c.Names]:r,[c.Close]:r};this.port.onmessage=({data:e})=>o[e.kind](e),this.port.onmessageerror=({data:e})=>n[e.kind](e)}}},718:function(e,t){"use strict";function r(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function n(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?n(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=o,t.asError=function(e){return o(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=n,t.encodeError=a,t.encodeResultValue=function(e){return o(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},82:function(e,t){"use strict";function r(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let o;Object.defineProperty(t,"__esModule",{value:!0}),t.maxTimeout=void 0,t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.setCallbacksTimeout=function(e,r,o){if(e>t.maxTimeout)return o;const n=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(n),o.resolve(e)},reject:e=>{clearTimeout(n),o.reject(e)}}},t.createEmptyRecord=r,t.getFunctionPropertyNames=function(e){const t=r();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch{}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return o??(o=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch{return!1}}())},t.createObjectFromFunction=function(e,t){const o=r(),n=(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r));return t?(t.forEach((e=>n(o,e))),o):new Proxy(o,{get:n})},t.maxTimeout=1<<30},381:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)a(r,t);else{const t=(0,o.getTrustedScriptUrls)([...e]);importScripts(...t)}};const o=r(852);function n(e,t,r){const o=e.indexOf("?");if(o<0)return`${e}?${t}=${r}`;const n=e.slice(0,o+1),a=e.slice(o+1).split("&");let i=0;for(;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]=`${t}=${r}`,n+a.join("&")}function a(e,t){let r;for(let a=0;a<=t;a+=1)try{const t=a>0?n(e,"retries",String(a)):e,r=(0,o.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},484:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,o=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??o(t)}catch{return o(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},447:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:n()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,o.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:o,insideInit:n,createOutside:a,createThread:s}=e,{status:l,start:d,end:u}=o;if("Pending"!==l&&void 0!==u)return{id:t,createMode:r,createWorker:{status:l,absStart:d,duration:i(u-d)},createThread:"Thread"===r?c(s,d,u):void 0,createOutside:c(a,d,u),insideInit:c(n,d,u)}};const o=r(718),n="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??n()))}function i(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function c(e,t,r){const o=s(e?.start??1/0,t,r),n=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:i(o-t),end:i(n-t),duration:i(n-o)}}},590:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const n=r(454),a=r(776),i=r(82),s=r(484),c=o(r(586)),l=r(852),d=r(512);let u=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:o}=e,s={type:"Thread",side:"Outside",id:o.id},c=this.worker,l=new Promise(((e,i)=>{this.createCallbacks={resolve:e,reject:i};const l={config:(0,a.getSafeParams)(),port:r,options:o,script:this.script,args:this.args,featureGateDictionary:(0,n.getFeatureGateDictionary)(),changeGateDictionary:(0,n.getChangeGateDictionary)()};c.postMessage(l,[r,...this.transferables]),c.onerror=e=>{e.preventDefault();const t=(0,d.getErrorEventWorkerError)(s,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,a.dispatchWorkerError)(t)},c.onmessage=({data:e})=>{switch(e.kind){case a.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,d.decodeResultValue)(e.error));case a.ThreadMessageKind.WorkerError:return(0,a.dispatchWorkerError)((0,d.decodeResultValue)(e.error));case a.ThreadMessageKind.CreateWorker:return(0,a.dispatchCreateWorker)(e.stats)}}}));return(0,i.promiseFinally)(l,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;(0,l.setUpTrustedTypesConfig)(e.isTrustedTypesPolicyEnabled),[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:o}="def"in e?e:(0,s.paramInsideDef)(e);if("function"!=typeof t)return[t,r,o,void 0];const n=`__generatedInsideInit${u+=1}`;return[{scriptUrl:void 0,insideInitName:n},r,o,`var ${n} = ${t.toString()};`]}(t);const o=void 0===r?[c.default]:[r,"\n\n",c.default];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));const n={};null!=e.id&&(n.name=e.id);const a=(0,l.getTrustedUrl)(this.blobUrl);this.worker=new Worker(a,n)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},586:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{"use strict";var e={216:(e,t)=>{function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},87:(e,t)=>{function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const n=r(e),o=r(t);let i=[];for(let e=0;e<=o.length;++e)i[e]=e;for(let e=1;e<=n.length;++e){const t=[e];for(let r=1;r<=o.length;++r)t[r]=n[e-1]===o[r-1]?i[r-1]:1+Math.min(i[r],i[r-1],t[r-1]);i=t}return i[o.length]}},448:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if("true"===r)return!0;if("false"===r)return!1;return t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const n=r(87);const o={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?o:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const r=i();if(Object.hasOwn(r,e))return r[e]??t;const o=globalThis.__office_online_feature_gates_verbose_log_callback;o(`Failed lookup for FeatureGate ${e}...`);const a=[],c=e.toLowerCase();for(const e of Object.keys(r))(0,n.editDistance)(e.toLowerCase(),c)<=4&&a.push(e);return a.length>0&&o(`Potential candidates found (edit distance <= 4, case-insensitive): [${a.join(", ")}]`),o(`FeatureGate override not found, returning default: ${t}`),t}},400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(533);n.__exportStar(r(448),t),n.__exportStar(r(187),t),n.__exportStar(r(216),t),n.__exportStar(r(340),t),n.__exportStar(r(56),t),n.__exportStar(r(96),t)},187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const n=r(448)},340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)};const n=r(216)},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)};const n=r(216);function o(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},96:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)};const n=r(448);function o(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=void 0;var n=r(719);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return n.urlOriginPolicy}})},654:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},n="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,o=n,i)=>{try{r[e]||(r[e]=o.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){i?.(`${e}`)}return r[e]}},719:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=void 0;const n=r(654),o=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft"].map((e=>e.trim())),i=[/^https?:\\/\\/([0-9a-zA-Z]+-)?(excel)\\.officeapps\\.live\\.com$/],a=[/^https?:\\/\\/([\\w-]+-)?(excel)(-[\\w-]+)?\\.cdn\\.office\\.net$/],c=new RegExp("https?://((localhost|local\\\\.teams\\\\.(office|live)\\\\.com|cpc-[\\\\w-]+|[\\\\w-]+\\\\.[\\\\w-]+\\\\.corp\\\\.microsoft\\\\.com)(:\\\\d+)?)(:|/|$)"),s=new RegExp("^https?://[\\\\w-]+\\\\.pyxidis\\\\.off(:\\\\d+)?$");t.createUrlOriginPolicy=(e,t)=>(0,n.createPolicy)(e,{createScriptURL:e=>{let t;try{t=new URL(e,document.baseURI)?.origin}catch(r){t=new URL(e)?.origin}if(t&&(e=>o.includes(e)||i.some((t=>t.test(e)))||a.some((t=>t.test(e)))||c.test(e)||s.test(e))(t))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${t}`)}},t),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("typedWorkersUrlOriginPolicy")},691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=c,t.setConfig=function(e){if(s)throw new TypeError("setConfig has already been called");s=e},t.getSafeParams=function(){const e=s??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??s?.createTimeout??o},t.getCreateMode=function(e){const t=e?.createMode??s?.createMode??i;return"ThreadOrLocal"===t?c()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(s?.onWorkerError??l)(e)}catch(t){console.warn(e),u(t)}},t.dispatchCreateWorker=function(e){try{(s?.onCreateWorker??d)(e)}catch(e){u(e)}};const n=r(739),o=3e5,i="Thread";var a;function c(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let s;function u(e){setTimeout((()=>{throw e}))}function f(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function l(e){const t=f();if(void 0!==t){const r={kind:a.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function d(e){const t=f();if(void 0!==t){const r={kind:a.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(a||(t.ThreadMessageKind=a={}))},739:(e,t)=>{function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?o(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=o,t.encodeError=i,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0===t){const t=(0,n.getTrustedScriptUrls)([...e]);return void importScripts(...t)}for(const r of e)i(r,t)};const n=r(481);function o(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const o=e.slice(0,n+1),i=e.slice(n+1).split("&");let a=0;for(;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]=`${t}=${r}`,o+i.join("&")}function i(e,t){let r;for(let i=0;i<=t;i+=1)try{const t=i>0?o(e,"retries",String(i)):e,r=(0,n.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},619:(e,t)=>{function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch{return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:o()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:o,createOutside:i,createThread:c}=e,{status:u,start:f,end:l}=n;if("Pending"===u||void 0===l)return;return{id:t,createMode:r,createWorker:{status:u,absStart:f,duration:a(l-f)},createThread:"Thread"===r?s(c,f,l):void 0,createOutside:s(i,f,l),insideInit:s(o,f,l)}};const n=r(739),o="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??o()))}function a(e){return Math.round(1e3*e)/1e3}function c(e,t,r){return e<t?t:e>r?r:e}function s(e,t,r){const n=c(e?.start??1/0,t,r),o=c(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:a(n-t),end:a(o-t),duration:a(o-n)}}},481:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e){o=e??!1,i=o?n.urlOriginPolicy:void 0},t.getTrustedUrl=a,t.getTrustedScriptUrls=function(e){if(!o||!i)return e;return e.map(a)};const n=r(598);let o,i;function a(e){if(o&&i)try{return i.createScriptURL(e)}catch{return e}return e}},533:(e,t,r)=>{r.r(t),r.d(t,{__addDisposableResource:()=>W,__assign:()=>i,__asyncDelegator:()=>T,__asyncGenerator:()=>S,__asyncValues:()=>j,__await:()=>P,__awaiter:()=>y,__classPrivateFieldGet:()=>G,__classPrivateFieldIn:()=>U,__classPrivateFieldSet:()=>R,__createBinding:()=>h,__decorate:()=>c,__disposeResources:()=>C,__esDecorate:()=>u,__exportStar:()=>g,__extends:()=>o,__generator:()=>_,__importDefault:()=>x,__importStar:()=>M,__makeTemplateObject:()=>k,__metadata:()=>p,__param:()=>s,__propKey:()=>l,__read:()=>b,__rest:()=>a,__runInitializers:()=>f,__setFunctionName:()=>d,__spread:()=>m,__spreadArray:()=>O,__spreadArrays:()=>w,__values:()=>v,default:()=>F});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function s(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=n.kind,u="getter"===s?"get":"setter"===s?"set":"value",f=!t&&e?n.static?e:e.prototype:null,l=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var _ in n)y[_]="access"===_?{}:n[_];for(var _ in n.access)y.access[_]=n.access[_];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var h=(0,r[p])("accessor"===s?{get:l.get,set:l.set}:l[u],y);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=a(h.get))&&(l.get=c),(c=a(h.set))&&(l.set=c),(c=a(h.init))&&o.unshift(c)}else(c=a(h))&&("field"===s?o.unshift(c):l[u]=c)}f&&Object.defineProperty(f,n.name,l),d=!0}function f(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function c(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))}function _(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,n=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}var h=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function P(e){return this instanceof P?(this.v=e,this):new P(e)}function S(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=o[e](t)).value instanceof P?Promise.resolve(r.value.v).then(s,u):f(i[0][2],r)}catch(e){f(i[0][3],e)}var r}function s(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:P(e[n](t)),done:!1}:o?o(t):t}:o}}function j(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var E=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return E(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function G(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function R(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function U(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function W(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function C(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:o,__assign:i,__rest:a,__decorate:c,__param:s,__metadata:p,__awaiter:y,__generator:_,__createBinding:h,__exportStar:g,__values:v,__read:b,__spread:m,__spreadArrays:w,__spreadArray:O,__await:P,__asyncGenerator:S,__asyncDelegator:T,__asyncValues:j,__makeTemplateObject:k,__importStar:M,__importDefault:x,__classPrivateFieldGet:G,__classPrivateFieldSet:R,__classPrivateFieldIn:U,__addDisposableResource:W,__disposeResources:C}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=r(400),o=r(691),i=r(739),a=r(762),c=r(619),s=r(506),u=r(481);self.onmessage=({data:{config:e,port:r,options:n,script:f,args:l,featureGateDictionary:d,changeGateDictionary:p}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,u.setUpTrustedTypesConfig)(n.isTrustedTypesPolicyEnabled),(0,t.setFeatureGateDictionaryGetter)((()=>d)),(0,t.setChangeGateDictionaryGetter)((()=>p));const y=n.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let _;function h(){if(_)return _;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,a.importScriptsWithRetry)([e.typedWorkersUrl],y),_=(0,c.indexObject)(self,e.typedWorkersName??"typedWorkers"),_.setConfig(e),_}const g=(0,s.startStopwatch)();function v(e,t){const r=e?void 0:(0,i.encodeResultValue)((0,i.asError)(t)),n={kind:o.ThreadMessageKind.InitResult,error:r,stopwatch:g};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(0,s.timePromise)(g,(()=>{(0,a.importScriptsWithRetry)([...n?.importScriptUrls??e.importScriptUrls??[],...void 0!==f.scriptUrl?[f.scriptUrl]:[]],y);return(0,c.indexObject)(self,f.insideInitName)({config:e,importTypedWorkers:h,connection:{port:r,options:n,createMode:"Thread"}},...l)})).then((()=>v(!0)),(e=>v(!1,e)))}catch(e){v(!1,e)}}})(),threadBootstrap=n})();})()'},332:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapTransferable=function(e,t){return{value:e,__isTransferableWrapper:!0,transferables:t}},t.isTransferableWrapper=function(e){return"object"==typeof e&&null!==e&&"__isTransferableWrapper"in e&&!0===e.__isTransferableWrapper&&"value"in e}},852:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e){n=e??!1,a=n?o.urlOriginPolicy:void 0},t.getTrustedUrl=i,t.getTrustedScriptUrls=function(e){return n&&a?e.map(i):e};const o=r(36);let n,a;function i(e){if(n&&a)try{return a.createScriptURL(e)}catch{return e}return e}},512:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownErrorClasses=t.WorkerError=void 0,t.getErrorEventWorkerError=function(e,t,r){if((0,o.isError)(r.error)){if((0,o.isWorkerError)(r.error))return r.error;const a={cause:"UnhandledError",idInfo:e,error:r.error};return new n(`${t} received an unhandled error`,a)}if(null==r.message)return new n(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const a={cause:"UnhandledError",idInfo:e},i=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new n(`${t} received an unhandled error: ${i}`,a)},t.decodeError=a,t.decodeWorkerErrorInfo=i,t.decodeResultValue=function(e){return e.isError?a(e.value):e.value};const o=r(718);class n extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function a(e){let r;if("WorkerError"===e.name)r=new n(e.message,i(e.info));else{const o=t.knownErrorClasses[e.name];o?r=new o(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function i(e){return{...e,error:e.error?a(e.error):void 0}}t.WorkerError=n,n.isWorkerError=o.isWorkerError,t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError}},625:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return"undefined"==typeof self?void 0:self.name}},533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return L},__assign:function(){return a},__asyncDelegator:function(){return v},__asyncGenerator:function(){return T},__asyncValues:function(){return P},__await:function(){return E},__awaiter:function(){return m},__classPrivateFieldGet:function(){return M},__classPrivateFieldIn:function(){return x},__classPrivateFieldSet:function(){return O},__createBinding:function(){return g},__decorate:function(){return s},__disposeResources:function(){return D},__esDecorate:function(){return l},__exportStar:function(){return y},__extends:function(){return n},__generator:function(){return h},__importDefault:function(){return k},__importStar:function(){return W},__makeTemplateObject:function(){return I},__metadata:function(){return f},__param:function(){return c},__propKey:function(){return u},__read:function(){return S},__rest:function(){return i},__runInitializers:function(){return d},__setFunctionName:function(){return p},__spread:function(){return b},__spreadArray:function(){return w},__spreadArrays:function(){return C},__values:function(){return _},default:function(){return R}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,n,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=o.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?o.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),p=!1,f=r.length-1;f>=0;f--){var m={};for(var h in o)m[h]="access"===h?{}:o[h];for(var h in o.access)m.access[h]=o.access[h];m.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var g=(0,r[f])("accessor"===c?{get:u.get,set:u.set}:u[l],m);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=i(g.get))&&(u.get=s),(s=i(g.set))&&(u.set=s),(s=i(g.init))&&n.unshift(s)}else(s=i(g))&&("field"===c?n.unshift(s):u[l]=s)}d&&Object.defineProperty(d,o.name,u),p=!0}function d(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))}function h(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var g=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function w(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function T(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof E?Promise.resolve(r.value.v).then(c,l):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function v(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:E(e[o](t)),done:!1}:n?n(t):t}:n}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function W(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return A(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function O(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var F="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function D(e){function t(t){e.error=e.hasError?new F(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const R={__extends:n,__assign:a,__rest:i,__decorate:s,__param:c,__metadata:f,__awaiter:m,__generator:h,__createBinding:g,__exportStar:y,__values:_,__read:S,__spread:b,__spreadArrays:C,__spreadArray:w,__await:E,__asyncGenerator:T,__asyncDelegator:v,__asyncValues:P,__makeTemplateObject:I,__importStar:W,__importDefault:k,__classPrivateFieldGet:M,__classPrivateFieldSet:O,__classPrivateFieldIn:x,__addDisposableResource:L,__disposeResources:D}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";r.r(o),r.d(o,{BaseError:function(){return P},CCPError:function(){return R},CancelError:function(){return j},CancelErrorTypes:function(){return C},ClipboardPlatformError:function(){return N},ClipboardPlatformErrorTypes:function(){return _},ClipboardStorageType:function(){return $e},ClipboardStrategyBase:function(){return Ft},ClipboardStrategyType:function(){return y},CopyClipboardCommand:function(){return ae},CopyClipboardEvent:function(){return ce},CopyContext:function(){return mr},CopyError:function(){return U},CopyErrorTypes:function(){return S},CopyStatus:function(){return gr},CutClipboardCommand:function(){return ie},CutClipboardEvent:function(){return le},CutCopyPasteFlags:function(){return je},InfraInitializationErrorTypes:function(){return Ne},InvalidArgumentError:function(){return W},InvalidOperationError:function(){return k},LocalStorageChangedEventFlagPostfix:function(){return lr},LocalStorageClipboardStorage:function(){return br},LocalStorageClipboardStrategy:function(){return wr},LocalStorageKeyChangeTracker:function(){return Er},MessageDestinationConst:function(){return Wt},MismatchVersionError:function(){return O},MissingArgumentError:function(){return A},NoUserHash:function(){return wt},NoValidKeyError:function(){return I},PasteClipboardCommand:function(){return se},PasteClipboardEvent:function(){return de},PasteContext:function(){return hr},PasteError:function(){return $},PasteErrorTypes:function(){return b},SharedClipboardError:function(){return H},TTLClipboardDataError:function(){return x},UnexpectedError:function(){return F},UnsupportedError:function(){return M},UserHashMismatchError:function(){return L},WindowRPCBase:function(){return Yt},addEventListener:function(){return ue},cloneMetadata:function(){return _r},createClipboardItems:function(){return Me},createClipboardOperationMessage:function(){return At},createClipboardOperationResultMessage:function(){return Ot},createContextId:function(){return vt},createCopyPasteInfra:function(){return gn},createDeferredPromise:function(){return Rt},createDeferredPromiseCache:function(){return Ht},createDisposableImplementationExtension:function(){return Lt},createLocalStorageClipboardStorage:function(){return Sr},createLocalStorageClipboardStrategy:function(){return Cr},createMessageDeserializer:function(){return zt},createMessageId:function(){return Tt},createMessageSerializer:function(){return Gt},createWindowRPCClientReceiver:function(){return er},createWindowRPCClientSender:function(){return nr},createWindowRPCServerReceiver:function(){return Qt},createWindowRPCServerSender:function(){return or},defaultClipboardDataFormat:function(){return pe},defaultIEClipboardDataFormat:function(){return fe},emptyString:function(){return p},getCanonicalValidatedMessageId:function(){return Pt},getClipboardItem:function(){return Fe},getClipboardItemContent:function(){return Oe},getClipboardItemsCount:function(){return ke},getClipboardItemsDataCount:function(){return We},getDefaultClipboardData:function(){return De},getDeferredClipboardItemContent:function(){return xe},getEmptyClipboardItemsData:function(){return Pe},getEmptyMetadata:function(){return yr},getImmutableEmptyClipboardItems:function(){return Ae},getItemsFromClipboardItems:function(){return Re},getLocalStorageDataKey:function(){return ur},getLocalStorageMetadataKey:function(){return pr},getLocalStorageMetadataKeyToWatch:function(){return fr},getSharedClipboardValidatedOrigin:function(){return ht},getStringifiedError:function(){return _n.getStringifiedError},getValidatedRemoteWindow:function(){return qt},getWindowLocation:function(){return ot},getWindowMessaging:function(){return oe},htmlClipboardItem:function(){return n},imageClipboardDataFormat:function(){return he},init:function(){return B},initLogger:function(){return u},initMessageIdPrefix:function(){return Vt},initializeHtmlMinifierWorker:function(){return In},isChromiumEdge:function(){return re},isClipboardPlatformErrorType:function(){return w},isClipboardPlatformErrorTypes:function(){return E},isEdge:function(){return Q},isEdgeVersionWithTextHtmlWrapperSupport:function(){return te},isEdgeWithTextHtmlClipboardSupport:function(){return ee},isIE:function(){return Z},isLocalStorageInaccessible:function(){return T},isLocalStorageSupported:function(){return dr},isValidClipboardOperationCode:function(){return kt},metadataAdditionalSignatureDataAttributes:function(){return Ee},metadataChromeExtensionId:function(){return be},metadataCopyContextClipboardDataFormat:function(){return Te},metadataCopyContextWebCustomDataFormat:function(){return ve},metadataCopyId:function(){return we},metadataInfraVersionFormat:function(){return Ce},metadataIsLastCopyWasExternal:function(){return _e},metadataIsLastCopyWasExternalXLOSource:function(){return Se},metadataLastCopyWasExternal:function(){return h},metadataLastCopyWasExternalXLOSource:function(){return g},oneDot:function(){return m},oneSpace:function(){return f},queryStringBulsEndpointUrlParameter:function(){return He},queryStringCreatorOriginParameter:function(){return Kt},queryStringSessionIdParameter:function(){return ze},queryStringWacClusterParameter:function(){return Je},rethrowAfterAllActions:function(){return J},setCopyPasteInfraFeatureGateManager:function(){return An},shadowWorkbookClipboardDataFormat:function(){return ge},shadowWorkbookClipboardWebCustomDataFormat:function(){return ye},sharedClipboardSettings:function(){return e},shouldClearClipboard:function(){return Et},textHtmlClipboardDataFormat:function(){return me},ulsLogger:function(){return d},unknownMessageId:function(){return Bt},validateClipboardOperationMessage:function(){return Mt},validateClipboardOperationResultMessage:function(){return xt},validateRemoteWindowOrigin:function(){return gt}});var e={};r.r(e),r.d(e,{createEmptySharedClipboardSettings:function(){return rt},defaultPromiseTimeoutInMinutes:function(){return qe},getSharedClipboardSettings:function(){return Ze},initializeSharedClipboardSettings:function(){return et},initializeSharedClipboardSettingsFromWindow:function(){return Qe},sharedClipboardSettingsVariableName:function(){return Ve}});var t={};r.r(t),r.d(t,{default:function(){return vo}});var n={};let a;r.r(n),r.d(n,{addClipboardWrapperForEdge:function(){return dn},ccpTimestampHtmlCustomAttributeName:function(){return en},createHtmlItemFromTextPlain:function(){return an},createPlainTextFromHtml:function(){return sn},createTextHtmlFromTextPlain:function(){return nn},divTagName:function(){return No},encodeAngleBrackets:function(){return mn},ensureOneLFPerNewLine:function(){return rn},getCcpTimestampHtmlCustomAttributeFromWrappingTag:function(){return pn},getExternalSource:function(){return fn},getFragmentFromTextHtml:function(){return un},isContainsTimestampWrapper:function(){return ln},minCcpTimestampHtmlCustomAttributeValue:function(){return tn},preTagName:function(){return Ho},tableTagName:function(){return Jo},tdTagName:function(){return Go},trTagName:function(){return zo},trimToLength:function(){return on},wrapContentWithTagAndAttributes:function(){return hn}});const i=e=>{a=e};class s{static setFeatureGateManager(e){i(e)}}var c=r(873);let l;function d(){return l}function u(e){if(!e)throw new Error("The 'logger' argument is missing");l=c.Hv.getFromExternalLogger(e)}const p="",f=" ",m=".",h="1",g="1";var y,_,S,b,C;function w(e,t){return E(e,[t])}function E(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function T(e){if(e&&"object"==typeof e){if(v(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(v(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(v(JSON.parse(e).reason))return!0}catch{}return!1}function v(e){return e===_.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(y||(y={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(_||(_={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(S||(S={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(b||(b={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(C||(C={}));class P extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():p}constructor(e,t,r){const o=P.augmentParameterValue(e);if(super(o),this.name=P.augmentParameterValue(t),this.errorName=this.name,this.name?d().ULS.traceTag(596456211,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Error '${this.name}': ${o}`):d().ULS.traceTag(596456212,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Error message: ${o}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=P.augmentParameterValue(e);t.length>0&&d().ULS.traceTag(596456213,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class I extends P{constructor(e,t){super(e,"NoValidKeyError",t)}}class A extends P{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=P.augmentParameterValue(t),n=A.getDefaultMessage(o);let a=P.augmentParameterValue(e);0===a.length&&(a=n),super(a,"MissingArgumentError",r),this.name=o}}class W extends P{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const n=P.augmentParameterValue(t);let a=r;a||(a=p);const i=W.getDefaultMessage(n,a);let s=P.augmentParameterValue(e);0===e.length&&(s=i),super(s,"InvalidArgumentError",o),this.name=n,this.value=a}}class k extends P{constructor(e,t){super(e,"InvalidOperationError",t)}}class M extends P{constructor(e,t){super(e,"UnsupportedError",t)}}class O extends P{constructor(e,t,r,o,n){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${o}`,"MismatchVersionError",n)}}class x extends P{constructor(e,t,r,o){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",o)}}class L extends P{constructor(e,t,r,o){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",o)}}class F extends P{constructor(e,t){super(e,"UnexpectedError",t)}}function D(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:p}class R extends P{constructor(e,t,r,o,n){super(t||`reason=${e}`,r,o),this.reason=e,n&&(this.errorName=n)}}class U extends R{constructor(e,t,r){super(e,t,"CopyError",r,D(e,S))}}class $ extends R{constructor(e,t,r){super(e,t,"PasteError",r,D(e,b))}}class j extends R{constructor(e,t,r){super(e,t,"CancelError",r,D(e,C))}}class N extends R{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,D(e,_))}}class H extends R{constructor(e,t,r){super(e,t,"SharedClipboardError",r,D(e,_))}}function J(e){if(!e||!Array.isArray(e)||0===e.length)return void d().ULS.traceTag(596456214,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){d().ULS.traceTag(596456216,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new k(e.message,e))}else d().ULS.traceTag(596456215,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}function z(){return G}const G={userAgent:()=>window&&window.navigator?window.navigator.userAgent:p,appVersion:()=>window&&window.navigator?window.navigator.appVersion:p};let V={};function B(){V={}}const K=new RegExp("(\\bTrident/| MSIE )"),q=16.16299,Y=17.17123,X=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function Z(){if(void 0===V.isIEProperty){V.isIEProperty=!1;const e=z();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(K);e&&2===e.length&&(V.isIEProperty=!0)}}}return V.isIEProperty}function Q(){if(void 0===V.isEdgeProperty){V.isEdgeProperty=!1,V.isEdgeWithTextHtmlClipboardSupportProperty=!1,V.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=z();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(X);if(e&&2===e.length){V.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=q&&(V.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=Y&&(V.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return V.isEdgeProperty}function ee(){return Q()&&V.isEdgeWithTextHtmlClipboardSupportProperty}function te(){return Q()&&V.isEdgeVersionWithTextHtmlWrapperSupportProperty}function re(){const e=z();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function oe(){return ne}const ne={postMessage:(e,t,r,o)=>{e.postMessage(t,r,o)}},ae="copy",ie="cut",se="paste",ce="copy",le="cut",de="paste",ue=(e,t,r,o)=>{const n=o||!1;return e.addEventListener(t,r,n),()=>{e.removeEventListener(t,r,n)}},pe="text/plain",fe="Text",me="text/html",he="image/png",ge="data/shadow-workbook",ye="web data/shadow-workbook",_e="metadata/is-last-copy-was-external",Se="metadata/is-last-copy-was-external-XLO-source",be="metadata/chrome-extension-id",Ce="metadata/ccp-infra-version",we="copyId",Ee="metadata/additional-signature-data-attributes",Te="metadata/copy-context",ve="web metadata/copy-context";function Pe(){return{items:{}}}const Ie=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new k(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":p}empty)`)},setDeferredItem:(e,t)=>{throw new k(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>Ue(void 0)}}();function Ae(){return Ie}function We(e){return e&&e.items?Object.keys(e.items).length:0}function ke(e){return We(e&&e.getData())}function Me(e=void 0){let t=e;return t||(t={items:{}}),{getItem:e=>Oe(t,e),setItem:(e,r)=>{Le(t,e,r)},setDeferredItem:(e,r)=>{Le(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>xe(t,e),getData:()=>t,get:()=>Ue(t)}}function Oe(e,t){if(!e)throw new A(p,"clipboardItemsData");if(!e.items)throw new W(p,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function xe(e,t){if(!e)throw new A(p,"clipboardItemsData");if(!e.items)throw new W(p,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:pe}))}function Le(e,t,r){if(!e)throw new A(p,"clipboardItemsData");if(!e.items)throw new W(p,"clipboardItemsData.items");e.items[t]=r}function Fe(e,t){if(!e||0===e.length||!t||!t.trim())return p;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||p}function De(e){return Fe(e,pe)}function Re(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:pe,data:p}),t}function Ue(e){const t=[];if(0===We(e))return t;for(const r in e.items){let o=e.items[r];o||(o=p);const n={clipboardDataFormat:r,data:o,deferred:o instanceof Promise};t.push(n)}return t}var $e,je,Ne;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}($e||($e={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}(je||(je={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Ne||(Ne={}));const He="BulsEndpointUrl",Je="WacCluster",ze="usid",Ge="-",Ve="sharedClipboardSettings",Be=1,Ke=3600,qe=2;let Ye=rt(),Xe=!1;function Ze(){if(!Xe)throw new k("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return Ye}function Qe(){Xe=!1,function(){if(!window||!(Ve in window))return Ye=rt(),void(Xe=!0);const e=window[Ve];if(!e||"object"!=typeof e)return Ye=rt(),void(Xe=!0);tt(e)}()}function et(e){Xe=!1,tt(e)}function tt(e){if(!e)throw new A(p,"sharedClipboardSettingsCandidate");const t=rt();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return Ye=t,void(Xe=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return d().ULS.traceTag(596124181,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),Ye=t,void(Xe=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf(Ge);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{d().ULS.traceTag(579737680,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return d().ULS.traceTag(596124182,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],Ye=t,void(Xe=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{d().ULS.traceTag(579737681,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return d().ULS.traceTag(596124183,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Ye=t,void(Xe=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return d().ULS.traceTag(596124184,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Ye=t,void(Xe=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return d().ULS.traceTag(596124185,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Ye=t,void(Xe=!0)}t.whitelistOriginComponents=!0,Ye=t,Xe=!0}function rt(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:p,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Be,sharedClipboardExpirationInMinutes:Ke,clipboardPromiseTimeoutInMinutes:qe,remoteLoggerPath:p}}function ot(){let e=p;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=p)):(d().ULS.traceTag(595932950,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const nt="://",at="http",it="https",st=".",ct="/",lt=":",dt=new RegExp("^\\d+$");let ut,pt,ft=!1;function mt(e){if(!e)throw new A(p,"origin");const t=e.trim().toLowerCase();let r=p,o=t.split(nt,3);if(!o||0===o.length||!o[0]||o[0]!==at&&o[0]!==it)throw new W("Missing protocol","origin",e);if(1===o.length)throw new W("Missing domain","origin",e);if(o.length>2)throw new W(`'${nt}' should appear once`,"origin",e);let n=o[1];if(!n)throw new W("Missing domain","origin",e);if(r=o[0]+nt,n=n.trim(),o=n.trim().split(ct,3),!o||0===o.length||!o[0]||!o[0].trim())throw new W("Missing domain","origin",e);if(o.length>2)throw new W("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new W("The last part of the origin should be the domain","origin",e);if(o=n.split(lt,3),!o||0===o.length||!o[0]||!o[0].trim())throw new W("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new W("The last part of the origin should be the domain and an optional port number","origin",e);if(n=o[0].trim(),r+=n,2===o.length){const t=o[1].trim(),n=dt.exec(t);if(!n||1!==n.length)throw new W("Invalid port number","origin",e);const a=Number(t);if(isNaN(a))throw new W("Invalid port number","origin",e);r+=lt+t}return d().ULS.traceTag(596452423,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function ht(e){bt();const t=mt(e);let r=t.split(nt);if(!r||2!==r.length||!r[0]||!r[1])throw new W("Invalid origin","parentOrigin",e);const o=Ze();let n=p;if(o.whitelistOriginComponents){const t=r[0]+nt;if(r=r[1].split(st),!r||r.length<2||!r[0])throw new W("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=t+r.join(st)}else n=t;return d().ULS.traceTag(596452424,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${n}' components=${JSON.stringify(r)}`),n}function gt(e){bt();const t=mt(e),r=mt(ot().origin);if(t===r)return t;if(!Ze().whitelistOriginComponents)throw new k(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=yt(t),n=yt(r);if(o.protocol!==n.protocol)throw new k(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${n.protocol}'`);if(o.environment!==n.environment)throw new k(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${n.environment}'`);return t}function yt(e){bt();const t=e.split(nt,2),r=t[0],o=_t(t[1]),n={protocol:r};if(n.environment=St(e,o,pt),o.length<=n.environment.length+1)throw new W("Missing app component","origin",e);if(o.charAt(n.environment.length)!==st)throw new W("Missing a domain separator after the environment component","origin",e);const a=o.substr(n.environment.length+st.length);if(n.app=St(e,a,ut),n.app.length<a.length&&a.charAt(n.app.length)!==Ge)throw new W(`When the Office Online app name is not the domain prefix, '${Ge}' should precede it`,"origin",e);return n}function _t(e){if(!e)throw new A(p,"stringToReverse");const t=e.length;let r=p;for(let o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function St(e,t,r){if(!t)throw new A(p,"reversedValidatedHostname");if(!r)throw new A(p,"reversedStringsToLengthMap");const o=t.length,n=Object.keys(r).filter((e=>{const n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return _t(n[0]);throw new W("Invalid origin","validatedOrigin",e)}function bt(){if(ft)return;const e=Ze();e.whitelistOriginComponents&&(ut=Ct(e.sharedClipboardHostingApps),pt=Ct(e.sharedClipboardHostingEnvironments),ft=!0)}function Ct(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[_t(e)]=e.length})),t):t}const wt=1;function Et(e,t){return null==e||e===wt||null==t||e!==t}function Tt(){return It()}function vt(){return It()}function Pt(e){if(!e)throw new A(p,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new W(p,"id");return t}function It(){return(Math.random()+1).toString(36).substring(7)}function At(e,t,r,o,n){const a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return Mt(a),a}class Wt{}function kt(e){return"get"===e||"set"===e||"init"===e}Wt.localStorageData="localStorage/data",Wt.localStorageMetadata="localStorage/metadata",Wt.initIframe="initIframe";const Mt=function(e){if(!e)throw new A(p,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new A(p,"id");if(!e.operationCode)throw new A(p,"operationCode");if(!e.destination)throw new A(p,"destination");if(!kt(e.operationCode))throw new W(p,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new W(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function Ot(e,t,r,o,n){const a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return xt(a),a}const xt=function(e){if(!e)throw new A(p,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new I("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw d().ULS.traceTag(553747865,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new A(p,"id");if(!e.operationCode)throw new A(p,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new W(p,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new W(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new W(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new W(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new W(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new W(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new W(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function Lt(e){if(!e||0===e.trim().length)throw new W(p,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&d().ULS.traceTag(596456217,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new k(r(e))}}})()}class Ft{initialize(e){return e.then((e=>(this.clipboardStorage=e,d().ULS.traceTag(596453007,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(d().ULS.traceTag(596453008,c.nh.msoulscat_ES_EWAJS,T(e)?c.kp.Info:c.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${c.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return d().ULS.shipAssertTag(596121485,c.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new N(_.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new N(_.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return d().ULS.shipAssertTag(596121486,c.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new N(_.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw d().ULS.traceTag(507848131,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${c.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new N(_.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(Ae(),e):(d().ULS.shipAssertTag(595882508,c.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new N(_.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new N(_.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=Lt(`${e}`)}}const Dt=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Rt(e){let t=e;return t&&0!==t.trim().length||(t=Tt()),new Nt(t)}function Ut(){return Dt?window.performance.now():Date.now()}function $t(e){return Dt?new Date(e+window.performance.timing.navigationStart):new Date(e)}function jt(e,t,r){if(!r)throw new A(p,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Ut()-r}ms`}class Nt{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):d().ULS.traceTag(596456257,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):d().ULS.traceTag(596456260,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Ut(),d().ULS.traceTag(596456261,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${jt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return d().ULS.traceTag(596456258,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&d().ULS.traceTag(596456259,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${$t(this.fulfillmentTimestamp)}. ${jt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Pt(e),Nt.sequenceId+=1,this.sequenceId=Nt.sequenceId,this.creationTimestamp=Ut(),d().ULS.traceTag(596456225,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${$t(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{d().ULS.traceTag(596456226,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${$t(Ut())}`),this.internalResolve=e,this.internalReject=t}))}}function Ht(){return new Jt}Nt.sequenceId=0;class Jt{getDeferredPromise(e){const t=Pt(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return d().ULS.traceTag(596456218,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;d().ULS.traceTag(596456219,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=Rt(e);if(this.getDeferredPromise(t.id))throw new W("A deferred promise already exists in the cache for the specified id","id",t.id);const r=Pt(t.id);return this.deferredResultMessagePromiseCache[r]=t,d().ULS.traceTag(596456220,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void d().ULS.traceTag(596456221,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=Pt(e);delete this.deferredResultMessagePromiseCache[t],d().ULS.traceTag(596456222,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(d().ULS.traceTag(596456223,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){d().ULS.traceTag(596456224,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}function zt(e){if(!e)throw new A(p,"validator");const t={deserialize:t=>function(e,t){if(!e)throw new A(p,"incomingMessage");if(!t)throw new A(p,"validator");if(0===e.length)throw new W("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new W("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new W("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new W("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)};return t}function Gt(e){if(!e)throw new A(p,"validator");const t={serialize:t=>function(e,t){if(!e)throw new A(p,"outgoingMessage");if(!t)throw new A(p,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new W("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return d().ULS.traceTag(596452375,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)};return t}const Vt="initmessageid",Bt="unknownmessageid",Kt="CreatorOrigin";function qt(e){if(!e)throw new A(p,"remoteWindow");if(!("window"in e)||!e.window)throw new A(p,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new A(p,"remoteWindow.windowOrigin");const t=gt(e.windowOrigin);return{window:e.window,windowOrigin:t}}class Yt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(J([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new A(p,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw d().ULS.shipAssertTag(596121484,c.nh.msoulscat_ES_EWAJS,!1,e),new k(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=Lt(o)}}function Xt(){return Zt}const Zt={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};function Qt(e,t,r){return new rr(e,t,r)}function er(e,t,r){return new rr(e,t,r)}const tr="message";class rr{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Xt().removeEventListener(tr,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return d().ULS.traceTag(596452370,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return d().ULS.traceTag(596452371,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return d().ULS.traceTag(596452372,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return d().ULS.traceTag(596452373,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){d().ULS.traceTag(596452374,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${c.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){d().ULS.traceTag(596452184,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${c.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{d().ULS.traceTag(595985880,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`Window RPC Receiver: unable to process incoming message. ${c.Wp.getStringifiedError(e)}`)}))}catch(e){d().ULS.traceTag(596452186,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`Window RPC Receiver: unable to process incoming message. ${c.Wp.getStringifiedError(e)}`)}else d().ULS.traceTag(596452185,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new A(p,"deserializer");if(!t)throw new A(p,"handler");if(!r)throw new A(p,"windowRPC");this.disposableImplementationExtension=Lt("WindowRPCReceiverInternal"),this.remoteWindow=qt(r.remoteWindow),Xt().addEventListener(tr,this.windowMessageHandler)}}function or(e,t){return new ar(e,t)}function nr(e,t){return new ar(e,t)}class ar{postMessage(e){if(!e)throw new A(p,"outgoingMessage");if(!this.remoteWindow.window)throw new k("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new k("The remote window does not support postMessage");const t=this.serializer.serialize(e);oe().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new A(p,"serializer");if(!t)throw new A(p,"windowRPC");this.disposableImplementationExtension=Lt("WindowRPCSenderInternal"),this.remoteWindow=qt(t.remoteWindow)}}const ir="OfficeOnlineCCP_",sr=ir+"Metadata_",cr=ir+"Data_",lr="_LocalStorageChangedFlag";function dr(){try{const e="XLO_CCP",t="1";return localStorage.setItem(e,t),localStorage.getItem(e)===t}catch{return!1}}function ur(e){return cr+e}function pr(e){return sr+e}function fr(e){return pr(e)+lr}class mr{constructor(){this.copyStatus=gr.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class hr{profilingMessage(e){const t=c.TZ.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=c.TZ.timeStamp()}}var gr;function yr(){return{}}function _r(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}function Sr(e){try{d().ULS.traceTag(595716237,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Attempting to create clipboard storage type '${$e.LocalStorage}'`);const t=new br(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(gr||(gr={}));class br{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),d().ULS.traceTag(595716238,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:p}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(Ae());try{const e=JSON.parse(t);if(!e||0===We(e))return Promise.resolve(Ae());const r=Me(e);return Promise.resolve(r)}catch(e){return Promise.resolve(Ae())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),d().ULS.traceTag(595716239,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`localStorageClipboardStorage.set: item count=${ke(e)}'; commandParameters.id='${t?t.id:p}'`),0===ke(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+lr}`,o=Tt();return d().ULS.traceTag(595654546,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[pe,me,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new N(_.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new N(_.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=$e.LocalStorage,this.disposableImplementationExtension=Lt("LocalStorageClipboardStorage")}}function Cr(e){return d().ULS.traceTag(595716236,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`Attempting to create clipboard strategy type '${y.LocalStorage}' with localStorageKey: '${e}'`),(new wr).initialize(Sr(e))}class wr extends Ft{constructor(e){super(y.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Er{onStorageChanged(e){d().ULS.shipAssertTag(595716249,c.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),d().ULS.traceTag(595716288,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),d().ULS.traceTag(595716289,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{d().ULS.traceTag(595716295,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return d().ULS.traceTag(595715525,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),d().ULS.traceTag(595716232,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{d().ULS.traceTag(595716233,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return d().ULS.traceTag(595715526,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(d().ULS.traceTag(595715527,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return d().ULS.traceTag(595715528,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=Rt(),r=new Date,o=setInterval((()=>{const n=(new Date).getTime()-r.getTime();d().ULS.traceTag(595715529,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),d().ULS.traceTag(595716234,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):n>e&&(clearInterval(o),d().ULS.traceTag(595716235,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}const Tr={},vr="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t},{entries:Pr,setPrototypeOf:Ir,isFrozen:Ar,getPrototypeOf:Wr,getOwnPropertyDescriptor:kr}=Object;let{freeze:Mr,seal:Or,create:xr}=Object,{apply:Lr,construct:Fr}="undefined"!=typeof Reflect&&Reflect;Mr||(Mr=function(e){return e}),Or||(Or=function(e){return e}),Lr||(Lr=function(e,t,r){return e.apply(t,r)}),Fr||(Fr=function(e,t){return new e(...t)});const Dr=Xr(Array.prototype.forEach),Rr=Xr(Array.prototype.lastIndexOf),Ur=Xr(Array.prototype.pop),$r=Xr(Array.prototype.push),jr=Xr(Array.prototype.splice),Nr=Xr(String.prototype.toLowerCase),Hr=Xr(String.prototype.toString),Jr=Xr(String.prototype.match),zr=Xr(String.prototype.replace),Gr=Xr(String.prototype.indexOf),Vr=Xr(String.prototype.trim),Br=Xr(Object.prototype.hasOwnProperty),Kr=Xr(RegExp.prototype.test),qr=(Yr=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Fr(Yr,t)});var Yr;function Xr(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return Lr(e,t,o)}}function Zr(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nr;Ir&&Ir(e,null);let o=t.length;for(;o--;){let n=t[o];if("string"==typeof n){const e=r(n);e!==n&&(Ar(t)||(t[o]=e),n=e)}e[n]=!0}return e}function Qr(e){for(let t=0;t<e.length;t++)Br(e,t)||(e[t]=null);return e}function eo(e){const t=xr(null);for(const[r,o]of Pr(e))Br(e,r)&&(Array.isArray(o)?t[r]=Qr(o):o&&"object"==typeof o&&o.constructor===Object?t[r]=eo(o):t[r]=o);return t}function to(e,t){for(;null!==e;){const r=kr(e,t);if(r){if(r.get)return Xr(r.get);if("function"==typeof r.value)return Xr(r.value)}e=Wr(e)}return function(){return null}}const ro=Mr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),oo=Mr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),no=Mr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ao=Mr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),io=Mr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),so=Mr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),co=Mr(["#text"]),lo=Mr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),uo=Mr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),po=Mr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),fo=Mr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mo=Or(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ho=Or(/<%[\w\W]*|[\w\W]*%>/gm),go=Or(/\$\{[\w\W]*/gm),yo=Or(/^data-[\-\w.\u00B7-\uFFFF]+$/),_o=Or(/^aria-[\-\w]+$/),So=Or(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bo=Or(/^(?:\w+script|data):/i),Co=Or(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wo=Or(/^html$/i),Eo=Or(/^[a-z][.\w]*(-[.\w]+)+$/i);var To=Object.freeze({__proto__:null,ARIA_ATTR:_o,ATTR_WHITESPACE:Co,CUSTOM_ELEMENT:Eo,DATA_ATTR:yo,DOCTYPE_NAME:wo,ERB_EXPR:ho,IS_ALLOWED_URI:So,IS_SCRIPT_OR_DATA:bo,MUSTACHE_EXPR:mo,TMPLIT_EXPR:go});var vo=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const r=t=>e(t);if(r.version="3.2.6",r.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return r.isSupported=!1,r;let{document:o}=t;const n=o,a=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:s,Node:c,Element:l,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:f,trustedTypes:m}=t,h=l.prototype,g=to(h,"cloneNode"),y=to(h,"remove"),_=to(h,"nextSibling"),S=to(h,"childNodes"),b=to(h,"parentNode");if("function"==typeof s){const e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let C,w="";const{implementation:E,createNodeIterator:T,createDocumentFragment:v,getElementsByTagName:P}=o,{importNode:I}=n;let A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof Pr&&"function"==typeof b&&E&&void 0!==E.createHTMLDocument;const{MUSTACHE_EXPR:W,ERB_EXPR:k,TMPLIT_EXPR:M,DATA_ATTR:O,ARIA_ATTR:x,IS_SCRIPT_OR_DATA:L,ATTR_WHITESPACE:F,CUSTOM_ELEMENT:D}=To;let{IS_ALLOWED_URI:R}=To,U=null;const $=Zr({},[...ro,...oo,...no,...io,...co]);let j=null;const N=Zr({},[...lo,...uo,...po,...fo]);let H=Object.seal(xr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),J=null,z=null,G=!0,V=!0,B=!1,K=!0,q=!1,Y=!0,X=!1,Z=!1,Q=!1,ee=!1,te=!1,re=!1,oe=!0,ne=!1,ae=!0,ie=!1,se={},ce=null;const le=Zr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const ue=Zr({},["audio","video","img","source","image","track"]);let pe=null;const fe=Zr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",he="http://www.w3.org/2000/svg",ge="http://www.w3.org/1999/xhtml";let ye=ge,_e=!1,Se=null;const be=Zr({},[me,he,ge],Hr);let Ce=Zr({},["mi","mo","mn","ms","mtext"]),we=Zr({},["annotation-xml"]);const Ee=Zr({},["title","style","font","a","script"]);let Te=null;const ve=["application/xhtml+xml","text/html"];let Pe=null,Ie=null;const Ae=o.createElement("form"),We=function(e){return e instanceof RegExp||e instanceof Function},ke=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ie||Ie!==e){if(e&&"object"==typeof e||(e={}),e=eo(e),Te=-1===ve.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Pe="application/xhtml+xml"===Te?Hr:Nr,U=Br(e,"ALLOWED_TAGS")?Zr({},e.ALLOWED_TAGS,Pe):$,j=Br(e,"ALLOWED_ATTR")?Zr({},e.ALLOWED_ATTR,Pe):N,Se=Br(e,"ALLOWED_NAMESPACES")?Zr({},e.ALLOWED_NAMESPACES,Hr):be,pe=Br(e,"ADD_URI_SAFE_ATTR")?Zr(eo(fe),e.ADD_URI_SAFE_ATTR,Pe):fe,de=Br(e,"ADD_DATA_URI_TAGS")?Zr(eo(ue),e.ADD_DATA_URI_TAGS,Pe):ue,ce=Br(e,"FORBID_CONTENTS")?Zr({},e.FORBID_CONTENTS,Pe):le,J=Br(e,"FORBID_TAGS")?Zr({},e.FORBID_TAGS,Pe):eo({}),z=Br(e,"FORBID_ATTR")?Zr({},e.FORBID_ATTR,Pe):eo({}),se=!!Br(e,"USE_PROFILES")&&e.USE_PROFILES,G=!1!==e.ALLOW_ARIA_ATTR,V=!1!==e.ALLOW_DATA_ATTR,B=e.ALLOW_UNKNOWN_PROTOCOLS||!1,K=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,q=e.SAFE_FOR_TEMPLATES||!1,Y=!1!==e.SAFE_FOR_XML,X=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,Q=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,ne=e.SANITIZE_NAMED_PROPS||!1,ae=!1!==e.KEEP_CONTENT,ie=e.IN_PLACE||!1,R=e.ALLOWED_URI_REGEXP||So,ye=e.NAMESPACE||ge,Ce=e.MATHML_TEXT_INTEGRATION_POINTS||Ce,we=e.HTML_INTEGRATION_POINTS||we,H=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&We(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&We(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),q&&(V=!1),te&&(ee=!0),se&&(U=Zr({},co),j=[],!0===se.html&&(Zr(U,ro),Zr(j,lo)),!0===se.svg&&(Zr(U,oo),Zr(j,uo),Zr(j,fo)),!0===se.svgFilters&&(Zr(U,no),Zr(j,uo),Zr(j,fo)),!0===se.mathMl&&(Zr(U,io),Zr(j,po),Zr(j,fo))),e.ADD_TAGS&&(U===$&&(U=eo(U)),Zr(U,e.ADD_TAGS,Pe)),e.ADD_ATTR&&(j===N&&(j=eo(j)),Zr(j,e.ADD_ATTR,Pe)),e.ADD_URI_SAFE_ATTR&&Zr(pe,e.ADD_URI_SAFE_ATTR,Pe),e.FORBID_CONTENTS&&(ce===le&&(ce=eo(ce)),Zr(ce,e.FORBID_CONTENTS,Pe)),ae&&(U["#text"]=!0),X&&Zr(U,["html","head","body"]),U.table&&(Zr(U,["tbody"]),delete J.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw qr('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw qr('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=e.TRUSTED_TYPES_POLICY,w=C.createHTML("")}else void 0===C&&(C=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let r=null;const o="data-tt-policy-suffix";t&&t.hasAttribute(o)&&(r=t.getAttribute(o));const n="dompurify"+(r?"#"+r:"");try{return e.createPolicy(n,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}}(m,a)),null!==C&&"string"==typeof w&&(w=C.createHTML(""));Mr&&Mr(e),Ie=e}},Me=Zr({},[...oo,...no,...ao]),Oe=Zr({},[...io,...so]),xe=function(e){$r(r.removed,{element:e});try{b(e).removeChild(e)}catch(t){y(e)}},Le=function(e,t){try{$r(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){$r(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{xe(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Fe=function(e){let t=null,r=null;if(Q)e="<remove></remove>"+e;else{const t=Jr(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===Te&&ye===ge&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const n=C?C.createHTML(e):e;if(ye===ge)try{t=(new f).parseFromString(n,Te)}catch(e){}if(!t||!t.documentElement){t=E.createDocument(ye,"template",null);try{t.documentElement.innerHTML=_e?w:n}catch(e){}}const a=t.body||t.documentElement;return e&&r&&a.insertBefore(o.createTextNode(r),a.childNodes[0]||null),ye===ge?P.call(t,X?"html":"body")[0]:X?t.documentElement:a},De=function(e){return T.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},Re=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Ue=function(e){return"function"==typeof c&&e instanceof c};function $e(e,t,o){Dr(e,(e=>{e.call(r,t,o,Ie)}))}const je=function(e){let t=null;if($e(A.beforeSanitizeElements,e,null),Re(e))return xe(e),!0;const o=Pe(e.nodeName);if($e(A.uponSanitizeElement,e,{tagName:o,allowedTags:U}),Y&&e.hasChildNodes()&&!Ue(e.firstElementChild)&&Kr(/<[/\w!]/g,e.innerHTML)&&Kr(/<[/\w!]/g,e.textContent))return xe(e),!0;if(7===e.nodeType)return xe(e),!0;if(Y&&8===e.nodeType&&Kr(/<[/\w]/g,e.data))return xe(e),!0;if(!U[o]||J[o]){if(!J[o]&&He(o)){if(H.tagNameCheck instanceof RegExp&&Kr(H.tagNameCheck,o))return!1;if(H.tagNameCheck instanceof Function&&H.tagNameCheck(o))return!1}if(ae&&!ce[o]){const t=b(e)||e.parentNode,r=S(e)||e.childNodes;if(r&&t)for(let o=r.length-1;o>=0;--o){const n=g(r[o],!0);n.__removalCount=(e.__removalCount||0)+1,t.insertBefore(n,_(e))}}return xe(e),!0}return e instanceof l&&!function(e){let t=b(e);t&&t.tagName||(t={namespaceURI:ye,tagName:"template"});const r=Nr(e.tagName),o=Nr(t.tagName);return!!Se[e.namespaceURI]&&(e.namespaceURI===he?t.namespaceURI===ge?"svg"===r:t.namespaceURI===me?"svg"===r&&("annotation-xml"===o||Ce[o]):Boolean(Me[r]):e.namespaceURI===me?t.namespaceURI===ge?"math"===r:t.namespaceURI===he?"math"===r&&we[o]:Boolean(Oe[r]):e.namespaceURI===ge?!(t.namespaceURI===he&&!we[o])&&!(t.namespaceURI===me&&!Ce[o])&&!Oe[r]&&(Ee[r]||!Me[r]):!("application/xhtml+xml"!==Te||!Se[e.namespaceURI]))}(e)?(xe(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!Kr(/<\/no(script|embed|frames)/i,e.innerHTML)?(q&&3===e.nodeType&&(t=e.textContent,Dr([W,k,M],(e=>{t=zr(t,e," ")})),e.textContent!==t&&($r(r.removed,{element:e.cloneNode()}),e.textContent=t)),$e(A.afterSanitizeElements,e,null),!1):(xe(e),!0)},Ne=function(e,t,r){if(oe&&("id"===t||"name"===t)&&(r in o||r in Ae))return!1;if(V&&!z[t]&&Kr(O,t));else if(G&&Kr(x,t));else if(!j[t]||z[t]){if(!(He(e)&&(H.tagNameCheck instanceof RegExp&&Kr(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&Kr(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&Kr(H.tagNameCheck,r)||H.tagNameCheck instanceof Function&&H.tagNameCheck(r))))return!1}else if(pe[t]);else if(Kr(R,zr(r,F,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Gr(r,"data:")||!de[e])if(B&&!Kr(L,zr(r,F,"")));else if(r)return!1;return!0},He=function(e){return"annotation-xml"!==e&&Jr(e,D)},Je=function(e){$e(A.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Re(e))return;const o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:j,forceKeepAttr:void 0};let n=t.length;for(;n--;){const a=t[n],{name:i,namespaceURI:s,value:c}=a,l=Pe(i),d=c;let u="value"===i?d:Vr(d);if(o.attrName=l,o.attrValue=u,o.keepAttr=!0,o.forceKeepAttr=void 0,$e(A.uponSanitizeAttribute,e,o),u=o.attrValue,!ne||"id"!==l&&"name"!==l||(Le(i,e),u="user-content-"+u),Y&&Kr(/((--!?|])>)|<\/(style|title)/i,u)){Le(i,e);continue}if(o.forceKeepAttr)continue;if(!o.keepAttr){Le(i,e);continue}if(!K&&Kr(/\/>/i,u)){Le(i,e);continue}q&&Dr([W,k,M],(e=>{u=zr(u,e," ")}));const p=Pe(e.nodeName);if(Ne(p,l,u)){if(C&&"object"==typeof m&&"function"==typeof m.getAttributeType)if(s);else switch(m.getAttributeType(p,l)){case"TrustedHTML":u=C.createHTML(u);break;case"TrustedScriptURL":u=C.createScriptURL(u)}if(u!==d)try{s?e.setAttributeNS(s,i,u):e.setAttribute(i,u),Re(e)?xe(e):Ur(r.removed)}catch(t){Le(i,e)}}else Le(i,e)}$e(A.afterSanitizeAttributes,e,null)},ze=function e(t){let r=null;const o=De(t);for($e(A.beforeSanitizeShadowDOM,t,null);r=o.nextNode();)$e(A.uponSanitizeShadowNode,r,null),je(r),Je(r),r.content instanceof i&&e(r.content);$e(A.afterSanitizeShadowDOM,t,null)};return r.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,a=null,s=null,l=null;if(_e=!e,_e&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Ue(e)){if("function"!=typeof e.toString)throw qr("toString is not a function");if("string"!=typeof(e=e.toString()))throw qr("dirty is not a string, aborting")}if(!r.isSupported)return e;if(Z||ke(t),r.removed=[],"string"==typeof e&&(ie=!1),ie){if(e.nodeName){const t=Pe(e.nodeName);if(!U[t]||J[t])throw qr("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)o=Fe("\x3c!----\x3e"),a=o.ownerDocument.importNode(e,!0),1===a.nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!ee&&!q&&!X&&-1===e.indexOf("<"))return C&&re?C.createHTML(e):e;if(o=Fe(e),!o)return ee?null:re?w:""}o&&Q&&xe(o.firstChild);const d=De(ie?e:o);for(;s=d.nextNode();)je(s),Je(s),s.content instanceof i&&ze(s.content);if(ie)return e;if(ee){if(te)for(l=v.call(o.ownerDocument);o.firstChild;)l.appendChild(o.firstChild);else l=o;return(j.shadowroot||j.shadowrootmode)&&(l=I.call(n,l,!0)),l}let u=X?o.outerHTML:o.innerHTML;return X&&U["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&Kr(wo,o.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+u),q&&Dr([W,k,M],(e=>{u=zr(u,e," ")})),C&&re?C.createHTML(u):u},r.setConfig=function(){ke(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},r.clearConfig=function(){Ie=null,Z=!1},r.isValidAttribute=function(e,t,r){Ie||ke({});const o=Pe(e),n=Pe(t);return Ne(o,n,r)},r.addHook=function(e,t){"function"==typeof t&&$r(A[e],t)},r.removeHook=function(e,t){if(void 0!==t){const r=Rr(A[e],t);return-1===r?void 0:jr(A[e],r,1)[0]}return Ur(A[e])},r.removeHooks=function(e){A[e]=[]},r.removeAllHooks=function(){A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();const Po={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},Io=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],Ao=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],Wo=vo||t,ko=(Wo.isValidAttribute,((e,t,r=vr,o,n=!1)=>{try{Tr[e]||(Tr[e]=r.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){if(o?.(`${e}`),n)throw e}return Tr[e]})("domPurifyHTML",{createHTML:(e,t,r)=>((e,t,r)=>{let o=!1;const n=t?(e=>({...Po,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE??"text/html"}))(t):Po;r&&Object.entries(r).forEach((([e,t])=>{Wo.addHook(e,t)}));const a=Wo.sanitize(e,n);return r&&Object.entries(r).forEach((([e])=>{Wo.removeHooks(e)})),t?.USE_PROFILES?a:(o=(e=>{let t=!1,r=!1;const o=new Set,n=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=Ao.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=Io.includes(e.element.localName)||r,n.add(e.element.localName))})),(o.size>0||n.size>0)&&(r||(t=!0))),t})(Wo.removed),o?e:a)})(e,t,r)},undefined));const Mo="\t",Oo="\n",xo="\r",Lo=new RegExp(`(${Oo}${xo})|(${xo}${Oo})|(${xo})`,"g"),Fo=new RegExp(`(${Mo})`,"g"),Do=10240,Ro=new RegExp("<","g"),Uo="&lt;",$o=new RegExp(">","g"),jo="&gt;",No="div",Ho="pre",Jo="table",zo="tr",Go="td",Vo="\x3c!--StartFragment--\x3e",Bo="\x3c!--EndFragment--\x3e",Ko=Vo.length,qo=Bo.length,Yo=`Version:0.9${Oo}StartHTML:0000000100${Oo}EndHTML:{EndHTML0}${Oo}StartFragment:0000000134${Oo}EndFragment:{EndFragm}${Oo}<html>${Oo}<body>${Oo}${Vo}${Oo}`,Xo=`${Bo}${Oo}</body>${Oo}</html>`,Zo="0000000000",Qo=7,en="data-ccp-timestamp",tn=0;function rn(e){return e?e.replace(Lo,Oo):e}function on(e){return e?e.length<=Do?e:e.substr(0,Do):p}function nn(e){var t;const r=function(e){return e?e.replace(Lo,`</${Go}></${zo}><${zo}><${Go}>`):e}((t=mn(e))?t.replace(Fo,`</${Go}><${Go}>`):t);return`<${Jo}><${zo}><${Go}>${r}</${Go}></${zo}></${Jo}>`}function an(e,t,r){if(r!==tn&&!r)throw new A(p,"timestamp");if(isNaN(r))throw new W(p,"timestamp",r.toString());const o=function(e,t,r){return`<${e} ${en}='${r}'>${t}</${e}>`}(e,nn(t),r);return dn(o)}function sn(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=cn(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(xo),t.push(Oo);const o=cn(r[e]);t.push(o)}}return t.join("")}function cn(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push(Mo),t.push(r[e].innerText)}return t.join("")}function ln(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(en)}function dn(e){if(!Q()||te())return e;const t=Zo.length,r=Yo.length+e.length+Xo.length;let o=(r-Xo.length).toString();if(o.length<t&&(o=Zo.substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be ${t}`;throw d().ULS.shipAssertTag(596128536,c.nh.msoulscat_ES_EWAJS,!1,e),new N(_.UnexpectedClipboardTextHtmlContentLength,e)}let n=(r-Qo).toString();if(n.length<t&&(n=Zo.substr(0,t-n.length)+n),n.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${n.length} but it should be ${t}`;throw d().ULS.shipAssertTag(596128537,c.nh.msoulscat_ES_EWAJS,!1,e),new N(_.UnexpectedClipboardTextHtmlContentLength,e)}const a=Yo.replace("{EndHTML0}",n).replace("{EndFragm}",o)+e+Xo;return d().ULS.shipAssertTag(596128538,c.nh.msoulscat_ES_EWAJS,a.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${a.length} differs from the expected length of ${r}`),a}function un(e){if(!e)return p;if(!e.trim())return e;const t=e.indexOf(Vo),r=e.indexOf(Bo);if(t<0||r<0||t>r)return e;const o=t+Ko,n=r-o,a=e.indexOf(Vo,o),i=e.indexOf(Bo,r+qo);return a>=0||i>=0?e:e.substr(o,n)}function pn(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new A(p,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,en);if(!t||!t.trim())return;const r=Number(t);return!r&&r!==tn||isNaN(r)?void 0:r}function fn(e){if(!e||!e.trim())return;const t=new DOMParser,r=ko.createHTML(e),o=t.parseFromString(r,"text/html"),n=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void d().ULS.shipAssertTag(595683460,c.nh.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";d().ULS.traceTag(595683457,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(o);if(void 0!==n)return n;const a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(o);return void 0!==a?a:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(o)?"Google Docs":void 0}function mn(e){return e?e.replace(Ro,Uo).replace($o,jo):p}function hn(e,t,r){let o="";return r&&(o=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${o}>${e}</${t}>`}function gn(e,t,r){return new yn(e,t,r)}class yn{get clipboardStrategy(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new k("clipboardPlatformEnvironment is missing")}onCopy(e){if(!e)return Promise.reject(new U(S.MissingArgumentError,"Missing commandParameters argument",new A(p,"commandParameters")));let t,r;this.initialClipboardStrategyType=e.dataClipboardStrategyType,t=new mr;try{t.id=vt(),d().ULS.traceTag(595937123,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onCopy: copy ${t.id} started.`),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;const o=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(o,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(o,t),d().ULS.traceTag(595937152,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after serialize.`),this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)&&r&&r.synchronousResult&&r.synchronousResult.setItem(Te,this.metadataManager.serializeMetadata({lastCopy:{...t,copyStatus:t.isFromCache?gr.Completed:gr.SynchronousPhaseCompleted}})),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?d().ULS.traceTag(595734742,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onCopy: catching error for copy id ${t.id} during serialize.`):d().ULS.traceTag(595734743,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.onCopy: catching error and no copy context during serialize. CopyCommandId: ${e?.id}`),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return this.writeClipboardItems(e,t,r).then((()=>this.rejectIfCopyCancelled(t))).then((()=>(d().ULS.traceTag(504715104,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,`CopyPasteFlowManager.onCopy: Write to clipboard completed for both sync and async phase. CopyId: ${t?.id}.`),this.copyCompleteCleanup(t,e),t)),(r=>{d().ULS.traceTag(595734747,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onCopy: Error in writeClipboardItems. CopyId: ${t?.id}. Error: ${c.Wp.getStringifiedError(r)}`);let o=r;return this.copyCompleteCleanup(t,e),o||(d().ULS.shipAssertTag(595854806,c.nh.msoulscat_ES_EWAJS,!1,`copyPasteFlowManager.onCopy: promise rejected without error. CopyId: ${t?.id}.`),o=new U(S.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),o.copyContext=t,Promise.reject(o)}))}catch(r){return this.copyCompleteCleanup(t,e),d().ULS.traceTag(596456160,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. CopyId: ${t?.id}. Exception: ${c.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(new U(S.SaveToTheClipboardFailed,`Failed to store content in the clipboard (with an exception): ${r.message}`,r))}}onPaste(e){const t=new hr;try{if(!e)return Promise.reject(new $(b.MissingArgumentError,"Missing commandParameters argument",new A(p,"commandParameters")));this.initialClipboardStrategyType=e.dataClipboardStrategyType,e.isTimestampStoredInSystemClipboard=!0,t.id=Tt(),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e,t.clipboardItems=Ae(),t.isClipboardInaccessible=!1,d().ULS.traceTag(595685636,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("start"));const r=this.metadataManager.getCachedMetadata();t.copyContextSnapshot=r.lastCopy,this.applicationHost.initializePasteContext(t),t.copyContextSnapshot?d().ULS.traceTag(595937154,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onPaste: paste started for copy id ${t.copyContextSnapshot.id}`):d().ULS.traceTag(595730637,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");let o,n=!1;return e.skipClipboardAccess?(d().ULS.traceTag(595685637,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("skipClipboardAccess")),o=Promise.resolve()):o=this.readFromClipboard(t,e).then((r=>{if(d().ULS.traceTag(595685638,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("readFromClipboard_then")),e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)){let e={lastCopy:void 0};if(!this.isEmptyClipboard(r)){const o=r.getItem(Te);o&&(e=this.metadataManager.deserializeMetadata(o),(!t?.copyContextSnapshot||t.copyContextSnapshot.id!==e?.lastCopy?.id||t?.copyContextSnapshot?.id===e?.lastCopy?.id&&t?.copyContextSnapshot?.copyStatus!==gr.Completed&&e?.lastCopy?.copyStatus===gr.Completed)&&(t.copyContextSnapshot=e?.lastCopy,this.metadataManager.updateMetadata(e)))}e?.lastCopy||(t.copyContextSnapshot=void 0,this.metadataManager.updateMetadata({lastCopy:void 0}),r.setItem(_e,h))}return t.clipboardItems=r,Promise.resolve()}),(e=>e&&e.reason&&e.reason===b.ClipboardIsInaccessible?(t.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e))),o.then((()=>e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)?t:this.readClipboardItemsAgainIfMetadataNotSync(t,e))).then((()=>(d().ULS.traceTag(595685639,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("getPasteFlowHandler")),this.getPasteFlowHandler(t)))).then((e=>(n||e.beforePaste&&e.beforePaste(t),e))).then((r=>{if(d().ULS.traceTag(595685640,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("getPasteFlowHandler_then")),t.clipboardItems?.getItem(_e)!==h&&!t.isSameSession&&(!e.isAsyncClipboardAPI||!this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType))&&t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus!==gr.Completed&&r.shouldWaitForCopyToComplete(t)){d().ULS.traceTag(595937155,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (${t.copyContextSnapshot.id}) to complete. current status ${t.copyContextSnapshot.copyStatus}. copy session id is ${t.copyContextSnapshot.sessionId}`),d().ULS.traceTag(595683427,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("onDeferredPasteStarted")),r.onDeferredPasteStarted(t);const o=this.continueWhenCopyComplete(e,t).then((e=>(d().ULS.traceTag(595685642,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("onDeferredPasteCompleted")),r.onDeferredPasteCompleted(t),t.copyContextSnapshot=this.metadataManager.getCachedMetadata().lastCopy,t.clipboardItems=e,r)),(e=>(r.onDeferredPasteCompleted(t),d().ULS.traceTag(595882504,c.nh.msoulscat_ES_EWAJS,c.kp.Error,`CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [${e}]`),Promise.reject(e))));return d().ULS.traceTag(595685643,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("continueWhenCopyComplete")),this.testHook("continueWhenCopyComplete"),o}return d().ULS.traceTag(595940941,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onPaste: not wait for copy(${t.copyContextSnapshot&&t.copyContextSnapshot.id}) to complete. is copyContextSnapshot defined: ${void 0!==t.copyContextSnapshot}. copyStatus: ${t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus}`),r})).then((e=>this.deserialize(e,t))).then((()=>{d().ULS.traceTag(595685644,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("deserialize_then")),t.clipboardItems&&t.clipboardItems.getItem(_e)===h&&(d().ULS.traceTag(595685645,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("onSystemClipboardChangedExternally")),this.onSystemClipboardChangedExternally())})).then((()=>{const e=t.clipboardItems;if(void 0===e)return;const r=e.getItem(me);if(void 0!==r){const e=fn(r);void 0!==e&&(t.externalAppSource=e)}})).then((()=>t)).catch((e=>{let r=e;return r||(d().ULS.shipAssertTag(595858762,c.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),r=new $(b.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),r.pasteContext=t,Promise.reject(r)}))}catch(e){return d().ULS.shipAssertTag(596456161,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ${c.Wp.getStringifiedError(e)}`),Promise.reject(new $(b.FailedToReadFromClipboard,`Failed to read data from the clipboard (with an exception): ${e.message}`,e,t))}}onCancelCopy(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,d().ULS.traceTag(595734748,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ${this.inProgressCopyContext.id}.`)):d().ULS.traceTag(595734749,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();const t=Ae(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:je.Copy};return this.clipboardStrategy.set(t,r).catch((e=>(d().ULS.traceTag(596456162,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ${c.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new j(C.FailedToClearClipboard,`Failed to clear the clipboard: ${e.message}`,e)))))}catch(e){return d().ULS.traceTag(596456163,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ${c.Wp.getStringifiedError(e)}`),Promise.reject(new j(C.FailedToClearClipboard,`Failed to clear the clipboard (with an exception): ${e.message}`,e))}}isAsyncClipboardEnhancementsEnabled(e){return this.isAsyncClipboardEnhancementsFGEnabled&&e===y.AsyncSystemClipboard}async onSystemClipboardChangedExternally(){this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0});const e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:je.Copy};await this.clipboardStrategy.onSystemClipboardChangedExternally(e)}readClipboardItemsAgainIfMetadataNotSync(e,t){let r=!1;return this.metadataManager.getMetadataSyncPromise().then((t=>{t&&t.lastCopy?(e.copyContextSnapshot&&(r=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,d().ULS.traceTag(595937158,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ${e.copyContextSnapshot.id}. copy status = ${e.copyContextSnapshot.copyStatus}. isMetadataChanged = ${r}`)):d().ULS.traceTag(595937025,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((()=>r?this.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems))).then((t=>(e.clipboardItems=t,e)))}getCopyFlowHandler(e){let t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw d().ULS.shipAssertTag(596456192,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ${c.Wp.getStringifiedError(e)}`),new U(S.FetchCopyFlowHandlerFailed,`applicationHost.getCopyFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw d().ULS.shipAssertTag(596456193,c.nh.msoulscat_ES_EWAJS,!1,e),new U(S.CopyFlowHandlerNotFound,e)}return t}getSourceItem(e,t){try{return e.getSourceItem(t)}catch(e){throw d().ULS.shipAssertTag(596456194,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ${c.Wp.getStringifiedError(e)}`),new U(S.FetchSourceItemFailed,`applicationHost.getSourceItem failed with an exception: ${e.message}`,e)}}serialize(e,t){try{e.beforeSerialize(t)}catch(e){throw d().ULS.shipAssertTag(596456195,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception. CopyId: ${t?.id}. Error: ${c.Wp.getStringifiedError(e)}`),new U(S.BeforeSerializeFailed,`copyFlowHandler.beforeSerialize failed with an exception: ${e.message}`,e)}let r;d().ULS.traceTag(504715103,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,`CopyPasteFlowManager.serialize: copyFlowHandler.beforeSerialize completed. CopyId: ${t?.id}.`);try{r=e.serialize(t)}catch(e){throw d().ULS.shipAssertTag(596456196,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize failed with an exception. CopyId: ${t?.id}. Error: ${c.Wp.getStringifiedError(e)}`),new U(S.SerializeFailed,`copyFlowHandler.serialize failed with an exception: ${e.message}`,e)}if(!r)throw d().ULS.shipAssertTag(596456197,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize should return a non null result. CopyId: ${t?.id}.`),new U(S.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return d().ULS.traceTag(504715102,c.nh.msoulscat_ES_EWAJS,c.kp.Verbose,`CopyPasteFlowManager.serialize completed. CopyId: ${t?.id}.`),r}setClipboardSync(e,t,r){try{r?d().ULS.traceTag(595734750,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ${r.id}.`):d().ULS.traceTag(595734751,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");let o=e;return o||(o=Ae()),this.clipboardStrategy.set(o,t).catch((e=>{if(d().ULS.traceTag(596456198,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ${t.isKeyboardEvent}, Error: ${c.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason){const t=e;if(t.reason===_.ClipboardIsInaccessible)return Promise.reject(new U(S.ClipboardIsInaccessible,t.message,t));if(t.reason===_.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new U(S.SuccessiveCutCopyOverridingPendingCutCopy,`A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ${t.message}`,t));if(t.reason===_.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new U(S.BlockedSynchronousCutCopy,`In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ${t.message}`,t))}return Promise.reject(new U(S.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard: ${e.message}`,e))})).then((()=>{r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return d().ULS.shipAssertTag(596456199,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ${c.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new U(S.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard (with an exception): ${e.message}`,e))}}setClipboardAsync(e,t,r){return d().ULS.traceTag(595734752,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ${r.id}.`),e?e.then((e=>{try{if(d().ULS.traceTag(505794970,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.setClipboardAsync: clipboardItemsPromise resolved for copy id ${r?.id}.`),this.isEmptyClipboard(e))return Promise.resolve();this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&e.setItem(Te,this.metadataManager.serializeMetadata({lastCopy:{...r,copyStatus:gr.Completed}}));const o=t.stopwatch;t.stopwatch=void 0;const n={...t};return n.isTimestampStoredInSystemClipboard=!1,t.isAsyncSystemClipboardEnabled&&this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&(n.stopwatch=o),t.stopwatch=o,t.isKeyboardEvent&&(n.isKeyboardEvent=!1,n.silentClipboardAccessFailures=!0),this.clipboardStrategy.set(e,n).catch((e=>(d().ULS.traceTag(596456200,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Error: ${c.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason&&e.reason===_.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new U(S.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard: ${e&&e.message}`,e))))).then((()=>{d().ULS.traceTag(505794969,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.setClipboardAsync: setClipboardAsync completed for copy id ${r.id}.`),r.succeededPopulatingSystemClipboardAsync=n.isTimestampStoredInSystemClipboard}))}catch(e){return d().ULS.shipAssertTag(596456201,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Exception: ${c.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new U(S.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard (with an exception): ${e.message}`,e))}}),(e=>(r.isAsyncSerializeFailed=!0,d().ULS.traceTag(596456202,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. CopyId: ${r?.id}. Error: ${c.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`),Promise.reject(new U(S.AsyncSerializeFailed,`Failed to asynchronously serialize the content. Error: ${e?e.message:"..."}`,e))))):(d().ULS.traceTag(595734753,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ${r.id}.`),Promise.resolve())}isEmptyClipboard(e){return e?0===ke(e)&&(d().ULS.traceTag(596456204,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(d().ULS.traceTag(596456203,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)}writeClipboardItems(e,t,r){return this.isAsyncClipboardEnhancementsEnabled(e?.dataClipboardStrategyType)?this.writeClipboardItemsInSyncPhase(e,t,r).then((()=>this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t))))):Promise.all([this.writeClipboardItemsInSyncPhase(e,t,r),this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t)))])}writeClipboardItemsInSyncPhase(e,t,r){return this.setClipboardSync(r.synchronousResult,e,t).then((()=>this.rejectIfCopyCancelled(t))).then((()=>{t.copyStatus=gr.SynchronousPhaseCompleted,d().ULS.traceTag(595937153,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after status changed to SynchronousPhaseCompleted.`),this.metadataManager.updateMetadata({lastCopy:t})})).catch((r=>{if(t?d().ULS.traceTag(595734744,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: Error in setClipboardSync. CopyId: ${t?.id}. Error: ${c.Wp.getStringifiedError(r)}`):d().ULS.traceTag(595734745,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: no copy context. CopyCommandId: ${e?.id}`),r&&r.reason){const e=r.reason;if(e===S.SuccessiveCutCopyOverridingPendingCutCopy||e===S.BlockedSynchronousCutCopy||e===S.CopyOperationCancelled||this.initialClipboardStrategyType===y.AsyncSystemClipboard&&e===S.ClipboardIsInaccessible)return d().ULS.traceTag(595734746,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. CopyId: ${t?.id}. Rejecting the promise: ${c.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(r)}return d().ULS.traceTag(596456159,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality. CopyId: ${t?.id}. Error: ${c.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),this.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}))}readFromClipboard(e,t){d().ULS.traceTag(595685646,c.nh.msoulscat_ES_EWAJS,c.kp.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);const r=this.clipboardStrategy.get(t);return d().ULS.traceTag(595685647,c.nh.msoulscat_ES_EWAJS,c.kp.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((t=>(d().ULS.traceTag(595685648,c.nh.msoulscat_ES_EWAJS,c.kp.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(d().ULS.traceTag(596456206,c.nh.msoulscat_ES_EWAJS,c.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new $(b.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new $(b.ClipboardIsEmpty,p)))))),(e=>{if(d().ULS.traceTag(596456207,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ${c.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return d().ULS.traceTag(577249542,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);const r=e;return w(e,_.ClipboardIsInaccessible)?Promise.reject(new $(b.ClipboardIsInaccessible,r.message,r)):w(e,_.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new $(b.SuccessivePasteOverridingPendingPaste,`A successive Paste user event occurred before the last Paste browser event fired: ${r.message}`,r)):w(e,_.AsyncClipboardReadFailure)?Promise.reject(new $(b.FailedToReadFromAsyncClipboard,r.message,r)):Promise.reject(new $(b.FailedToReadFromClipboard,`Failed to read data from the clipboard: ${e.message}`,e))})):(d().ULS.shipAssertTag(596456205,c.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new $(b.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new $(b.ReadFromClipboardReturnNullOrUndefined,p))))}getPasteFlowHandler(e){let t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw d().ULS.shipAssertTag(596456208,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ${c.Wp.getStringifiedError(e)}`),new $(b.FetchPasteFlowHandlerFailed,`applicationHost.getPasteFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw d().ULS.shipAssertTag(596456209,c.nh.msoulscat_ES_EWAJS,!1,e),new $(b.PasteFlowHandlerNotFound,e)}return t}deserialize(e,t){return d().ULS.traceTag(595683456,c.nh.msoulscat_ES_EWAJS,c.kp.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((e=>{const t=c.Wp.getStringifiedError(e);return d().ULS.traceTag(596456210,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ${t}.`),Promise.reject(new $(b.DeserializeOperationFailed,`Deserialization failed: ${t}`,e))}))}copyCompleteCleanup(e,t){e?(d().ULS.traceTag(595734754,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ${e.id}.`),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=gr.Completed,d().ULS.traceTag(595937159,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ${e.id} after copy completed.`),this.metadataManager.updateMetadata({lastCopy:e})):d().ULS.traceTag(595734755,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ${e.id}.`)):d().ULS.traceTag(595734784,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.copyCompleteCleanup: no copy context. CopyCommandId: ${t?.id}`)}readRichClipboardOnly(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((e=>(d().ULS.traceTag(595937160,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e)),(e=>(d().ULS.traceTag(595940942,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,`CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ${c.Wp.getStringifiedError(e)}. use clipboard items from the first read as fallback.`),Promise.resolve(r))))}continueWhenCopyComplete(e,t){if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===gr.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(d().ULS.shipAssertTag(595937161,c.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(${this.deferredPasteData.copyContextId} !== ${t.copyContextSnapshot.id}) exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)`),this.rejectDeferredPasteData(b.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){const r=this.metadataManager.getCachedMetadata();if(r&&r.lastCopy&&r.lastCopy.copyStatus===gr.Completed&&r.lastCopy.id===t.copyContextSnapshot.id)return d().ULS.traceTag(595937162,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: copy ${r.lastCopy.id} already completed, not need for waiting any longer, reading the rich clipboard items`),this.readRichClipboardOnly(t,e,t.clipboardItems);const o=Rt(),n=o.promise.then((()=>this.readRichClipboardOnly(t,e,t.clipboardItems)));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:o,readClipboardPromise:n,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,d().ULS.traceTag(595937163,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}`),this.deferredPasteData.readClipboardPromise}rejectDeferredPasteData(e){if(this.deferredPasteData){d().ULS.traceTag(595937164,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new $(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}}resolveDeferredPasteData(){if(this.deferredPasteData){d().ULS.traceTag(595937165,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}}rejectIfCopyCancelled(e){return e?d().ULS.traceTag(595734785,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ${e.id}.`):d().ULS.traceTag(595734786,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(d().ULS.traceTag(595734787,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ${e.id}.`),Promise.reject(new U(S.CopyOperationCancelled,`CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ${e.id} is marked for cancellation`))):(e&&d().ULS.traceTag(595734788,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ${e.id}.`),Promise.resolve())}clearInProgressCopyIfNeeded(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(d().ULS.traceTag(595937166,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ${this.inProgressCopyContext.id}) as new copy started (${e.id})`),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)}onMetadataChanged(e){e&&e.lastCopy?(d().ULS.traceTag(595937167,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onMetadataChanged: the status of copy id ${e.lastCopy.id} from session ${e.lastCopy.sessionId} changed to ${e.lastCopy.copyStatus}`),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(d().ULS.traceTag(595734789,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ${e.lastCopy.id} is not equal to ${this.deferredPasteData.copyContextId}`),this.rejectDeferredPasteData(b.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===gr.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(d().ULS.traceTag(595734790,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(d().ULS.traceTag(595724049,c.nh.msoulscat_ES_EWAJS,c.kp.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(b.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))}onCopyCompletedSuccessfully(e){e?d().ULS.traceTag(595734791,c.nh.msoulscat_ES_EWAJS,c.kp.Info,`CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ${e.id}.`):d().ULS.traceTag(595734792,c.nh.msoulscat_ES_EWAJS,c.kp.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===gr.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()}testHook(e){}constructor(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,this.isAsyncClipboardEnhancementsFGEnabled=!1,!r)throw new A(p,"logger");u(r),d().ULS.shipAssertTag(596456157,c.nh.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),d().ULS.shipAssertTag(596456158,c.nh.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),d().ULS.shipAssertTag(596456156,c.nh.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid"),this.isAsyncClipboardEnhancementsFGEnabled=((e,t=!1)=>a?a.getBooleanFeatureGate(e,t):t)("Microsoft.Office.Excel.AsyncClipboardEnhancements",!1)}}var _n=r(780);class Sn{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const bn=new class{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,r,o){this.externalLogger.sendTraceTag(e,t,r,o)}debugAssertTag(e,t,r,o){this.externalLogger.debugAssertTag(e,t,r,o)}shipAssertTag(e,t,r,o){this.externalLogger.shipAssertTag(e,t,r,o)}forwardFeedbackCacheLogs(){this.externalLogger.forwardFeedbackCacheLogs?.()}constructor(){this.externalLogger=new Sn}};var Cn,wn;!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleLicensing=4013]="msoulscat_AIHub_CreateModuleLicensing",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(Cn||(Cn={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(wn||(wn={}));var En=r(194),Tn=r(454);let vn,Pn=!1;async function In(e){if(Pn)return bn.sendTraceTag(504452609,Cn.msoulscat_ES_EWAJS,wn.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Worker already initialized"),null;const t=(0,Tn.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.OfficeVSO_10358639_EnableTTPolicyWorkerConstructor3");try{const r={reportProgress(e){vn&&vn(e)}},o=await(0,En.createWorker)({id:"HtmlMinifierWorker",createMode:"Thread",isTrustedTypesPolicyEnabled:t},{scriptUrl:e,insideInitName:"htmlMinifierWorker.htmlMinifierWorkerServiceInit"},(()=>r));return o?(Pn=!0,bn.sendTraceTag(504452579,Cn.msoulscat_ES_EWAJS,wn.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: worker endpoint created"),{minifyHtml:async(e,t)=>(vn=t,await o.call.minifyHtml(e))}):(bn.sendTraceTag(504452608,Cn.msoulscat_ES_EWAJS,wn.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Worker endpoint not initialized"),null)}catch(e){return bn.sendTraceTag(504451539,Cn.msoulscat_ES_EWAJS,wn.Info,`HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Failed to create worker - ${e}`),null}}function An(e){s.setFeatureGateManager(e)}}(),copyPasteInfra=o}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/copyPasteInfra.min.js.map/7a3312795bfd2eee7730b6897cdb98d9/copyPasteInfra.min.js.map